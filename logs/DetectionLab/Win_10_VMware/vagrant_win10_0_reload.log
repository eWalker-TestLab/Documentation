 INFO global: Vagrant version: 2.2.19
 INFO global: Ruby version: 2.7.4
 INFO global: RubyGems version: 3.1.6
 INFO global: VAGRANT_EXECUTABLE="C:\\Program_Files\\HashiCorp\\Vagrant\\embedded\\gems\\2.2.19\\gems\\vagrant-2.2.19\\bin\\vagrant"
 INFO global: VAGRANT_INSTALLER_EMBEDDED_DIR="C:\\Program_Files\\HashiCorp\\Vagrant\\embedded"
 INFO global: VAGRANT_INSTALLER_ENV="1"
 INFO global: VAGRANT_INSTALLER_VERSION="2"
 INFO global: VAGRANT_LOG="debug"
 WARN global: resolv replacement has not been enabled!
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/autocomplete/plugin.rb
 INFO manager: Registered plugin: autocomplete command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/box/plugin.rb
 INFO manager: Registered plugin: box command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/cap/plugin.rb
 INFO manager: Registered plugin: cap command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/cloud/plugin.rb
 INFO manager: Registered plugin: vagrant-cloud
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/destroy/plugin.rb
 INFO manager: Registered plugin: destroy command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/global-status/plugin.rb
 INFO manager: Registered plugin: global-status command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/halt/plugin.rb
 INFO manager: Registered plugin: halt command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/help/plugin.rb
 INFO manager: Registered plugin: help command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/init/plugin.rb
 INFO manager: Registered plugin: init command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/list-commands/plugin.rb
 INFO manager: Registered plugin: list-commands command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/login/plugin.rb
 INFO manager: Registered plugin: vagrant-login
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/package/plugin.rb
 INFO manager: Registered plugin: package command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/plugin/plugin.rb
 INFO manager: Registered plugin: plugin command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/port/plugin.rb
 INFO manager: Registered plugin: port command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/powershell/plugin.rb
 INFO manager: Registered plugin: powershell command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/provider/plugin.rb
 INFO manager: Registered plugin: provider command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/provision/plugin.rb
 INFO manager: Registered plugin: provision command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/push/plugin.rb
 INFO manager: Registered plugin: push command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/rdp/plugin.rb
 INFO manager: Registered plugin: rdp command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/reload/plugin.rb
 INFO manager: Registered plugin: reload command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/resume/plugin.rb
 INFO manager: Registered plugin: resume command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/snapshot/plugin.rb
 INFO manager: Registered plugin: snapshot command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/ssh/plugin.rb
 INFO manager: Registered plugin: ssh command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/ssh_config/plugin.rb
 INFO manager: Registered plugin: ssh-config command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/status/plugin.rb
 INFO manager: Registered plugin: status command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/suspend/plugin.rb
 INFO manager: Registered plugin: suspend command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/up/plugin.rb
 INFO manager: Registered plugin: up command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/upload/plugin.rb
 INFO manager: Registered plugin: upload command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/validate/plugin.rb
 INFO manager: Registered plugin: validate command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/version/plugin.rb
 INFO manager: Registered plugin: version command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/winrm/plugin.rb
 INFO manager: Registered plugin: winrm command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/winrm_config/plugin.rb
 INFO manager: Registered plugin: winrm-config command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/ssh/plugin.rb
 INFO manager: Registered plugin: ssh communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/winrm/plugin.rb
 INFO manager: Registered plugin: winrm communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/winssh/plugin.rb
 INFO manager: Registered plugin: windows ssh communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/alpine/plugin.rb
 INFO manager: Registered plugin: Alpine guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/alt/plugin.rb
 INFO manager: Registered plugin: ALT Platform guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/amazon/plugin.rb
 INFO manager: Registered plugin: Amazon Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/arch/plugin.rb
 INFO manager: Registered plugin: Arch guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/atomic/plugin.rb
 INFO manager: Registered plugin: Atomic Host guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/bsd/plugin.rb
 INFO manager: Registered plugin: BSD-based guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/centos/plugin.rb
 INFO manager: Registered plugin: CentOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/coreos/plugin.rb
 INFO manager: Registered plugin: CoreOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/darwin/plugin.rb
 INFO manager: Registered plugin: Darwin guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/debian/plugin.rb
 INFO manager: Registered plugin: Debian guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/dragonflybsd/plugin.rb
 INFO manager: Registered plugin: DragonFly BSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/elementary/plugin.rb
 INFO manager: Registered plugin: Elementary guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/esxi/plugin.rb
 INFO manager: Registered plugin: ESXi guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/fedora/plugin.rb
 INFO manager: Registered plugin: Fedora guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/freebsd/plugin.rb
 INFO manager: Registered plugin: FreeBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/funtoo/plugin.rb
 INFO manager: Registered plugin: Funtoo guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/gentoo/plugin.rb
 INFO manager: Registered plugin: Gentoo guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/haiku/plugin.rb
 INFO manager: Registered plugin: Haiku guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/kali/plugin.rb
 INFO manager: Registered plugin: Kali guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/linux/plugin.rb
 INFO manager: Registered plugin: Linux guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/mint/plugin.rb
 INFO manager: Registered plugin: Mint guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/netbsd/plugin.rb
 INFO manager: Registered plugin: NetBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/nixos/plugin.rb
 INFO manager: Registered plugin: NixOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/omnios/plugin.rb
 INFO manager: Registered plugin: OmniOS guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/openbsd/plugin.rb
 INFO manager: Registered plugin: OpenBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/openwrt/plugin.rb
 INFO manager: Registered plugin: OpenWrt guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/photon/plugin.rb
 INFO manager: Registered plugin: VMware Photon guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/pld/plugin.rb
 INFO manager: Registered plugin: PLD Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/redhat/plugin.rb
 INFO manager: Registered plugin: Red Hat Enterprise Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/rocky/plugin.rb
 INFO manager: Registered plugin: Rocky guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/slackware/plugin.rb
 INFO manager: Registered plugin: Slackware guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/smartos/plugin.rb
 INFO manager: Registered plugin: SmartOS guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/solaris/plugin.rb
 INFO manager: Registered plugin: Solaris guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/solaris11/plugin.rb
 INFO manager: Registered plugin: Solaris 11 guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/suse/plugin.rb
 INFO manager: Registered plugin: SUSE guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/tinycore/plugin.rb
 INFO manager: Registered plugin: TinyCore Linux guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/trisquel/plugin.rb
 INFO manager: Registered plugin: Trisquel guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/ubuntu/plugin.rb
 INFO manager: Registered plugin: Ubuntu guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/windows/plugin.rb
 INFO manager: Registered plugin: Windows guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/alt/plugin.rb
 INFO manager: Registered plugin: ALT Platform host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/arch/plugin.rb
 INFO manager: Registered plugin: Arch host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/bsd/plugin.rb
 INFO manager: Registered plugin: BSD host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/darwin/plugin.rb
 INFO manager: Registered plugin: Mac OS X host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/freebsd/plugin.rb
 INFO manager: Registered plugin: FreeBSD host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/gentoo/plugin.rb
 INFO manager: Registered plugin: Gentoo host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/linux/plugin.rb
 INFO manager: Registered plugin: Linux host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/null/plugin.rb
 INFO manager: Registered plugin: null host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/redhat/plugin.rb
 INFO manager: Registered plugin: Red Hat Enterprise Linux host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/slackware/plugin.rb
 INFO manager: Registered plugin: Slackware host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/suse/plugin.rb
 INFO manager: Registered plugin: SUSE host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/void/plugin.rb
 INFO manager: Registered plugin: Void host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/windows/plugin.rb
 INFO manager: Registered plugin: Windows host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/kernel_v1/plugin.rb
 INFO manager: Registered plugin: kernel
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/kernel_v2/plugin.rb
 INFO manager: Registered plugin: kernel
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb
 INFO manager: Registered plugin: docker-provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb
 INFO manager: Registered plugin: Hyper-V provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb
 INFO manager: Registered plugin: VirtualBox provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/ansible/plugin.rb
 INFO manager: Registered plugin: ansible
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/cfengine/plugin.rb
 INFO manager: Registered plugin: CFEngine Provisioner
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/chef/plugin.rb
 INFO manager: Registered plugin: chef
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/container/plugin.rb
 INFO manager: Registered plugin: container
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/docker/plugin.rb
 INFO manager: Registered plugin: docker
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/file/plugin.rb
 INFO manager: Registered plugin: file
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/podman/plugin.rb
 INFO manager: Registered plugin: podman
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/puppet/plugin.rb
 INFO manager: Registered plugin: puppet
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/salt/plugin.rb
 INFO manager: Registered plugin: salt
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/shell/plugin.rb
 INFO manager: Registered plugin: shell
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/atlas/plugin.rb
 INFO manager: Registered plugin: atlas
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/ftp/plugin.rb
 INFO manager: Registered plugin: ftp
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/heroku/plugin.rb
 INFO manager: Registered plugin: heroku
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/local-exec/plugin.rb
 INFO manager: Registered plugin: local-exec
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/noop/plugin.rb
 INFO manager: Registered plugin: noop
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/nfs/plugin.rb
 INFO manager: Registered plugin: NFS synced folders
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/rsync/plugin.rb
 INFO manager: Registered plugin: RSync synced folders
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb
 INFO manager: Registered plugin: SMB synced folders
 INFO vagrant: `vagrant` invoked: ["reload", "win10", "--debug"]
DEBUG vagrant: Creating Vagrant environment
 INFO environment: Environment initialized (#<Vagrant::Environment:0x000001efd68bb498>)
 INFO environment:   - cwd: D:/workspace/eWalker/DetectionLab/Vagrant
 INFO environment: Home path: D:/yzhao/.vagrant.d
DEBUG environment: Effective local data path: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
 INFO environment: Local data path: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
DEBUG environment: Creating: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
DEBUG manager: Enabling localized plugins
 INFO manager: Plugins:
DEBUG solution_file: new solution file instance plugin_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json solution_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol
DEBUG solution_file: missing file so skipping loading
DEBUG bundler: solution file in use for init: <Vagrant::Bundler::SolutionFile:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol:invalid>
DEBUG bundler: Generating new builtin set instance.
DEBUG bundler: Generating new plugin set instance. Skip gems - []
DEBUG bundler: generating solution set for configured plugins
DEBUG bundler: Current generated plugin dependency list: []
DEBUG bundler: resolving solution from available specification set
DEBUG bundler: solution set for configured plugins has been resolved
DEBUG bundler: activating solution set
DEBUG bundler: Activating solution set: []
DEBUG solution_file: plugin file does not exist, not storing solution
DEBUG bundler: solution set stored to - <Vagrant::Bundler::SolutionFile:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol:invalid>
 INFO manager: Loading plugins...
DEBUG manager: Enabling globalized plugins
 INFO manager: Plugins:
 INFO manager:   - vagrant-reload = [installed: 0.0.1 constraint: > 0]
 INFO manager:   - vagrant-vmware-desktop = [installed: 3.0.1 constraint: > 0]
DEBUG solution_file: new solution file instance plugin_file=D:/yzhao/.vagrant.d/plugins.json solution_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol
DEBUG solution_file: reading solution file - D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol
DEBUG solution_file: solution validation check CHECKSUM 9fcfcffe612e5ad699ff689b31abbda7e7dbd14525fe86e49533ab494f410560 <-> 9fcfcffe612e5ad699ff689b31abbda7e7dbd14525fe86e49533ab494f410560 VERSION 2.2.19 <-> 2.2.19
DEBUG solution_file: loading solution dependency list
DEBUG solution_file: solution dependency list: [#<Gem::Resolver::DependencyRequest:0x000001efd6b70d28 @dependency=<Gem::Dependency type=:runtime name="vagrant-reload" requirements="= 0.0.1">, @requester=nil>, #<Gem::Resolver::DependencyRequest:0x000001efd6b70a30 @dependency=<Gem::Dependency type=:runtime name="vagrant-vmware-desktop" requirements="= 3.0.1">, @requester=nil>]
DEBUG bundler: solution file in use for init: <Vagrant::Bundler::SolutionFile:D:/yzhao/.vagrant.d/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol:valid>
DEBUG bundler: Generating new builtin set instance.
DEBUG bundler: Generating new plugin set instance. Skip gems - []
DEBUG bundler: loading cached solution set
DEBUG bundler: activating solution set
DEBUG bundler: Activating solution set: ["vagrant-reload-0.0.1", "vagrant-vmware-desktop-3.0.1"]
DEBUG bundler: Activating gem vagrant-reload-0.0.1
DEBUG bundler: Activating gem vagrant-vmware-desktop-3.0.1
 INFO manager: Loading plugins...
 INFO manager: Loading plugin `vagrant-reload` with default require: `vagrant-reload`
 INFO manager: Registered plugin: Reload
DEBUG manager: Successfully loaded plugin `vagrant-reload`.
 INFO manager: Loading plugin `vagrant-vmware-desktop` with default require: `vagrant-vmware-desktop`
 INFO manager: Registered plugin: VMware Workstation Provider
DEBUG manager: Successfully loaded plugin `vagrant-vmware-desktop`.
 INFO loader: Set :root = ["#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile
 INFO loader: Loading configuration in order: [:home, :root]
DEBUG loader: Loading from: root (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO subprocess: Starting process: ["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\/powershell.EXE", "-NoLogo", "-NoProfile", "-NonInteractive", "-ExecutionPolicy", "Bypass", "-Command", "Write-Output $PSVersionTable.PSVersion.Major"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 5
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 30
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\/powershell.EXE", "-NoLogo", "-NoProfile", "-NonInteractive", "-ExecutionPolicy", "Bypass", "-Command", "(new-object System.Security.Principal.WindowsPrincipal([System.Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([System.Security.Principal.WindowsBuiltInRole]::Administrator)"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: True
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_logger" = ["[\"2\", #<Proc:0x000001efd68aec98 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:3>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd68aec98 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:3>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_logger"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: bento/ubuntu-20.04 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO host: Autodetecting host type for [#<Vagrant::Environment: D:/workspace/eWalker/DetectionLab/Vagrant>]
DEBUG host: Trying: alt
DEBUG host: Trying: arch
DEBUG host: Trying: darwin
DEBUG host: Trying: freebsd
DEBUG host: Trying: gentoo
DEBUG host: Trying: redhat
DEBUG host: Trying: slackware
DEBUG host: Trying: suse
DEBUG host: Trying: void
DEBUG host: Trying: bsd
DEBUG host: Trying: linux
DEBUG host: Trying: null
DEBUG host: Trying: windows
 INFO host: Detected: windows!
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x000001efd5987580>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd67b4310>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd67b4310>
 INFO loader: Set :"3060_bento/ubuntu-20.04_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile
 INFO loader: Loading configuration in order: [:"3060_bento/ubuntu-20.04_vmware_desktop", :home, :root, "2860_machine_logger"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop" = ["[\"2\", #<Proc:0x000001efd6901740>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd6901740>]
 INFO loader: Loading configuration in order: [:"3060_bento/ubuntu-20.04_vmware_desktop", :home, :root, "2860_machine_logger", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (cache)
DEBUG loader: Loading from: 2860_vm_logger_bento/ubuntu-20.04_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_dc" = ["[\"2\", #<Proc:0x000001efd68aea90 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd68aea90 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x000001efd73d4960>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd7351d08>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd7351d08>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile
 INFO root: Version requirements from Vagrantfile: [">= 1.6.2"]
 INFO root:   - Version requirements satisfied!
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_dc_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x000001efd7657868>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd7657868>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Loading from: 2860_vm_dc_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_wef" = ["[\"2\", #<Proc:0x000001efd68ae888 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd68ae888 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x000001efd73bd210>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd73132d8>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd73132d8>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_wef_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x000001efd5984ad8>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd5984ad8>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Loading from: 2860_vm_wef_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_win10" = ["[\"2\", #<Proc:0x000001efd68ae630 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd68ae630 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win10 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x000001efd73dea50>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd7353630>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd7353630>
 INFO loader: Set :"3060_detectionlab/win10_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win10/1.8/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win10/1.8/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win10/1.8/vmware_desktop/Vagrantfile
 INFO root: Version requirements from Vagrantfile: [">= 1.6.2"]
 INFO root:   - Version requirements satisfied!
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win10_vmware_desktop", :home, :root, "2860_machine_win10"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win10_vmware_desktop (evaluating)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x000001efd6593d38>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000001efd6593d38>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win10_vmware_desktop", :home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO environment: Running hook: environment_plugins_loaded
 INFO runner: Running action: environment_plugins_loaded #<Vagrant::Action::Builder:0x000001efd72faaa8>
 INFO environment: Running hook: environment_load
 INFO runner: Running action: environment_load #<Vagrant::Action::Builder:0x000001efd71462c0>
 INFO warden: Calling IN action: #<HashiCorp::VagrantVMwareDesktop::SetupPlugin:0x000001efd70fc6c0>
DEBUG checkpoint_client: starting plugin check
DEBUG checkpoint_client: starting utility check
 INFO warden: Calling OUT action: #<HashiCorp::VagrantVMwareDesktop::SetupPlugin:0x000001efd70fc6c0>
DEBUG checkpoint_client: plugin check complete
DEBUG checkpoint_client: starting plugin check
 INFO cli: CLI: [] "reload" ["win10"]
DEBUG checkpoint_client: plugin check complete
DEBUG cli: Invoking command class: VagrantPlugins::CommandReload::Command ["win10"]
DEBUG checkpoint_client: no information received from checkpoint
DEBUG command: 'reload' each target VM...
DEBUG command: Getting target VMs for command. Arguments:
DEBUG command:  -- names: ["win10"]
DEBUG command:  -- options: nil
DEBUG command: Finding machine that match name: win10
 INFO command: Active machine found with name win10. Using provider: vmware_desktop
 INFO environment: Getting machine: win10 (vmware_desktop)
 INFO environment: Uncached load of machine.
 INFO loader: Set "2860_machine_win10" = ["[\"2\", #<Proc:0x000001efd68ae630 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", :"3060_detectionlab/win10_vmware_desktop", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win10 (vmware_desktop)
 INFO vmware_driver: VMX file: 
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x000001efd670bbc0>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd60a0b78>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000001efd60a0b78>
 INFO loader: Set :"3060_detectionlab/win10_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win10/1.8/vmware_desktop/Vagrantfile>"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win10_vmware_desktop", :home, :root, "2860_machine_win10"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x000001efd6593d38>]"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win10_vmware_desktop", :home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (cache)
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO machine: Initializing machine: win10
 INFO machine:   - Provider: HashiCorp::VagrantVMwareDesktop::Provider
 INFO machine:   - Box: #<Vagrant::Box:0x000001efd75c9400>
 INFO machine:   - Data dir: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/win10/vmware_desktop
DEBUG vmware: Re-initializing driver for new ID: "D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/win10/vmware_desktop/605be27b-5823-4a72-8c1b-b76fa4cbf6a0/windows_10.vmx"
 INFO vmware_driver: VMX file: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/win10/vmware_desktop/605be27b-5823-4a72-8c1b-b76fa4cbf6a0/windows_10.vmx
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
DEBUG vmware_driver: discovered vmware NAT device: vmnet8
DEBUG checkpoint_client: getting utility version
DEBUG vmware_driver: Getting version from vagrant-vmware-utility
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG checkpoint_client: got utility version: "1.0.21"
DEBUG checkpoint_client: running utility checkpoint check
DEBUG checkpoint_client: utility check complete
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
DEBUG vmware_driver: discovered vmware NAT device: vmnet8
DEBUG machine: Eager loading WinRM communicator to avoid GH-3390
 INFO winrm: Initializing WinRMCommunicator
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO interface: Machine: metadata ["provider", :vmware_desktop, {:target=>:win10}]
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO command: With machine: win10 (#<HashiCorp::VagrantVMwareDesktop::Provider:0x000001efd7273bc0 @logger=#<Log4r::Logger:0x000001efd7273b70 @fullname="hashicorp::vagrant::vmware", @outputters=[], @additive=true, @name="vmware", @path="hashicorp::vagrant", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @machine=#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, @driver=#<HashiCorp::VagrantVMwareDesktop::Driver::Base:0x000001efd7226028 @config=#<HashiCorp::VagrantVMwareDesktop::Config:0x000001efd753acc8 @allowlist_verified=false, @base_address=nil, @base_mac=nil, @clone_directory=nil, @functional_hgfs=true, @unmount_default_hgfs=true, @enable_vmrun_ip_lookup=true, @gui=true, @force_vmware_license=nil, @linked_clone=true, @nat_device="vmnet8", @network_adapters={0=>[:nat, {:auto_config=>false}]}, @shared_folder_special_char="-", @verify_vmnet=true, @vmx={"displayname"=>"win10.windomain.local", "gui.fullscreenatpoweron"=>"FALSE", "gui.viewModeAtPowerOn"=>"windowed", "memsize"=>"3072", "numvcpus"=>"2"}, @port_forward_network_pause=0, @ssh_info_public=false, @utility_host="127.0.0.1", @utility_port=9922, @utility_certificate_path="C:/ProgramData/HashiCorp/vagrant-vmware-desktop/certificates", @logger=#<Log4r::Logger:0x000001efd7570d00 @fullname="hashicorp::provider::vmware::config", @outputters=[], @additive=true, @name="config", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @__invalid_methods=#<Set: {}>>, @logger=#<Log4r::Logger:0x000001efd7225f10 @fullname="hashicorp::provider::vmware_driver", @outputters=[], @additive=true, @name="vmware_driver", @path="hashicorp::provider", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @vmx_path=#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/win10/vmware_desktop/605be27b-5823-4a72-8c1b-b76fa4cbf6a0/windows_10.vmx>, @vm_dir=#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/win10/vmware_desktop/605be27b-5823-4a72-8c1b-b76fa4cbf6a0>, @vagrant_utility=#<HashiCorp::VagrantVMwareDesktop::Helper::VagrantUtility:0x000001efd71e2878 @logger=#<Log4r::Logger:0x000001efd71e2800 @fullname="hashicorp::provider::vmware::vagrant_utility", @outputters=[], @additive=true, @name="vagrant_utility", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @connection=#<Net::HTTP 127.0.0.1:9922 open=false>, @headers={"Content-Type"=>"application/vnd.hashicorp.vagrant.vmware.rest-v1+json", "Origin"=>"https://127.0.0.1:9922", "User-Agent"=>"Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4)  - VagrantVMWareDesktop/STUB", "X-Requested-With"=>"Vagrant"}>, @license="workstation", @pro_license=true, @version="16.2.3", @product_name="Workstation", @vmrun_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", @vmware_vmx_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\x64\\vmware-vmx.exe", @vmware_vdiskmanager_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmware-vdiskmanager.exe", @utility_version=#<Gem::Version "1.0.21">>, @cap_logger=#<Log4r::Logger:0x000001efd70bee10 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::provider", @outputters=[], @additive=true, @name="provider", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x000001efd6119e60 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware_desktop, #<#<Class:0x000001efd70bf748>:0x000001efd706a360>]], @cap_args=[#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:docker=>#<Vagrant::Registry:0x000001efd70bf4a0 @items={:public_address=>#<Proc:0x000001efd66c1818 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:60>, :proxy_machine=>#<Proc:0x000001efd66c1728 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:65>, :has_communicator=>#<Proc:0x000001efd66c1638 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:70>}, @results_cache={}>, :hyperv=>#<Vagrant::Registry:0x000001efd70bf3d8 @items={:public_address=>#<Proc:0x000001efd6a38e10 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:25>, :snapshot_list=>#<Proc:0x000001efd6a38d70 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:30>, :configure_disks=>#<Proc:0x000001efd6a38d20 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:35>, :cleanup_disks=>#<Proc:0x000001efd6a38cf8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:40>, :validate_disk_ext=>#<Proc:0x000001efd6a38cd0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:45>, :default_disk_exts=>#<Proc:0x000001efd6a38ca8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:50>, :set_default_disk_ext=>#<Proc:0x000001efd6a38c80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:55>}, @results_cache={}>, :virtualbox=>#<Vagrant::Registry:0x000001efd70bf338 @items={:forwarded_ports=>#<Proc:0x000001efd66d3180 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:27>, :nic_mac_addresses=>#<Proc:0x000001efd66d3158 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:32>, :public_address=>#<Proc:0x000001efd66d3130 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:37>, :configure_disks=>#<Proc:0x000001efd66d3108 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:42>, :cleanup_disks=>#<Proc:0x000001efd66d30e0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:47>, :validate_disk_ext=>#<Proc:0x000001efd66d30b8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:52>, :default_disk_exts=>#<Proc:0x000001efd66d3090 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:57>, :set_default_disk_ext=>#<Proc:0x000001efd66d3068 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:62>, :snapshot_list=>#<Proc:0x000001efd66d3040 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:67>}, @results_cache={}>, :vmware_desktop=>#<Vagrant::Registry:0x000001efd70bf1d0 @items={:snapshot_list=>#<Proc:0x000001efd5fe2a38 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x000001efd5fe2a10 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x000001efd5fe29e8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x000001efd5fe2600 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x000001efd5fe25d8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x000001efd5fe25b0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x000001efd5fe2588 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>, :vmware_workstation=>#<Vagrant::Registry:0x000001efd70bf0e0 @items={:snapshot_list=>#<Proc:0x000001efd5fe2240 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x000001efd5fe21c8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x000001efd5fe21a0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x000001efd5fe1958 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x000001efd5fe18e0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x000001efd5fe17c8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x000001efd5fe16d8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>}>)
 INFO machine: Calling action: reload on provider VMware Workstation
DEBUG environment: Attempting to acquire process-lock: machine-action-214247f541928e3ff1900db7ca1788f7
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: machine-action-214247f541928e3ff1900db7ca1788f7
 INFO interface: Machine: action ["reload", "start", {:target=>:win10}]
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd70ecb08>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd7f3df68>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd74d08a0>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd82f01d8>
 INFO warden: Calling IN action: #<Proc:0x000001efd8419be0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::ConfigValidate:0x000001efd82f0110>
DEBUG syncedfolder: Searching for cap: default_fstab_modification
DEBUG syncedfolder: Checking in: vmware
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: VMware Middleware: CheckVMware
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd830b118>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd8330da0>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd806bcf0>
 INFO warden: Calling IN action: #<Proc:0x000001efd74ca9f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: DiscardSuspendedState
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - guestinfo.detailed.data = 
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:fb:4b:c4"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:fb:4b:ce"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = ""
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "5"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd7f40308>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd67ffd38>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd8372408>
 INFO warden: Calling IN action: #<Proc:0x000001efd82c0b18 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000001efd8372340 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000001efd7f40290 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
DEBUG checkpoint: checkpoint data processing complete
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x000001efd8339950>
 INFO interface: output: Checking if box 'detectionlab/win10' version '1.8' is up to date...
 INFO interface: output: ==> win10: Checking if box 'detectionlab/win10' version '1.8' is up to date...
==> win10: Checking if box 'detectionlab/win10' version '1.8' is up to date...
 INFO box: box update check is under the interval threshold
 INFO box: Skipping box update check
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd83709f0>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd81d3bd8>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd745d350>
 INFO warden: Calling IN action: #<Proc:0x000001efd70cc948 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: CheckExistingNetwork
 INFO check_existing_network: Checking if the vmnet devices are healthy...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Verifying vmnet devices are healthy...
 INFO interface: info: ==> win10: Verifying vmnet devices are healthy...
==> win10: Verifying vmnet devices are healthy...
DEBUG vagrant_utility: request METHOD=POST PATH=/vmnet/verify RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: PruneForwardedPorts
 INFO prune_forwarded_ports: Pruning forwarded ports...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
DEBUG vmware_driver: requesting prune of unused port forwards
DEBUG vagrant_utility: request METHOD=DELETE PATH=/portforwards RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd736bca8>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd66250a8>
 INFO warden: Calling IN action: VMware Middleware: Suspended
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
DEBUG suspended: result: false
 INFO warden: Calling OUT action: VMware Middleware: Suspended
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd82f07a0>
 INFO warden: Calling IN action: #<Proc:0x000001efd89242e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Provision:0x000001efd82f0660>
 INFO provision: Checking provisioner sentinel file...
 INFO warden: Calling IN action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x000001efd8390d90>
DEBUG host: Searching for cap: nfs_prune
DEBUG host: Checking in: windows
 INFO nfs: Host doesn't support pruning NFS. Skipping.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x000001efd83c1008>
 INFO synced_folder_cleanup: Invoking synced folder cleanup for: vmware
 INFO synced_folder: Clearing shared folders
 INFO vmware_driver: Clearing shared folders...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:fb:4b:c4"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:fb:4b:ce"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = ""
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "5"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Delayed:0x000001efd8452738>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolders:0x000001efd84526e8>
 INFO synced_folders: SyncedFolders loading from cache: false
 INFO synced_folders: Synced Folder Implementation: vmware
 INFO synced_folders:   - /vagrant: . => /vagrant
 INFO synced_folders: Invoking synced folder prepare for: vmware
 INFO warden: Calling IN action: VMware Middleware: PrepareNFSSettings
 INFO warden: Calling IN action: VMware Middleware: Network
DEBUG network: Available slots for high-level adapters: #<Set: {1, 2, 3, 4, 5, 6, 7, 8}>
 INFO network: Determining network adapters required for high-level configuration...
 INFO network:  -- Slot 1: hostonly
 INFO network: Determining adapters and compiling network configuration...
 INFO network: Slot 0. Type: nat
DEBUG network: Normalized configuration: {:auto_config=>false, :type=>:dhcp}
DEBUG network: Adapter configuration: {:type=>:nat, :slot=>0}
DEBUG network: Network configuration: {:type=>:dhcp, :auto_config=>false}
 INFO network: Slot 1. Type: hostonly
DEBUG network: Normalized configuration: {:auto_config=>true, :netmask=>"255.255.255.0", :type=>:static, :ip=>"192.168.56.104", :gateway=>"192.168.56.1", :dns=>"192.168.56.102", :protocol=>"tcp", :id=>"abc09ff8-db5e-4dae-8e14-e0e8d09012bd", :subnet_ip=>"192.168.56.0", :adapter_ip=>"192.168.56.1"}
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
 INFO network: Found matching vmnet device: vmnet2
 INFO network: Checking for hostonly network collisions...
 INFO subprocess: Starting process: ["C:\\WINDOWS\\system32/netsh.exe", "interface", "ip", "show", "route"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 

Publish  Type      Met  Prefix                    Idx  Gateway/Interface Name

-------  --------  ---  ------------------------  ---  ------------------------

No       Manual    100  0.0.0.0/0                  19  192.168.70.254

No       System    256  127.0.0.0/8                 1  Loopback Pseudo-Interface 1

No       System    256  127.0.0.1/32                1  Loopback Pseudo-Interface 1

No       System    256  127.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  169.254.0.0/16             34  VMware Network Adapter VMnet2

No       System    256  169.254.140.76/32          34  VMware Network Adapter VMnet2

No       System    256  169.254.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  172.22.112.0/20            97  vEthernet (Wi-Fi)

No       System    256  172.22.112.1/32            97  vEthernet (Wi-Fi)

No       System    256  172.22.127.255/32          97  vEthernet (Wi-Fi)

No       System    256  172.23.48.0/20             79  vEthernet (VMware Network )

No       System    256  172.23.48.1/32             79  vEthernet (VMware Network )

No       System    256  172.23.63.255/32           79  vEthernet (VMware Network )

No       System    256  172.23.128.0/20            28  vEthernet (Default Switch)

No       System    256  172.23.128.1/32            28  vEthernet (Default Switch)

No       System    256  172.23.143.255/32          28  vEthernet (Default Switch)

No       System    256  172.24.224.0/20            91  vEthernet (VMware Network ) 3

No       System    256  172.24.224.1/32            91  vEthernet (VMware Network ) 3

No       System    256  172.24.239.255/32          91  vEthernet (VMware Network ) 3

No       System    256  172.25.64.0/20             51  vEthernet (Ethernet)

No       System    256  172.25.64.1/32             51  vEthernet (Ethernet)

No       System    256  172.25.79.255/32           51  vEthernet (Ethernet)

No       System    256  172.28.64.0/20             85  vEthernet (VMware Network ) 2

No       System    256  172.28.64.1/32             85  vEthernet (VMware Network ) 2

No       System    256  172.28.79.255/32           85  vEthernet (VMware Network ) 2

No       System    256  172.30.80.0/20             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.80.1/32             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.95.255/32           73  vEthernet (vEthernet (NAT )

No       System    256  192.168.44.0/24            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.1/32            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.255/32          21  VMware Network Adapter VMnet1

No       System    256  192.168.70.0/24            19  Wi-Fi

No       System    256  192.168.70.245/32          19  Wi-Fi

No       System    256  192.168.70.255/32          19  Wi-Fi

No       System    256  192.168.222.0/24           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.1/32           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.255/32         33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 1  Loopback Pseudo-Interface 1

No       System    256  224.0.0.0/4                11  OpenVPN Wintun

No       System    256  224.0.0.0/4                34  VMware Network Adapter VMnet2

No       System    256  224.0.0.0/4                21  VMware Network Adapter VMnet1

No       System    256  224.0.0.0/4                33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 4  Ethernet

No       System    256  224.0.0.0/4                24  vEthernet (NAT vSwitch)

No       System    256  224.0.0.0/4                19  Wi-Fi

No       System    256  224.0.0.0/4                51  vEthernet (Ethernet)

No       System    256  224.0.0.0/4                28  vEthernet (Default Switch)

No       System    256  224.0.0.0/4                73  vEthernet (vEthernet (NAT )

No       System    256  224.0.0.0/4                79  vEthernet (VMware Network )

No       System    256  224.0.0.0/4                85  vEthernet (VMware Network ) 2

No       System    256  224.0.0.0/4                91  vEthernet (VMware Network ) 3

No       System    256  224.0.0.0/4                97  vEthernet (Wi-Fi)

No       System    256  224.0.0.0/4                32  Local Area Connection* 2

No       System    256  255.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  255.255.255.255/32         11  OpenVPN Wintun

No       System    256  255.255.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  255.255.255.255/32         21  VMware Network Adapter VMnet1

No       System    256  255.255.255.255/32         33  VMware Network Adapter VMnet8

No       System    256  255.255.255.255/32          4  Ethernet

No       System    256  255.255.255.255/32         24  vEthernet (NAT vSwitch)

No       System    256  255.255.255.255/32         19  Wi-Fi

No       System    256  255.255.255.255/32         51  vEthernet (Ethernet)

No       System    256  255.255.255.255/32         28  vEthernet (Default Switch)

No       System    256  255.255.255.255/32         73  vEthernet (vEthernet (NAT )

No       System    256  255.255.255.255/32         79  vEthernet (VMware Network )

No       System    256  255.255.255.255/32         85  vEthernet (VMware Network ) 2

No       System    256  255.255.255.255/32         91  vEthernet (VMware Network ) 3

No       System    256  255.255.255.255/32         97  vEthernet (Wi-Fi)

No       System    256  255.255.255.255/32         32  Local Area Connection* 2


DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG network: Adapter configuration: {:type=>:custom, :mac_address=>nil, :vnet=>"vmnet2", :slot=>1}
DEBUG network: Network configuration: {:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.104", :netmask=>"255.255.255.0", :auto_config=>true}
 INFO network: Enabling 2 adapters...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Preparing network adapters...
 INFO interface: info: ==> win10: Preparing network adapters...
==> win10: Preparing network adapters...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet0.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddressoffset
WARNING: The VMX file for this box contains a setting that is automatically overwritten by Vagrant
WARNING: when started. Vagrant will stop overwriting this setting in an upcoming release which may
WARNING: prevent proper networking setup. Below is the detected VMX setting:
WARNING: 
WARNING:   ethernet1.pcislotnumber = "33"
WARNING: 
WARNING: If networking fails to properly configure, it may require this VMX setting. It can be manually
WARNING: applied via the Vagrantfile:
WARNING: 
WARNING:   Vagrant.configure(2) do |config|
WARNING:     config.vm.provider :vmware_desktop do |vmware|
WARNING:       vmware.vmx["ethernet1.pcislotnumber"] = "33"
WARNING:     end
WARNING:   end
WARNING: 
WARNING: For more information: https://www.vagrantup.com/docs/vmware/boxes.html#vmx-allowlisting
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet1.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.vnet
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = ""
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "5"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: BaseMacToIp
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SetHostname:0x000001efd86b7668>
 INFO warden: Calling IN action: VMware Middleware: VMXModify
 INFO vmx_modify: Modifying VMX file according to user config...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmx_modify:   - Set: displayname = 'win10.windomain.local'
 INFO vmx_modify:   - Set: gui.fullscreenatpoweron = 'FALSE'
 INFO vmx_modify:   - Set: gui.viewModeAtPowerOn = 'windowed'
 INFO vmx_modify:   - Set: memsize = '3072'
 INFO vmx_modify:   - Set: numvcpus = '2'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = ""
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "5"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: PrepareForwardedPortCollisionParams
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2209, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2211, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2215, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2213, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5985}}, {:port=>2214, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5986}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2212, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2207, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2210, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2208, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}]
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x000001efd8391650>
DEBUG environment: Attempting to acquire process-lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: fpcollision
 INFO handle_port_collisions: Detecting any forwarded port collisions...
DEBUG handle_port_collisions: Extra in use: {2206=>#<Set: {"*"}>, 2209=>#<Set: {"*"}>, 2211=>#<Set: {"*"}>, 2215=>#<Set: {"*"}>, 2222=>#<Set: {"*"}>, 2201=>#<Set: {"*"}>, 2202=>#<Set: {"*"}>, 2203=>#<Set: {"*"}>, 2213=>#<Set: {"*"}>, 2214=>#<Set: {"*"}>, 55985=>#<Set: {"*"}>, 55986=>#<Set: {"*"}>, 2204=>#<Set: {"*"}>, 2212=>#<Set: {"*"}>, 2205=>#<Set: {"*"}>, 2207=>#<Set: {"*"}>, 2210=>#<Set: {"*"}>, 2200=>#<Set: {"*"}>, 2208=>#<Set: {"*"}>}
DEBUG handle_port_collisions: Remap: {}
DEBUG handle_port_collisions: Repair: true
 INFO handle_port_collisions: Attempting to repair FP collision: 55985
 INFO handle_port_collisions: Repaired FP collision: 55985 to 2216
 INFO interface: info: Fixed port collision for 5985 => 55985. Now on port 2216.
 INFO interface: info: ==> win10: Fixed port collision for 5985 => 55985. Now on port 2216.
==> win10: Fixed port collision for 5985 => 55985. Now on port 2216.
 INFO handle_port_collisions: Attempting to repair FP collision: 55986
 INFO handle_port_collisions: Repaired FP collision: 55986 to 2217
 INFO interface: info: Fixed port collision for 5986 => 55986. Now on port 2217.
 INFO interface: info: ==> win10: Fixed port collision for 5986 => 55986. Now on port 2217.
==> win10: Fixed port collision for 5986 => 55986. Now on port 2217.
 INFO handle_port_collisions: Attempting to repair FP collision: 2222
 INFO handle_port_collisions: Repaired FP collision: 2222 to 2218
 INFO interface: info: Fixed port collision for 22 => 2222. Now on port 2218.
 INFO interface: info: ==> win10: Fixed port collision for 22 => 2222. Now on port 2218.
==> win10: Fixed port collision for 22 => 2222. Now on port 2218.
 INFO environment: Released process lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: Boot
 INFO interface: info: Starting the VMware VM...
 INFO interface: info: ==> win10: Starting the VMware VM...
==> win10: Starting the VMware VM...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "start", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", "gui"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 43
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: VMware Middleware: WaitForAddress
 INFO interface: info: Waiting for the VM to receive an address...
 INFO interface: info: ==> win10: Waiting for the VM to receive an address...
==> win10: Waiting for the VM to receive an address...
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
 INFO warden: Calling IN action: VMware Middleware: ForwardPorts
DEBUG forward_ports: Building up ports to forward...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2210, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2215, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>22}}, {:port=>2209, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2208, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2213, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5985}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2207, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2211, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2212, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2214, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5986}}]
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
 INFO interface: info: Forwarding ports...
 INFO interface: info: ==> win10: Forwarding ports...
==> win10: Forwarding ports...
 INFO interface: detail: -- 5985 => 2216
 INFO interface: detail:     win10: -- 5985 => 2216
    win10: -- 5985 => 2216
 INFO interface: detail: -- 5986 => 2217
 INFO interface: detail:     win10: -- 5986 => 2217
    win10: -- 5986 => 2217
 INFO interface: detail: -- 22 => 2218
 INFO interface: detail:     win10: -- 22 => 2218
    win10: -- 22 => 2218
DEBUG vmware_driver: requesting ports to be forwarded: [{:device=>"vmnet8", :guest_port=>5985, :host_port=>2216, :protocol=>"tcp", :guest_ip=>"192.168.222.132"}, {:device=>"vmnet8", :guest_port=>5986, :host_port=>2217, :protocol=>"tcp", :guest_ip=>"192.168.222.132"}, {:device=>"vmnet8", :guest_port=>22, :host_port=>2218, :protocol=>"tcp", :guest_ip=>"192.168.222.132"}]
DEBUG vmware_driver: forwarding ports via collection method
DEBUG vagrant_utility: request METHOD=PUT PATH=/vmnet/vmnet8/portforward RESPONSE=200 
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x000001efd8333fa0>
 INFO interface: output: Waiting for machine to boot. This may take a few minutes...
 INFO interface: output: ==> win10: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Searching for cap: winrm_info
==> win10: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2214, 5985=>2216, 22=>2215}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 5986=>2217, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO interface: detail: WinRM address: 127.0.0.1:2216
 INFO interface: detail:     win10: WinRM address: 127.0.0.1:2216
    win10: WinRM address: 127.0.0.1:2216
 INFO interface: detail: WinRM username: vagrant
 INFO interface: detail:     win10: WinRM username: vagrant
    win10: WinRM username: vagrant
 INFO interface: detail: WinRM execution_time_limit: PT2H
 INFO interface: detail:     win10: WinRM execution_time_limit: PT2H
    win10: WinRM execution_time_limit: PT2H
 INFO interface: detail: WinRM transport: negotiate
 INFO interface: detail:     win10: WinRM transport: negotiate
    win10: WinRM transport: negotiate
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware: VM state requested. Current state: running
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5985=>2213, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B861CB29-C0A6-4E57-BFB7-BB513572237D
DEBUG winrmshell: [WinRM] Command created for hostname with id: 54FF99AC-0A1C-4F49-B320-3D71192BEF41
DEBUG winrmshell: [WinRM] creating command_id: 54FF99AC-0A1C-4F49-B320-3D71192BEF41 on shell_id B861CB29-C0A6-4E57-BFB7-BB513572237D
DEBUG winrmshell: [WinRM] Waiting for output...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 54FF99AC-0A1C-4F49-B320-3D71192BEF41 on shell_id B861CB29-C0A6-4E57-BFB7-BB513572237D
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8904b00 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO interface: output: Machine booted and ready!
 INFO interface: output: ==> win10: Machine booted and ready!
==> win10: Machine booted and ready!
 INFO warden: Calling IN action: #<Proc:0x000001efd8333f28 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000001efd736bc30 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<Proc:0x000001efd8392eb0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000001efd8392eb0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000001efd736bc30 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8333f28 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x000001efd8333fa0>
 INFO warden: Calling OUT action: VMware Middleware: ForwardPorts
 INFO warden: Calling OUT action: VMware Middleware: WaitForAddress
 INFO warden: Calling OUT action: VMware Middleware: Boot
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x000001efd8391650>
 INFO warden: Calling OUT action: VMware Middleware: PrepareForwardedPortCollisionParams
 INFO warden: Calling OUT action: VMware Middleware: VMXModify
 INFO interface: info: Setting hostname...
 INFO interface: info: ==> win10: Setting hostname...
==> win10: Setting hostname...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 22=>2215, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CC316866-624C-4606-92FA-881F05877901
DEBUG winrmshell: [WinRM] Command created for hostname with id: 2DB3CDAE-D7C3-4F2E-B8D6-C5E7971B1BB1
DEBUG winrmshell: [WinRM] creating command_id: 2DB3CDAE-D7C3-4F2E-B8D6-C5E7971B1BB1 on shell_id CC316866-624C-4606-92FA-881F05877901
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2DB3CDAE-D7C3-4F2E-B8D6-C5E7971B1BB1 on shell_id CC316866-624C-4606-92FA-881F05877901
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8f0b670 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: change_host_name
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: change_host_name in windows
 INFO guest: Execute capability: change_host_name [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, "win10"] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd864d970 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd864c7c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8302cc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 48A2A780-AFEF-4494-A1B6-DD22D59077E3
DEBUG winrmshell: [WinRM] Command created for if ([System.Net.Dns]::GetHostName() -eq 'win10') { exit 0 } exit 1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 79A9BD4A-C68B-4393-BB34-072A31DFADF4
DEBUG winrmshell: [WinRM] creating command_id: 79A9BD4A-C68B-4393-BB34-072A31DFADF4 on shell_id 48A2A780-AFEF-4494-A1B6-DD22D59077E3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 79A9BD4A-C68B-4393-BB34-072A31DFADF4 on shell_id 48A2A780-AFEF-4494-A1B6-DD22D59077E3
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd752b908 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SetHostname:0x000001efd86b7668>
 INFO warden: Calling OUT action: VMware Middleware: BaseMacToIp
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
 INFO interface: info: Configuring network adapters within the VM...
 INFO interface: info: ==> win10: Configuring network adapters within the VM...
==> win10: Configuring network adapters within the VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 5986=>2217, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 385D64B2-1FD0-4C6F-AE8F-9628FDF2A0C9
DEBUG winrmshell: [WinRM] Command created for hostname with id: 80CC3F91-A247-4CA0-B561-73A5AE786CBE
DEBUG winrmshell: [WinRM] creating command_id: 80CC3F91-A247-4CA0-B561-73A5AE786CBE on shell_id 385D64B2-1FD0-4C6F-AE8F-9628FDF2A0C9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 80CC3F91-A247-4CA0-B561-73A5AE786CBE on shell_id 385D64B2-1FD0-4C6F-AE8F-9628FDF2A0C9
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8a6e6a8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: configure_networks
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: configure_networks in windows
 INFO guest: Execute capability: configure_networks [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.104", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]] (windows)
DEBUG configure_networks: Networks: [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.104", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]
 INFO interface: warn: Configuring secondary network adapters through VMware 
 INFO interface: warn: ==> win10: Configuring secondary network adapters through VMware 
==> win10: Configuring secondary network adapters through VMware 
 INFO interface: warn: on Windows is not yet supported. You will need to manually
 INFO interface: warn: ==> win10: on Windows is not yet supported. You will need to manually
==> win10: on Windows is not yet supported. You will need to manually
 INFO interface: warn: configure the network adapter.
 INFO interface: warn: ==> win10: configure the network adapter.
==> win10: configure the network adapter.
 INFO warden: Calling OUT action: VMware Middleware: Network
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
 INFO warden: Calling OUT action: VMware Middleware: PrepareNFSSettings
 INFO synced_folders: Invoking synced folder enable: vmware
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2218, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 07D259A7-9868-4898-B003-E6F62A2B87D9
DEBUG winrmshell: [WinRM] Command created for hostname with id: B517F0F8-5044-4B17-ABFE-5800B6BFC3E6
DEBUG winrmshell: [WinRM] creating command_id: B517F0F8-5044-4B17-ABFE-5800B6BFC3E6 on shell_id 07D259A7-9868-4898-B003-E6F62A2B87D9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B517F0F8-5044-4B17-ABFE-5800B6BFC3E6 on shell_id 07D259A7-9868-4898-B003-E6F62A2B87D9
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd9176f90 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: verify_vmware_hgfs
DEBUG guest: Checking in: windows
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 5
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2218, 5986=>2214}, :udp=>{}}
 INFO synced_folder: Preparing shared folders with VMX...
 INFO interface: info: Enabling and configuring shared folders...
 INFO interface: info: ==> win10: Enabling and configuring shared folders...
==> win10: Enabling and configuring shared folders...
 INFO vmware_driver: Enabling shared folders...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "enableSharedFolders", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31879
DEBUG subprocess: Exit status: 0
 INFO interface: detail: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO interface: detail:     win10: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
    win10: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO vmware_driver: Adding a shared folder '-vagrant': D:/workspace/eWalker/DetectionLab/Vagrant
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "addSharedFolder", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "setSharedFolderState", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant", "writable"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 5985=>2213, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D5F27B73-5710-4F73-B62D-E3D75BE5DACC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4152E530-AB18-419B-A453-F2BC8EFD3F9D
DEBUG winrmshell: [WinRM] creating command_id: 4152E530-AB18-419B-A453-F2BC8EFD3F9D on shell_id D5F27B73-5710-4F73-B62D-E3D75BE5DACC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4152E530-AB18-419B-A453-F2BC8EFD3F9D on shell_id D5F27B73-5710-4F73-B62D-E3D75BE5DACC
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8fd08f8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: mount_vmware_shared_folder
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: mount_vmware_shared_folder in windows
 INFO guest: Execute capability: mount_vmware_shared_folder [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, "-vagrant", "/vagrant", {:guestpath=>"/vagrant", :hostpath=>"D:/workspace/eWalker/DetectionLab/Vagrant", :disabled=>false, :__vagrantfile=>true, :plugin=>#<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x000001efd8b3bae0 @logger=#<Log4r::Logger:0x000001efd8b3ba68 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_logger=#<Log4r::Logger:0x000001efd80d8328 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::syncedfolder", @outputters=[], @additive=true, @name="syncedfolder", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x000001efd6119e60 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware, #<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x000001efd80b8f50 @logger=#<Log4r::Logger:0x000001efd80b8b90 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>>]], @cap_args=[#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:virtualbox=>#<Vagrant::Registry:0x000001efd80d95e8 @items={:mount_options=>#<Proc:0x000001efd66d2f00 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:72>, :mount_type=>#<Proc:0x000001efd66d2e38 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:77>, :mount_name=>#<Proc:0x000001efd66d2d70 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:82>}, @results_cache={}>, :smb=>#<Vagrant::Registry:0x000001efd80d90e8 @items={:default_fstab_modification=>#<Proc:0x000001efd60580f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:26>, :mount_options=>#<Proc:0x000001efd605a6c8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:31>, :mount_name=>#<Proc:0x000001efd6757f48 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:36>, :mount_type=>#<Proc:0x000001efd6757ed0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:41>}, @results_cache={}>}>, :owner=>"vagrant", :group=>"vagrant"}] (windows)
DEBUG winrm: powershell executing:
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd869d9e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd869cb38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd83a0880 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C0C19676-44CD-4868-9C90-3B3501041EDC
DEBUG winrmshell: [WinRM] Command created for function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B04C45C4-994B-4ADA-AD53-6D98823F4BEF
DEBUG winrmshell: [WinRM] creating command_id: B04C45C4-994B-4ADA-AD53-6D98823F4BEF on shell_id C0C19676-44CD-4868-9C90-3B3501041EDC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B04C45C4-994B-4ADA-AD53-6D98823F4BEF on shell_id C0C19676-44CD-4868-9C90-3B3501041EDC
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd7f9bb18 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2218, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 524DE03D-A737-418C-B32E-321B2434ADCC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 261E6612-BCD8-41C1-B299-501B94B35F75
DEBUG winrmshell: [WinRM] creating command_id: 261E6612-BCD8-41C1-B299-501B94B35F75 on shell_id 524DE03D-A737-418C-B32E-321B2434ADCC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 261E6612-BCD8-41C1-B299-501B94B35F75 on shell_id 524DE03D-A737-418C-B32E-321B2434ADCC
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8c09558 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: persist_mount_shared_folder
DEBUG guest: Checking in: windows
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolders:0x000001efd84526e8>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Delayed:0x000001efd8452738>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x000001efd83c1008>
 INFO warden: Calling OUT action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x000001efd8390d90>
 INFO warden: Calling OUT action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO provision: Writing provisioning sentinel so we don't provision again
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd88ef6b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2215, 5985=>2216, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 61C1BFD4-BB00-4D8A-8D70-D59578547440
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1A64648A-B880-41CC-8FE5-DEE9F5D49305
DEBUG winrmshell: [WinRM] creating command_id: 1A64648A-B880-41CC-8FE5-DEE9F5D49305 on shell_id 61C1BFD4-BB00-4D8A-8D70-D59578547440
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1A64648A-B880-41CC-8FE5-DEE9F5D49305 on shell_id 61C1BFD4-BB00-4D8A-8D70-D59578547440
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd92f6eb0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 22=>2215, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BCF6BA68-9770-4F4A-AC08-6BB096E33BF1
DEBUG winrmshell: [WinRM] Command created for hostname with id: 99F2C02E-E858-4F8A-8EEA-AD362FDD1164
DEBUG winrmshell: [WinRM] creating command_id: 99F2C02E-E858-4F8A-8EEA-AD362FDD1164 on shell_id BCF6BA68-9770-4F4A-AC08-6BB096E33BF1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 99F2C02E-E858-4F8A-8EEA-AD362FDD1164 on shell_id BCF6BA68-9770-4F4A-AC08-6BB096E33BF1
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8aaced0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = 
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 5985=>2216, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6A5106BB-BA00-4389-9512-889C098F558F
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8DCBDB95-07CE-4783-AD62-83C3C1489BCB
DEBUG winrmshell: [WinRM] creating command_id: 8DCBDB95-07CE-4783-AD62-83C3C1489BCB on shell_id 6A5106BB-BA00-4389-9512-889C098F558F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8DCBDB95-07CE-4783-AD62-83C3C1489BCB on shell_id 6A5106BB-BA00-4389-9512-889C098F558F
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd92644c0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd899cc20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7e5fc68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88f5038 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EA1DBC46-44BB-4552-814F-B49C53218BBF
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 321E20A1-5E57-4F62-A480-951A7E887AA6
DEBUG winrmshell: [WinRM] creating command_id: 321E20A1-5E57-4F62-A480-951A7E887AA6 on shell_id EA1DBC46-44BB-4552-814F-B49C53218BBF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 321E20A1-5E57-4F62-A480-951A7E887AA6 on shell_id EA1DBC46-44BB-4552-814F-B49C53218BBF
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd86b46c0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d43b30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d42b40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8c87700 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1B7FB754-CA34-494D-B7FB-22216EC68FC5
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D17718E3-BCEF-4784-9C9E-E25BBDF8E4C6
DEBUG winrmshell: [WinRM] creating command_id: D17718E3-BCEF-4784-9C9E-E25BBDF8E4C6 on shell_id 1B7FB754-CA34-494D-B7FB-22216EC68FC5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D17718E3-BCEF-4784-9C9E-E25BBDF8E4C6 on shell_id 1B7FB754-CA34-494D-B7FB-22216EC68FC5
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8b90798 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1gh49su.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90e2548 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90e15d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8f72e60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "df3bb7a140e7cb3fdabbde32ca410ed38003dcb4" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-1gh49su.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 52ED71E3-C2E8-4802-8683-8DAEF146B686
DEBUG winrmshell: [WinRM] creating command_id: 52ED71E3-C2E8-4802-8683-8DAEF146B686 on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 52ED71E3-C2E8-4802-8683-8DAEF146B686 on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"False","df3bb7a140e7cb3fdabbde32ca410ed38003dcb4",,"True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1gh49su.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 90A6D075-3D91-4F15-B23E-01A11930FD9C
DEBUG winrmshell: [WinRM] creating command_id: 90A6D075-3D91-4F15-B23E-01A11930FD9C on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 90A6D075-3D91-4F15-B23E-01A11930FD9C on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBTb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9TdGVmYW5TY2hlcmVyL2FkZnMyCnBhcmFtIChbU3RyaW5nXSAkaXAsIFtTdHJpbmddICRkbnMsIFtTdHJpbmddICRnYXRld2F5KQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFJ1bm5pbmcgZml4LXNlY29uZC1uZXR3b3JrLnBzMS4uLiIKCmlmICggKEdldC1OZXRBZGFwdGVyIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IEludGVyZmFjZURlc2NyaXB0aW9uKS5Db250YWlucygnUmVkIEhhdCBWaXJ0SU8nKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIE5ldHdvcmsgQ29uZmlndXJhdGlvbiBmb3IgTGliVmlydCBpbnRlcmZhY2UiCiAgJHN1Ym5ldCA9ICRpcCAtcmVwbGFjZSAiXC5cZCskIiwgIiIKICAkbmFtZSA9IChHZXQtTmV0SVBBZGRyZXNzIC1BZGRyZXNzRmFtaWx5IElQdjQgYAogICAgIHwgV2hlcmUtT2JqZWN0IC1GaWx0ZXJTY3JpcHQgeyAoJF8uSVBBZGRyZXNzKS5TdGFydHNXaXRoKCIkc3VibmV0IikgfSBgCiAgICAgKS5JbnRlcmZhY2VBbGlhcwogIGlmICgkbmFtZSkgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldCBJUCBhZGRyZXNzIHRvICRpcCBvZiBpbnRlcmZhY2UgJG5hbWUiCiAgICAmIG5ldHNoLmV4ZSBpbnQgaXAgc2V0IGFkZHJlc3MgIiRuYW1lIiBzdGF0aWMgJGlwIDI1NS4yNTUuMjU1LjAgIiRnYXRld2F5IgogICAgaWYgKCRkbnMpIHsKICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldCBETlMgc2VydmVyIGFkZHJlc3MgdG8gJGRucyBvZiBpbnRlcmZhY2UgJG5hbWUiCiAgICAgICYgbmV0c2guZXhlIGludGVyZmFjZSBpcHY0IGFkZCBkbnNzZXJ2ZXIgIiRuYW1lIiBhZGRyZXNzPSRkbnMgaW5kZXg9MQogICAgfQogIH0gZWxzZSB7CiAgICBXcml0ZS1FcnJvciAiQ291bGQgbm90IGZpbmQgYSBpbnRlcmZhY2Ugd2l0aCBzdWJuZXQgJHN1Ym5ldC54eCIKICB9CiAgZXhpdCAwCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE5vIFZpcnRJTyBhZGFwdGVycywgbW92aW5nIG9uLi4uIgp9CgppZiAoISAoVGVzdC1QYXRoICdDOlxQcm9ncmFtIEZpbGVzXFZNd2FyZVxWTXdhcmUgVG9vbHMnKSApIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVk13YXJlIFRvb2xzIG5vdCBmb3VuZCwgbm8gbmVlZCB0byBjb250aW51ZS4gRXhpdGluZy4iCiAgZXhpdCAwCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSIKV3JpdGUtSG9zdCAiU2V0dGluZyBJUCBhZGRyZXNzIGFuZCBETlMgaW5mb3JtYXRpb24gZm9yIHRoZSBFdGhlcm5ldDEgaW50ZXJmYWNlIgpXcml0ZS1Ib3N0ICJJZiB0aGlzIHN0ZXAgdGltZXMgb3V0LCBpdCdzIGJlY2F1c2UgdmFncmFudCBpcyBjb25uZWN0aW5nIHRvIHRoZSBWTSBvbiB0aGUgd3JvbmcgaW50ZXJmYWNlIgpXcml0ZS1Ib3N0ICJTZWUgaHR0cHM6Ly9naXRodWIuY29tL2Nsb25nL0RldGVjdGlvbkxhYi9pc3N1ZXMvMTE0IGZvciBtb3JlIGluZm9ybWF0aW9uIgoKJHN1Ym5ldCA9ICRpcCAtcmVwbGFjZSAiXC5cZCskIiwgIiIKJG5hbWUgPSAoR2V0LU5ldElQQWRkcmVzcyAtQWRkcmVzc0ZhbWlseSBJUHY0IGAKICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7ICgkXy5JUEFkZHJlc3MpLlN0YXJ0c1dpdGgoJHN1Ym5ldCkgfSBgCiAgICkuSW50ZXJmYWNlQWxpYXMKaWYgKCEkbmFtZSkgewogICRuYW1lID0gKEdldC1OZXRJUEFkZHJlc3MgLUFkZHJlc3NGYW1pbHkgSVB2NCBgCiAgICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7ICgkXy5JUEFkZHJlc3MpLlN0YXJ0c1dpdGgoIjE2OS4yNTQuIikgfSBgCiAgICAgKS5JbnRlcmZhY2VBbGlhcwp9CmlmICgkbmFtZSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXQgSVAgYWRkcmVzcyB0byAkaXAgb2YgaW50ZXJmYWNlICRuYW1lIgogICYgbmV0c2guZXhlIGludCBpcCBzZXQgYWRkcmVzcyAiJG5hbWUiIHN0YXRpYyAkaXAgMjU1LjI1NS4yNTUuMCAiJHN1Ym5ldC4xIgogIGlmICgkZG5zKSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU2V0IEROUyBzZXJ2ZXIgYWRkcmVzcyB0byAkZG5zIG9mIGludGVyZmFjZSAkbmFtZSIKICAgICYgbmV0c2guZXhlIGludGVyZmFjZSBpcHY0IGFkZCBkbnNzZXJ2ZXIgIiRuYW1lIiBhZGRyZXNzPSRkbnMgaW5kZXg9MQogIH0KfSBlbHNlIHsKICBXcml0ZS1FcnJvciAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIENvdWxkIG5vdCBmaW5kIGEgaW50ZXJmYWNlIHdpdGggc3VibmV0ICRzdWJuZXQueHgiCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C658397C-E1EA-4B73-B30A-6201D588F0BE
DEBUG winrmshell: [WinRM] creating command_id: C658397C-E1EA-4B73-B30A-6201D588F0BE on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C658397C-E1EA-4B73-B30A-6201D588F0BE on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: ECB161E3-CCE9-46BB-93ED-051A7CE80098
DEBUG winrmshell: [WinRM] creating command_id: ECB161E3-CCE9-46BB-93ED-051A7CE80098 on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ECB161E3-CCE9-46BB-93ED-051A7CE80098 on shell_id 4A732C13-5EF0-4778-A662-73DFF197A734
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1gh49su.ps1 to C:/tmp/vagrant-shell.ps1 (3.296 KB over 1 chunks) in (0m0.23s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.74s) stream_files: (0m0.23s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1" -ip 192.168.56.104 -dns 8.8.8.8 -gateway 192.168.56.1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a94ad8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a8fc18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89e7068 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DA8B8BFE-13FD-4827-8747-915F5B26AC50
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1" -ip 192.168.56.104 -dns 8.8.8.8 -gateway 192.168.56.1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BA0B5F5C-DD38-43AE-99A6-8594D3A7C0C0
DEBUG winrmshell: [WinRM] creating command_id: BA0B5F5C-DD38-43AE-99A6-8594D3A7C0C0 on shell_id DA8B8BFE-13FD-4827-8747-915F5B26AC50
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:35] Running fix-second-network.ps1...
 INFO interface: detail:     win10: [20:35] Running fix-second-network.ps1...
    win10: [20:35] Running fix-second-network.ps1...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:35] No VirtIO adapters, moving on...
 INFO interface: detail:     win10: [20:35] No VirtIO adapters, moving on...
    win10: [20:35] No VirtIO adapters, moving on...
 INFO interface: detail: [20:35]
 INFO interface: detail:     win10: [20:35]
    win10: [20:35]
 INFO interface: detail: Setting IP address and DNS information for the Ethernet1 interface
 INFO interface: detail:     win10: Setting IP address and DNS information for the Ethernet1 interface
    win10: Setting IP address and DNS information for the Ethernet1 interface
 INFO interface: detail: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
 INFO interface: detail:     win10: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
    win10: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
 INFO interface: detail: See https://github.com/clong/DetectionLab/issues/114 for more information
 INFO interface: detail:     win10: See https://github.com/clong/DetectionLab/issues/114 for more information
    win10: See https://github.com/clong/DetectionLab/issues/114 for more information
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:35] Set IP address to 192.168.56.104 of interface Ethernet1
 INFO interface: detail:     win10: [20:35] Set IP address to 192.168.56.104 of interface Ethernet1
    win10: [20:35] Set IP address to 192.168.56.104 of interface Ethernet1
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: [20:35] Set DNS server address to 8.8.8.8 of interface Ethernet1
 INFO interface: detail:     win10: [20:35] Set DNS server address to 8.8.8.8 of interface Ethernet1
    win10: [20:35] Set DNS server address to 8.8.8.8 of interface Ethernet1
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] cleaning up command_id: BA0B5F5C-DD38-43AE-99A6-8594D3A7C0C0 on shell_id DA8B8BFE-13FD-4827-8747-915F5B26AC50
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd894f330 @data=[{:stdout=>"[20:35] Running fix-second-network.ps1...\r\n"}, {:stdout=>"[20:35] No VirtIO adapters, moving on...\r\n"}, {:stdout=>"[20:35]\r\n"}, {:stdout=>"Setting IP address and DNS information for the Ethernet1 interface\r\n"}, {:stdout=>"If this step times out, it's because vagrant is connecting to the VM on the wrong interface\r\n"}, {:stdout=>"See https://github.com/clong/DetectionLab/issues/114 for more information\r\n"}, {:stdout=>"[20:35] Set IP address to 192.168.56.104 of interface Ethernet1\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[20:35] Set DNS server address to 8.8.8.8 of interface Ethernet1\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd88ef6b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd90f93d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 22=>2218, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E6598F47-AF2A-4ED0-8463-B6BE88FF4ECD
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5C701673-0002-424F-97EE-BAC41CD73786
DEBUG winrmshell: [WinRM] creating command_id: 5C701673-0002-424F-97EE-BAC41CD73786 on shell_id E6598F47-AF2A-4ED0-8463-B6BE88FF4ECD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5C701673-0002-424F-97EE-BAC41CD73786 on shell_id E6598F47-AF2A-4ED0-8463-B6BE88FF4ECD
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8beb9b8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5986=>2217, 5985=>2213}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 383910A0-3746-439D-A342-D94C95523B88
DEBUG winrmshell: [WinRM] Command created for hostname with id: 410F4E6C-3BB8-42E7-9FCC-792B55C11027
DEBUG winrmshell: [WinRM] creating command_id: 410F4E6C-3BB8-42E7-9FCC-792B55C11027 on shell_id 383910A0-3746-439D-A342-D94C95523B88
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 410F4E6C-3BB8-42E7-9FCC-792B55C11027 on shell_id 383910A0-3746-439D-A342-D94C95523B88
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd70e6258 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5986=>2214, 5985=>2213}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 75A3C94E-A076-46CD-A3D0-17FAB3EBFB73
DEBUG winrmshell: [WinRM] Command created for hostname with id: E9E51C89-B1F4-45D5-A124-6D197FEECBB4
DEBUG winrmshell: [WinRM] creating command_id: E9E51C89-B1F4-45D5-A124-6D197FEECBB4 on shell_id 75A3C94E-A076-46CD-A3D0-17FAB3EBFB73
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E9E51C89-B1F4-45D5-A124-6D197FEECBB4 on shell_id 75A3C94E-A076-46CD-A3D0-17FAB3EBFB73
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8ba0648 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91cade8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91c9f10 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90d0488 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4146A0A4-A4E2-48A2-8544-28AC0EF1B5B2
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7E680F35-9A1B-4215-869F-4E3A8C89A8B4
DEBUG winrmshell: [WinRM] creating command_id: 7E680F35-9A1B-4215-869F-4E3A8C89A8B4 on shell_id 4146A0A4-A4E2-48A2-8544-28AC0EF1B5B2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7E680F35-9A1B-4215-869F-4E3A8C89A8B4 on shell_id 4146A0A4-A4E2-48A2-8544-28AC0EF1B5B2
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8f12290 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd843ae80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd84329b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd82a2078 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1643BAA0-09D3-4518-B0FD-4620AC4BAB5C
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 909950B4-5D98-4CC4-9849-1A4E844849A2
DEBUG winrmshell: [WinRM] creating command_id: 909950B4-5D98-4CC4-9849-1A4E844849A2 on shell_id 1643BAA0-09D3-4518-B0FD-4620AC4BAB5C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 909950B4-5D98-4CC4-9849-1A4E844849A2 on shell_id 1643BAA0-09D3-4518-B0FD-4620AC4BAB5C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd73020c8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-19049at.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89ade08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89acf80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd892c470 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "93c0f572b02ed6ea73cfea3459aef558ea59bf8c" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-19049at.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 90E633CE-3C79-4C12-A84A-2DE0A998AF5F
DEBUG winrmshell: [WinRM] creating command_id: 90E633CE-3C79-4C12-A84A-2DE0A998AF5F on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 90E633CE-3C79-4C12-A84A-2DE0A998AF5F on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","93c0f572b02ed6ea73cfea3459aef558ea59bf8c","df3bb7a140e7cb3fdabbde32ca410ed38003dcb4","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-19049at.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B7F6260B-D7E8-411C-812A-1B8B04573039
DEBUG winrmshell: [WinRM] creating command_id: B7F6260B-D7E8-411C-812A-1B8B04573039 on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B7F6260B-D7E8-411C-812A-1B8B04573039 on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBJbXBvcnQgdGhlIHJlZ2lzdHJ5IGtleXMKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE1ha2luZyBXaW5kb3dzIDEwIEdyZWF0IGFnYWluIgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW1wb3J0aW5nIHJlZ2lzdHJ5IGtleXMuLi4iCnJlZ2VkaXQgL3MgYzpcdmFncmFudFxzY3JpcHRzXE1ha2VXaW5kb3dzMTBHcmVhdEFnYWluLnJlZwoKIyBSZW1vdmUgT25lRHJpdmUgZnJvbSB0aGUgU3lzdGVtCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBSZW1vdmluZyBPbmVEcml2ZS4uLiIKJG9uZWRyaXZlID0gR2V0LVByb2Nlc3Mgb25lZHJpdmUgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKaWYgKCRvbmVkcml2ZSkgewogIHRhc2traWxsIC9mIC9pbSBPbmVEcml2ZS5leGUKfQpjOlxXaW5kb3dzXFN5c1dPVzY0XE9uZURyaXZlU2V0dXAuZXhlIC91bmluc3RhbGwKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEaXNhYmxpbmcgYXV0b21hdGljIHNjcmVlbiB0dXJub2ZmIGluIG9yZGVyIHRvIHByZXZlbnQgc2NyZWVuIGxvY2tpbmcuLi4iCnBvd2VyY2ZnIC1jaGFuZ2UgLW1vbml0b3ItdGltZW91dC1hYyAwCnBvd2VyY2ZnIC1jaGFuZ2UgLXN0YW5kYnktdGltZW91dC1hYyAwCnBvd2VyY2ZnIC1jaGFuZ2UgLWhpYmVybmF0ZS10aW1lb3V0LWFjIDAKCiMgRG93bmxvYWQgYW5kIGluc3RhbGwgU2h1dFVwMTAKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIFNodXRVcDEwLi4uIgpbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gInRsczEyLCB0bHMxMSwgdGxzIgojIERpc2FibGluZyB0aGUgcHJvZ3Jlc3MgYmFyIHNwZWVkcyB1cCBJV1IgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOAokUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnCiRzaHV0VXAxMERvd25sb2FkVXJsID0gImh0dHBzOi8vZGw1Lm9vLXNvZnR3YXJlLmNvbS9maWxlcy9vb3NodXR1cDEwL09PU1UxMC5leGUiCiRzaHV0VXAxMFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXE9PU1UxMC5leGUiCmlmICgtbm90IChUZXN0LVBhdGggJHNodXRVcDEwUmVwb1BhdGgpKSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgU2h1dFVwMTAgYW5kIGRpc2FibGluZyBXaW5kb3dzIERlZmVuZGVyIgogIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgIiRzaHV0VXAxMERvd25sb2FkVXJsIiAtT3V0RmlsZSAkc2h1dFVwMTBSZXBvUGF0aAogIC4gJHNodXRVcDEwUmVwb1BhdGggYzpcdmFncmFudFxyZXNvdXJjZXNcd2luZG93c1xzaHV0dXAxMC5jZmcgL3F1aWV0IC9mb3JjZQp9IGVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTaHV0VXAxMCB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgUmVtb3ZlIHRoZSBFZGdlIHNob3J0Y3V0IGZyb20gdGhlIERlc2t0b3AKJGxua1BhdGggPSAiYzpcVXNlcnNcdmFncmFudFxEZXNrdG9wXE1pY3Jvc29mdCBFZGdlLmxuayIKaWYgKFRlc3QtUGF0aCAkbG5rUGF0aCkgeyBSZW1vdmUtSXRlbSAkbG5rUGF0aCB9Cg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2979856A-BF24-46DB-B355-A6E1B9B47755
DEBUG winrmshell: [WinRM] creating command_id: 2979856A-BF24-46DB-B355-A6E1B9B47755 on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2979856A-BF24-46DB-B355-A6E1B9B47755 on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B8D01CDB-1DD8-46ED-95C7-5356762CE502
DEBUG winrmshell: [WinRM] creating command_id: B8D01CDB-1DD8-46ED-95C7-5356762CE502 on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B8D01CDB-1DD8-46ED-95C7-5356762CE502 on shell_id DC2FE334-6798-4C75-90CD-AA4F68458B9E
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-19049at.ps1 to C:/tmp/vagrant-shell.ps1 (2.3 KB over 1 chunks) in (0m0.22s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.71s) stream_files: (0m0.22s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/MakeWindows10GreatAgain.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/MakeWindows10GreatAgain.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/MakeWindows10GreatAgain.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd92835c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd92825b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd919edb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1CC8F5D5-5ABB-418F-AAF1-C4BF7A71D73C
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 836BEB19-0041-4834-A271-0B69CA537253
DEBUG winrmshell: [WinRM] creating command_id: 836BEB19-0041-4834-A271-0B69CA537253 on shell_id 1CC8F5D5-5ABB-418F-AAF1-C4BF7A71D73C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:35] Making Windows 10 Great again
 INFO interface: detail:     win10: [20:35] Making Windows 10 Great again
    win10: [20:35] Making Windows 10 Great again
 INFO interface: detail: [20:35] Importing registry keys...
 INFO interface: detail:     win10: [20:35] Importing registry keys...
    win10: [20:35] Importing registry keys...
 INFO interface: detail: [20:35] Removing OneDrive...
 INFO interface: detail:     win10: [20:35] Removing OneDrive...
    win10: [20:35] Removing OneDrive...
 INFO interface: detail: SUCCESS: The process "OneDrive.exe" with PID 1820 has been terminated.
 INFO interface: detail:     win10: SUCCESS: The process "OneDrive.exe" with PID 1820 has been terminated.
    win10: SUCCESS: The process "OneDrive.exe" with PID 1820 has been terminated.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:35] Disabling automatic screen turnoff in order to prevent screen locking...
 INFO interface: detail:     win10: [20:35] Disabling automatic screen turnoff in order to prevent screen locking...
    win10: [20:35] Disabling automatic screen turnoff in order to prevent screen locking...
 INFO interface: detail: [20:35] Downloading ShutUp10...
 INFO interface: detail:     win10: [20:35] Downloading ShutUp10...
    win10: [20:35] Downloading ShutUp10...
 INFO interface: detail: [20:35] Installing ShutUp10 and disabling Windows Defender
 INFO interface: detail:     win10: [20:35] Installing ShutUp10 and disabling Windows Defender
    win10: [20:35] Installing ShutUp10 and disabling Windows Defender
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 836BEB19-0041-4834-A271-0B69CA537253 on shell_id 1CC8F5D5-5ABB-418F-AAF1-C4BF7A71D73C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd9090298 @data=[{:stdout=>"[20:35] Making Windows 10 Great again\r\n"}, {:stdout=>"[20:35] Importing registry keys...\r\n"}, {:stdout=>"[20:35] Removing OneDrive...\r\n"}, {:stdout=>"SUCCESS: The process \"OneDrive.exe\" with PID 1820 has been terminated.\r\n"}, {:stdout=>"[20:35] Disabling automatic screen turnoff in order to prevent screen locking...\r\n"}, {:stdout=>"[20:35] Downloading ShutUp10...\r\n"}, {:stdout=>"[20:35] Installing ShutUp10 and disabling Windows Defender\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd90f93d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd7fe1be0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2218, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4AE7621A-AF81-4456-AEC3-B4ABEC0CE3B3
DEBUG winrmshell: [WinRM] Command created for hostname with id: E4427CEB-72AD-4A93-AEE7-A2228A4E8479
DEBUG winrmshell: [WinRM] creating command_id: E4427CEB-72AD-4A93-AEE7-A2228A4E8479 on shell_id 4AE7621A-AF81-4456-AEC3-B4ABEC0CE3B3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E4427CEB-72AD-4A93-AEE7-A2228A4E8479 on shell_id 4AE7621A-AF81-4456-AEC3-B4ABEC0CE3B3
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd709cd10 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5985=>2213, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A696FE80-62CC-4BA7-84F7-FD82E84641F2
DEBUG winrmshell: [WinRM] Command created for hostname with id: 646F380B-E91D-4587-A3A7-FCF201F01C36
DEBUG winrmshell: [WinRM] creating command_id: 646F380B-E91D-4587-A3A7-FCF201F01C36 on shell_id A696FE80-62CC-4BA7-84F7-FD82E84641F2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 646F380B-E91D-4587-A3A7-FCF201F01C36 on shell_id A696FE80-62CC-4BA7-84F7-FD82E84641F2
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8b91e40 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2215, 5986=>2217, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 470E6B9A-FECA-40EF-B744-2D84752E2596
DEBUG winrmshell: [WinRM] Command created for hostname with id: 58D1F749-82E3-40DA-BFE5-D8D9CECC06EF
DEBUG winrmshell: [WinRM] creating command_id: 58D1F749-82E3-40DA-BFE5-D8D9CECC06EF on shell_id 470E6B9A-FECA-40EF-B744-2D84752E2596
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 58D1F749-82E3-40DA-BFE5-D8D9CECC06EF on shell_id 470E6B9A-FECA-40EF-B744-2D84752E2596
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd92b6d10 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89af708 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89ae880 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8927650 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 79B64F50-5797-49F9-825C-AC368A2CE548
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5AC9BA4C-C874-4C30-8479-D8BAAE12C83C
DEBUG winrmshell: [WinRM] creating command_id: 5AC9BA4C-C874-4C30-8479-D8BAAE12C83C on shell_id 79B64F50-5797-49F9-825C-AC368A2CE548
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5AC9BA4C-C874-4C30-8479-D8BAAE12C83C on shell_id 79B64F50-5797-49F9-825C-AC368A2CE548
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd86c50b0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d3a170 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d39220 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8c7dde0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C2BEA7DD-3373-41B3-95B5-690D3B41566B
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B1AA8C54-4195-432A-9D00-B52F23A0D73C
DEBUG winrmshell: [WinRM] creating command_id: B1AA8C54-4195-432A-9D00-B52F23A0D73C on shell_id C2BEA7DD-3373-41B3-95B5-690D3B41566B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B1AA8C54-4195-432A-9D00-B52F23A0D73C on shell_id C2BEA7DD-3373-41B3-95B5-690D3B41566B
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8b827b0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1gv5o18.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9099a00 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9098b78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8f03150 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "91103d0ccbde4757bd913a8feb78e434a7d2d5dc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-1gv5o18.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2444B371-6A70-46AA-8BB5-35C9D0873AA6
DEBUG winrmshell: [WinRM] creating command_id: 2444B371-6A70-46AA-8BB5-35C9D0873AA6 on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2444B371-6A70-46AA-8BB5-35C9D0873AA6 on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","93c0f572b02ed6ea73cfea3459aef558ea59bf8c","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1gv5o18.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6CD9C95A-1B72-4928-802B-DF8A397D2CF2
DEBUG winrmshell: [WinRM] creating command_id: 6CD9C95A-1B72-4928-802B-DF8A397D2CF2 on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6CD9C95A-1B72-4928-802B-DF8A397D2CF2 on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBTZXRzIHRpbWV6b25lIHRvIFVUQywgc2V0cyBob3N0bmFtZSwgY3JlYXRlcy9qb2lucyBkb21haW4uCiMgU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vU3RlZmFuU2NoZXJlci9hZGZzMgoKJFByb2ZpbGVQYXRoID0gIkM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwcm9maWxlLnBzMSIKJGJveCA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggSEtMTTpTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxDb21wdXRlck5hbWVcQ29tcHV0ZXJOYW1lIC1OYW1lICJDb21wdXRlck5hbWUiCiRib3ggPSAkYm94LkNvbXB1dGVyTmFtZS5Ub1N0cmluZygpLlRvTG93ZXIoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldHRpbmcgdGltZXpvbmUgdG8gVVRDLi4uIgpjOlx3aW5kb3dzXHN5c3RlbTMyXHR6dXRpbC5leGUgL3MgIlVUQyIKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDaGVja2luZyBpZiBXaW5kb3dzIGV2YWx1YXRpb24gaXMgZXhwaXJpbmcgc29vbiBvciBleHBpcmVkLi4uIgouIGM6XHZhZ3JhbnRcc2NyaXB0c1xmaXgtd2luZG93cy1leHBpcmF0aW9uLnBzMQoKSWYgKCEoVGVzdC1QYXRoICRQcm9maWxlUGF0aCkpIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGlzYWJsaW5nIHRoZSBJbnZva2UtV2ViUmVxdWVzdCBkb3dubG9hZCBwcm9ncmVzcyBiYXIgZ2xvYmFsbHkgZm9yIHNwZWVkIGltcHJvdmVtZW50cy4iIAogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZWUgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOCBmb3IgbW9yZSBpbmZvIgogIE5ldy1JdGVtIC1QYXRoICRQcm9maWxlUGF0aCB8IE91dC1OdWxsCiAgSWYgKCEoR2V0LUNvbnRlbnQgJFByb2ZpbGVwYXRofCAlIHsgJF8gLW1hdGNoICJTaWxlbnRseUNvbnRpbnVlIiB9ICkpIHsKICAgIEFkZC1Db250ZW50IC1QYXRoICRQcm9maWxlUGF0aCAtVmFsdWUgIiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZSciCiAgfQp9CgojIFBpbmcgRGV0ZWN0aW9uTGFiIHNlcnZlciBmb3IgdXNhZ2Ugc3RhdGlzdGljcwpUcnkgewogIGN1cmwgLXVzZXJBZ2VudCAiRGV0ZWN0aW9uTGFiLSRib3giICJodHRwczovL3BpbmcuZGV0ZWN0aW9ubGFiLm5ldHdvcmsvJGJveCIgLVVzZUJhc2ljUGFyc2luZyB8IG91dC1udWxsCn0gQ2F0Y2ggewogIFdyaXRlLUhvc3QgIlVuYWJsZSB0byBjb25uZWN0IHRvIHBpbmcuZGV0ZWN0aW9ubGFiLm5ldHdvcmsiCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEaXNhYmxpbmcgSVB2NiBvbiBhbGwgbmV0d29yayBhZGF0cGVycy4uLiIKR2V0LU5ldEFkYXB0ZXJCaW5kaW5nIC1Db21wb25lbnRJRCBtc190Y3BpcDYgfCBGb3JFYWNoLU9iamVjdCB7RGlzYWJsZS1OZXRBZGFwdGVyQmluZGluZyAtTmFtZSAkXy5OYW1lIC1Db21wb25lbnRJRCBtc190Y3BpcDZ9CkdldC1OZXRBZGFwdGVyQmluZGluZyAtQ29tcG9uZW50SUQgbXNfdGNwaXA2IAojIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLWdiL2hlbHAvOTI5ODUyL2d1aWRhbmNlLWZvci1jb25maWd1cmluZy1pcHY2LWluLXdpbmRvd3MtZm9yLWFkdmFuY2VkLXVzZXJzCnJlZyBhZGQgIkhLRVlfTE9DQUxfTUFDSElORVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcVGNwaXA2XFBhcmFtZXRlcnMiIC92IERpc2FibGVkQ29tcG9uZW50cyAvdCBSRUdfRFdPUkQgL2QgMjU1IC9mCgppZiAoJGVudjpDT01QVVRFUk5BTUUgLWltYXRjaCAndmFncmFudCcpIHsKCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEhvc3RuYW1lIGlzIHN0aWxsIHRoZSBvcmlnaW5hbCBvbmUsIHNraXAgcHJvdmlzaW9uaW5nIGZvciByZWJvb3QuLi4iCgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIGJnaW5mby4uLiIKICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xpbnN0YWxsLWJnaW5mby5wczEKCn0gZWxzZWlmICgoZ3dtaSB3aW4zMl9jb21wdXRlcnN5c3RlbSkucGFydG9mZG9tYWluIC1lcSAkZmFsc2UpIHsKCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEN1cnJlbnQgZG9tYWluIGlzIHNldCB0byAnd29ya2dyb3VwJy4gVGltZSB0byBqb2luIHRoZSBkb21haW4hIgoKICBpZiAoIShUZXN0LVBhdGggJ2M6XFByb2dyYW0gRmlsZXNcc3lzaW50ZXJuYWxzXGJnaW5mby5leGUnKSkgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgYmdpbmZvLi4uIgogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcaW5zdGFsbC1iZ2luZm8ucHMxCiAgICAjIFNldCBiYWNrZ3JvdW5kIHRvIGJlICJmaXR0ZWQiIGluc3RlYWQgb2YgInRpbGVkIgogICAgU2V0LUl0ZW1Qcm9wZXJ0eSAnSEtDVTpcQ29udHJvbCBQYW5lbFxEZXNrdG9wJyAtTmFtZSBUaWxlV2FsbHBhcGVyIC1WYWx1ZSAnMCcKICAgIFNldC1JdGVtUHJvcGVydHkgJ0hLQ1U6XENvbnRyb2wgUGFuZWxcRGVza3RvcCcgLU5hbWUgV2FsbHBhcGVyU3R5bGUgLVZhbHVlICc2JwogICAgIyBTZXQgVGFzayBNYW5hZ2VyIHByZWZzCiAgICByZWcgaW1wb3J0ICJjOlx2YWdyYW50XHJlc291cmNlc1x3aW5kb3dzXFRhc2tNYW5hZ2VyLnJlZyIgMj4mMSB8IG91dC1udWxsCiAgfQoKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgTXkgaG9zdG5hbWUgaXMgJGVudjpDT01QVVRFUk5BTUUiCiAgaWYgKCRlbnY6Q09NUFVURVJOQU1FIC1pbWF0Y2ggJ2RjJykgewogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcY3JlYXRlLWRvbWFpbi5wczEgMTkyLjE2OC41Ni4xMDIKICB9IGVsc2UgewogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcam9pbi1kb21haW4ucHMxCiAgfQp9IGVsc2UgewogIFdyaXRlLUhvc3QgLWZvcmUgZ3JlZW4gIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJIGFtIGRvbWFpbiBqb2luZWQhIgogIGlmICghKFRlc3QtUGF0aCAnYzpcUHJvZ3JhbSBGaWxlc1xzeXNpbnRlcm5hbHNcYmdpbmZvLmV4ZScpKSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW5zdGFsbGluZyBiZ2luZm8uLi4iCiAgICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xpbnN0YWxsLWJnaW5mby5wczEKICB9CgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIHRoZSByZWdpc3RyeSBmb3IgYXV0by1sb2dpbi4uLiIKICBTZXQtSXRlbVByb3BlcnR5ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxXaW5sb2dvbiIgLU5hbWUgQXV0b0FkbWluTG9nb24gLVZhbHVlIDEgLVR5cGUgU3RyaW5nCiAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC1OYW1lIERlZmF1bHRVc2VyTmFtZSAtVmFsdWUgInZhZ3JhbnQiCiAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC1OYW1lIERlZmF1bHRQYXNzd29yZCAtVmFsdWUgInZhZ3JhbnQiCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFByb3Zpc2lvbmluZyBhZnRlciBqb2luaW5nIGRvbWFpbi4uLiIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0C27B234-F03E-4C17-8655-52A8C271DE79
DEBUG winrmshell: [WinRM] creating command_id: 0C27B234-F03E-4C17-8655-52A8C271DE79 on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0C27B234-F03E-4C17-8655-52A8C271DE79 on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 15CC9BE0-1DA9-4332-938F-1D95189D331B
DEBUG winrmshell: [WinRM] creating command_id: 15CC9BE0-1DA9-4332-938F-1D95189D331B on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 15CC9BE0-1DA9-4332-938F-1D95189D331B on shell_id 79431B04-B9FF-4538-B3A8-FD3F4FFF683B
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1gv5o18.ps1 to C:/tmp/vagrant-shell.ps1 (5.112 KB over 1 chunks) in (0m0.24s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.71s) stream_files: (0m0.24s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a37f18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a36d20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd898c5a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4275AD9B-B402-4A79-9DEF-2EE6D33B095A
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: AD0893E2-EE1B-4E00-BBA9-7D7DFC318086
DEBUG winrmshell: [WinRM] creating command_id: AD0893E2-EE1B-4E00-BBA9-7D7DFC318086 on shell_id 4275AD9B-B402-4A79-9DEF-2EE6D33B095A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:36] Setting timezone to UTC...
 INFO interface: detail:     win10: [20:36] Setting timezone to UTC...
    win10: [20:36] Setting timezone to UTC...
 INFO interface: detail: [20:36] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail:     win10: [20:36] Checking if Windows evaluation is expiring soon or expired...
    win10: [20:36] Checking if Windows evaluation is expiring soon or expired...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:36] 90 days left until expiration, no need to rearm.
 INFO interface: detail:     win10: [20:36] 90 days left until expiration, no need to rearm.
    win10: [20:36] 90 days left until expiration, no need to rearm.
 INFO interface: detail: [20:36] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
 INFO interface: detail:     win10: [20:36] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
    win10: [20:36] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
 INFO interface: detail: [20:36] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
 INFO interface: detail:     win10: [20:36] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
    win10: [20:36] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:36] Disabling IPv6 on all network adatpers...
 INFO interface: detail:     win10: [20:36] Disabling IPv6 on all network adatpers...
    win10: [20:36] Disabling IPv6 on all network adatpers...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Name                           DisplayName                                        ComponentID
 INFO interface: detail:     win10: Name                           DisplayName                                        ComponentID
    win10: Name                           DisplayName                                        ComponentID
 INFO interface: detail: ----                           -----------                                        -----------
 INFO interface: detail:     win10: ----                           -----------                                        -----------
    win10: ----                           -----------                                        -----------
 INFO interface: detail: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     win10: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    win10: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     win10: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    win10: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: The operation completed successfully.
 INFO interface: detail:     win10: The operation completed successfully.
    win10: The operation completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: [20:36] Current domain is set to 'workgroup'. Time to join the domain!
 INFO interface: detail:     win10: [20:36] Current domain is set to 'workgroup'. Time to join the domain!
    win10: [20:36] Current domain is set to 'workgroup'. Time to join the domain!
 INFO interface: detail: [20:36] Installing bginfo...
 INFO interface: detail:     win10: [20:36] Installing bginfo...
    win10: [20:36] Installing bginfo...
 INFO interface: detail: [20:36] Installing BGInfo...
 INFO interface: detail:     win10: [20:36] Installing BGInfo...
    win10: [20:36] Installing BGInfo...
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
 INFO interface: detail:     win10: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
    win10: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
 INFO interface: detail: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
 INFO interface: detail:     win10: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
    win10: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
 INFO interface: detail: PSChildName       : sysinternals
 INFO interface: detail:     win10: PSChildName       : sysinternals
    win10: PSChildName       : sysinternals
 INFO interface: detail: PSDrive           : C
 INFO interface: detail:     win10: PSDrive           : C
    win10: PSDrive           : C
 INFO interface: detail: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail:     win10: PSProvider        : Microsoft.PowerShell.Core\FileSystem
    win10: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail: PSIsContainer     : True
 INFO interface: detail:     win10: PSIsContainer     : True
    win10: PSIsContainer     : True
 INFO interface: detail: Name              : sysinternals
 INFO interface: detail:     win10: Name              : sysinternals
    win10: Name              : sysinternals
 INFO interface: detail: FullName          : C:\Program Files\sysinternals
 INFO interface: detail:     win10: FullName          : C:\Program Files\sysinternals
    win10: FullName          : C:\Program Files\sysinternals
 INFO interface: detail: Parent            : Program Files
 INFO interface: detail:     win10: Parent            : Program Files
    win10: Parent            : Program Files
 INFO interface: detail: Exists            : True
 INFO interface: detail:     win10: Exists            : True
    win10: Exists            : True
 INFO interface: detail: Root              : C:\
 INFO interface: detail:     win10: Root              : C:\
    win10: Root              : C:\
 INFO interface: detail: Extension         :
 INFO interface: detail:     win10: Extension         :
    win10: Extension         :
 INFO interface: detail: CreationTime      : 6/20/2022 8:36:35 PM
 INFO interface: detail:     win10: CreationTime      : 6/20/2022 8:36:35 PM
    win10: CreationTime      : 6/20/2022 8:36:35 PM
 INFO interface: detail: CreationTimeUtc   : 6/21/2022 3:36:35 AM
 INFO interface: detail:     win10: CreationTimeUtc   : 6/21/2022 3:36:35 AM
    win10: CreationTimeUtc   : 6/21/2022 3:36:35 AM
 INFO interface: detail: LastAccessTime    : 6/20/2022 8:36:35 PM
 INFO interface: detail:     win10: LastAccessTime    : 6/20/2022 8:36:35 PM
    win10: LastAccessTime    : 6/20/2022 8:36:35 PM
 INFO interface: detail: LastAccessTimeUtc : 6/21/2022 3:36:35 AM
 INFO interface: detail:     win10: LastAccessTimeUtc : 6/21/2022 3:36:35 AM
    win10: LastAccessTimeUtc : 6/21/2022 3:36:35 AM
 INFO interface: detail: LastWriteTime     : 6/20/2022 8:36:35 PM
 INFO interface: detail:     win10: LastWriteTime     : 6/20/2022 8:36:35 PM
    win10: LastWriteTime     : 6/20/2022 8:36:35 PM
 INFO interface: detail: LastWriteTimeUtc  : 6/21/2022 3:36:35 AM
 INFO interface: detail:     win10: LastWriteTimeUtc  : 6/21/2022 3:36:35 AM
    win10: LastWriteTimeUtc  : 6/21/2022 3:36:35 AM
 INFO interface: detail: Attributes        : Directory
 INFO interface: detail:     win10: Attributes        : Directory
    win10: Attributes        : Directory
 INFO interface: detail: Mode              : d-----
 INFO interface: detail:     win10: Mode              : d-----
    win10: Mode              : d-----
 INFO interface: detail: BaseName          : sysinternals
 INFO interface: detail:     win10: BaseName          : sysinternals
    win10: BaseName          : sysinternals
 INFO interface: detail: Target            : {}
 INFO interface: detail:     win10: Target            : {}
    win10: Target            : {}
 INFO interface: detail: LinkType          :
 INFO interface: detail:     win10: LinkType          :
    win10: LinkType          :
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [20:37] My hostname is WIN10
 INFO interface: detail:     win10: [20:37] My hostname is WIN10
    win10: [20:37] My hostname is WIN10
 INFO interface: detail: [20:37] Joining the domain...
 INFO interface: detail:     win10: [20:37] Joining the domain...
    win10: [20:37] Joining the domain...
 INFO interface: detail: [20:37] First, set DNS to DC to join the domain...
 INFO interface: detail:     win10: [20:37] First, set DNS to DC to join the domain...
    win10: [20:37] First, set DNS to DC to join the domain...
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: __GENUS          : 2
 INFO interface: detail:     win10: __GENUS          : 2
    win10: __GENUS          : 2
 INFO interface: detail: __CLASS          : __PARAMETERS
 INFO interface: detail:     win10: __CLASS          : __PARAMETERS
    win10: __CLASS          : __PARAMETERS
 INFO interface: detail: __SUPERCLASS     :
 INFO interface: detail:     win10: __SUPERCLASS     :
    win10: __SUPERCLASS     :
 INFO interface: detail: __DYNASTY        : __PARAMETERS
 INFO interface: detail:     win10: __DYNASTY        : __PARAMETERS
    win10: __DYNASTY        : __PARAMETERS
 INFO interface: detail: __RELPATH        :
 INFO interface: detail:     win10: __RELPATH        :
    win10: __RELPATH        :
 INFO interface: detail: __PROPERTY_COUNT : 1
 INFO interface: detail:     win10: __PROPERTY_COUNT : 1
    win10: __PROPERTY_COUNT : 1
 INFO interface: detail: __DERIVATION     : {}
 INFO interface: detail:     win10: __DERIVATION     : {}
    win10: __DERIVATION     : {}
 INFO interface: detail: __SERVER         :
 INFO interface: detail:     win10: __SERVER         :
    win10: __SERVER         :
 INFO interface: detail: __NAMESPACE      :
 INFO interface: detail:     win10: __NAMESPACE      :
    win10: __NAMESPACE      :
 INFO interface: detail: __PATH           :
 INFO interface: detail:     win10: __PATH           :
    win10: __PATH           :
 INFO interface: detail: ReturnValue      : 0
 INFO interface: detail:     win10: ReturnValue      : 0
    win10: ReturnValue      : 0
 INFO interface: detail: PSComputerName   :
 INFO interface: detail:     win10: PSComputerName   :
    win10: PSComputerName   :
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: __GENUS          : 2
 INFO interface: detail:     win10: __GENUS          : 2
    win10: __GENUS          : 2
 INFO interface: detail: __CLASS          : __PARAMETERS
 INFO interface: detail:     win10: __CLASS          : __PARAMETERS
    win10: __CLASS          : __PARAMETERS
 INFO interface: detail: __SUPERCLASS     :
 INFO interface: detail:     win10: __SUPERCLASS     :
    win10: __SUPERCLASS     :
 INFO interface: detail: __DYNASTY        : __PARAMETERS
 INFO interface: detail:     win10: __DYNASTY        : __PARAMETERS
    win10: __DYNASTY        : __PARAMETERS
 INFO interface: detail: __RELPATH        :
 INFO interface: detail:     win10: __RELPATH        :
    win10: __RELPATH        :
 INFO interface: detail: __PROPERTY_COUNT : 1
 INFO interface: detail:     win10: __PROPERTY_COUNT : 1
    win10: __PROPERTY_COUNT : 1
 INFO interface: detail: __DERIVATION     : {}
 INFO interface: detail:     win10: __DERIVATION     : {}
    win10: __DERIVATION     : {}
 INFO interface: detail: __SERVER         :
 INFO interface: detail:     win10: __SERVER         :
    win10: __SERVER         :
 INFO interface: detail: __NAMESPACE      :
 INFO interface: detail:     win10: __NAMESPACE      :
    win10: __NAMESPACE      :
 INFO interface: detail: __PATH           :
 INFO interface: detail:     win10: __PATH           :
    win10: __PATH           :
 INFO interface: detail: ReturnValue      : 0
 INFO interface: detail:     win10: ReturnValue      : 0
    win10: ReturnValue      : 0
 INFO interface: detail: PSComputerName   :
 INFO interface: detail:     win10: PSComputerName   :
    win10: PSComputerName   :
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: [20:37] Now join the domain...
 INFO interface: detail:     win10: [20:37] Now join the domain...
    win10: [20:37] Now join the domain...
 INFO interface: detail: [20:37] Adding Win10 to the domain. Sometimes this step times out. If that happens, just run 'vagrant reload win10 --provision'
 INFO interface: detail:     win10: [20:37] Adding Win10 to the domain. Sometimes this step times out. If that happens, just run 'vagrant reload win10 --provision'
    win10: [20:37] Adding Win10 to the domain. Sometimes this step times out. If that happens, just run 'vagrant reload win10 --provision'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: The changes will take effect after you restart the computer win10.
 INFO interface: detail:     win10: WARNING: The changes will take effect after you restart the computer win10.
    win10: WARNING: The changes will take effect after you restart the computer win10.
 INFO interface: detail: [20:37] Disabling Windows Updates and Windows Module Services
 INFO interface: detail:     win10: [20:37] Disabling Windows Updates and Windows Module Services
    win10: [20:37] Disabling Windows Updates and Windows Module Services
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] cleaning up command_id: AD0893E2-EE1B-4E00-BBA9-7D7DFC318086 on shell_id 4275AD9B-B402-4A79-9DEF-2EE6D33B095A
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd88b4858 @data=[{:stdout=>"[20:36] Setting timezone to UTC...\r\n"}, {:stdout=>"[20:36] Checking if Windows evaluation is expiring soon or expired...\r\n"}, {:stdout=>"[20:36] 90 days left until expiration, no need to rearm.\r\n"}, {:stdout=>"[20:36] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.\r\n"}, {:stdout=>"[20:36] See https://github.com/PowerShell/PowerShell/issues/2138 for more info\r\n"}, {:stdout=>"[20:36] Disabling IPv6 on all network adatpers...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           DisplayName                                        ComponentID     \r\n"}, {:stdout=>"----                           -----------                                        -----------     \r\n"}, {:stdout=>"Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"The operation completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[20:36] Current domain is set to 'workgroup'. Time to join the domain!\r\n"}, {:stdout=>"[20:36] Installing bginfo...\r\n"}, {:stdout=>"[20:36] Installing BGInfo...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Program Files\\sysinternals\r\n"}, {:stdout=>"PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\Program Files\r\n"}, {:stdout=>"PSChildName       : sysinternals\r\n"}, {:stdout=>"PSDrive           : C\r\n"}, {:stdout=>"PSProvider        : Microsoft.PowerShell.Core\\FileSystem\r\n"}, {:stdout=>"PSIsContainer     : True\r\n"}, {:stdout=>"Name              : sysinternals\r\n"}, {:stdout=>"FullName          : C:\\Program Files\\sysinternals\r\n"}, {:stdout=>"Parent            : Program Files\r\n"}, {:stdout=>"Exists            : True\r\n"}, {:stdout=>"Root              : C:\\\r\n"}, {:stdout=>"Extension         : \r\n"}, {:stdout=>"CreationTime      : 6/20/2022 8:36:35 PM\r\n"}, {:stdout=>"CreationTimeUtc   : 6/21/2022 3:36:35 AM\r\n"}, {:stdout=>"LastAccessTime    : 6/20/2022 8:36:35 PM\r\n"}, {:stdout=>"LastAccessTimeUtc : 6/21/2022 3:36:35 AM\r\n"}, {:stdout=>"LastWriteTime     : 6/20/2022 8:36:35 PM\r\n"}, {:stdout=>"LastWriteTimeUtc  : 6/21/2022 3:36:35 AM\r\n"}, {:stdout=>"Attributes        : Directory\r\n"}, {:stdout=>"Mode              : d-----\r\n"}, {:stdout=>"BaseName          : sysinternals\r\n"}, {:stdout=>"Target            : {}\r\n"}, {:stdout=>"LinkType          : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[20:37] My hostname is WIN10\r\n"}, {:stdout=>"[20:37] Joining the domain...\r\n"}, {:stdout=>"[20:37] First, set DNS to DC to join the domain...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"__GENUS          : 2\r\n"}, {:stdout=>"__CLASS          : __PARAMETERS\r\n"}, {:stdout=>"__SUPERCLASS     : \r\n"}, {:stdout=>"__DYNASTY        : __PARAMETERS\r\n"}, {:stdout=>"__RELPATH        : \r\n"}, {:stdout=>"__PROPERTY_COUNT : 1\r\n"}, {:stdout=>"__DERIVATION     : {}\r\n"}, {:stdout=>"__SERVER         : \r\n"}, {:stdout=>"__NAMESPACE      : \r\n"}, {:stdout=>"__PATH           : \r\n"}, {:stdout=>"ReturnValue      : 0\r\n"}, {:stdout=>"PSComputerName   : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"__GENUS          : 2\r\n"}, {:stdout=>"__CLASS          : __PARAMETERS\r\n"}, {:stdout=>"__SUPERCLASS     : \r\n"}, {:stdout=>"__DYNASTY        : __PARAMETERS\r\n"}, {:stdout=>"__RELPATH        : \r\n"}, {:stdout=>"__PROPERTY_COUNT : 1\r\n"}, {:stdout=>"__DERIVATION     : {}\r\n"}, {:stdout=>"__SERVER         : \r\n"}, {:stdout=>"__NAMESPACE      : \r\n"}, {:stdout=>"__PATH           : \r\n"}, {:stdout=>"ReturnValue      : 0\r\n"}, {:stdout=>"PSComputerName   : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[20:37] Now join the domain...\r\n"}, {:stdout=>"[20:37] Adding Win10 to the domain. Sometimes this step times out. If that happens, just run 'vagrant reload win10 --provision'\r\n"}, {:stdout=>"WARNING: The changes will take effect after you restart the computer win10.\r\n"}, {:stdout=>"[20:37] Disabling Windows Updates and Windows Module Services\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd7fe1be0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: reload...
 INFO interface: info: ==> win10: Running provisioner: reload...
==> win10: Running provisioner: reload...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd91fdf90 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO machine: Calling action: reload on provider VMware Workstation
 INFO interface: Machine: action ["reload", "start", {:target=>:win10}]
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd91c2ad0>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd8fd01c8>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd8e91348>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd8a248a0>
 INFO warden: Calling IN action: #<Proc:0x000001efd887e2d0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::ConfigValidate:0x000001efd8a247d8>
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: VMware Middleware: CheckVMware
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd89bdcb8>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd8676208>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd72fa080>
 INFO warden: Calling IN action: #<Proc:0x000001efd922d880 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: DiscardSuspendedState
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "FALSE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:fb:4b:c4"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:fb:4b:ce"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'"
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "1"
DEBUG vmware_driver:   - SET sharedfolder0.enabled = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.expiration = "never"
DEBUG vmware_driver:   - SET sharedfolder0.guestname = "-vagrant"
DEBUG vmware_driver:   - SET sharedfolder0.hostpath = "D:\workspace\eWalker\DetectionLab\Vagrant"
DEBUG vmware_driver:   - SET sharedfolder0.present = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.readaccess = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.writeaccess = "TRUE"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "6"
DEBUG vmware_driver:   - SET unity.wascapable = "TRUE"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd6989870>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd8fe3228>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd8d7eb68>
 INFO warden: Calling IN action: #<Proc:0x000001efd8cb6dc0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd8d7ecf8>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd8c13da0>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::GracefulHalt:0x000001efd8b8a938>
 INFO graceful_halt: Verifying source state of machine: :running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO interface: output: Attempting graceful shutdown of VM...
 INFO interface: output: ==> win10: Attempting graceful shutdown of VM...
==> win10: Attempting graceful shutdown of VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 22=>2218, 5985=>2213}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2216
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E1E93C1B-DB8D-4329-82D7-2B15059F5E5E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 53B9F955-819C-4B1B-9F0E-CBC04B4E548B
DEBUG winrmshell: [WinRM] creating command_id: 53B9F955-819C-4B1B-9F0E-CBC04B4E548B on shell_id E1E93C1B-DB8D-4329-82D7-2B15059F5E5E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 53B9F955-819C-4B1B-9F0E-CBC04B4E548B on shell_id E1E93C1B-DB8D-4329-82D7-2B15059F5E5E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd7f2e680 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: halt
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: halt in windows
 INFO guest: Execute capability: halt [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
DEBUG winrm: powershell executing:
shutdown -a
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a0cd90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89e7ea0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89546a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5DE99872-F73D-418F-AB4E-D37D3054449E
DEBUG winrmshell: [WinRM] Command created for shutdown -a

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 98AE3EA7-6BAE-4741-9271-673D3396658C
DEBUG winrmshell: [WinRM] creating command_id: 98AE3EA7-6BAE-4741-9271-673D3396658C on shell_id 5DE99872-F73D-418F-AB4E-D37D3054449E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 98AE3EA7-6BAE-4741-9271-673D3396658C on shell_id 5DE99872-F73D-418F-AB4E-D37D3054449E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd86b4008 @data=[{:stderr=>"shutdown.exe : Unable to abort the system shutdown because no shutdown was in progress.(1116)\n    + CategoryInfo          : NotSpecified: (Unable to abort...progress.(1116):String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n"}], @exitcode=1116>
DEBUG winrm: powershell executing:
shutdown /s /t 1 /c "Vagrant Halt" /f /d p:4:1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2216/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88c42a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88bf0f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd865cbc8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 61145C76-4F22-4CE8-83C3-6E4440FE0372
DEBUG winrmshell: [WinRM] Command created for shutdown /s /t 1 /c "Vagrant Halt" /f /d p:4:1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9E6855A6-FB79-4FEF-8BEB-8A7D510A303E
DEBUG winrmshell: [WinRM] creating command_id: 9E6855A6-FB79-4FEF-8BEB-8A7D510A303E on shell_id 61145C76-4F22-4CE8-83C3-6E4440FE0372
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9E6855A6-FB79-4FEF-8BEB-8A7D510A303E on shell_id 61145C76-4F22-4CE8-83C3-6E4440FE0372
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd82a1268 @data=[], @exitcode=0>
DEBUG graceful_halt: Waiting for target graceful halt state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO graceful_halt: Gracefully halted.
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::GracefulHalt:0x000001efd8b8a938>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd8ac6fd8>
 INFO warden: Calling IN action: #<Proc:0x000001efd89be280 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: WaitForVMXHalt
 INFO wait_for_vmx_halt: Waiting for VMX process to go away...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
 INFO warden: Calling IN action: #<Proc:0x000001efd8aa4410 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000001efd8d7ede8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000001efd69897a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
DEBUG checkpoint: checkpoint data processing complete
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x000001efd8994ef8>
 INFO interface: output: Checking if box 'detectionlab/win10' version '1.8' is up to date...
 INFO interface: output: ==> win10: Checking if box 'detectionlab/win10' version '1.8' is up to date...
==> win10: Checking if box 'detectionlab/win10' version '1.8' is up to date...
 INFO box: box update check is under the interval threshold
 INFO box: Skipping box update check
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd896e320>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd890d098>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd824a4b8>
 INFO warden: Calling IN action: #<Proc:0x000001efd9307878 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: CheckExistingNetwork
 INFO check_existing_network: Checking if the vmnet devices are healthy...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Verifying vmnet devices are healthy...
 INFO interface: info: ==> win10: Verifying vmnet devices are healthy...
==> win10: Verifying vmnet devices are healthy...
DEBUG vagrant_utility: request METHOD=POST PATH=/vmnet/verify RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: PruneForwardedPorts
 INFO prune_forwarded_ports: Pruning forwarded ports...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
DEBUG vmware_driver: requesting prune of unused port forwards
DEBUG vagrant_utility: request METHOD=DELETE PATH=/portforwards RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000001efd80a0158>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000001efd91ff930>
 INFO warden: Calling IN action: VMware Middleware: Suspended
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
DEBUG suspended: result: false
 INFO warden: Calling OUT action: VMware Middleware: Suspended
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x000001efd8a7f250>
 INFO warden: Calling IN action: #<Proc:0x000001efd7fb1738 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Provision:0x000001efd8a7f1b0>
 INFO provision: Checking provisioner sentinel file...
 INFO provision: Sentinel found! Not provisioning.
 INFO warden: Calling IN action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x000001efd8a577a0>
DEBUG host: Searching for cap: nfs_prune
DEBUG host: Checking in: windows
 INFO nfs: Host doesn't support pruning NFS. Skipping.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x000001efd89bd718>
 INFO synced_folder_cleanup: Invoking synced folder cleanup for: vmware
 INFO synced_folder: Clearing shared folders
 INFO vmware_driver: Clearing shared folders...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:fb:4b:c4"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:fb:4b:ce"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'"
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "6"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Delayed:0x000001efd7e5cb30>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolders:0x000001efd7e5cb08>
 INFO synced_folders: SyncedFolders loading from cache: false
 INFO synced_folders: Synced Folder Implementation: vmware
 INFO synced_folders:   - /vagrant: . => /vagrant
 INFO synced_folders: Invoking synced folder prepare for: vmware
 INFO warden: Calling IN action: VMware Middleware: PrepareNFSSettings
 INFO warden: Calling IN action: VMware Middleware: Network
DEBUG network: Available slots for high-level adapters: #<Set: {1, 2, 3, 4, 5, 6, 7, 8}>
 INFO network: Determining network adapters required for high-level configuration...
 INFO network:  -- Slot 1: hostonly
 INFO network: Determining adapters and compiling network configuration...
 INFO network: Slot 0. Type: nat
DEBUG network: Normalized configuration: {:auto_config=>false, :type=>:dhcp}
DEBUG network: Adapter configuration: {:type=>:nat, :slot=>0}
DEBUG network: Network configuration: {:type=>:dhcp, :auto_config=>false}
 INFO network: Slot 1. Type: hostonly
DEBUG network: Normalized configuration: {:auto_config=>true, :netmask=>"255.255.255.0", :type=>:static, :ip=>"192.168.56.104", :gateway=>"192.168.56.1", :dns=>"192.168.56.102", :protocol=>"tcp", :id=>"abc09ff8-db5e-4dae-8e14-e0e8d09012bd", :subnet_ip=>"192.168.56.0", :adapter_ip=>"192.168.56.1"}
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
 INFO network: Found matching vmnet device: vmnet2
 INFO network: Checking for hostonly network collisions...
 INFO subprocess: Starting process: ["C:\\WINDOWS\\system32/netsh.exe", "interface", "ip", "show", "route"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 

Publish  Type      Met  Prefix                    Idx  Gateway/Interface Name

-------  --------  ---  ------------------------  ---  ------------------------

No       Manual    100  0.0.0.0/0                  19  192.168.70.254

No       System    256  127.0.0.0/8                 1  Loopback Pseudo-Interface 1

No       System    256  127.0.0.1/32                1  Loopback Pseudo-Interface 1

No       System    256  127.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  169.254.0.0/16             34  VMware Network Adapter VMnet2

No       System    256  169.254.140.76/32          34  VMware Network Adapter VMnet2

No       System    256  169.254.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  172.22.112.0/20            97  vEthernet (Wi-Fi)

No       System    256  172.22.112.1/32            97  vEthernet (Wi-Fi)

No       System    256  172.22.127.255/32          97  vEthernet (Wi-Fi)

No       System    256  172.23.48.0/20             79  vEthernet (VMware Network )

No       System    256  172.23.48.1/32             79  vEthernet (VMware Network )

No       System    256  172.23.63.255/32           79  vEthernet (VMware Network )

No       System    256  172.23.128.0/20            28  vEthernet (Default Switch)

No       System    256  172.23.128.1/32            28  vEthernet (Default Switch)

No       System    256  172.23.143.255/32          28  vEthernet (Default Switch)

No       System    256  172.24.224.0/20            91  vEthernet (VMware Network ) 3

No       System    256  172.24.224.1/32            91  vEthernet (VMware Network ) 3

No       System    256  172.24.239.255/32          91  vEthernet (VMware Network ) 3

No       System    256  172.25.64.0/20             51  vEthernet (Ethernet)

No       System    256  172.25.64.1/32             51  vEthernet (Ethernet)

No       System    256  172.25.79.255/32           51  vEthernet (Ethernet)

No       System    256  172.28.64.0/20             85  vEthernet (VMware Network ) 2

No       System    256  172.28.64.1/32             85  vEthernet (VMware Network ) 2

No       System    256  172.28.79.255/32           85  vEthernet (VMware Network ) 2

No       System    256  172.30.80.0/20             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.80.1/32             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.95.255/32           73  vEthernet (vEthernet (NAT )

No       System    256  192.168.44.0/24            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.1/32            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.255/32          21  VMware Network Adapter VMnet1

No       System    256  192.168.70.0/24            19  Wi-Fi

No       System    256  192.168.70.245/32          19  Wi-Fi

No       System    256  192.168.70.255/32          19  Wi-Fi

No       System    256  192.168.222.0/24           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.1/32           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.255/32         33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 1  Loopback Pseudo-Interface 1

No       System    256  224.0.0.0/4                11  OpenVPN Wintun

No       System    256  224.0.0.0/4                34  VMware Network Adapter VMnet2

No       System    256  224.0.0.0/4                21  VMware Network Adapter VMnet1

No       System    256  224.0.0.0/4                33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 4  Ethernet

No       System    256  224.0.0.0/4                24  vEthernet (NAT vSwitch)

No       System    256  224.0.0.0/4                19  Wi-Fi

No       System    256  224.0.0.0/4                51  vEthernet (Ethernet)

No       System    256  224.0.0.0/4                28  vEthernet (Default Switch)

No       System    256  224.0.0.0/4                73  vEthernet (vEthernet (NAT )

No       System    256  224.0.0.0/4                79  vEthernet (VMware Network )

No       System    256  224.0.0.0/4                85  vEthernet (VMware Network ) 2

No       System    256  224.0.0.0/4                91  vEthernet (VMware Network ) 3

No       System    256  224.0.0.0/4                97  vEthernet (Wi-Fi)

No       System    256  224.0.0.0/4                32  Local Area Connection* 2

No       System    256  255.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  255.255.255.255/32         11  OpenVPN Wintun

No       System    256  255.255.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  255.255.255.255/32         21  VMware Network Adapter VMnet1

No       System    256  255.255.255.255/32         33  VMware Network Adapter VMnet8

No       System    256  255.255.255.255/32          4  Ethernet

No       System    256  255.255.255.255/32         24  vEthernet (NAT vSwitch)

No       System    256  255.255.255.255/32         19  Wi-Fi

No       System    256  255.255.255.255/32         51  vEthernet (Ethernet)

No       System    256  255.255.255.255/32         28  vEthernet (Default Switch)

No       System    256  255.255.255.255/32         73  vEthernet (vEthernet (NAT )

No       System    256  255.255.255.255/32         79  vEthernet (VMware Network )

No       System    256  255.255.255.255/32         85  vEthernet (VMware Network ) 2

No       System    256  255.255.255.255/32         91  vEthernet (VMware Network ) 3

No       System    256  255.255.255.255/32         97  vEthernet (Wi-Fi)

No       System    256  255.255.255.255/32         32  Local Area Connection* 2


DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG network: Adapter configuration: {:type=>:custom, :mac_address=>nil, :vnet=>"vmnet2", :slot=>1}
DEBUG network: Network configuration: {:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.104", :netmask=>"255.255.255.0", :auto_config=>true}
 INFO network: Enabling 2 adapters...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Preparing network adapters...
 INFO interface: info: ==> win10: Preparing network adapters...
==> win10: Preparing network adapters...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet0.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet1.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.vnet
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'"
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "6"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: BaseMacToIp
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SetHostname:0x000001efd88d79c0>
 INFO warden: Calling IN action: VMware Middleware: VMXModify
 INFO vmx_modify: Modifying VMX file according to user config...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmx_modify:   - Set: displayname = 'win10.windomain.local'
 INFO vmx_modify:   - Set: gui.fullscreenatpoweron = 'FALSE'
 INFO vmx_modify:   - Set: gui.viewModeAtPowerOn = 'windowed'
 INFO vmx_modify:   - Set: memsize = '3072'
 INFO vmx_modify:   - Set: numvcpus = '2'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "win10.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "windows_10.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'"
DEBUG vmware_driver:   - SET guestos = "windows9-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = ""
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "windows_10.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "Upk2o9go"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5963"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 69 b7 a3 88 f0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "6"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-212327770261140810"
DEBUG vmware_driver:   - SET vm.genidx = "6892556021860232927"
DEBUG vmware_driver:   - SET vmci0.id = "1861462630"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: PrepareForwardedPortCollisionParams
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2207, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2208, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2214, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5986}}, {:port=>2216, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5985}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2209, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2211, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2210, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2212, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2215, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>22}}, {:port=>2217, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5986}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2213, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5985}}, {:port=>2218, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}]
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x000001efd869dab0>
DEBUG environment: Attempting to acquire process-lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: fpcollision
 INFO handle_port_collisions: Detecting any forwarded port collisions...
DEBUG handle_port_collisions: Extra in use: {2207=>#<Set: {"*"}>, 2208=>#<Set: {"*"}>, 2214=>#<Set: {"*"}>, 2216=>#<Set: {"*"}>, 55985=>#<Set: {"*"}>, 2202=>#<Set: {"*"}>, 2204=>#<Set: {"*"}>, 2209=>#<Set: {"*"}>, 2211=>#<Set: {"*"}>, 55986=>#<Set: {"*"}>, 2201=>#<Set: {"*"}>, 2210=>#<Set: {"*"}>, 2212=>#<Set: {"*"}>, 2215=>#<Set: {"*"}>, 2217=>#<Set: {"*"}>, 2205=>#<Set: {"*"}>, 2206=>#<Set: {"*"}>, 2203=>#<Set: {"*"}>, 2213=>#<Set: {"*"}>, 2218=>#<Set: {"*"}>, 2222=>#<Set: {"*"}>, 2200=>#<Set: {"*"}>}
DEBUG handle_port_collisions: Remap: {}
DEBUG handle_port_collisions: Repair: true
 INFO handle_port_collisions: Attempting to repair FP collision: 2216
 INFO handle_port_collisions: Repaired FP collision: 2216 to 2219
 INFO interface: info: Fixed port collision for 5985 => 2216. Now on port 2219.
 INFO interface: info: ==> win10: Fixed port collision for 5985 => 2216. Now on port 2219.
==> win10: Fixed port collision for 5985 => 2216. Now on port 2219.
 INFO handle_port_collisions: Attempting to repair FP collision: 2217
 INFO handle_port_collisions: Repaired FP collision: 2217 to 2220
 INFO interface: info: Fixed port collision for 5986 => 2217. Now on port 2220.
 INFO interface: info: ==> win10: Fixed port collision for 5986 => 2217. Now on port 2220.
==> win10: Fixed port collision for 5986 => 2217. Now on port 2220.
 INFO handle_port_collisions: Attempting to repair FP collision: 2218
 INFO handle_port_collisions: Repaired FP collision: 2218 to 2221
 INFO interface: info: Fixed port collision for 22 => 2218. Now on port 2221.
 INFO interface: info: ==> win10: Fixed port collision for 22 => 2218. Now on port 2221.
==> win10: Fixed port collision for 22 => 2218. Now on port 2221.
 INFO environment: Released process lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: Boot
 INFO interface: info: Starting the VMware VM...
 INFO interface: info: ==> win10: Starting the VMware VM...
==> win10: Starting the VMware VM...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "start", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", "gui"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 44
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: VMware Middleware: WaitForAddress
 INFO interface: info: Waiting for the VM to receive an address...
 INFO interface: info: ==> win10: Waiting for the VM to receive an address...
==> win10: Waiting for the VM to receive an address...
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
 INFO warden: Calling IN action: VMware Middleware: ForwardPorts
DEBUG forward_ports: Building up ports to forward...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2214, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5986}}, {:port=>2218, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2209, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2215, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>22}}, {:port=>2217, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5986}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2207, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2210, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2212, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2213, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5985}}, {:port=>2216, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", :guest=>{:ip=>"192.168.222.132", :port=>5985}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2208, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2211, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}]
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
 INFO interface: info: Forwarding ports...
 INFO interface: info: ==> win10: Forwarding ports...
==> win10: Forwarding ports...
 INFO interface: detail: -- 5985 => 2219
 INFO interface: detail:     win10: -- 5985 => 2219
    win10: -- 5985 => 2219
 INFO interface: detail: -- 5986 => 2220
 INFO interface: detail:     win10: -- 5986 => 2220
    win10: -- 5986 => 2220
 INFO interface: detail: -- 22 => 2221
 INFO interface: detail:     win10: -- 22 => 2221
    win10: -- 22 => 2221
DEBUG vmware_driver: requesting ports to be forwarded: [{:device=>"vmnet8", :guest_port=>5985, :host_port=>2219, :protocol=>"tcp", :guest_ip=>"192.168.222.132"}, {:device=>"vmnet8", :guest_port=>5986, :host_port=>2220, :protocol=>"tcp", :guest_ip=>"192.168.222.132"}, {:device=>"vmnet8", :guest_port=>22, :host_port=>2221, :protocol=>"tcp", :guest_ip=>"192.168.222.132"}]
DEBUG vmware_driver: forwarding ports via collection method
DEBUG vagrant_utility: request METHOD=PUT PATH=/vmnet/vmnet8/portforward RESPONSE=200 
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x000001efd83a3c60>
 INFO interface: output: Waiting for machine to boot. This may take a few minutes...
 INFO interface: output: ==> win10: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Searching for cap: winrm_info
==> win10: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5986=>2217, 5985=>2213}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
 INFO interface: detail: WinRM address: 127.0.0.1:2216
 INFO interface: detail:     win10: WinRM address: 127.0.0.1:2216
    win10: WinRM address: 127.0.0.1:2216
 INFO interface: detail: WinRM username: vagrant
 INFO interface: detail:     win10: WinRM username: vagrant
 INFO interface: detail: WinRM execution_time_limit: PT2H
    win10: WinRM username: vagrant
 INFO interface: detail:     win10: WinRM execution_time_limit: PT2H
    win10: WinRM execution_time_limit: PT2H
 INFO interface: detail: WinRM transport: negotiate
 INFO interface: detail:     win10: WinRM transport: negotiate
    win10: WinRM transport: negotiate
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 5986=>2220, 22=>2215}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 130917B7-8F58-416F-9E95-FD0A0702DBD4
DEBUG winrmshell: [WinRM] Command created for hostname with id: A0CFFF59-50F8-470E-9F29-9AB18C60762F
DEBUG winrmshell: [WinRM] creating command_id: A0CFFF59-50F8-470E-9F29-9AB18C60762F on shell_id 130917B7-8F58-416F-9E95-FD0A0702DBD4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A0CFFF59-50F8-470E-9F29-9AB18C60762F on shell_id 130917B7-8F58-416F-9E95-FD0A0702DBD4
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8e1e460 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO interface: output: Machine booted and ready!
 INFO interface: output: ==> win10: Machine booted and ready!
==> win10: Machine booted and ready!
 INFO warden: Calling IN action: #<Proc:0x000001efd83a3be8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000001efd809b6f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<Proc:0x000001efd8937c08 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000001efd8937c08 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000001efd809b6f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000001efd83a3be8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x000001efd83a3c60>
 INFO warden: Calling OUT action: VMware Middleware: ForwardPorts
 INFO warden: Calling OUT action: VMware Middleware: WaitForAddress
 INFO warden: Calling OUT action: VMware Middleware: Boot
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x000001efd869dab0>
 INFO warden: Calling OUT action: VMware Middleware: PrepareForwardedPortCollisionParams
 INFO warden: Calling OUT action: VMware Middleware: VMXModify
 INFO interface: info: Setting hostname...
 INFO interface: info: ==> win10: Setting hostname...
==> win10: Setting hostname...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 22=>2215, 5985=>2219}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6FA83BB2-2D02-4C47-9FCC-E35864FCC80C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 780A8FC1-D8B3-49C2-867A-3659E0BC3CBC
DEBUG winrmshell: [WinRM] creating command_id: 780A8FC1-D8B3-49C2-867A-3659E0BC3CBC on shell_id 6FA83BB2-2D02-4C47-9FCC-E35864FCC80C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 780A8FC1-D8B3-49C2-867A-3659E0BC3CBC on shell_id 6FA83BB2-2D02-4C47-9FCC-E35864FCC80C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd9264ce0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: change_host_name
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: change_host_name in windows
 INFO guest: Execute capability: change_host_name [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, "win10"] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86af8a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8381cf0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7f2ee00 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EF02AABF-EBFF-46F8-8C6C-4F5C34274D22
DEBUG winrmshell: [WinRM] Command created for if ([System.Net.Dns]::GetHostName() -eq 'win10') { exit 0 } exit 1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 123398C4-F0E2-49E3-8ABD-9E796941B0DE
DEBUG winrmshell: [WinRM] creating command_id: 123398C4-F0E2-49E3-8ABD-9E796941B0DE on shell_id EF02AABF-EBFF-46F8-8C6C-4F5C34274D22
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 123398C4-F0E2-49E3-8ABD-9E796941B0DE on shell_id EF02AABF-EBFF-46F8-8C6C-4F5C34274D22
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd924c820 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SetHostname:0x000001efd88d79c0>
 INFO warden: Calling OUT action: VMware Middleware: BaseMacToIp
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
 INFO interface: info: Configuring network adapters within the VM...
 INFO interface: info: ==> win10: Configuring network adapters within the VM...
==> win10: Configuring network adapters within the VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 22=>2215, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 96726764-F6F3-4115-8CB6-A2B0CE137885
DEBUG winrmshell: [WinRM] Command created for hostname with id: 9CFEA10F-BBAE-498C-BAAF-D8E09A284388
DEBUG winrmshell: [WinRM] creating command_id: 9CFEA10F-BBAE-498C-BAAF-D8E09A284388 on shell_id 96726764-F6F3-4115-8CB6-A2B0CE137885
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9CFEA10F-BBAE-498C-BAAF-D8E09A284388 on shell_id 96726764-F6F3-4115-8CB6-A2B0CE137885
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd88d5058 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: configure_networks
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: configure_networks in windows
 INFO guest: Execute capability: configure_networks [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.104", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]] (windows)
DEBUG configure_networks: Networks: [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.104", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]
 INFO interface: warn: Configuring secondary network adapters through VMware 
 INFO interface: warn: ==> win10: Configuring secondary network adapters through VMware 
==> win10: Configuring secondary network adapters through VMware 
 INFO interface: warn: on Windows is not yet supported. You will need to manually
 INFO interface: warn: ==> win10: on Windows is not yet supported. You will need to manually
==> win10: on Windows is not yet supported. You will need to manually
 INFO interface: warn: configure the network adapter.
 INFO interface: warn: ==> win10: configure the network adapter.
==> win10: configure the network adapter.
 INFO warden: Calling OUT action: VMware Middleware: Network
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
 INFO warden: Calling OUT action: VMware Middleware: PrepareNFSSettings
 INFO synced_folders: Invoking synced folder enable: vmware
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 22=>2215, 5985=>2219}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B9DC8EA8-FAF1-4791-B2AA-F3FB7E42394F
DEBUG winrmshell: [WinRM] Command created for hostname with id: E61EA9C3-5D6F-4914-ACA1-CDB184A0A44A
DEBUG winrmshell: [WinRM] creating command_id: E61EA9C3-5D6F-4914-ACA1-CDB184A0A44A on shell_id B9DC8EA8-FAF1-4791-B2AA-F3FB7E42394F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E61EA9C3-5D6F-4914-ACA1-CDB184A0A44A on shell_id B9DC8EA8-FAF1-4791-B2AA-F3FB7E42394F
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8cac258 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: verify_vmware_hgfs
DEBUG guest: Checking in: windows
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5985=>2219, 5986=>2217}, :udp=>{}}
 INFO synced_folder: Preparing shared folders with VMX...
 INFO interface: info: Enabling and configuring shared folders...
 INFO interface: info: ==> win10: Enabling and configuring shared folders...
==> win10: Enabling and configuring shared folders...
 INFO vmware_driver: Enabling shared folders...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "enableSharedFolders", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO interface: detail: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO interface: detail:     win10: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
    win10: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO vmware_driver: Adding a shared folder '-vagrant': D:/workspace/eWalker/DetectionLab/Vagrant
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "addSharedFolder", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "setSharedFolderState", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\win10\\vmware_desktop\\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\\windows_10.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant", "writable"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 5985=>2213, 22=>2215}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 17968483-CCB6-4AC5-87EA-D8CA1B69B58A
DEBUG winrmshell: [WinRM] Command created for hostname with id: 392547A9-D29E-40A5-9FEE-CFC43FDC2F5C
DEBUG winrmshell: [WinRM] creating command_id: 392547A9-D29E-40A5-9FEE-CFC43FDC2F5C on shell_id 17968483-CCB6-4AC5-87EA-D8CA1B69B58A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 392547A9-D29E-40A5-9FEE-CFC43FDC2F5C on shell_id 17968483-CCB6-4AC5-87EA-D8CA1B69B58A
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d14b50 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: mount_vmware_shared_folder
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: mount_vmware_shared_folder in windows
 INFO guest: Execute capability: mount_vmware_shared_folder [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>, "-vagrant", "/vagrant", {:guestpath=>"/vagrant", :hostpath=>"D:/workspace/eWalker/DetectionLab/Vagrant", :disabled=>false, :__vagrantfile=>true, :plugin=>#<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x000001efd8fc7460 @logger=#<Log4r::Logger:0x000001efd8fc73c0 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_logger=#<Log4r::Logger:0x000001efd8f18938 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::syncedfolder", @outputters=[], @additive=true, @name="syncedfolder", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x000001efd6119e60 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware, #<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x000001efd8ecbc00 @logger=#<Log4r::Logger:0x000001efd8ecbb88 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x000001efd70d7b68 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000001efd60f3e90 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000001efd60ddb18 @formatter=#<Log4r::BasicFormatter:0x000001efd60dece8 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000001efd6119cf8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>>]], @cap_args=[#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:virtualbox=>#<Vagrant::Registry:0x000001efd8f18b40 @items={:mount_options=>#<Proc:0x000001efd66d2f00 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:72>, :mount_type=>#<Proc:0x000001efd66d2e38 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:77>, :mount_name=>#<Proc:0x000001efd66d2d70 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:82>}, @results_cache={}>, :smb=>#<Vagrant::Registry:0x000001efd8f18aa0 @items={:default_fstab_modification=>#<Proc:0x000001efd60580f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:26>, :mount_options=>#<Proc:0x000001efd605a6c8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:31>, :mount_name=>#<Proc:0x000001efd6757f48 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:36>, :mount_type=>#<Proc:0x000001efd6757ed0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:41>}, @results_cache={}>}>, :owner=>"vagrant", :group=>"vagrant"}] (windows)
DEBUG winrm: powershell executing:
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9081dd8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9080c30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e92040 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E3F11275-C0A7-48BA-9454-CC99C36D675A
DEBUG winrmshell: [WinRM] Command created for function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C4949D2A-1DA6-4F0F-AC86-B79E8C1576DD
DEBUG winrmshell: [WinRM] creating command_id: C4949D2A-1DA6-4F0F-AC86-B79E8C1576DD on shell_id E3F11275-C0A7-48BA-9454-CC99C36D675A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C4949D2A-1DA6-4F0F-AC86-B79E8C1576DD on shell_id E3F11275-C0A7-48BA-9454-CC99C36D675A
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d8d898 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 5986=>2217, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 926B2AF8-7E4A-4F92-815C-B8454F2A3B95
DEBUG winrmshell: [WinRM] Command created for hostname with id: CD0AAE9F-32A8-404D-A047-0969521EC879
DEBUG winrmshell: [WinRM] creating command_id: CD0AAE9F-32A8-404D-A047-0969521EC879 on shell_id 926B2AF8-7E4A-4F92-815C-B8454F2A3B95
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CD0AAE9F-32A8-404D-A047-0969521EC879 on shell_id 926B2AF8-7E4A-4F92-815C-B8454F2A3B95
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd91194d0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: persist_mount_shared_folder
DEBUG guest: Checking in: windows
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolders:0x000001efd7e5cb08>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Delayed:0x000001efd7e5cb30>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x000001efd89bd718>
 INFO warden: Calling OUT action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x000001efd8a577a0>
 INFO warden: Calling OUT action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO interface: info: Machine already provisioned. Run `vagrant provision` or use the `--provision`
flag to force provisioning. Provisioners marked to run always will still run.
 INFO interface: info: ==> win10: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> win10: flag to force provisioning. Provisioners marked to run always will still run.
==> win10: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> win10: flag to force provisioning. Provisioners marked to run always will still run.
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Provision:0x000001efd8a7f1b0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd7fb1738 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd80a0158>
 INFO warden: Calling OUT action: VMware Middleware: PruneForwardedPorts
 INFO warden: Calling OUT action: VMware Middleware: CheckExistingNetwork
 INFO warden: Calling OUT action: #<Proc:0x000001efd9307878 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd896e320>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x000001efd8994ef8>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000001efd69897a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8d7ede8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8aa4410 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: WaitForVMXHalt
 INFO warden: Calling OUT action: #<Proc:0x000001efd89be280 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd8d7ecf8>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8cb6dc0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd6989870>
 INFO warden: Calling OUT action: VMware Middleware: DiscardSuspendedState
 INFO warden: Calling OUT action: #<Proc:0x000001efd922d880 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd89bdcb8>
 INFO warden: Calling OUT action: VMware Middleware: CheckVMware
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::ConfigValidate:0x000001efd8a247d8>
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: #<Proc:0x000001efd887e2d0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd8fd01c8>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO interface: Machine: action ["reload", "end", {:target=>:win10}]
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 5986=>2217, 22=>2221}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A9782E54-D3E1-46A5-B304-79EB43691C86
DEBUG winrmshell: [WinRM] Command created for hostname with id: A1E68DE5-BB1E-4629-B5E5-BB8933B02D27
DEBUG winrmshell: [WinRM] creating command_id: A1E68DE5-BB1E-4629-B5E5-BB8933B02D27 on shell_id A9782E54-D3E1-46A5-B304-79EB43691C86
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A1E68DE5-BB1E-4629-B5E5-BB8933B02D27 on shell_id A9782E54-D3E1-46A5-B304-79EB43691C86
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd865ec70 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO warden: Calling OUT action: #<Proc:0x000001efd91fdf90 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd9118ee0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2215, 5985=>2219, 5986=>2214}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AF065E7E-55D1-4832-8818-285C63F76044
DEBUG winrmshell: [WinRM] Command created for hostname with id: 76E7451D-DA49-49AC-923B-79EEDDE31B8C
DEBUG winrmshell: [WinRM] creating command_id: 76E7451D-DA49-49AC-923B-79EEDDE31B8C on shell_id AF065E7E-55D1-4832-8818-285C63F76044
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 76E7451D-DA49-49AC-923B-79EEDDE31B8C on shell_id AF065E7E-55D1-4832-8818-285C63F76044
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8a9c5d0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 5985=>2216, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 964D73D1-0A49-4622-AD88-A47592C821DF
DEBUG winrmshell: [WinRM] Command created for hostname with id: 6BCE4A73-F939-42CC-95ED-AA3C1E1A3593
DEBUG winrmshell: [WinRM] creating command_id: 6BCE4A73-F939-42CC-95ED-AA3C1E1A3593 on shell_id 964D73D1-0A49-4622-AD88-A47592C821DF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6BCE4A73-F939-42CC-95ED-AA3C1E1A3593 on shell_id 964D73D1-0A49-4622-AD88-A47592C821DF
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8f72370 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 5985=>2216, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 83938F8C-CAD4-4B76-9B85-648296C17332
DEBUG winrmshell: [WinRM] Command created for hostname with id: 37E29B92-FE6F-4FAE-A7CD-9E41D2D2C739
DEBUG winrmshell: [WinRM] creating command_id: 37E29B92-FE6F-4FAE-A7CD-9E41D2D2C739 on shell_id 83938F8C-CAD4-4B76-9B85-648296C17332
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 37E29B92-FE6F-4FAE-A7CD-9E41D2D2C739 on shell_id 83938F8C-CAD4-4B76-9B85-648296C17332
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd82abe70 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89762a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89751e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86cf1a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 0B5D153A-55ED-452C-8E86-75E2B889C28E
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3E0D0D18-744B-43AC-8ED7-410CA4743476
DEBUG winrmshell: [WinRM] creating command_id: 3E0D0D18-744B-43AC-8ED7-410CA4743476 on shell_id 0B5D153A-55ED-452C-8E86-75E2B889C28E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3E0D0D18-744B-43AC-8ED7-410CA4743476 on shell_id 0B5D153A-55ED-452C-8E86-75E2B889C28E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83a0560 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89a6ec8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89a6018 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88e47b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 58E80287-A34C-4ED3-AE16-7316B7748B2B
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 276A2507-3E55-45AF-81FE-50389C0C402A
DEBUG winrmshell: [WinRM] creating command_id: 276A2507-3E55-45AF-81FE-50389C0C402A on shell_id 58E80287-A34C-4ED3-AE16-7316B7748B2B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 276A2507-3E55-45AF-81FE-50389C0C402A on shell_id 58E80287-A34C-4ED3-AE16-7316B7748B2B
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8664fa8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-8pbxe3.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd898d2e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd898c3e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8887e20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B0BDED70-801C-457F-BCF3-1D954C8593AE
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "91103d0ccbde4757bd913a8feb78e434a7d2d5dc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-8pbxe3.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4DEBC04B-8FE7-4276-8288-12B072D21B53
DEBUG winrmshell: [WinRM] creating command_id: 4DEBC04B-8FE7-4276-8288-12B072D21B53 on shell_id B0BDED70-801C-457F-BCF3-1D954C8593AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4DEBC04B-8FE7-4276-8288-12B072D21B53 on shell_id B0BDED70-801C-457F-BCF3-1D954C8593AE
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","False","True","False"


DEBUG winrmshell: File C:/tmp/vagrant-shell.ps1 is up to date, skipping
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m1.02s) stream_files: (0m0.00s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd896f4f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd896e208 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86c7d38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4AC8FFD1-9878-4A37-AD65-A3C6D1DF0C38
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8740EA74-FED7-4E31-85E9-CBC200B96EF5
DEBUG winrmshell: [WinRM] creating command_id: 8740EA74-FED7-4E31-85E9-CBC200B96EF5 on shell_id 4AC8FFD1-9878-4A37-AD65-A3C6D1DF0C38
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:38] Setting timezone to UTC...
 INFO interface: detail:     win10: [03:38] Setting timezone to UTC...
    win10: [03:38] Setting timezone to UTC...
 INFO interface: detail: [03:38] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail:     win10: [03:38] Checking if Windows evaluation is expiring soon or expired...
    win10: [03:38] Checking if Windows evaluation is expiring soon or expired...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:38] 90 days left until expiration, no need to rearm.
 INFO interface: detail:     win10: [03:38] 90 days left until expiration, no need to rearm.
    win10: [03:38] 90 days left until expiration, no need to rearm.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:38] Disabling IPv6 on all network adatpers...
 INFO interface: detail:     win10: [03:38] Disabling IPv6 on all network adatpers...
    win10: [03:38] Disabling IPv6 on all network adatpers...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Name                           DisplayName                                        ComponentID
 INFO interface: detail:     win10: Name                           DisplayName                                        ComponentID
    win10: Name                           DisplayName                                        ComponentID
 INFO interface: detail: ----                           -----------                                        -----------
 INFO interface: detail:     win10: ----                           -----------                                        -----------
    win10: ----                           -----------                                        -----------
 INFO interface: detail: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     win10: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    win10: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     win10: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    win10: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: The operation completed successfully.
 INFO interface: detail:     win10: The operation completed successfully.
    win10: The operation completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: [03:38] I am domain joined!
 INFO interface: detail:     win10: [03:38] I am domain joined!
    win10: [03:38] I am domain joined!
 INFO interface: detail: [03:38] Setting the registry for auto-login...
 INFO interface: detail:     win10: [03:38] Setting the registry for auto-login...
    win10: [03:38] Setting the registry for auto-login...
 INFO interface: detail: [03:38] Provisioning after joining domain...
 INFO interface: detail:     win10: [03:38] Provisioning after joining domain...
    win10: [03:38] Provisioning after joining domain...
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8740EA74-FED7-4E31-85E9-CBC200B96EF5 on shell_id 4AC8FFD1-9878-4A37-AD65-A3C6D1DF0C38
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8392168 @data=[{:stdout=>"[03:38] Setting timezone to UTC...\r\n"}, {:stdout=>"[03:38] Checking if Windows evaluation is expiring soon or expired...\r\n"}, {:stdout=>"[03:38] 90 days left until expiration, no need to rearm.\r\n"}, {:stdout=>"[03:38] Disabling IPv6 on all network adatpers...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           DisplayName                                        ComponentID     \r\n"}, {:stdout=>"----                           -----------                                        -----------     \r\n"}, {:stdout=>"Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"The operation completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[03:38] I am domain joined!\r\n"}, {:stdout=>"[03:38] Setting the registry for auto-login...\r\n"}, {:stdout=>"[03:38] Provisioning after joining domain...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd9118ee0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd88e6768 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 5986=>2217, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5F674E21-4495-49AD-87A4-753DC3BA7912
DEBUG winrmshell: [WinRM] Command created for hostname with id: 7F0581DA-392E-4C32-9F0F-40A9D9B261EF
DEBUG winrmshell: [WinRM] creating command_id: 7F0581DA-392E-4C32-9F0F-40A9D9B261EF on shell_id 5F674E21-4495-49AD-87A4-753DC3BA7912
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7F0581DA-392E-4C32-9F0F-40A9D9B261EF on shell_id 5F674E21-4495-49AD-87A4-753DC3BA7912
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd90fb0e8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2218, 5986=>2214, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 843DB3CC-CBCA-4ACC-9E7D-70FC398A3E68
DEBUG winrmshell: [WinRM] Command created for hostname with id: D9F3EC80-5920-4641-AA97-9FBDA85F1034
DEBUG winrmshell: [WinRM] creating command_id: D9F3EC80-5920-4641-AA97-9FBDA85F1034 on shell_id 843DB3CC-CBCA-4ACC-9E7D-70FC398A3E68
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D9F3EC80-5920-4641-AA97-9FBDA85F1034 on shell_id 843DB3CC-CBCA-4ACC-9E7D-70FC398A3E68
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8654d88 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2215, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 12141DEE-D0F6-4E94-A502-8995D2AFBD19
DEBUG winrmshell: [WinRM] Command created for hostname with id: 79E24125-F4EA-4E4E-ABB7-16FB5D1FA9B3
DEBUG winrmshell: [WinRM] creating command_id: 79E24125-F4EA-4E4E-ABB7-16FB5D1FA9B3 on shell_id 12141DEE-D0F6-4E94-A502-8995D2AFBD19
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 79E24125-F4EA-4E4E-ABB7-16FB5D1FA9B3 on shell_id 12141DEE-D0F6-4E94-A502-8995D2AFBD19
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8bdb928 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e73f50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e730c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d7cb88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D0841F54-49C9-4BA9-82E0-501D9C1C8C6C
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9041D0A4-3826-4A09-8205-7DC99B4B1722
DEBUG winrmshell: [WinRM] creating command_id: 9041D0A4-3826-4A09-8205-7DC99B4B1722 on shell_id D0841F54-49C9-4BA9-82E0-501D9C1C8C6C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9041D0A4-3826-4A09-8205-7DC99B4B1722 on shell_id D0841F54-49C9-4BA9-82E0-501D9C1C8C6C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8c7c3a0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e890a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e83d10 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d8d258 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AB05052E-7C01-4C6B-8C42-9AE880C330C2
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E36FF4F1-9900-4F7C-9F9C-4F0A95D2D625
DEBUG winrmshell: [WinRM] creating command_id: E36FF4F1-9900-4F7C-9F9C-4F0A95D2D625 on shell_id AB05052E-7C01-4C6B-8C42-9AE880C330C2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E36FF4F1-9900-4F7C-9F9C-4F0A95D2D625 on shell_id AB05052E-7C01-4C6B-8C42-9AE880C330C2
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8c8d358 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1yghwab.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8dc5e50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8dc4a78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d14e98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "09c377ee7e4e922ca5e8af4143bc0682a8350493" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-1yghwab.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F0588A07-4F0F-48AD-9555-5AE139BD3F96
DEBUG winrmshell: [WinRM] creating command_id: F0588A07-4F0F-48AD-9555-5AE139BD3F96 on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F0588A07-4F0F-48AD-9555-5AE139BD3F96 on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","09c377ee7e4e922ca5e8af4143bc0682a8350493","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1yghwab.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 66CA987C-C318-45EF-9186-7BAFB4E2DA61
DEBUG winrmshell: [WinRM] creating command_id: 66CA987C-C318-45EF-9186-7BAFB4E2DA61 on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 66CA987C-C318-45EF-9186-7BAFB4E2DA61 on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIHVuemlwcyBhIGNvcHkgb2YgdGhlIFBhbGFudGlyIFdFRiBHaXRodWIgUmVwby4gVGhpcyBpbmNsdWRlcyBXRUYgc3Vic2NyaXB0aW9ucyBhbmQgY3VzdG9tIFdFRiBjaGFubmVscy4KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBhbmQgdW56aXBwaW5nIHRoZSBQYWxhbnRpciBXaW5kb3dzIEV2ZW50IEZvcndhcmRpbmcgUmVwbyBmcm9tIEdpdGh1Yi4uLiIKCiR3ZWZSZXBvUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3ZWYtTWFzdGVyLnppcCcKCklmICgtbm90IChUZXN0LVBhdGggJHdlZlJlcG9QYXRoKSkKewogICAgIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzEvMjAxOAogICAgW05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMgogICAgIyBEaXNhYmxpbmcgdGhlIHByb2dyZXNzIGJhciBzcGVlZHMgdXAgSVdSIGh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwvaXNzdWVzLzIxMzgKICAgICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICAgIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgImh0dHBzOi8vZ2l0aHViLmNvbS9wYWxhbnRpci93aW5kb3dzLWV2ZW50LWZvcndhcmRpbmcvYXJjaGl2ZS9tYXN0ZXIuemlwIiAtT3V0RmlsZSAkd2VmUmVwb1BhdGgKICAgIEV4cGFuZC1BcmNoaXZlIC1wYXRoICIkd2VmUmVwb1BhdGgiIC1kZXN0aW5hdGlvbnBhdGggJ2M6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wJyAtRm9yY2UKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSAkd2VmUmVwb1BhdGggYWxyZWFkeSBleGlzdHMuIE1vdmluZyBPbi4iCn0KV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFBhbGFudGlyIFdFRiBkb3dubG9hZCBjb21wbGV0ZSEiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 046DF859-024C-4EC7-8EC8-F9C1BA6044C8
DEBUG winrmshell: [WinRM] creating command_id: 046DF859-024C-4EC7-8EC8-F9C1BA6044C8 on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 046DF859-024C-4EC7-8EC8-F9C1BA6044C8 on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D80DE95B-F165-43C1-8302-C4582252BC8C
DEBUG winrmshell: [WinRM] creating command_id: D80DE95B-F165-43C1-8302-C4582252BC8C on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D80DE95B-F165-43C1-8302-C4582252BC8C on shell_id 3234A2B9-101B-401D-9713-6C22743785A9
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1yghwab.ps1 to C:/tmp/vagrant-shell.ps1 (1.384 KB over 1 chunks) in (0m0.29s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.96s) stream_files: (0m0.29s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8fe2350 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8fe0c80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e36330 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 502420E7-6A41-4B60-B3FA-23B44EFABBD9
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 12BC5407-B6A0-4615-9A77-285B30D46EA3
DEBUG winrmshell: [WinRM] creating command_id: 12BC5407-B6A0-4615-9A77-285B30D46EA3 on shell_id 502420E7-6A41-4B60-B3FA-23B44EFABBD9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
 INFO interface: detail:     win10: [03:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
    win10: [03:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:39] Palantir WEF download complete!
 INFO interface: detail:     win10: [03:39] Palantir WEF download complete!
    win10: [03:39] Palantir WEF download complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 12BC5407-B6A0-4615-9A77-285B30D46EA3 on shell_id 502420E7-6A41-4B60-B3FA-23B44EFABBD9
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d51de8 @data=[{:stdout=>"[03:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...\r\n"}, {:stdout=>"[03:39] Palantir WEF download complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd88e6768 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd818a8c0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 5986=>2220, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 735ACD7F-FE52-401F-B2AB-6CBEC10CD086
DEBUG winrmshell: [WinRM] Command created for hostname with id: A7878FF7-3040-4BF9-A8B0-9BF49125A283
DEBUG winrmshell: [WinRM] creating command_id: A7878FF7-3040-4BF9-A8B0-9BF49125A283 on shell_id 735ACD7F-FE52-401F-B2AB-6CBEC10CD086
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A7878FF7-3040-4BF9-A8B0-9BF49125A283 on shell_id 735ACD7F-FE52-401F-B2AB-6CBEC10CD086
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8daede0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 5985=>2219, 22=>2221}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 587241B1-A475-4852-B5AD-2F9254A7A320
DEBUG winrmshell: [WinRM] Command created for hostname with id: C935F2E2-E797-4D00-BA18-B9FA65BCDF24
DEBUG winrmshell: [WinRM] creating command_id: C935F2E2-E797-4D00-BA18-B9FA65BCDF24 on shell_id 587241B1-A475-4852-B5AD-2F9254A7A320
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C935F2E2-E797-4D00-BA18-B9FA65BCDF24 on shell_id 587241B1-A475-4852-B5AD-2F9254A7A320
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd921ed58 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 5986=>2220, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32B82FBC-2A3F-4204-8813-601C9186AAB1
DEBUG winrmshell: [WinRM] Command created for hostname with id: 06051DC7-55C8-4E47-A934-B58B4C85DE90
DEBUG winrmshell: [WinRM] creating command_id: 06051DC7-55C8-4E47-A934-B58B4C85DE90 on shell_id 32B82FBC-2A3F-4204-8813-601C9186AAB1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 06051DC7-55C8-4E47-A934-B58B4C85DE90 on shell_id 32B82FBC-2A3F-4204-8813-601C9186AAB1
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd88c61c0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b31068 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b301e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89b4e60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E3569A36-1299-4E8C-91E7-5C03A372F92E
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: AB1708A2-4636-49BB-A03E-30E0A8E2D635
DEBUG winrmshell: [WinRM] creating command_id: AB1708A2-4636-49BB-A03E-30E0A8E2D635 on shell_id E3569A36-1299-4E8C-91E7-5C03A372F92E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AB1708A2-4636-49BB-A03E-30E0A8E2D635 on shell_id E3569A36-1299-4E8C-91E7-5C03A372F92E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd88df4b8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b8b9c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b8aaf0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a1f968 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F7B350AC-F628-4297-B7B2-0BA1A973AA23
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5720ED78-DB96-4975-8470-14950E1E089E
DEBUG winrmshell: [WinRM] creating command_id: 5720ED78-DB96-4975-8470-14950E1E089E on shell_id F7B350AC-F628-4297-B7B2-0BA1A973AA23
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5720ED78-DB96-4975-8470-14950E1E089E on shell_id F7B350AC-F628-4297-B7B2-0BA1A973AA23
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd891d768 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-fezhl3 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a7f818 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8a7e3a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd897f120 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "af4aaea595b5271e1593adca5253b0b12d4b3df3" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-fezhl3";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 167EA213-9075-4EAE-BA93-A6118756CE78
DEBUG winrmshell: [WinRM] creating command_id: 167EA213-9075-4EAE-BA93-A6118756CE78 on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 167EA213-9075-4EAE-BA93-A6118756CE78 on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","af4aaea595b5271e1593adca5253b0b12d4b3df3","09c377ee7e4e922ca5e8af4143bc0682a8350493","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-fezhl3 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 029A71E3-C916-44DD-A142-0FDBBE846451
DEBUG winrmshell: [WinRM] creating command_id: 029A71E3-C916-44DD-A142-0FDBBE846451 on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 029A71E3-C916-44DD-A142-0FDBBE846451 on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('d2V2dHV0aWwgZWwgfCBTZWxlY3QtU3RyaW5nIC1ub3RtYXRjaCAiTWljcm9zb2Z0LVdpbmRvd3MtTGl2ZUlkIiB8IEZvcmVhY2gtT2JqZWN0IHt3ZXZ0dXRpbCBjbCAiJF8ifQ==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7499F439-3DE7-4837-BBED-B6385F1C7E7B
DEBUG winrmshell: [WinRM] creating command_id: 7499F439-3DE7-4837-BBED-B6385F1C7E7B on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7499F439-3DE7-4837-BBED-B6385F1C7E7B on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 557DE5C0-63F7-4C6C-9C85-110BCACC6F7C
DEBUG winrmshell: [WinRM] creating command_id: 557DE5C0-63F7-4C6C-9C85-110BCACC6F7C on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 557DE5C0-63F7-4C6C-9C85-110BCACC6F7C on shell_id 8B3E3F18-0273-4CFA-9670-15866C18D85E
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-fezhl3 to C:/tmp/vagrant-shell.ps1 (0.132 KB over 1 chunks) in (0m0.41s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m1.04s) stream_files: (0m0.42s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     win10: Running: inline PowerShell script
    win10: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8c9c128 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8c97128 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8aa65f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B001953F-4B2F-4A7B-8A84-022CE2CA604C
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 75254C1E-EEBA-49AA-9979-49FEB8A9A6F6
DEBUG winrmshell: [WinRM] creating command_id: 75254C1E-EEBA-49AA-9979-49FEB8A9A6F6 on shell_id B001953F-4B2F-4A7B-8A84-022CE2CA604C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 75254C1E-EEBA-49AA-9979-49FEB8A9A6F6 on shell_id B001953F-4B2F-4A7B-8A84-022CE2CA604C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd7fe3238 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd818a8c0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd92e4c60 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2221, 5985=>2213, 5986=>2220}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 75F67F06-1FA0-46AE-B572-6807E66F3371
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5205AAB4-051E-4868-83E3-659839A437F7
DEBUG winrmshell: [WinRM] creating command_id: 5205AAB4-051E-4868-83E3-659839A437F7 on shell_id 75F67F06-1FA0-46AE-B572-6807E66F3371
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5205AAB4-051E-4868-83E3-659839A437F7 on shell_id 75F67F06-1FA0-46AE-B572-6807E66F3371
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8cb6ca8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2221, 5986=>2214}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 83C4A2F7-F873-4D62-B1FF-DEA72D189C39
DEBUG winrmshell: [WinRM] Command created for hostname with id: FD9DBBCA-4FCB-427D-96C7-2318ABA0879B
DEBUG winrmshell: [WinRM] creating command_id: FD9DBBCA-4FCB-427D-96C7-2318ABA0879B on shell_id 83C4A2F7-F873-4D62-B1FF-DEA72D189C39
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FD9DBBCA-4FCB-427D-96C7-2318ABA0879B on shell_id 83C4A2F7-F873-4D62-B1FF-DEA72D189C39
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd90e29f8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 5986=>2217, 22=>2221}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8FD8C572-58EB-4F4A-803C-FBB643FDDED3
DEBUG winrmshell: [WinRM] Command created for hostname with id: 737CD2BF-4C34-4C23-B751-2C86808F9EF0
DEBUG winrmshell: [WinRM] creating command_id: 737CD2BF-4C34-4C23-B751-2C86808F9EF0 on shell_id 8FD8C572-58EB-4F4A-803C-FBB643FDDED3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 737CD2BF-4C34-4C23-B751-2C86808F9EF0 on shell_id 8FD8C572-58EB-4F4A-803C-FBB643FDDED3
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83a9f20 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8995268 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd898fde0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd888d910 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: FB9CAB19-4174-4525-BD4C-20D382869A2E
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B9E44C86-4EFC-4A45-B334-D9ADA3F4D4D1
DEBUG winrmshell: [WinRM] creating command_id: B9E44C86-4EFC-4A45-B334-D9ADA3F4D4D1 on shell_id FB9CAB19-4174-4525-BD4C-20D382869A2E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B9E44C86-4EFC-4A45-B334-D9ADA3F4D4D1 on shell_id FB9CAB19-4174-4525-BD4C-20D382869A2E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83b1658 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8997630 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8995c68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8894648 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 81E90140-6DAE-44FE-808A-6F48AE9A2B49
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9961919D-F54F-466D-9220-AB4E5CE245C6
DEBUG winrmshell: [WinRM] creating command_id: 9961919D-F54F-466D-9220-AB4E5CE245C6 on shell_id 81E90140-6DAE-44FE-808A-6F48AE9A2B49
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9961919D-F54F-466D-9220-AB4E5CE245C6 on shell_id 81E90140-6DAE-44FE-808A-6F48AE9A2B49
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83b3840 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-102az1q.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88cdd08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88cc868 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd84537c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "2ccc385c1b1113d499646914f2abe476d7a690be" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-102az1q.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 470E6B27-43B5-4014-BCDF-B2DB65030F55
DEBUG winrmshell: [WinRM] creating command_id: 470E6B27-43B5-4014-BCDF-B2DB65030F55 on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 470E6B27-43B5-4014-BCDF-B2DB65030F55 on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","2ccc385c1b1113d499646914f2abe476d7a690be","af4aaea595b5271e1593adca5253b0b12d4b3df3","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-102az1q.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A793B853-762B-4CBF-8EA3-29CA22570F36
DEBUG winrmshell: [WinRM] creating command_id: A793B853-762B-4CBF-8EA3-29CA22570F36 on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A793B853-762B-4CBF-8EA3-29CA22570F36 on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBjaG9jb2xhdGV5IHBhY2thZ2UgbWFuYWdlciwgdGhlbiBpbnN0YWxscyBjdXN0b20gdXRpbGl0aWVzIGZyb20gQ2hvY28uCgpJZiAoLW5vdCAoVGVzdC1QYXRoICJDOlxQcm9ncmFtRGF0YVxjaG9jb2xhdGV5IikpIHsKICBbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ2hvY29sYXRleSIKICBJbnZva2UtRXhwcmVzc2lvbiAoKG5ldy1vYmplY3QgbmV0LndlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vY2hvY29sYXRleS5vcmcvaW5zdGFsbC5wczEnKSkKfSBlbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ2hvY29sYXRleSBpcyBhbHJlYWR5IGluc3RhbGxlZC4iCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIHV0aWxpdGllcy4uLiIKSWYgKCQoaG9zdG5hbWUpIC1lcSAid2luMTAiKSB7CiAgIyBCZWNhdXNlIHRoZSBXaW5kb3dzMTAgc3RhcnQgbWVudSBzdWNrcwogIGNob2NvIGluc3RhbGwgLXkgLS1saW1pdC1vdXRwdXQgLS1uby1wcm9ncmVzcyBjbGFzc2ljLXNoZWxsIC1pbnN0YWxsQXJncyBBRERMT0NBTD1DbGFzc2ljU3RhcnRNZW51CiAgJiAiQzpcUHJvZ3JhbSBGaWxlc1xDbGFzc2ljIFNoZWxsXENsYXNzaWNTdGFydE1lbnUuZXhlIiAiLXhtbCIgImM6XHZhZ3JhbnRccmVzb3VyY2VzXHdpbmRvd3NcTWVudVNldHRpbmdzLnhtbCIKICByZWdlZGl0IC9zIGM6XHZhZ3JhbnRccmVzb3VyY2VzXHdpbmRvd3NcTWVudVN0eWxlX0RlZmF1bHRfV2luNy5yZWcKfQpjaG9jbyBpbnN0YWxsIC15IC0tbGltaXQtb3V0cHV0IC0tbm8tcHJvZ3Jlc3MgTm90ZXBhZFBsdXNQbHVzIFdpblJhciBwcm9jZXNzaGFja2VyCgojIFRoaXMgcmVwbyBvZnRlbiBjYXVzZXMgZmFpbHVyZXMgZHVlIHRvIGluY29ycmVjdCBjaGVja3N1bXMsIHNvIHdlIGlnbm9yZSB0aGVtIGZvciBDaHJvbWUKY2hvY28gaW5zdGFsbCAteSAtLWxpbWl0LW91dHB1dCAtLW5vLXByb2dyZXNzIC0taWdub3JlLWNoZWNrc3VtcyBHb29nbGVDaHJvbWUgCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVXRpbHRpZXMgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4E036B61-AF01-4690-9C5E-E5148484D586
DEBUG winrmshell: [WinRM] creating command_id: 4E036B61-AF01-4690-9C5E-E5148484D586 on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4E036B61-AF01-4690-9C5E-E5148484D586 on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 286519CE-BD48-494C-8F40-86B8070ECECE
DEBUG winrmshell: [WinRM] creating command_id: 286519CE-BD48-494C-8F40-86B8070ECECE on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 286519CE-BD48-494C-8F40-86B8070ECECE on shell_id 09C440B1-BB86-4C8B-BB95-7CB08A9F6E40
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-102az1q.ps1 to C:/tmp/vagrant-shell.ps1 (1.66 KB over 1 chunks) in (0m0.26s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m1.10s) stream_files: (0m0.26s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7e57978 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7e567f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88c7980 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 13579C08-753A-49A5-ACE1-28922D21D554
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 72B31C33-CE8B-4B95-94B6-AB80F8115996
DEBUG winrmshell: [WinRM] creating command_id: 72B31C33-CE8B-4B95-94B6-AB80F8115996 on shell_id 13579C08-753A-49A5-ACE1-28922D21D554
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:39] Installing Chocolatey
 INFO interface: detail:     win10: [03:39] Installing Chocolatey
    win10: [03:39] Installing Chocolatey
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
 INFO interface: detail:     win10: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
    win10: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
 INFO interface: detail: Getting latest version of the Chocolatey package for download.
 INFO interface: detail:     win10: Getting latest version of the Chocolatey package for download.
    win10: Getting latest version of the Chocolatey package for download.
 INFO interface: detail: Not using proxy.
 INFO interface: detail:     win10: Not using proxy.
    win10: Not using proxy.
 INFO interface: detail: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
 INFO interface: detail:     win10: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
    win10: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
 INFO interface: detail: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
 INFO interface: detail:     win10: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
    win10: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
 INFO interface: detail: Not using proxy.
 INFO interface: detail:     win10: Not using proxy.
    win10: Not using proxy.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
 INFO interface: detail:     win10: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
    win10: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing Chocolatey on the local machine
 INFO interface: detail:     win10: Installing Chocolatey on the local machine
    win10: Installing Chocolatey on the local machine
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
 INFO interface: detail:     win10: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
    win10: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
 INFO interface: detail:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
 INFO interface: detail:     win10:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
    win10:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
 INFO interface: detail: WARNING: It's very likely you will need to close and reopen your shell
 INFO interface: detail:     win10: WARNING: It's very likely you will need to close and reopen your shell
    win10: WARNING: It's very likely you will need to close and reopen your shell
 INFO interface: detail:   before you can use choco.
 INFO interface: detail:     win10:   before you can use choco.
    win10:   before you can use choco.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Restricting write permissions to Administrators
 INFO interface: detail:     win10: Restricting write permissions to Administrators
    win10: Restricting write permissions to Administrators
 INFO interface: detail: We are setting up the Chocolatey package repository.
 INFO interface: detail:     win10: We are setting up the Chocolatey package repository.
    win10: We are setting up the Chocolatey package repository.
 INFO interface: detail: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
 INFO interface: detail:     win10: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
    win10: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
 INFO interface: detail:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
 INFO interface: detail:     win10:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
    win10:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
 INFO interface: detail: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
 INFO interface: detail:     win10: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
    win10: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
 INFO interface: detail:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
 INFO interface: detail:     win10:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
    win10:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Creating Chocolatey folders if they do not already exist.
 INFO interface: detail:     win10: Creating Chocolatey folders if they do not already exist.
    win10: Creating Chocolatey folders if they do not already exist.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: WARNING: You can safely ignore errors related to missing log files when
 INFO interface: detail:     win10: WARNING: You can safely ignore errors related to missing log files when
    win10: WARNING: You can safely ignore errors related to missing log files when
 INFO interface: detail:   upgrading from a version of Chocolatey less than 0.9.9.
 INFO interface: detail:     win10:   upgrading from a version of Chocolatey less than 0.9.9.
    win10:   upgrading from a version of Chocolatey less than 0.9.9.
 INFO interface: detail:   'Batch file could not be found' is also safe to ignore.
 INFO interface: detail:     win10:   'Batch file could not be found' is also safe to ignore.
    win10:   'Batch file could not be found' is also safe to ignore.
 INFO interface: detail:   'The system cannot find the file specified' - also safe.
 INFO interface: detail:     win10:   'The system cannot find the file specified' - also safe.
    win10:   'The system cannot find the file specified' - also safe.
 INFO interface: detail: chocolatey.nupkg file not installed in lib.
 INFO interface: detail:     win10: chocolatey.nupkg file not installed in lib.
    win10: chocolatey.nupkg file not installed in lib.
 INFO interface: detail:  Attempting to locate it from bootstrapper.
 INFO interface: detail:     win10:  Attempting to locate it from bootstrapper.
    win10:  Attempting to locate it from bootstrapper.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
 INFO interface: detail:     win10: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
    win10: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Not setting tab completion: Profile file does not exist at
 INFO interface: detail:     win10: WARNING: Not setting tab completion: Profile file does not exist at
    win10: WARNING: Not setting tab completion: Profile file does not exist at
 INFO interface: detail: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
 INFO interface: detail:     win10: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
    win10: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Chocolatey (choco.exe) is now ready.
 INFO interface: detail:     win10: Chocolatey (choco.exe) is now ready.
    win10: Chocolatey (choco.exe) is now ready.
 INFO interface: detail: You can call choco from anywhere, command line or powershell by typing choco.
 INFO interface: detail:     win10: You can call choco from anywhere, command line or powershell by typing choco.
    win10: You can call choco from anywhere, command line or powershell by typing choco.
 INFO interface: detail: Run choco /? for a list of functions.
 INFO interface: detail:     win10: Run choco /? for a list of functions.
    win10: Run choco /? for a list of functions.
 INFO interface: detail: You may need to shut down and restart powershell and/or consoles
 INFO interface: detail:     win10: You may need to shut down and restart powershell and/or consoles
    win10: You may need to shut down and restart powershell and/or consoles
 INFO interface: detail:  first prior to using choco.
 INFO interface: detail:     win10:  first prior to using choco.
    win10:  first prior to using choco.
 INFO interface: detail: Ensuring Chocolatey commands are on the path
 INFO interface: detail:     win10: Ensuring Chocolatey commands are on the path
    win10: Ensuring Chocolatey commands are on the path
 INFO interface: detail: Ensuring chocolatey.nupkg is in the lib folder
 INFO interface: detail:     win10: Ensuring chocolatey.nupkg is in the lib folder
    win10: Ensuring chocolatey.nupkg is in the lib folder
 INFO interface: detail: [03:40] Installing utilities...
 INFO interface: detail:     win10: [03:40] Installing utilities...
    win10: [03:40] Installing utilities...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     win10: Installing the following packages:
    win10: Installing the following packages:
 INFO interface: detail: classic-shell
 INFO interface: detail:     win10: classic-shell
    win10: classic-shell
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     win10: By installing, you accept licenses for the packages.
    win10: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: classic-shell v4.3.1.20180405 [Approved]
 INFO interface: detail:     win10: classic-shell v4.3.1.20180405 [Approved]
    win10: classic-shell v4.3.1.20180405 [Approved]
 INFO interface: detail: classic-shell package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: classic-shell package files install completed. Performing other installation steps.
    win10: classic-shell package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing classic-shell...
 INFO interface: detail:     win10: Installing classic-shell...
    win10: Installing classic-shell...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: classic-shell has been installed.
 INFO interface: detail:     win10: classic-shell has been installed.
    win10: classic-shell has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   classic-shell may be able to be automatically uninstalled.
 INFO interface: detail:     win10:   classic-shell may be able to be automatically uninstalled.
    win10:   classic-shell may be able to be automatically uninstalled.
 INFO interface: detail:  The install of classic-shell was successful.
 INFO interface: detail:     win10:  The install of classic-shell was successful.
    win10:  The install of classic-shell was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     win10:   Software installed as 'exe', install location is likely default.
    win10:   Software installed as 'exe', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     win10: Chocolatey installed 1/1 packages.
    win10: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     win10: Installing the following packages:
    win10: Installing the following packages:
 INFO interface: detail: NotepadPlusPlus;WinRar;processhacker
 INFO interface: detail:     win10: NotepadPlusPlus;WinRar;processhacker
    win10: NotepadPlusPlus;WinRar;processhacker
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     win10: By installing, you accept licenses for the packages.
    win10: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: chocolatey-compatibility.extension v1.0.0 [Approved]
 INFO interface: detail:     win10: chocolatey-compatibility.extension v1.0.0 [Approved]
    win10: chocolatey-compatibility.extension v1.0.0 [Approved]
 INFO interface: detail: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
    win10: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-compatibility extensions.
 INFO interface: detail:     win10:  Installed/updated chocolatey-compatibility extensions.
    win10:  Installed/updated chocolatey-compatibility extensions.
 INFO interface: detail:  The install of chocolatey-compatibility.extension was successful.
 INFO interface: detail:     win10:  The install of chocolatey-compatibility.extension was successful.
    win10:  The install of chocolatey-compatibility.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
 INFO interface: detail:     win10:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
    win10:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: chocolatey-core.extension v1.4.0 [Approved]
 INFO interface: detail:     win10: chocolatey-core.extension v1.4.0 [Approved]
    win10: chocolatey-core.extension v1.4.0 [Approved]
 INFO interface: detail: chocolatey-core.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: chocolatey-core.extension package files install completed. Performing other installation steps.
    win10: chocolatey-core.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-core extensions.
 INFO interface: detail:     win10:  Installed/updated chocolatey-core extensions.
    win10:  Installed/updated chocolatey-core extensions.
 INFO interface: detail:  The install of chocolatey-core.extension was successful.
 INFO interface: detail:     win10:  The install of chocolatey-core.extension was successful.
    win10:  The install of chocolatey-core.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
 INFO interface: detail:     win10:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
    win10:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: notepadplusplus.install v8.4.2 [Approved]
 INFO interface: detail:     win10: notepadplusplus.install v8.4.2 [Approved]
    win10: notepadplusplus.install v8.4.2 [Approved]
 INFO interface: detail: notepadplusplus.install package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: notepadplusplus.install package files install completed. Performing other installation steps.
    win10: notepadplusplus.install package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing 64-bit notepadplusplus.install...
 INFO interface: detail:     win10: Installing 64-bit notepadplusplus.install...
    win10: Installing 64-bit notepadplusplus.install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: notepadplusplus.install has been installed.
 INFO interface: detail:     win10: notepadplusplus.install has been installed.
    win10: notepadplusplus.install has been installed.
 INFO interface: detail: WARNING: No registry key found based on  'Notepad\+\+*'
 INFO interface: detail:     win10: WARNING: No registry key found based on  'Notepad\+\+*'
    win10: WARNING: No registry key found based on  'Notepad\+\+*'
 INFO interface: detail: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
 INFO interface: detail:     win10: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
    win10: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
 INFO interface: detail:     win10: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
    win10: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   notepadplusplus.install can be automatically uninstalled.
 INFO interface: detail:     win10:   notepadplusplus.install can be automatically uninstalled.
    win10:   notepadplusplus.install can be automatically uninstalled.
 INFO interface: detail:  The install of notepadplusplus.install was successful.
 INFO interface: detail:     win10:  The install of notepadplusplus.install was successful.
    win10:  The install of notepadplusplus.install was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     win10:   Software installed as 'exe', install location is likely default.
    win10:   Software installed as 'exe', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: notepadplusplus v8.4.2 [Approved]
 INFO interface: detail:     win10: notepadplusplus v8.4.2 [Approved]
    win10: notepadplusplus v8.4.2 [Approved]
 INFO interface: detail: notepadplusplus package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: notepadplusplus package files install completed. Performing other installation steps.
    win10: notepadplusplus package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of notepadplusplus was successful.
 INFO interface: detail:     win10:  The install of notepadplusplus was successful.
    win10:  The install of notepadplusplus was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: winrar v6.11.0.20220504 [Approved]
 INFO interface: detail:     win10: winrar v6.11.0.20220504 [Approved]
    win10: winrar v6.11.0.20220504 [Approved]
 INFO interface: detail: winrar package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: winrar package files install completed. Performing other installation steps.
    win10: winrar package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading winrar 64 bit
 INFO interface: detail:     win10: Downloading winrar 64 bit
    win10: Downloading winrar 64 bit
 INFO interface: detail:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
 INFO interface: detail:     win10:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
    win10:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Download of winrar-x64-611.exe (3.32 MB) completed.
 INFO interface: detail:     win10: Download of winrar-x64-611.exe (3.32 MB) completed.
    win10: Download of winrar-x64-611.exe (3.32 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     win10: Hashes match.
    win10: Hashes match.
 INFO interface: detail: Installing winrar...
 INFO interface: detail:     win10: Installing winrar...
    win10: Installing winrar...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: winrar has been installed.
 INFO interface: detail:     win10: winrar has been installed.
    win10: winrar has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   winrar may be able to be automatically uninstalled.
 INFO interface: detail:     win10:   winrar may be able to be automatically uninstalled.
    win10:   winrar may be able to be automatically uninstalled.
 INFO interface: detail:  The install of winrar was successful.
 INFO interface: detail:     win10:  The install of winrar was successful.
    win10:  The install of winrar was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\WinRAR\'
 INFO interface: detail:     win10:   Software installed to 'C:\Program Files\WinRAR\'
    win10:   Software installed to 'C:\Program Files\WinRAR\'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
 INFO interface: detail:     win10: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
    win10: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
 INFO interface: detail: processhacker.install package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: processhacker.install package files install completed. Performing other installation steps.
    win10: processhacker.install package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading processhacker.install
 INFO interface: detail:     win10: Downloading processhacker.install
    win10: Downloading processhacker.install
 INFO interface: detail:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
 INFO interface: detail:     win10:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
    win10:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
 INFO interface: detail:     win10: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
    win10: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     win10: Hashes match.
    win10: Hashes match.
 INFO interface: detail: Installing processhacker.install...
 INFO interface: detail:     win10: Installing processhacker.install...
    win10: Installing processhacker.install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: processhacker.install has been installed.
 INFO interface: detail:     win10: processhacker.install has been installed.
    win10: processhacker.install has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   processhacker.install can be automatically uninstalled.
 INFO interface: detail:     win10:   processhacker.install can be automatically uninstalled.
    win10:   processhacker.install can be automatically uninstalled.
 INFO interface: detail:  The install of processhacker.install was successful.
 INFO interface: detail:     win10:  The install of processhacker.install was successful.
    win10:  The install of processhacker.install was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\Process Hacker 2\'
 INFO interface: detail:     win10:   Software installed to 'C:\Program Files\Process Hacker 2\'
    win10:   Software installed to 'C:\Program Files\Process Hacker 2\'
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: processhacker v2.39 [Approved] - Possibly broken
 INFO interface: detail:     win10: processhacker v2.39 [Approved] - Possibly broken
    win10: processhacker v2.39 [Approved] - Possibly broken
 INFO interface: detail: processhacker package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: processhacker package files install completed. Performing other installation steps.
    win10: processhacker package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of processhacker was successful.
 INFO interface: detail:     win10:  The install of processhacker was successful.
    win10:  The install of processhacker was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Chocolatey installed 7/7 packages.
 INFO interface: detail:     win10: Chocolatey installed 7/7 packages.
    win10: Chocolatey installed 7/7 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Installed:
 INFO interface: detail:     win10: Installed:
    win10: Installed:
 INFO interface: detail:  - processhacker.install v2.39
 INFO interface: detail:     win10:  - processhacker.install v2.39
    win10:  - processhacker.install v2.39
 INFO interface: detail:  - notepadplusplus.install v8.4.2
 INFO interface: detail:     win10:  - notepadplusplus.install v8.4.2
    win10:  - notepadplusplus.install v8.4.2
 INFO interface: detail:  - chocolatey-core.extension v1.4.0
 INFO interface: detail:     win10:  - chocolatey-core.extension v1.4.0
    win10:  - chocolatey-core.extension v1.4.0
 INFO interface: detail:  - winrar v6.11.0.20220504
 INFO interface: detail:     win10:  - winrar v6.11.0.20220504
    win10:  - winrar v6.11.0.20220504
 INFO interface: detail:  - chocolatey-compatibility.extension v1.0.0
 INFO interface: detail:     win10:  - chocolatey-compatibility.extension v1.0.0
    win10:  - chocolatey-compatibility.extension v1.0.0
 INFO interface: detail:  - notepadplusplus v8.4.2
 INFO interface: detail:     win10:  - notepadplusplus v8.4.2
    win10:  - notepadplusplus v8.4.2
 INFO interface: detail:  - processhacker v2.39
 INFO interface: detail:     win10:  - processhacker v2.39
    win10:  - processhacker v2.39
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     win10: Installing the following packages:
    win10: Installing the following packages:
 INFO interface: detail: GoogleChrome
 INFO interface: detail:     win10: GoogleChrome
    win10: GoogleChrome
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     win10: By installing, you accept licenses for the packages.
    win10: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: GoogleChrome v102.0.5005.115 [Approved]
 INFO interface: detail:     win10: GoogleChrome v102.0.5005.115 [Approved]
    win10: GoogleChrome v102.0.5005.115 [Approved]
 INFO interface: detail: googlechrome package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: googlechrome package files install completed. Performing other installation steps.
    win10: googlechrome package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading googlechrome 64 bit
 INFO interface: detail:     win10: Downloading googlechrome 64 bit
    win10: Downloading googlechrome 64 bit
 INFO interface: detail:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
 INFO interface: detail:     win10:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
    win10:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
 INFO interface: detail:     win10: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
    win10: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
 INFO interface: detail:     win10: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
    win10: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
 INFO interface: detail: Installing googlechrome...
 INFO interface: detail:     win10: Installing googlechrome...
    win10: Installing googlechrome...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: googlechrome has been installed.
 INFO interface: detail:     win10: googlechrome has been installed.
    win10: googlechrome has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   googlechrome may be able to be automatically uninstalled.
 INFO interface: detail:     win10:   googlechrome may be able to be automatically uninstalled.
    win10:   googlechrome may be able to be automatically uninstalled.
 INFO interface: detail:  The install of googlechrome was successful.
 INFO interface: detail:     win10:  The install of googlechrome was successful.
    win10:  The install of googlechrome was successful.
 INFO interface: detail:   Software installed as 'MSI', install location is likely default.
 INFO interface: detail:     win10:   Software installed as 'MSI', install location is likely default.
    win10:   Software installed as 'MSI', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     win10: Chocolatey installed 1/1 packages.
    win10: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: [03:42] Utilties installation complete!
 INFO interface: detail:     win10: [03:42] Utilties installation complete!
    win10: [03:42] Utilties installation complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 72B31C33-CE8B-4B95-94B6-AB80F8115996 on shell_id 13579C08-753A-49A5-ACE1-28922D21D554
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd84228f8 @data=[{:stdout=>"[03:39] Installing Chocolatey\r\n"}, {:stdout=>"Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)\r\n"}, {:stdout=>"Getting latest version of the Chocolatey package for download.\r\n"}, {:stdout=>"Not using proxy.\r\n"}, {:stdout=>"Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.\r\n"}, {:stdout=>"Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\\chocolatey.zip\r\n"}, {:stdout=>"Not using proxy.\r\n"}, {:stdout=>"Extracting C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\\chocolatey.zip to C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\r\n"}, {:stdout=>"Installing Chocolatey on the local machine\r\n"}, {:stdout=>"Creating ChocolateyInstall as an environment variable (targeting 'Machine') \r\n"}, {:stdout=>"  Setting ChocolateyInstall to 'C:\\ProgramData\\chocolatey'\r\n"}, {:stdout=>"WARNING: It's very likely you will need to close and reopen your shell \r\n"}, {:stdout=>"  before you can use choco.\r\n"}, {:stdout=>"Restricting write permissions to Administrators\r\n"}, {:stdout=>"We are setting up the Chocolatey package repository.\r\n"}, {:stdout=>"The packages themselves go to 'C:\\ProgramData\\chocolatey\\lib'\r\n"}, {:stdout=>"  (i.e. C:\\ProgramData\\chocolatey\\lib\\yourPackageName).\r\n"}, {:stdout=>"A shim file for the command line goes to 'C:\\ProgramData\\chocolatey\\bin'\r\n"}, {:stdout=>"  and points to an executable in 'C:\\ProgramData\\chocolatey\\lib\\yourPackageName'.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Creating Chocolatey folders if they do not already exist.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: You can safely ignore errors related to missing log files when \r\n"}, {:stdout=>"  upgrading from a version of Chocolatey less than 0.9.9. \r\n"}, {:stdout=>"  'Batch file could not be found' is also safe to ignore. \r\n"}, {:stdout=>"  'The system cannot find the file specified' - also safe.\r\n"}, {:stdout=>"chocolatey.nupkg file not installed in lib.\r\n"}, {:stdout=>" Attempting to locate it from bootstrapper.\r\n"}, {:stdout=>"PATH environment variable does not have C:\\ProgramData\\chocolatey\\bin in it. Adding...\r\n"}, {:stdout=>"WARNING: Not setting tab completion: Profile file does not exist at \r\n"}, {:stdout=>"'C:\\Users\\vagrant\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'.\r\n"}, {:stdout=>"Chocolatey (choco.exe) is now ready.\r\n"}, {:stdout=>"You can call choco from anywhere, command line or powershell by typing choco.\r\n"}, {:stdout=>"Run choco /? for a list of functions.\r\n"}, {:stdout=>"You may need to shut down and restart powershell and/or consoles\r\n"}, {:stdout=>" first prior to using choco.\r\n"}, {:stdout=>"Ensuring Chocolatey commands are on the path\r\n"}, {:stdout=>"Ensuring chocolatey.nupkg is in the lib folder\r\n"}, {:stdout=>"[03:40] Installing utilities...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"classic-shell\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"classic-shell v4.3.1.20180405 [Approved]\r\n"}, {:stdout=>"classic-shell package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing classic-shell...\r\n"}, {:stdout=>"classic-shell has been installed.\r\n"}, {:stdout=>"  classic-shell may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of classic-shell was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"NotepadPlusPlus;WinRar;processhacker\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-compatibility.extension v1.0.0 [Approved]\r\n"}, {:stdout=>"chocolatey-compatibility.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-compatibility extensions.\r\n"}, {:stdout=>" The install of chocolatey-compatibility.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-compatibility'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-core.extension v1.4.0 [Approved]\r\n"}, {:stdout=>"chocolatey-core.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-core extensions.\r\n"}, {:stdout=>" The install of chocolatey-core.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-core'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"notepadplusplus.install v8.4.2 [Approved]\r\n"}, {:stdout=>"notepadplusplus.install package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing 64-bit notepadplusplus.install...\r\n"}, {:stdout=>"notepadplusplus.install has been installed.\r\n"}, {:stdout=>"WARNING: No registry key found based on  'Notepad\\+\\+*'\r\n"}, {:stdout=>"notepadplusplus.install installed to 'C:\\Program Files\\Notepad++'\r\n"}, {:stdout=>"Added C:\\ProgramData\\chocolatey\\bin\\notepad++.exe shim pointed to 'c:\\program files\\notepad++\\notepad++.exe'.\r\n"}, {:stdout=>"  notepadplusplus.install can be automatically uninstalled.\r\n"}, {:stdout=>" The install of notepadplusplus.install was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"notepadplusplus v8.4.2 [Approved]\r\n"}, {:stdout=>"notepadplusplus package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" The install of notepadplusplus was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"winrar v6.11.0.20220504 [Approved]\r\n"}, {:stdout=>"winrar package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading winrar 64 bit\r\n"}, {:stdout=>"  from 'https://www.rarlab.com/rar/winrar-x64-611.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of winrar-x64-611.exe (3.32 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing winrar...\r\n"}, {:stdout=>"winrar has been installed.\r\n"}, {:stdout=>"  winrar may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of winrar was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\WinRAR\\'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)\r\n"}, {:stdout=>"processhacker.install package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading processhacker.install \r\n"}, {:stdout=>"  from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of processhacker-2.39-setup.exe (2.16 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing processhacker.install...\r\n"}, {:stdout=>"processhacker.install has been installed.\r\n"}, {:stdout=>"  processhacker.install can be automatically uninstalled.\r\n"}, {:stdout=>" The install of processhacker.install was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\Process Hacker 2\\'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"processhacker v2.39 [Approved] - Possibly broken\r\n"}, {:stdout=>"processhacker package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" The install of processhacker was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 7/7 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Installed:\r\n"}, {:stdout=>" - processhacker.install v2.39\r\n"}, {:stdout=>" - notepadplusplus.install v8.4.2\r\n"}, {:stdout=>" - chocolatey-core.extension v1.4.0\r\n"}, {:stdout=>" - winrar v6.11.0.20220504\r\n"}, {:stdout=>" - chocolatey-compatibility.extension v1.0.0\r\n"}, {:stdout=>" - notepadplusplus v8.4.2\r\n"}, {:stdout=>" - processhacker v2.39\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"GoogleChrome\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"GoogleChrome v102.0.5005.115 [Approved]\r\n"}, {:stdout=>"googlechrome package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading googlechrome 64 bit\r\n"}, {:stdout=>"  from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.\r\n"}, {:stdout=>"WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.\r\n"}, {:stdout=>"Installing googlechrome...\r\n"}, {:stdout=>"googlechrome has been installed.\r\n"}, {:stdout=>"  googlechrome may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of googlechrome was successful.\r\n"}, {:stdout=>"  Software installed as 'MSI', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"[03:42] Utilties installation complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd92e4c60 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd8f7b060 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2221, 5986=>2220, 5985=>2213}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3D8E68C6-1A1E-41B4-A556-FCEC803E876D
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0329C1F3-DF6F-475D-9EC9-9A11B471A9F4
DEBUG winrmshell: [WinRM] creating command_id: 0329C1F3-DF6F-475D-9EC9-9A11B471A9F4 on shell_id 3D8E68C6-1A1E-41B4-A556-FCEC803E876D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0329C1F3-DF6F-475D-9EC9-9A11B471A9F4 on shell_id 3D8E68C6-1A1E-41B4-A556-FCEC803E876D
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd897fb48 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2214, 5985=>2219, 22=>2215}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 71B2061B-D090-475D-9C2D-0E270E8A42E5
DEBUG winrmshell: [WinRM] Command created for hostname with id: ABA6E0D2-AA31-45DC-8D55-1A7A66E05006
DEBUG winrmshell: [WinRM] creating command_id: ABA6E0D2-AA31-45DC-8D55-1A7A66E05006 on shell_id 71B2061B-D090-475D-9C2D-0E270E8A42E5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ABA6E0D2-AA31-45DC-8D55-1A7A66E05006 on shell_id 71B2061B-D090-475D-9C2D-0E270E8A42E5
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d76620 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 22=>2218, 5986=>2220}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 39B79EA7-3B3E-493D-9B3D-518CEF143B2A
DEBUG winrmshell: [WinRM] Command created for hostname with id: DF2ADFBF-A3FC-4735-B1A9-2BA5409B9B38
DEBUG winrmshell: [WinRM] creating command_id: DF2ADFBF-A3FC-4735-B1A9-2BA5409B9B38 on shell_id 39B79EA7-3B3E-493D-9B3D-518CEF143B2A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DF2ADFBF-A3FC-4735-B1A9-2BA5409B9B38 on shell_id 39B79EA7-3B3E-493D-9B3D-518CEF143B2A
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd9185748 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8100198 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7f78af0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd924f520 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 12A04532-E52B-4195-B0D0-0BA34AF521B7
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 41B05A28-5FF5-4804-B030-8F2D30476E4E
DEBUG winrmshell: [WinRM] creating command_id: 41B05A28-5FF5-4804-B030-8F2D30476E4E on shell_id 12A04532-E52B-4195-B0D0-0BA34AF521B7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 41B05A28-5FF5-4804-B030-8F2D30476E4E on shell_id 12A04532-E52B-4195-B0D0-0BA34AF521B7
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd9122eb8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd752b7f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd74d1458 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd920f5d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5BBBC008-B1A7-491A-ADF9-B2DE57E27F17
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: EA500332-1DEF-4B13-9ABF-6A96B69BF4B8
DEBUG winrmshell: [WinRM] creating command_id: EA500332-1DEF-4B13-9ABF-6A96B69BF4B8 on shell_id 5BBBC008-B1A7-491A-ADF9-B2DE57E27F17
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EA500332-1DEF-4B13-9ABF-6A96B69BF4B8 on shell_id 5BBBC008-B1A7-491A-ADF9-B2DE57E27F17
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd90e2c00 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-pmxwy7.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91fce60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91f7d20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90db4c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "c7314f1931cc68e64e30c31ffa092d2063d36af1" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-pmxwy7.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 318EFB6F-2CF7-4678-AD19-BE86EB5EE73A
DEBUG winrmshell: [WinRM] creating command_id: 318EFB6F-2CF7-4678-AD19-BE86EB5EE73A on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 318EFB6F-2CF7-4678-AD19-BE86EB5EE73A on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","c7314f1931cc68e64e30c31ffa092d2063d36af1","2ccc385c1b1113d499646914f2abe476d7a690be","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-pmxwy7.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3F4A6BCB-EA16-4C86-B00D-41B3F1504F25
DEBUG winrmshell: [WinRM] creating command_id: 3F4A6BCB-EA16-4C86-B00D-41B3F1504F25 on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3F4A6BCB-EA16-4C86-B00D-41B3F1504F25 on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBNaW1pa2F0eiBhbmQgUG93ZXJzcGxvaXQgaW50byBjOlxUb29sc1xNaW1pa2F0ei4gVXNlZCB0byBpbnN0YWxsIHJlZHRlYW0gcmVsYXRlZCB0b29saW5nLgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgUmVkIFRlYW0gVG9vbGluZy4uLiIKJGhvc3RuYW1lID0gJChob3N0bmFtZSkKCiMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzI3CltOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSBbTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTIKCiMgV2luZG93cyBEZWZlbmRlciBzaG91bGQgYmUgZGlzYWJsZWQgYWxyZWFkeSBieSBPJk8gU2h1dFVwMTAgYW5kIHRoZSBHUE8KSWYgKCRob3N0bmFtZSAtZXEgIndpbjEwIiAtQW5kIChHZXQtU2VydmljZSAtTmFtZSBXaW5EZWZlbmQpLlN0YXJ0VHlwZSAtbmUgJ0Rpc2FibGVkJyApIHsKICAjIEFkZGluZyBEZWZlbmRlciBleGNsdXNpb25zIGp1c3QgaW4gY2FzZQogIFNldC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblBhdGggIkM6XFRvb2xzIgogIEFkZC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblBhdGggIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wIgoKICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xJbnZva2UtQ29tbWFuZEFzLnBzMQogIEludm9rZS1Db21tYW5kQXMgJ05UIFNFUlZJQ0VcVHJ1c3RlZEluc3RhbGxlcicgewogICAgU2V0LVNlcnZpY2UgV2luRGVmZW5kIC1TdGFydHVwVHlwZSBEaXNhYmxlZAogICAgU3RvcC1TZXJ2aWNlIFdpbkRlZmVuZAogIH0KfQoKIyBXaW5kb3dzIERlZmVuZGVyIHNob3VsZCBiZSBkaXNhYmxlZCBieSB0aGUgR1BPIG9yIHVuaW5zdGFsbGVkIGFscmVhZHksIGJ1dCB3ZSdsbCBrZWVwIHRoaXMganVzdCBpbiBjYXNlCklmICgkaG9zdG5hbWUgLW5lICJ3aW4xMCIgLUFuZCAoR2V0LVNlcnZpY2UgLU5hbWUgV2luRGVmZW5kIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKS5zdGF0dXMgLWVxICdSdW5uaW5nJykgewogICMgVW5pbnN0YWxsaW5nIFdpbmRvd3MgRGVmZW5kZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9TdGVmYW5TY2hlcmVyL3BhY2tlci13aW5kb3dzL2lzc3Vlcy8yMDEpCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVW5pbnN0YWxsaW5nIFdpbmRvd3MgRGVmZW5kZXIuLi4iCiAgVHJ5IHsKICAgIFVuaW5zdGFsbC1XaW5kb3dzRmVhdHVyZSBXaW5kb3dzLURlZmVuZGVyIC1FcnJvckFjdGlvbiBTdG9wCiAgICBVbmluc3RhbGwtV2luZG93c0ZlYXR1cmUgV2luZG93cy1EZWZlbmRlci1GZWF0dXJlcyAtRXJyb3JBY3Rpb24gU3RvcAogIH0gQ2F0Y2ggewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdpbmRvd3MgRGVmZW5kZXIgZGlkIG5vdCB1bmluc3RhbGwgc3VjY2Vzc2Z1bGx5Li4uIgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdlJ2xsIHRyeSBhZ2FpbiBkdXJpbmcgaW5zdGFsbC1yZWQtdGVhbS5wczEiCiAgfQp9IEVsc2UgIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV2luZG93cyBEZWZlbmRlciBoYXMgYWxyZWFkeSBiZWVuIGRpc2FibGVkIG9yIHVuaW5zdGFsbGVkLiIKfQoKIyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIHVuemlwcyBhIGNvcHkgb2YgdGhlIGxhdGVzdCBNaW1pa2F0eiB0cnVuawpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGV0ZXJtaW5pbmcgbGF0ZXN0IHJlbGVhc2Ugb2YgTWltaWthdHouLi4iCiR0YWcgPSAoSW52b2tlLVdlYlJlcXVlc3QgImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvZ2VudGlsa2l3aS9taW1pa2F0ei9yZWxlYXNlcyIgLVVzZUJhc2ljUGFyc2luZyB8IENvbnZlcnRGcm9tLUpzb24pWzBdLnRhZ19uYW1lCiRtaW1pa2F0ekRvd25sb2FkVXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbS9nZW50aWxraXdpL21pbWlrYXR6L3JlbGVhc2VzL2Rvd25sb2FkLyR0YWcvbWltaWthdHpfdHJ1bmsuemlwIgokbWltaWthdHpSZXBvUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFxtaW1pa2F0el90cnVuay56aXAnCklmICgtbm90IChUZXN0LVBhdGggJG1pbWlrYXR6UmVwb1BhdGgpKSB7CiAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJG1pbWlrYXR6RG93bmxvYWRVcmwiIC1PdXRGaWxlICRtaW1pa2F0elJlcG9QYXRoCiAgRXhwYW5kLUFyY2hpdmUgLXBhdGggIiRtaW1pa2F0elJlcG9QYXRoIiAtZGVzdGluYXRpb25wYXRoICdjOlxUb29sc1xNaW1pa2F0eicgLUZvcmNlCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE1pbWlrYXR6IHdhcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQoKIyBEb3dubG9hZCBhbmQgdW56aXAgYSBjb3B5IG9mIFBvd2VyU3Bsb2l0CldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBQb3dlcnNwbG9pdC4uLiIKJHBvd2Vyc3Bsb2l0RG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdC9hcmNoaXZlL2Rldi56aXAiCiRwb3dlcnNwbG9pdFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHBvd2Vyc3Bsb2l0LnppcCIKSWYgKC1ub3QgKFRlc3QtUGF0aCAkcG93ZXJzcGxvaXRSZXBvUGF0aCkpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkcG93ZXJzcGxvaXREb3dubG9hZFVybCIgLU91dEZpbGUgJHBvd2Vyc3Bsb2l0UmVwb1BhdGgKICBFeHBhbmQtQXJjaGl2ZSAtcGF0aCAiJHBvd2Vyc3Bsb2l0UmVwb1BhdGgiIC1kZXN0aW5hdGlvbnBhdGggJ2M6XFRvb2xzXFBvd2VyU3Bsb2l0JyAtRm9yY2UKICBDb3B5LUl0ZW0gImM6XFRvb2xzXFBvd2VyU3Bsb2l0XFBvd2VyU3Bsb2l0LWRldlwqIiAiJEVudjp3aW5kaXJcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxNb2R1bGVzIiAtUmVjdXJzZSAtRm9yY2UKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgUG93ZXJTcGxvaXQgd2FzIGFscmVhZHkgaW5zdGFsbGVkLiBNb3ZpbmcgT24uIgp9CgojIERvd25sb2FkIGFuZCB1bnppcCBhIGNvcHkgb2YgQmFkQmxvb2QKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIEJhZEJsb29kLi4uIgokYmFkYmxvb2REb3dubG9hZFVybCA9ICJodHRwczovL2dpdGh1Yi5jb20vZGF2aWRwcm93ZS9CYWRCbG9vZC9hcmNoaXZlL21hc3Rlci56aXAiCiRiYWRibG9vZFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXGJhZGJsb29kLnppcCIKSWYgKC1ub3QgKFRlc3QtUGF0aCAkYmFkYmxvb2RSZXBvUGF0aCkpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkYmFkYmxvb2REb3dubG9hZFVybCIgLU91dEZpbGUgIiRiYWRibG9vZFJlcG9QYXRoIgogIEV4cGFuZC1BcmNoaXZlIC1wYXRoICIkYmFkYmxvb2RSZXBvUGF0aCIgLWRlc3RpbmF0aW9ucGF0aCAnYzpcVG9vbHNcQmFkQmxvb2QnIC1Gb3JjZQogICMgTG93ZXIgdGhlIG51bWJlciBvZiBkZWZhdWx0IHVzZXJzIHRvIGJlIGNyZWF0ZWQgYnkgQmFkQmxvb2QKICAkaW52b2tlQmFkQmxvb2RQYXRoID0gImM6XFRvb2xzXEJhZEJsb29kXEJhZEJsb29kLW1hc3RlclxJbnZva2UtQmFkQmxvb2QucHMxIgogICgoR2V0LUNvbnRlbnQgLXBhdGggJGludm9rZUJhZEJsb29kUGF0aCAtUmF3KSAtcmVwbGFjZSAnMTAwMC4uNTAwMCcsJzUwMC4uMTUwMCcpIHwgU2V0LUNvbnRlbnQgLVBhdGggJGludm9rZUJhZEJsb29kUGF0aAp9IEVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBCYWRCbG9vZCB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgRG93bmxvYWQgYW5kIGluc3RhbGwgSW52b2tlLUF0b21pY1JlZFRlYW0KV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIEludm9rZS1BdG9taWNSZWRUZWFtIGFuZCBhdG9taWMgdGVzdHMuLi4iCklmICgtbm90IChUZXN0LVBhdGggIkM6XFRvb2xzXEF0b21pY1JlZFRlYW0iKSkgewogIEluc3RhbGwtUGFja2FnZVByb3ZpZGVyIC1OYW1lIE51R2V0IC1Gb3JjZQogIEluc3RhbGwtTW9kdWxlIC1OYW1lIHBvd2Vyc2hlbGwteWFtbCAtRm9yY2UKICBJRVggKElXUiAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2ludm9rZS1hdG9taWNyZWR0ZWFtL21hc3Rlci9pbnN0YWxsLWF0b21pY3JlZHRlYW0ucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsKICBJbnN0YWxsLUF0b21pY1JlZFRlYW0gLWdldEF0b21pY3MgLUluc3RhbGxQYXRoICJjOlxUb29sc1xBdG9taWNSZWRUZWFtIgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBVcGRhdGluZyBQcm9maWxlLnBzMSB0byBpbXBvcnQgdGhlIEludm9rZS1BdG9taWNSZWRUZWFtIG1vZHVsZS4uLiIKICBBZGQtQ29udGVudCAtUGF0aCBDOlxXaW5kb3dzXFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBcUHJvZmlsZS5wczEgJ0ltcG9ydC1Nb2R1bGUgIkM6XFRvb2xzXEF0b21pY1JlZFRlYW1caW52b2tlLWF0b21pY3JlZHRlYW1cSW52b2tlLUF0b21pY1JlZFRlYW0ucHNkMSIgLUZvcmNlCiRQU0RlZmF1bHRQYXJhbWV0ZXJWYWx1ZXMgPSBAeyJJbnZva2UtQXRvbWljVGVzdDpQYXRoVG9BdG9taWNzRm9sZGVyIj0iQzpcVG9vbHNcQXRvbWljUmVkVGVhbVxhdG9taWNzIn0nIC1Gb3JjZQp9IEVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnZva2UtQXRvbWljUmVkVGVhbSB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgUHVycG9zZTogRG93bmxvYWRzIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBQdXJwbGVTaGFycE5ld3RvbnNvZnQuSnNvbi5kbGwKSWYgKC1ub3QgKFRlc3QtUGF0aCAiYzpcVG9vbHNcUHVycGxlU2hhcnAiKSkgewogIE5ldy1JdGVtIC1QYXRoICJjOlxUb29sc1wiIC1OYW1lICJQdXJwbGVTaGFycCIgLUl0ZW1UeXBlICJkaXJlY3RvcnkiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFB1cnBsZVNoYXJwIGZvbGRlciBhbHJlYWR5IGV4aXN0cy4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERldGVybWluaW5nIGxhdGVzdCByZWxlYXNlIG9mIFB1cnBsZXNoYXJwLi4uIgokdGFnID0gKEludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL212ZWxhemMwL1B1cnBsZVNoYXJwL3JlbGVhc2VzIiAtVXNlQmFzaWNQYXJzaW5nIHwgQ29udmVydEZyb20tSnNvbilbMF0udGFnX25hbWUKJHB1cnBsZXNoYXJwRG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL212ZWxhemMwL1B1cnBsZVNoYXJwL3JlbGVhc2VzL2Rvd25sb2FkLyR0YWcvUHVycGxlU2hhcnBfeDY0LmV4ZSIKSWYgKC1ub3QgKFRlc3QtUGF0aCAiYzpcVG9vbHNcUHVycGxlU2hhcnBcUHVycGxlU2hhcnAuZXhlIikpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICRwdXJwbGVzaGFycERvd25sb2FkVXJsIC1PdXRGaWxlICJjOlxUb29sc1xQdXJwbGVTaGFycFxQdXJwbGVTaGFycC5leGUiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFB1cnBsZVNoYXJwIHdhcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFJlZCBUZWFtIHRvb2xpbmcgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 192D6E7C-4953-4589-A152-A88180E910B3
DEBUG winrmshell: [WinRM] creating command_id: 192D6E7C-4953-4589-A152-A88180E910B3 on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 192D6E7C-4953-4589-A152-A88180E910B3 on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9B1BF9DE-A59A-4DE7-8AA5-4AAC03B6EB76
DEBUG winrmshell: [WinRM] creating command_id: 9B1BF9DE-A59A-4DE7-8AA5-4AAC03B6EB76 on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9B1BF9DE-A59A-4DE7-8AA5-4AAC03B6EB76 on shell_id E309259A-55A7-45F6-9A43-833E60B45A4A
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-pmxwy7.ps1 to C:/tmp/vagrant-shell.ps1 (8.2 KB over 1 chunks) in (0m0.31s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.86s) stream_files: (0m0.31s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d153c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d0ed90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b3af50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 43A7F291-CAF7-4F87-A2D5-5D88F85F7CDC
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2D3DBF0B-5AEC-4FA9-8E6B-CBD8F5A0E13B
DEBUG winrmshell: [WinRM] creating command_id: 2D3DBF0B-5AEC-4FA9-8E6B-CBD8F5A0E13B on shell_id 43A7F291-CAF7-4F87-A2D5-5D88F85F7CDC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2D3DBF0B-5AEC-4FA9-8E6B-CBD8F5A0E13B on shell_id 43A7F291-CAF7-4F87-A2D5-5D88F85F7CDC
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd89af078 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8f7b060 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd75bbeb8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 22=>2215, 5985=>2213}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AF80109C-3A00-4CCA-AE17-C87ED1CA3007
DEBUG winrmshell: [WinRM] Command created for hostname with id: 59EB4DA6-491F-46B4-8AD7-B6342EF41B3E
DEBUG winrmshell: [WinRM] creating command_id: 59EB4DA6-491F-46B4-8AD7-B6342EF41B3E on shell_id AF80109C-3A00-4CCA-AE17-C87ED1CA3007
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 59EB4DA6-491F-46B4-8AD7-B6342EF41B3E on shell_id AF80109C-3A00-4CCA-AE17-C87ED1CA3007
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d507e0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 22=>2218, 5986=>2220}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BE1B30BE-C8CF-4C47-9240-2137FD2FC7F3
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4EE8F77C-9491-4E32-BD18-F87F237AD242
DEBUG winrmshell: [WinRM] creating command_id: 4EE8F77C-9491-4E32-BD18-F87F237AD242 on shell_id BE1B30BE-C8CF-4C47-9240-2137FD2FC7F3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4EE8F77C-9491-4E32-BD18-F87F237AD242 on shell_id BE1B30BE-C8CF-4C47-9240-2137FD2FC7F3
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd913e780 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 5986=>2220, 22=>2221}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CE726AFC-2E93-4BC0-90C2-9356F62A99BA
DEBUG winrmshell: [WinRM] Command created for hostname with id: BA79B054-4C99-4FC6-AC05-FA3AE09A925F
DEBUG winrmshell: [WinRM] creating command_id: BA79B054-4C99-4FC6-AC05-FA3AE09A925F on shell_id CE726AFC-2E93-4BC0-90C2-9356F62A99BA
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BA79B054-4C99-4FC6-AC05-FA3AE09A925F on shell_id CE726AFC-2E93-4BC0-90C2-9356F62A99BA
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83c1bc0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89679f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8966850 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86b4be8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1CF115D2-1506-4574-BD1B-18BD673ACE0A
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0E392867-9B35-42C9-A982-705476732324
DEBUG winrmshell: [WinRM] creating command_id: 0E392867-9B35-42C9-A982-705476732324 on shell_id 1CF115D2-1506-4574-BD1B-18BD673ACE0A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0E392867-9B35-42C9-A982-705476732324 on shell_id 1CF115D2-1506-4574-BD1B-18BD673ACE0A
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83290a0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88ef840 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd88edf68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd866e418 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BECEBF4A-00E7-4D62-96CB-01CC854AA3B2
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 00DFFA2F-5982-4F31-83FF-18F63678369D
DEBUG winrmshell: [WinRM] creating command_id: 00DFFA2F-5982-4F31-83FF-18F63678369D on shell_id BECEBF4A-00E7-4D62-96CB-01CC854AA3B2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 00DFFA2F-5982-4F31-83FF-18F63678369D on shell_id BECEBF4A-00E7-4D62-96CB-01CC854AA3B2
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8162820 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1tv294v.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd84537c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd84507f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd80f8e20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "81883041f088db0f0d4a349f41739c56f60c7961" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-1tv294v.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 971F8D97-C836-4029-B01C-16B1B684D60C
DEBUG winrmshell: [WinRM] creating command_id: 971F8D97-C836-4029-B01C-16B1B684D60C on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 971F8D97-C836-4029-B01C-16B1B684D60C on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","81883041f088db0f0d4a349f41739c56f60c7961","da39a3ee5e6b4b0d3255bfef95601890afd80709","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1tv294v.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 91D789E3-68E6-4903-80D3-45E5DFFE45EB
DEBUG winrmshell: [WinRM] creating command_id: 91D789E3-68E6-4903-80D3-45E5DFFE45EB on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 91D789E3-68E6-4903-80D3-45E5DFFE45EB on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIGFkZGl0aW9uYWwgcGFja2FnZXMgZnJvbSBDaG9jb2xhdGV5LgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgYWRkaXRpb25hbCBDaG9jbyBwYWNrYWdlcy4uLiIKCklmICgtbm90IChUZXN0LVBhdGggIkM6XFByb2dyYW1EYXRhXGNob2NvbGF0ZXkiKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIENob2NvbGF0ZXkiCiAgaWV4ICgobmV3LW9iamVjdCBuZXQud2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cHM6Ly9jaG9jb2xhdGV5Lm9yZy9pbnN0YWxsLnBzMScpKQp9IGVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDaG9jb2xhdGV5IGlzIGFscmVhZHkgaW5zdGFsbGVkLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ2hvY29sYXRleSBleHRyYXMuLi4iCmNob2NvIGluc3RhbGwgLXkgLS1saW1pdC1vdXRwdXQgLS1uby1wcm9ncmVzcyB3aXJlc2hhcmsgd2lucGNhcAoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIENob2NvIGFkZG9ucyBjb21wbGV0ZSEiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 64CBAABE-CE0A-49FA-B405-0AEB1CE9E1D0
DEBUG winrmshell: [WinRM] creating command_id: 64CBAABE-CE0A-49FA-B405-0AEB1CE9E1D0 on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 64CBAABE-CE0A-49FA-B405-0AEB1CE9E1D0 on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C001E148-B6FB-4A94-8BA9-E74046BBAD95
DEBUG winrmshell: [WinRM] creating command_id: C001E148-B6FB-4A94-8BA9-E74046BBAD95 on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C001E148-B6FB-4A94-8BA9-E74046BBAD95 on shell_id 51616890-D8DB-4F68-AAC0-06CA65795FC8
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1tv294v.ps1 to C:/tmp/vagrant-shell.ps1 (0.864 KB over 1 chunks) in (0m0.31s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.93s) stream_files: (0m0.31s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd867d328 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86772e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd81cb0a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7DF8F0C5-9E45-4B6D-A44B-06D507096203
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C2266273-CC28-4B7A-B2C6-4C51C8D41578
DEBUG winrmshell: [WinRM] creating command_id: C2266273-CC28-4B7A-B2C6-4C51C8D41578 on shell_id 7DF8F0C5-9E45-4B6D-A44B-06D507096203
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:42] Installing additional Choco packages...
 INFO interface: detail:     win10: [03:42] Installing additional Choco packages...
    win10: [03:42] Installing additional Choco packages...
 INFO interface: detail: [03:42] Chocolatey is already installed.
 INFO interface: detail:     win10: [03:42] Chocolatey is already installed.
    win10: [03:42] Chocolatey is already installed.
 INFO interface: detail: [03:42] Installing Chocolatey extras...
 INFO interface: detail:     win10: [03:42] Installing Chocolatey extras...
    win10: [03:42] Installing Chocolatey extras...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     win10: Installing the following packages:
    win10: Installing the following packages:
 INFO interface: detail: wireshark;winpcap
 INFO interface: detail:     win10: wireshark;winpcap
    win10: wireshark;winpcap
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     win10: By installing, you accept licenses for the packages.
    win10: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: chocolatey-windowsupdate.extension v1.0.4 [Approved]
 INFO interface: detail:     win10: chocolatey-windowsupdate.extension v1.0.4 [Approved]
    win10: chocolatey-windowsupdate.extension v1.0.4 [Approved]
 INFO interface: detail: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
    win10: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-windowsupdate extensions.
 INFO interface: detail:     win10:  Installed/updated chocolatey-windowsupdate extensions.
    win10:  Installed/updated chocolatey-windowsupdate extensions.
 INFO interface: detail:  The install of chocolatey-windowsupdate.extension was successful.
 INFO interface: detail:     win10:  The install of chocolatey-windowsupdate.extension was successful.
    win10:  The install of chocolatey-windowsupdate.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
 INFO interface: detail:     win10:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
    win10:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: KB3035131 v1.0.3 [Approved]
 INFO interface: detail:     win10: KB3035131 v1.0.3 [Approved]
    win10: KB3035131 v1.0.3 [Approved]
 INFO interface: detail: kb3035131 package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: kb3035131 package files install completed. Performing other installation steps.
    win10: kb3035131 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
 INFO interface: detail:     win10: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
    win10: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb3035131 was successful.
 INFO interface: detail:     win10:  The install of kb3035131 was successful.
    win10:  The install of kb3035131 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: KB3033929 v1.0.5 [Approved]
 INFO interface: detail:     win10: KB3033929 v1.0.5 [Approved]
    win10: KB3033929 v1.0.5 [Approved]
 INFO interface: detail: kb3033929 package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: kb3033929 package files install completed. Performing other installation steps.
    win10: kb3033929 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
 INFO interface: detail:     win10: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
    win10: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb3033929 was successful.
 INFO interface: detail:     win10:  The install of kb3033929 was successful.
    win10:  The install of kb3033929 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: KB2919442 v1.0.20160915 [Approved]
 INFO interface: detail:     win10: KB2919442 v1.0.20160915 [Approved]
    win10: KB2919442 v1.0.20160915 [Approved]
 INFO interface: detail: kb2919442 package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: kb2919442 package files install completed. Performing other installation steps.
    win10: kb2919442 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:     win10: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
    win10: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb2919442 was successful.
 INFO interface: detail:     win10:  The install of kb2919442 was successful.
    win10:  The install of kb2919442 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: KB2919355 v1.0.20160915 [Approved]
 INFO interface: detail:     win10: KB2919355 v1.0.20160915 [Approved]
    win10: KB2919355 v1.0.20160915 [Approved]
 INFO interface: detail: kb2919355 package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: kb2919355 package files install completed. Performing other installation steps.
    win10: kb2919355 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:     win10: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
    win10: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb2919355 was successful.
 INFO interface: detail:     win10:  The install of kb2919355 was successful.
    win10:  The install of kb2919355 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: KB2999226 v1.0.20181019 [Approved] - Possibly broken
 INFO interface: detail:     win10: KB2999226 v1.0.20181019 [Approved] - Possibly broken
    win10: KB2999226 v1.0.20181019 [Approved] - Possibly broken
 INFO interface: detail: kb2999226 package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: kb2999226 package files install completed. Performing other installation steps.
    win10: kb2999226 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
 INFO interface: detail:     win10: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
    win10: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb2999226 was successful.
 INFO interface: detail:     win10:  The install of kb2999226 was successful.
    win10:  The install of kb2999226 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: vcredist140 v14.32.31326 [Approved]
 INFO interface: detail:     win10: vcredist140 v14.32.31326 [Approved]
    win10: vcredist140 v14.32.31326 [Approved]
 INFO interface: detail: vcredist140 package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: vcredist140 package files install completed. Performing other installation steps.
    win10: vcredist140 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading vcredist140-x86
 INFO interface: detail:     win10: Downloading vcredist140-x86
    win10: Downloading vcredist140-x86
 INFO interface: detail:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
 INFO interface: detail:     win10:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
    win10:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Download of VC_redist.x86.exe (13.1 MB) completed.
 INFO interface: detail:     win10: Download of VC_redist.x86.exe (13.1 MB) completed.
    win10: Download of VC_redist.x86.exe (13.1 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     win10: Hashes match.
    win10: Hashes match.
 INFO interface: detail: Installing vcredist140-x86...
 INFO interface: detail:     win10: Installing vcredist140-x86...
    win10: Installing vcredist140-x86...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: vcredist140-x86 has been installed.
 INFO interface: detail:     win10: vcredist140-x86 has been installed.
    win10: vcredist140-x86 has been installed.
 INFO interface: detail: Downloading vcredist140-x64 64 bit
 INFO interface: detail:     win10: Downloading vcredist140-x64 64 bit
    win10: Downloading vcredist140-x64 64 bit
 INFO interface: detail:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
 INFO interface: detail:     win10:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
    win10:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Download of VC_redist.x64.exe (24.16 MB) completed.
 INFO interface: detail:     win10: Download of VC_redist.x64.exe (24.16 MB) completed.
    win10: Download of VC_redist.x64.exe (24.16 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     win10: Hashes match.
    win10: Hashes match.
 INFO interface: detail: Installing vcredist140-x64...
 INFO interface: detail:     win10: Installing vcredist140-x64...
    win10: Installing vcredist140-x64...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: vcredist140-x64 has been installed.
 INFO interface: detail:     win10: vcredist140-x64 has been installed.
    win10: vcredist140-x64 has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   vcredist140 may be able to be automatically uninstalled.
 INFO interface: detail:     win10:   vcredist140 may be able to be automatically uninstalled.
    win10:   vcredist140 may be able to be automatically uninstalled.
 INFO interface: detail:  The install of vcredist140 was successful.
 INFO interface: detail:     win10:  The install of vcredist140 was successful.
    win10:  The install of vcredist140 was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     win10:   Software installed as 'exe', install location is likely default.
    win10:   Software installed as 'exe', install location is likely default.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: wireshark v3.6.6 [Approved]
 INFO interface: detail:     win10: wireshark v3.6.6 [Approved]
    win10: wireshark v3.6.6 [Approved]
 INFO interface: detail: wireshark package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: wireshark package files install completed. Performing other installation steps.
    win10: wireshark package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing 64-bit wireshark...
 INFO interface: detail:     win10: Installing 64-bit wireshark...
    win10: Installing 64-bit wireshark...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: wireshark has been installed.
 INFO interface: detail:     win10: wireshark has been installed.
    win10: wireshark has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   wireshark can be automatically uninstalled.
 INFO interface: detail:     win10:   wireshark can be automatically uninstalled.
    win10:   wireshark can be automatically uninstalled.
 INFO interface: detail:  The install of wireshark was successful.
 INFO interface: detail:     win10:  The install of wireshark was successful.
    win10:  The install of wireshark was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\Wireshark'
 INFO interface: detail:     win10:   Software installed to 'C:\Program Files\Wireshark'
    win10:   Software installed to 'C:\Program Files\Wireshark'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: autohotkey.portable v1.1.34.03 [Approved]
 INFO interface: detail:     win10: autohotkey.portable v1.1.34.03 [Approved]
    win10: autohotkey.portable v1.1.34.03 [Approved]
 INFO interface: detail: autohotkey.portable package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: autohotkey.portable package files install completed. Performing other installation steps.
    win10: autohotkey.portable package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
 INFO interface: detail:     win10: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
    win10: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
 INFO interface: detail:     win10: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
    win10: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
 INFO interface: detail: Removing ANSI-32 version
 INFO interface: detail:     win10: Removing ANSI-32 version
    win10: Removing ANSI-32 version
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  ShimGen has successfully created a shim for AutoHotkey.exe
 INFO interface: detail:     win10:  ShimGen has successfully created a shim for AutoHotkey.exe
    win10:  ShimGen has successfully created a shim for AutoHotkey.exe
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  ShimGen has successfully created a shim for Ahk2Exe.exe
 INFO interface: detail:     win10:  ShimGen has successfully created a shim for Ahk2Exe.exe
    win10:  ShimGen has successfully created a shim for Ahk2Exe.exe
 INFO interface: detail:  The install of autohotkey.portable was successful.
 INFO interface: detail:     win10:  The install of autohotkey.portable was successful.
    win10:  The install of autohotkey.portable was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
 INFO interface: detail:     win10:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
    win10:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: WinPcap v4.1.3.20161116 [Approved]
 INFO interface: detail:     win10: WinPcap v4.1.3.20161116 [Approved]
    win10: WinPcap v4.1.3.20161116 [Approved]
 INFO interface: detail: winpcap package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: winpcap package files install completed. Performing other installation steps.
    win10: winpcap package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading WinPcap
 INFO interface: detail:     win10: Downloading WinPcap
    win10: Downloading WinPcap
 INFO interface: detail:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
 INFO interface: detail:     win10:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
    win10:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Download of WinPcapInstall.exe (893.68 KB) completed.
 INFO interface: detail:     win10: Download of WinPcapInstall.exe (893.68 KB) completed.
    win10: Download of WinPcapInstall.exe (893.68 KB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     win10: Hashes match.
    win10: Hashes match.
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
 INFO interface: detail:     win10: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
    win10: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
 INFO interface: detail: Running Autohotkey installer
 INFO interface: detail:     win10: Running Autohotkey installer
    win10: Running Autohotkey installer
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of winpcap was successful.
 INFO interface: detail:     win10:  The install of winpcap was successful.
    win10:  The install of winpcap was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Chocolatey installed 10/10 packages.
 INFO interface: detail:     win10: Chocolatey installed 10/10 packages.
    win10: Chocolatey installed 10/10 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Installed:
 INFO interface: detail:     win10: Installed:
    win10: Installed:
 INFO interface: detail:  - kb2919355 v1.0.20160915
 INFO interface: detail:     win10:  - kb2919355 v1.0.20160915
    win10:  - kb2919355 v1.0.20160915
 INFO interface: detail:  - kb3033929 v1.0.5
 INFO interface: detail:     win10:  - kb3033929 v1.0.5
    win10:  - kb3033929 v1.0.5
 INFO interface: detail:  - kb2999226 v1.0.20181019
 INFO interface: detail:     win10:  - kb2999226 v1.0.20181019
    win10:  - kb2999226 v1.0.20181019
 INFO interface: detail:  - wireshark v3.6.6
 INFO interface: detail:     win10:  - wireshark v3.6.6
    win10:  - wireshark v3.6.6
 INFO interface: detail:  - kb2919442 v1.0.20160915
 INFO interface: detail:     win10:  - kb2919442 v1.0.20160915
    win10:  - kb2919442 v1.0.20160915
 INFO interface: detail:  - autohotkey.portable v1.1.34.03
 INFO interface: detail:     win10:  - autohotkey.portable v1.1.34.03
    win10:  - autohotkey.portable v1.1.34.03
 INFO interface: detail:  - vcredist140 v14.32.31326
 INFO interface: detail:     win10:  - vcredist140 v14.32.31326
    win10:  - vcredist140 v14.32.31326
 INFO interface: detail:  - winpcap v4.1.3.20161116
 INFO interface: detail:     win10:  - winpcap v4.1.3.20161116
    win10:  - winpcap v4.1.3.20161116
 INFO interface: detail:  - kb3035131 v1.0.3
 INFO interface: detail:     win10:  - kb3035131 v1.0.3
    win10:  - kb3035131 v1.0.3
 INFO interface: detail:  - chocolatey-windowsupdate.extension v1.0.4
 INFO interface: detail:     win10:  - chocolatey-windowsupdate.extension v1.0.4
    win10:  - chocolatey-windowsupdate.extension v1.0.4
 INFO interface: detail: [03:45] Choco addons complete!
 INFO interface: detail:     win10: [03:45] Choco addons complete!
    win10: [03:45] Choco addons complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C2266273-CC28-4B7A-B2C6-4C51C8D41578 on shell_id 7DF8F0C5-9E45-4B6D-A44B-06D507096203
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd92e5b88 @data=[{:stdout=>"[03:42] Installing additional Choco packages...\r\n"}, {:stdout=>"[03:42] Chocolatey is already installed.\r\n"}, {:stdout=>"[03:42] Installing Chocolatey extras...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"wireshark;winpcap\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-windowsupdate.extension v1.0.4 [Approved]\r\n"}, {:stdout=>"chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-windowsupdate extensions.\r\n"}, {:stdout=>" The install of chocolatey-windowsupdate.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-windowsupdate'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB3035131 v1.0.3 [Approved]\r\n"}, {:stdout=>"kb3035131 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).\r\n"}, {:stdout=>" The install of kb3035131 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB3033929 v1.0.5 [Approved]\r\n"}, {:stdout=>"kb3033929 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).\r\n"}, {:stdout=>" The install of kb3033929 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2919442 v1.0.20160915 [Approved]\r\n"}, {:stdout=>"kb2919442 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.\r\n"}, {:stdout=>" The install of kb2919442 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2919355 v1.0.20160915 [Approved]\r\n"}, {:stdout=>"kb2919355 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.\r\n"}, {:stdout=>" The install of kb2919355 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2999226 v1.0.20181019 [Approved] - Possibly broken\r\n"}, {:stdout=>"kb2999226 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows 10 Enterprise Evaluation).\r\n"}, {:stdout=>" The install of kb2999226 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"vcredist140 v14.32.31326 [Approved]\r\n"}, {:stdout=>"vcredist140 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading vcredist140-x86 \r\n"}, {:stdout=>"  from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of VC_redist.x86.exe (13.1 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing vcredist140-x86...\r\n"}, {:stdout=>"vcredist140-x86 has been installed.\r\n"}, {:stdout=>"Downloading vcredist140-x64 64 bit\r\n"}, {:stdout=>"  from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of VC_redist.x64.exe (24.16 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing vcredist140-x64...\r\n"}, {:stdout=>"vcredist140-x64 has been installed.\r\n"}, {:stdout=>"  vcredist140 may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of vcredist140 was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"wireshark v3.6.6 [Approved]\r\n"}, {:stdout=>"wireshark package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing 64-bit wireshark...\r\n"}, {:stdout=>"wireshark has been installed.\r\n"}, {:stdout=>"  wireshark can be automatically uninstalled.\r\n"}, {:stdout=>" The install of wireshark was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\Wireshark'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"autohotkey.portable v1.1.34.03 [Approved]\r\n"}, {:stdout=>"autohotkey.portable package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Extracting C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools\\AutoHotkey_1.1.34.03.zip to C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools...\r\n"}, {:stdout=>"C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools\r\n"}, {:stdout=>"Removing ANSI-32 version\r\n"}, {:stdout=>" ShimGen has successfully created a shim for AutoHotkey.exe\r\n"}, {:stdout=>" ShimGen has successfully created a shim for Ahk2Exe.exe\r\n"}, {:stdout=>" The install of autohotkey.portable was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WinPcap v4.1.3.20161116 [Approved]\r\n"}, {:stdout=>"winpcap package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading WinPcap \r\n"}, {:stdout=>"  from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of WinPcapInstall.exe (893.68 KB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\WinPcap\\4.1.3.20161116\\WinPcapInstall.exe\r\n"}, {:stdout=>"Running Autohotkey installer\r\n"}, {:stdout=>" The install of winpcap was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 10/10 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Installed:\r\n"}, {:stdout=>" - kb2919355 v1.0.20160915\r\n"}, {:stdout=>" - kb3033929 v1.0.5\r\n"}, {:stdout=>" - kb2999226 v1.0.20181019\r\n"}, {:stdout=>" - wireshark v3.6.6\r\n"}, {:stdout=>" - kb2919442 v1.0.20160915\r\n"}, {:stdout=>" - autohotkey.portable v1.1.34.03\r\n"}, {:stdout=>" - vcredist140 v14.32.31326\r\n"}, {:stdout=>" - winpcap v4.1.3.20161116\r\n"}, {:stdout=>" - kb3035131 v1.0.3\r\n"}, {:stdout=>" - chocolatey-windowsupdate.extension v1.0.4\r\n"}, {:stdout=>"[03:45] Choco addons complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd75bbeb8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd8c7d2f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2215, 5986=>2214}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B133A9C0-AEC9-44FF-BAE1-29DCBBB2A78E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 7A3728F9-C374-4F4D-BCF1-4DFD7BFECD6B
DEBUG winrmshell: [WinRM] creating command_id: 7A3728F9-C374-4F4D-BCF1-4DFD7BFECD6B on shell_id B133A9C0-AEC9-44FF-BAE1-29DCBBB2A78E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7A3728F9-C374-4F4D-BCF1-4DFD7BFECD6B on shell_id B133A9C0-AEC9-44FF-BAE1-29DCBBB2A78E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd74c9280 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 22=>2218, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9434322A-9F4C-457F-825C-4F2C03FE63A8
DEBUG winrmshell: [WinRM] Command created for hostname with id: AB932184-F736-40D9-B227-97254339F117
DEBUG winrmshell: [WinRM] creating command_id: AB932184-F736-40D9-B227-97254339F117 on shell_id 9434322A-9F4C-457F-825C-4F2C03FE63A8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AB932184-F736-40D9-B227-97254339F117 on shell_id 9434322A-9F4C-457F-825C-4F2C03FE63A8
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8956950 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 5986=>2214, 22=>2218}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5F30526F-340F-4997-B520-A1621477CA7E
DEBUG winrmshell: [WinRM] Command created for hostname with id: F7C4E2AE-DED2-4D2D-A90D-A8CFACA47833
DEBUG winrmshell: [WinRM] creating command_id: F7C4E2AE-DED2-4D2D-A90D-A8CFACA47833 on shell_id 5F30526F-340F-4997-B520-A1621477CA7E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F7C4E2AE-DED2-4D2D-A90D-A8CFACA47833 on shell_id 5F30526F-340F-4997-B520-A1621477CA7E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d0db48 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e73208 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e72380 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d76300 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CF05CB42-5294-4295-98AD-8946DE5B55E3
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B2DA3748-FF73-4A7B-A2A7-71C6246DDBE0
DEBUG winrmshell: [WinRM] creating command_id: B2DA3748-FF73-4A7B-A2A7-71C6246DDBE0 on shell_id CF05CB42-5294-4295-98AD-8946DE5B55E3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B2DA3748-FF73-4A7B-A2A7-71C6246DDBE0 on shell_id CF05CB42-5294-4295-98AD-8946DE5B55E3
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8c0b498 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d9f7f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d9e968 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8c9d938 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C874C5F3-EAC9-4DD3-B9E2-FDE32102C234
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8E09EBDD-6DA5-4909-B265-6DAAC505019E
DEBUG winrmshell: [WinRM] creating command_id: 8E09EBDD-6DA5-4909-B265-6DAAC505019E on shell_id C874C5F3-EAC9-4DD3-B9E2-FDE32102C234
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8E09EBDD-6DA5-4909-B265-6DAAC505019E on shell_id C874C5F3-EAC9-4DD3-B9E2-FDE32102C234
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8a972b0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-xqghtl.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b8ad98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b89cb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89e4570 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "299638e78893f8011af9474087001dd60f0e0bcc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-xqghtl.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CDB5B605-4DE3-4FD4-AF3B-F8547C97CE63
DEBUG winrmshell: [WinRM] creating command_id: CDB5B605-4DE3-4FD4-AF3B-F8547C97CE63 on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CDB5B605-4DE3-4FD4-AF3B-F8547C97CE63 on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","299638e78893f8011af9474087001dd60f0e0bcc","81883041f088db0f0d4a349f41739c56f60c7961","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-xqghtl.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B198D884-49AB-403F-8410-7EF045C5DBC0
DEBUG winrmshell: [WinRM] creating command_id: B198D884-49AB-403F-8410-7EF045C5DBC0 on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B198D884-49AB-403F-8410-7EF045C5DBC0 on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBvc3F1ZXJ5IG9uIHRoZSBob3N0LiBPc3F1ZXJ5IGNvbm50ZWN0cyB0byBGbGVldCB2aWEgVExTLgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgb3NxdWVyeS4uLiIKJGZsYWdmaWxlID0gImM6XFByb2dyYW0gRmlsZXNcb3NxdWVyeVxvc3F1ZXJ5LmZsYWdzIgpjaG9jbyBpbnN0YWxsIC15IC0tbGltaXQtb3V0cHV0IC0tbm8tcHJvZ3Jlc3Mgb3NxdWVyeSB8IE91dC1TdHJpbmcgICMgQXBwYXJlbnRseSBPdXQtU3RyaW5nIG1ha2VzIHRoZSBwcm9jZXNzIHdhaXQKJHNlcnZpY2UgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9TZXJ2aWNlIC1GaWx0ZXIgIk5hbWU9J29zcXVlcnlkJyIKSWYgKC1ub3QgKCRzZXJ2aWNlKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIG9zcXVlcnkgdG8gcnVuIGFzIGEgc2VydmljZSIKICBOZXctU2VydmljZSAtTmFtZSAib3NxdWVyeWQiIC1CaW5hcnlQYXRoTmFtZSAiQzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XG9zcXVlcnlkXG9zcXVlcnlkLmV4ZSAtLWZsYWdmaWxlPWAiQzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XG9zcXVlcnkuZmxhZ3NgIiIKCiAgIyBEb3dubG9hZCB0aGUgZmxhZ3MgZmlsZSBmcm9tIHRoZSBQYWxhbnRpciBvc3F1ZXJ5LWNvbmZpZ3VyYXRpb24gR2l0aHViCiAgIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzEvMjAxOAogIFtOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSBbTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTIKICAjIERpc2FibGluZyB0aGUgcHJvZ3Jlc3MgYmFyIHNwZWVkcyB1cCBJV1IgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOAogICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcGFsYW50aXIvb3NxdWVyeS1jb25maWd1cmF0aW9uL21hc3Rlci9DbGFzc2ljL0VuZHBvaW50cy9XaW5kb3dzL29zcXVlcnkuZmxhZ3MiIC1PdXRGaWxlICRmbGFnZmlsZQoKICAjIyBVc2UgdGhlIFRMUyBjb25maWcKICAjIyBBZGQgZW50cnkgdG8gaG9zdHMgZmlsZSBmb3IgRmxlZXQgZm9yIFNTTCB2YWxpZGF0aW9uCiAgSWYgKFNlbGVjdC1TdHJpbmcgLVBhdGggImM6XHdpbmRvd3Ncc3lzdGVtMzJcZHJpdmVyc1xldGNcaG9zdHMiIC1QYXR0ZXJuICJmbGVldCIpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBIb3N0cyBmaWxlIGFscmVhZHkgdXBkYXRlZC4gTW92aW5nIG9uLiIKICB9CiAgRWxzZSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQWRkaW5nIEZsZWV0IHRvIHRoZSBob3N0cyBmaWxlIgogICAgQWRkLUNvbnRlbnQgImM6XHdpbmRvd3Ncc3lzdGVtMzJcZHJpdmVyc1xldGNcaG9zdHMiICIgICAgICAgIDE5Mi4xNjguNTYuMTA1ICAgIGZsZWV0IgogIH0KICAjIyBBZGQgRmxlZXQgc2VjcmV0IGFuZCBhdm9pZCBCT00KICAkVXRmOE5vQm9tRW5jb2RpbmcgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LlVURjhFbmNvZGluZyAkRmFsc2UKICBbU3lzdGVtLklPLkZpbGVdOjpXcml0ZUFsbExpbmVzKCJjOlxQcm9ncmFtIEZpbGVzXG9zcXVlcnlcZmxlZXRfc2VjcmV0LnR4dCIsICJlbnJvbGxtZW50c2VjcmV0ZW5yb2xsbWVudHNlY3JldCIsICRVdGY4Tm9Cb21FbmNvZGluZykKICAjIyBDaGFuZ2UgVExTIHNlcnZlciBob3N0bmFtZSBpbiB0aGUgZmxhZ3MgZmlsZQogIChHZXQtQ29udGVudCAkZmxhZ2ZpbGUpIC1yZXBsYWNlICd0bHMuZW5kcG9pbnQuc2VydmVyLmNvbScsICdmbGVldDo4NDEyJyB8IFNldC1Db250ZW50ICRmbGFnZmlsZQogICMjIENoYW5nZSBwYXRoIHRvIHNlY3JldHMgaW4gdGhlIGZsYWdzIGZpbGUKICAoR2V0LUNvbnRlbnQgJGZsYWdmaWxlKSAtcmVwbGFjZSAncGF0aFxcdG9cXGZpbGVcXGNvbnRhaW5pbmdcXHNlY3JldC50eHQnLCAnUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGZsZWV0X3NlY3JldC50eHQnIHwgU2V0LUNvbnRlbnQgJGZsYWdmaWxlCiAgIyMgQ2hhbmdlIHBhdGggdG8gY2VydGZpbGUgaW4gdGhlIGZsYWdzIGZpbGUKICAoR2V0LUNvbnRlbnQgJGZsYWdmaWxlKSAtcmVwbGFjZSAnYzpcXFByb2dyYW1EYXRhXFxvc3F1ZXJ5XFxjZXJ0ZmlsZS5jcnQnLCAnYzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGNlcnRmaWxlLmNydCcgfCBTZXQtQ29udGVudCAkZmxhZ2ZpbGUKICAjIyBSZW1vdmUgdGhlIHZlcmJvc2UgZmxhZyBhbmQgcmVwbGFjZSBpdCB3aXRoIHRoZSBsb2dnZXJfbWluX3N0YXR1cz0xIG9wdGlvbiAoU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9vc3F1ZXJ5L29zcXVlcnkvaXNzdWVzLzUyMTIpCiAgKEdldC1Db250ZW50ICRmbGFnZmlsZSkgLXJlcGxhY2UgJy0tdmVyYm9zZT10cnVlJywgJy0tbG9nZ2VyX21pbl9zdGF0dXM9MScgfCBTZXQtQ29udGVudCAkZmxhZ2ZpbGUKICAjIyBBZGQgY2VydGZpbGUuY3J0CiAgQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1xmbGVldFxzZXJ2ZXIuY3J0IiAiYzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGNlcnRmaWxlLmNydCIKICAjIyBTdGFydCB0aGUgc2VydmljZQogIFN0YXJ0LVNlcnZpY2Ugb3NxdWVyeWQKfQplbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgb3NxdWVyeSBpcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQpJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIG9zcXVlcnlkKS5TdGF0dXMgLW5lICJSdW5uaW5nIikKewogIHRocm93ICJvc3F1ZXJ5ZCBzZXJ2aWNlIHdhcyBub3QgcnVubmluZyIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D980649D-4855-44F7-A9EF-2B5EFF6D2C1E
DEBUG winrmshell: [WinRM] creating command_id: D980649D-4855-44F7-A9EF-2B5EFF6D2C1E on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D980649D-4855-44F7-A9EF-2B5EFF6D2C1E on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C50917D5-12B5-4B12-9D6A-4D80843CA3FB
DEBUG winrmshell: [WinRM] creating command_id: C50917D5-12B5-4B12-9D6A-4D80843CA3FB on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C50917D5-12B5-4B12-9D6A-4D80843CA3FB on shell_id 75385F4E-4211-46E8-899B-0B45A505A1D4
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-xqghtl.ps1 to C:/tmp/vagrant-shell.ps1 (3.916 KB over 1 chunks) in (0m0.27s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.89s) stream_files: (0m0.27s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8abcf88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8abc088 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7e57798 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A24EE265-C2FD-4DFC-9CFF-04A71EFA9E86
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 822D8127-C21D-407F-927A-4BFE8AA886C0
DEBUG winrmshell: [WinRM] creating command_id: 822D8127-C21D-407F-927A-4BFE8AA886C0 on shell_id A24EE265-C2FD-4DFC-9CFF-04A71EFA9E86
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Installing osquery...
 INFO interface: detail:     win10: [03:46] Installing osquery...
    win10: [03:46] Installing osquery...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     win10: Installing the following packages:
    win10: Installing the following packages:
 INFO interface: detail: osquery
 INFO interface: detail:     win10: osquery
    win10: osquery
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     win10: By installing, you accept licenses for the packages.
    win10: By installing, you accept licenses for the packages.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: osquery v5.2.2 [Approved]
 INFO interface: detail:     win10: osquery v5.2.2 [Approved]
    win10: osquery v5.2.2 [Approved]
 INFO interface: detail: osquery package files install completed. Performing other installation steps.
 INFO interface: detail:     win10: osquery package files install completed. Performing other installation steps.
    win10: osquery package files install completed. Performing other installation steps.
 INFO interface: detail: C:\Program Files\osquery\log
 INFO interface: detail:     win10: C:\Program Files\osquery\log
    win10: C:\Program Files\osquery\log
 INFO interface: detail: True
 INFO interface: detail:     win10: True
    win10: True
 INFO interface: detail: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
 INFO interface: detail:     win10: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
    win10: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
 INFO interface: detail: Environment Vars (like PATH) have changed. Close/reopen your shell to
 INFO interface: detail:     win10: Environment Vars (like PATH) have changed. Close/reopen your shell to
    win10: Environment Vars (like PATH) have changed. Close/reopen your shell to
 INFO interface: detail:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
 INFO interface: detail:     win10:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
    win10:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
 INFO interface: detail:  ShimGen has successfully created a shim for osqueryi.exe
 INFO interface: detail:     win10:  ShimGen has successfully created a shim for osqueryi.exe
    win10:  ShimGen has successfully created a shim for osqueryi.exe
 INFO interface: detail:  ShimGen has successfully created a shim for osqueryd.exe
 INFO interface: detail:     win10:  ShimGen has successfully created a shim for osqueryd.exe
    win10:  ShimGen has successfully created a shim for osqueryd.exe
 INFO interface: detail:  The install of osquery was successful.
 INFO interface: detail:     win10:  The install of osquery was successful.
    win10:  The install of osquery was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     win10:   Software install location not explicitly set, it could be in package or
    win10:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     win10:   default install location of installer.
    win10:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     win10: Chocolatey installed 1/1 packages.
    win10: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    win10:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: [03:46] Setting osquery to run as a service
 INFO interface: detail:     win10: [03:46] Setting osquery to run as a service
    win10: [03:46] Setting osquery to run as a service
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Status   Name               DisplayName
 INFO interface: detail:     win10: Status   Name               DisplayName
    win10: Status   Name               DisplayName
 INFO interface: detail: ------   ----               -----------
 INFO interface: detail:     win10: ------   ----               -----------
    win10: ------   ----               -----------
 INFO interface: detail: Stopped  osqueryd           osqueryd
 INFO interface: detail:     win10: Stopped  osqueryd           osqueryd
    win10: Stopped  osqueryd           osqueryd
 INFO interface: detail: [03:46] Adding Fleet to the hosts file
 INFO interface: detail:     win10: [03:46] Adding Fleet to the hosts file
    win10: [03:46] Adding Fleet to the hosts file
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 822D8127-C21D-407F-927A-4BFE8AA886C0 on shell_id A24EE265-C2FD-4DFC-9CFF-04A71EFA9E86
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd889d5b8 @data=[{:stdout=>"[03:46] Installing osquery...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"osquery\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"osquery v5.2.2 [Approved]\r\n"}, {:stdout=>"osquery package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"C:\\Program Files\\osquery\\log\r\n"}, {:stdout=>"True\r\n"}, {:stdout=>"PATH environment variable does not have C:\\Program Files\\osquery in it. Adding...\r\n"}, {:stdout=>"Environment Vars (like PATH) have changed. Close/reopen your shell to\r\n"}, {:stdout=>" see the changes (or in powershell/cmd.exe just type `refreshenv`).\r\n"}, {:stdout=>" ShimGen has successfully created a shim for osqueryi.exe\r\n"}, {:stdout=>" ShimGen has successfully created a shim for osqueryd.exe\r\n"}, {:stdout=>" The install of osquery was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[03:46] Setting osquery to run as a service\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status   Name               DisplayName                           \r\n"}, {:stdout=>"------   ----               -----------                           \r\n"}, {:stdout=>"Stopped  osqueryd           osqueryd                              \r\n"}, {:stdout=>"[03:46] Adding Fleet to the hosts file\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8c7d2f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd86562f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 22=>2218, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3388CC90-F335-40BB-9DE8-59DB9014F14C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 02832389-FA30-4D87-9203-63134886A4D1
DEBUG winrmshell: [WinRM] creating command_id: 02832389-FA30-4D87-9203-63134886A4D1 on shell_id 3388CC90-F335-40BB-9DE8-59DB9014F14C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 02832389-FA30-4D87-9203-63134886A4D1 on shell_id 3388CC90-F335-40BB-9DE8-59DB9014F14C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8e35b88 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2220, 22=>2218, 5985=>2219}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B97E6E86-36BB-4965-9BE7-78F193C7D23C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 059520F8-6213-4114-B8D8-94B08D20AFCE
DEBUG winrmshell: [WinRM] creating command_id: 059520F8-6213-4114-B8D8-94B08D20AFCE on shell_id B97E6E86-36BB-4965-9BE7-78F193C7D23C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 059520F8-6213-4114-B8D8-94B08D20AFCE on shell_id B97E6E86-36BB-4965-9BE7-78F193C7D23C
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd91ef558 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5986=>2217, 22=>2215, 5985=>2219}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 54632101-925A-4C0B-AD0F-D302E0AB5C7F
DEBUG winrmshell: [WinRM] Command created for hostname with id: C392F087-8BCE-4106-94EE-B4E2FD4917C2
DEBUG winrmshell: [WinRM] creating command_id: C392F087-8BCE-4106-94EE-B4E2FD4917C2 on shell_id 54632101-925A-4C0B-AD0F-D302E0AB5C7F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C392F087-8BCE-4106-94EE-B4E2FD4917C2 on shell_id 54632101-925A-4C0B-AD0F-D302E0AB5C7F
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd865d140 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8964208 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd895f1b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86a77b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 76E1DD6C-3FF1-4133-B84F-0280DBFCD51E
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D8455289-5503-43D2-8050-F512F0AAA8AB
DEBUG winrmshell: [WinRM] creating command_id: D8455289-5503-43D2-8050-F512F0AAA8AB on shell_id 76E1DD6C-3FF1-4133-B84F-0280DBFCD51E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D8455289-5503-43D2-8050-F512F0AAA8AB on shell_id 76E1DD6C-3FF1-4133-B84F-0280DBFCD51E
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd82b0420 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd887c110 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8876f58 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd83816d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E903780A-A7AA-44CB-8F38-8E64632FB103
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C5E7CECB-BE7F-4F13-8727-BFC8ED8676D5
DEBUG winrmshell: [WinRM] creating command_id: C5E7CECB-BE7F-4F13-8727-BFC8ED8676D5 on shell_id E903780A-A7AA-44CB-8F38-8E64632FB103
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C5E7CECB-BE7F-4F13-8727-BFC8ED8676D5 on shell_id E903780A-A7AA-44CB-8F38-8E64632FB103
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd7072290 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-8l2buj.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd81010c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd80fad88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd922e3c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "74ae4687be5f0897ea0e3af4033ec979f9cb4103" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-8l2buj.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4E6E1976-6151-4511-9E88-F9401AC618D3
DEBUG winrmshell: [WinRM] creating command_id: 4E6E1976-6151-4511-9E88-F9401AC618D3 on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4E6E1976-6151-4511-9E88-F9401AC618D3 on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","74ae4687be5f0897ea0e3af4033ec979f9cb4103","299638e78893f8011af9474087001dd60f0e0bcc","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-8l2buj.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0E9D682A-A5F6-4453-A1AD-8BC9297D9750
DEBUG winrmshell: [WinRM] creating command_id: 0E9D682A-A5F6-4453-A1AD-8BC9297D9750 on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0E9D682A-A5F6-4453-A1AD-8BC9297D9750 on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBhIGhhbmRmdWwgb2YgU3lzSW50ZXJuYWxzIHRvb2xzIG9uIHRoZSBob3N0IGludG8gYzpcVG9vbHNcU3lzaW50ZXJuYWxzCiMgQWxzbyBpbnN0YWxscyBTeXNtb24gYW5kIE9sYWYgSGFydG9uJ3MgU3lzbW9uIGNvbmZpZwoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgU3lzSW50ZXJuYWxzIFRvb2xpbmcuLi4iCiRzeXNpbnRlcm5hbHNEaXIgPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzIgokc3lzbW9uRGlyID0gIkM6XFByb2dyYW1EYXRhXFN5c21vbiIKSWYoISh0ZXN0LXBhdGggJHN5c2ludGVybmFsc0RpcikpIHsKICBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZSAtUGF0aCAkc3lzaW50ZXJuYWxzRGlyCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFRvb2xzIGRpcmVjdG9yeSBleGlzdHMsIG5vIG5lZWQgdG8gcmUtaW5zdGFsbC4gRXhpdGluZy4iCiAgZXhpdAp9CgpJZighKHRlc3QtcGF0aCAkc3lzbW9uRGlyKSkgewogIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRzeXNtb25EaXIKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3lzbW9uIGRpcmVjdG9yeSBleGlzdHMsIG5vIG5lZWQgdG8gcmUtaW5zdGFsbC4gRXhpdGluZy4iCiAgZXhpdAp9CgokYXV0b3J1bnNQYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xBdXRvcnVuczY0LmV4ZSIKJHByb2Ntb25QYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xQcm9jbW9uLmV4ZSIKJHBzZXhlY1BhdGggPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzXFBzRXhlYzY0LmV4ZSIKJHByb2NleHBQYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xwcm9jZXhwNjQuZXhlIgokc3lzbW9uUGF0aCA9ICJDOlxUb29sc1xTeXNpbnRlcm5hbHNcU3lzbW9uNjQuZXhlIgokc2RlbGV0ZVBhdGggPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzXFNkZWxldGU2NC5leGUiCiR0Y3B2aWV3UGF0aCA9ICJDOlxUb29sc1xTeXNpbnRlcm5hbHNcVGNwdmlldy5leGUiCiRzeXNtb25Db25maWdQYXRoID0gIiRzeXNtb25EaXJcc3lzbW9uQ29uZmlnLnhtbCIKJHNob3J0Y3V0TG9jYXRpb24gPSAiJEVOVjpBTExVU0VSU1BST0ZJTEVcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1wiCgokV1NjcmlwdFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuU2hlbGwKCiMgTWljcm9zb2Z0IGxpa2VzIFRMU3YxLjIgYXMgd2VsbApbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBBdXRvcnVuczY0LmV4ZS4uLiIKVHJ5IHsgCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vQXV0b3J1bnM2NC5leGUnLCAkYXV0b3J1bnNQYXRoKSAKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL0F1dG9ydW5zNjQuZXhlJywgJGF1dG9ydW5zUGF0aCkgCn0KJFNob3J0Y3V0ID0gJFdTY3JpcHRTaGVsbC5DcmVhdGVTaG9ydGN1dCgkU2hvcnRjdXRMb2NhdGlvbiArICJBdXRvcnVucy5sbmsiKQokU2hvcnRjdXQuVGFyZ2V0UGF0aCA9ICRhdXRvcnVuc1BhdGgKJFNob3J0Y3V0LlNhdmUoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIFByb2Ntb24uZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9Qcm9jbW9uLmV4ZScsICRwcm9jbW9uUGF0aCkKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1Byb2Ntb24uZXhlJywgJHByb2Ntb25QYXRoKQp9CiRTaG9ydGN1dCA9ICRXU2NyaXB0U2hlbGwuQ3JlYXRlU2hvcnRjdXQoJFNob3J0Y3V0TG9jYXRpb24gKyAiUHJvY2VzcyBNb25pdG9yLmxuayIpCiRTaG9ydGN1dC5UYXJnZXRQYXRoID0gJHByb2Ntb25QYXRoCiRTaG9ydGN1dC5TYXZlKCkKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBQc0V4ZWM2NC5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1BzRXhlYzY0LmV4ZScsICRwc2V4ZWNQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vUHNFeGVjNjQuZXhlJywgJHBzZXhlY1BhdGgpCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBwcm9jZXhwNjQuZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9wcm9jZXhwNjQuZXhlJywgJHByb2NleHBQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vcHJvY2V4cDY0LmV4ZScsICRwcm9jZXhwUGF0aCkKfQokU2hvcnRjdXQgPSAkV1NjcmlwdFNoZWxsLkNyZWF0ZVNob3J0Y3V0KCRTaG9ydGN1dExvY2F0aW9uICsgIlByb2Nlc3MgRXhwbG9yZXIubG5rIikKJFNob3J0Y3V0LlRhcmdldFBhdGggPSAkcHJvY2V4cFBhdGgKJFNob3J0Y3V0LlNhdmUoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIHNkZWxldGU2NC5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL3NkZWxldGU2NC5leGUnLCAkc2RlbGV0ZVBhdGgpCn0KQ2F0Y2ggeyAKICBXcml0ZS1Ib3N0ICJIVFRQUyBjb25uZWN0aW9uIGZhaWxlZC4gU3dpdGNoaW5nIHRvIEhUVFAgOigiCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cDovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9zZGVsZXRlNjQuZXhlJywgJHNkZWxldGVQYXRoKQp9CgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgU3lzbW9uNjQuZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9TeXNtb242NC5leGUnLCAkc3lzbW9uUGF0aCkKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1N5c21vbjY0LmV4ZScsICRzeXNtb25QYXRoKQp9CkNvcHktSXRlbSAkc3lzbW9uUGF0aCAkc3lzbW9uRGlyCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgVGNwdmlldy5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1RjcHZpZXcuZXhlJywgJHRjcHZpZXdQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vVGNwdmlldy5leGUnLCAkdGNwdmlld1BhdGgpCn0KJFNob3J0Y3V0ID0gJFdTY3JpcHRTaGVsbC5DcmVhdGVTaG9ydGN1dCgkU2hvcnRjdXRMb2NhdGlvbiArICJUY3B2aWV3LmxuayIpCiRTaG9ydGN1dC5UYXJnZXRQYXRoID0gJHRjcHZpZXdQYXRoCiRTaG9ydGN1dC5TYXZlKCkKCiMgUmVzdGFydCBFeHBsb3JlciBzbyB0aGUgdGFza2JhciBzaG9ydGN1dHMgc2hvdyB1cAppZiAoR2V0LVByb2Nlc3MgLVByb2Nlc3NOYW1lIGV4cGxvcmVyIC1FcnJvckFjdGlvbiAnc2lsZW50bHljb250aW51ZScpIHsKICBTdG9wLVByb2Nlc3MgLVByb2Nlc3NOYW1lIGV4cGxvcmVyIC1Gb3JjZQp9CgojIERvd25sb2FkIE9sYWYgSGFydG9uZ3MgU3lzbW9uIGNvbmZpZwpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgT2xhZiBIYXJ0b25nJ3MgU3lzbW9uIGNvbmZpZy4uLiIKKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL29sYWZoYXJ0b25nL3N5c21vbi1tb2R1bGFyL21hc3Rlci9zeXNtb25jb25maWcueG1sJywgIiRzeXNtb25Db25maWdQYXRoIikKIyBBbHRlcm5hdGl2ZTogRG93bmxvYWQgU3dpZnRPblNlY3VyaXR5J3MgU3lzbW9uIGNvbmZpZwojIFdyaXRlLUhvc3QgIkRvd25sb2FkaW5nIFN3aWZ0T25TZWN1cml0eSdzIFN5c21vbiBjb25maWcuLi4iCiMgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1N3aWZ0T25TZWN1cml0eS9zeXNtb24tY29uZmlnL21hc3Rlci9zeXNtb25jb25maWctZXhwb3J0LnhtbCcsICIkc3lzbW9uQ29uZmlnUGF0aCIpCgojIFN0YXJ0IFN5c21vbgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3RhcnRpbmcgU3lzbW9uLi4uIgpTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAiJHN5c21vbkRpclxTeXNtb242NC5leGUiIC1Bcmd1bWVudExpc3QgIi1hY2NlcHRldWxhIC1pICRzeXNtb25Db25maWdQYXRoIgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV2FpdGluZyA1IHNlY29uZHMgdG8gZ2l2ZSB0aGUgc2VydmljZSB0aW1lIHRvIGluc3RhbGwuLi4iClN0YXJ0LVNsZWVwIDUKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFZlcmlmeWluZyB0aGF0IHRoZSBTeXNtb24gc2VydmljZSBpcyBydW5uaW5nLi4uIgoKIyBQb2xsIHRoZSBzeXNtb24gc2VydmljZSBldmVyeSA1IHNlY29uZHMgdG8gc2VlIGlmIGl0IGhhcyBzdGFydGVkICh1cCB0byAyNSBzZWNvbmRzKQokdHJpZXMgPSAxCldoaWxlICgkdHJpZXMgLWx0IDYpIHsKICBJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIFN5c21vbjY0KS5TdGF0dXMgLW5lICJSdW5uaW5nIikgewogICAgV3JpdGUtSG9zdCAiV2FpdGluZyBmb3IgdGhlIFN5c21vbiBzZXJ2aWNlIHRvIHN0YXJ0Li4uIChBdHRlbXB0ICR0cmllcyBvZiA1KSIKICAgIFN0YXJ0LVNsZWVwIDUKICAgICR0cmllcyArPSAxCiAgfSBFbHNlIHsKICAgIFdyaXRlLUhvc3QgIlRoZSBTeXNtb24gc2VydmljZSBoYXMgc3RhcnRlZCBzdWNjZXNzZnVsbHkhIgogICAgYnJlYWsKICB9Cn0KCklmICgoR2V0LVNlcnZpY2UgLW5hbWUgU3lzbW9uNjQpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgdGhyb3cgIlRoZSBTeXNtb24gc2VydmljZSBmYWlsZWQgdG8gc3RhcnQgc3VjY2Vzc2Z1bGx5Igp9CgojIE1ha2UgdGhlIGV2ZW50IGxvZyBjaGFubmVsIHJlYWRhYmxlLiBGb3Igc29tZSByZWFzb24gdGhpcyBkb2Vzbid0IHdvcmsgaW4gdGhlIEdQTyBhbmQgb25seSB3b3JrcyB3aGVuIHJ1biBtYW51YWxseS4Kd2V2dHV0aWwgc2wgTWljcm9zb2Z0LVdpbmRvd3MtU3lzbW9uL09wZXJhdGlvbmFsICIvY2E6TzpCQUc6U1lEOihBOzsweDU7OztCQSkoQTs7MHgxOzs7Uy0xLTUtMjApKEE7OzB4MTs7O1MtMS01LTMyLTU3MykiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 800235FD-B25B-4D5D-80EC-F8FF090146BB
DEBUG winrmshell: [WinRM] creating command_id: 800235FD-B25B-4D5D-80EC-F8FF090146BB on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 800235FD-B25B-4D5D-80EC-F8FF090146BB on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5654ABAB-9350-4751-AA8E-672653670550
DEBUG winrmshell: [WinRM] creating command_id: 5654ABAB-9350-4751-AA8E-672653670550 on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5654ABAB-9350-4751-AA8E-672653670550 on shell_id 14DE0184-4C85-4433-AE89-1FEA081749B6
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-8l2buj.ps1 to C:/tmp/vagrant-shell.ps1 (8.58 KB over 1 chunks) in (0m0.33s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.83s) stream_files: (0m0.33s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9306018 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9305140 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd919ec98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 675AFF12-AA19-4877-B109-F93FAC89406B
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 084BF534-74FB-4330-A135-B0AFED7D67F2
DEBUG winrmshell: [WinRM] creating command_id: 084BF534-74FB-4330-A135-B0AFED7D67F2 on shell_id 675AFF12-AA19-4877-B109-F93FAC89406B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Installing SysInternals Tooling...
 INFO interface: detail:     win10: [03:46] Installing SysInternals Tooling...
    win10: [03:46] Installing SysInternals Tooling...
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail:     Directory: C:\Tools
 INFO interface: detail:     win10:     Directory: C:\Tools
    win10:     Directory: C:\Tools
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     win10: Mode                LastWriteTime         Length Name
    win10: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     win10: ----                -------------         ------ ----
    win10: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   3:46 AM                Sysinternals
 INFO interface: detail:     win10: d-----        6/21/2022   3:46 AM                Sysinternals
    win10: d-----        6/21/2022   3:46 AM                Sysinternals
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail:     Directory: C:\ProgramData
 INFO interface: detail:     win10:     Directory: C:\ProgramData
    win10:     Directory: C:\ProgramData
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     win10: Mode                LastWriteTime         Length Name
    win10: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     win10: ----                -------------         ------ ----
    win10: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   3:46 AM                Sysmon
 INFO interface: detail:     win10: d-----        6/21/2022   3:46 AM                Sysmon
    win10: d-----        6/21/2022   3:46 AM                Sysmon
 INFO interface: detail: [03:46] Downloading Autoruns64.exe...
 INFO interface: detail:     win10: [03:46] Downloading Autoruns64.exe...
    win10: [03:46] Downloading Autoruns64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Downloading Procmon.exe...
 INFO interface: detail:     win10: [03:46] Downloading Procmon.exe...
    win10: [03:46] Downloading Procmon.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Downloading PsExec64.exe...
 INFO interface: detail:     win10: [03:46] Downloading PsExec64.exe...
    win10: [03:46] Downloading PsExec64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Downloading procexp64.exe...
 INFO interface: detail:     win10: [03:46] Downloading procexp64.exe...
    win10: [03:46] Downloading procexp64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Downloading sdelete64.exe...
 INFO interface: detail:     win10: [03:46] Downloading sdelete64.exe...
    win10: [03:46] Downloading sdelete64.exe...
 INFO interface: detail: [03:46] Downloading Sysmon64.exe...
 INFO interface: detail:     win10: [03:46] Downloading Sysmon64.exe...
    win10: [03:46] Downloading Sysmon64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Downloading Tcpview.exe...
 INFO interface: detail:     win10: [03:46] Downloading Tcpview.exe...
    win10: [03:46] Downloading Tcpview.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Downloading Olaf Hartong's Sysmon config...
 INFO interface: detail:     win10: [03:46] Downloading Olaf Hartong's Sysmon config...
    win10: [03:46] Downloading Olaf Hartong's Sysmon config...
 INFO interface: detail: [03:46] Starting Sysmon...
 INFO interface: detail:     win10: [03:46] Starting Sysmon...
    win10: [03:46] Starting Sysmon...
 INFO interface: detail: [03:46] Waiting 5 seconds to give the service time to install...
 INFO interface: detail:     win10: [03:46] Waiting 5 seconds to give the service time to install...
    win10: [03:46] Waiting 5 seconds to give the service time to install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:46] Verifying that the Sysmon service is running...
 INFO interface: detail:     win10: [03:46] Verifying that the Sysmon service is running...
    win10: [03:46] Verifying that the Sysmon service is running...
 INFO interface: detail: The Sysmon service has started successfully!
 INFO interface: detail:     win10: The Sysmon service has started successfully!
    win10: The Sysmon service has started successfully!
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 084BF534-74FB-4330-A135-B0AFED7D67F2 on shell_id 675AFF12-AA19-4877-B109-F93FAC89406B
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd90794d0 @data=[{:stdout=>"[03:46] Installing SysInternals Tooling...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Tools\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   3:46 AM                Sysinternals                                     \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\ProgramData\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   3:46 AM                Sysmon                                           \r\n"}, {:stdout=>"[03:46] Downloading Autoruns64.exe...\r\n"}, {:stdout=>"[03:46] Downloading Procmon.exe...\r\n"}, {:stdout=>"[03:46] Downloading PsExec64.exe...\r\n"}, {:stdout=>"[03:46] Downloading procexp64.exe...\r\n"}, {:stdout=>"[03:46] Downloading sdelete64.exe...\r\n"}, {:stdout=>"[03:46] Downloading Sysmon64.exe...\r\n"}, {:stdout=>"[03:46] Downloading Tcpview.exe...\r\n"}, {:stdout=>"[03:46] Downloading Olaf Hartong's Sysmon config...\r\n"}, {:stdout=>"[03:46] Starting Sysmon...\r\n"}, {:stdout=>"[03:46] Waiting 5 seconds to give the service time to install...\r\n"}, {:stdout=>"[03:46] Verifying that the Sysmon service is running...\r\n"}, {:stdout=>"The Sysmon service has started successfully!\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd86562f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd86c6938 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2221, 5986=>2220, 5985=>2216}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8F5121B2-A691-42C9-BA98-5A133B158CD1
DEBUG winrmshell: [WinRM] Command created for hostname with id: 7E93221A-D43D-4222-BCA2-630CB2C65A54
DEBUG winrmshell: [WinRM] creating command_id: 7E93221A-D43D-4222-BCA2-630CB2C65A54 on shell_id 8F5121B2-A691-42C9-BA98-5A133B158CD1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7E93221A-D43D-4222-BCA2-630CB2C65A54 on shell_id 8F5121B2-A691-42C9-BA98-5A133B158CD1
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8f0aae0 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2213, 22=>2221, 5986=>2214}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6B8B9B8F-DC60-4046-A3C1-665EC92BA8DC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 016DEC67-40D5-464D-B9A6-E7A32042528B
DEBUG winrmshell: [WinRM] creating command_id: 016DEC67-40D5-464D-B9A6-E7A32042528B on shell_id 6B8B9B8F-DC60-4046-A3C1-665EC92BA8DC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 016DEC67-40D5-464D-B9A6-E7A32042528B on shell_id 6B8B9B8F-DC60-4046-A3C1-665EC92BA8DC
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd925a6c8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 22=>2215, 5986=>2214}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 815F7C12-C81A-4EB4-B135-111EDA29C375
DEBUG winrmshell: [WinRM] Command created for hostname with id: 2A037771-51A9-4164-B655-BD03F672C5B8
DEBUG winrmshell: [WinRM] creating command_id: 2A037771-51A9-4164-B655-BD03F672C5B8 on shell_id 815F7C12-C81A-4EB4-B135-111EDA29C375
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2A037771-51A9-4164-B655-BD03F672C5B8 on shell_id 815F7C12-C81A-4EB4-B135-111EDA29C375
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd869f6f8 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd897f878 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd897e720 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86bc6b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 77B12A0E-075B-4D65-BD48-9B1A8083C246
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7E0BCA5D-DB60-4A16-AF52-F7EC20E8E1A4
DEBUG winrmshell: [WinRM] creating command_id: 7E0BCA5D-DB60-4A16-AF52-F7EC20E8E1A4 on shell_id 77B12A0E-075B-4D65-BD48-9B1A8083C246
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7E0BCA5D-DB60-4A16-AF52-F7EC20E8E1A4 on shell_id 77B12A0E-075B-4D65-BD48-9B1A8083C246
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8311518 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86bf9a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd86be968 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8330328 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 35DCBF79-17C3-4876-A434-31E5DC6D111B
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A18F2B8E-5471-4D89-87F3-A08DF7B53FA3
DEBUG winrmshell: [WinRM] creating command_id: A18F2B8E-5471-4D89-87F3-A08DF7B53FA3 on shell_id 35DCBF79-17C3-4876-A434-31E5DC6D111B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A18F2B8E-5471-4D89-87F3-A08DF7B53FA3 on shell_id 35DCBF79-17C3-4876-A434-31E5DC6D111B
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd92ff240 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-rw4dmo.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7368878 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd733a1f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91ecc18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "984c644c76a43d97a0e67d77a7ece323b8897b17" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-rw4dmo.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F49F9172-0330-4C35-BD8D-37B2D38BE52F
DEBUG winrmshell: [WinRM] creating command_id: F49F9172-0330-4C35-BD8D-37B2D38BE52F on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F49F9172-0330-4C35-BD8D-37B2D38BE52F on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","984c644c76a43d97a0e67d77a7ece323b8897b17","74ae4687be5f0897ea0e3af4033ec979f9cb4103","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-rw4dmo.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D24CB408-D5C0-4A8D-A800-EC12CFCF8BB3
DEBUG winrmshell: [WinRM] creating command_id: D24CB408-D5C0-4A8D-A800-EC12CFCF8BB3 on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D24CB408-D5C0-4A8D-A800-EC12CFCF8BB3 on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyB2ZWxvY2lyYXB0b3Igb24gdGhlIGhvc3QKCnBhcmFtICgKICBbc3dpdGNoXSRVcGRhdGUKKQoKIyBBZGQgYSBob3N0cyBlbnRyeSB0byBhdm9pZCBETlMgaXNzdWVzCklmIChTZWxlY3QtU3RyaW5nIC1QYXRoICJjOlx3aW5kb3dzXHN5c3RlbTMyXGRyaXZlcnNcZXRjXGhvc3RzIiAtUGF0dGVybiAibG9nZ2VyIikgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBIb3N0cyBmaWxlIGFscmVhZHkgdXBkYXRlZC4gTW92aW5nIG9uLiIKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQWRkaW5nIGxvZ2dlciB0byB0aGUgaG9zdHMgZmlsZSIKICBBZGQtQ29udGVudCAiYzpcd2luZG93c1xzeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cyIgIiAgICAgICAgMTkyLjE2OC41Ni4xMDUgICAgbG9nZ2VyIgp9CgojIERvd25sb2FkcyBhbmQgaW5zdGFsbCB0aGUgbGF0ZXN0IFZlbG9jaXJhcHRvciByZWxlYXNlCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEZXRlcm1pbmluZyBsYXRlc3QgcmVsZWFzZSBvZiBWZWxvY2lyYXB0b3IuLi4iCiMgR2l0SHViIHJlcXVpcmVzIFRMUyAxLjIgYXMgb2YgMi8yNwpbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCiMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKJHZlbG9jaXJhcHRvckRvd25sb2FkVXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbSIgKyAoKEludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2dpdGh1Yi5jb20vVmVsb2NpZGV4L3ZlbG9jaXJhcHRvci9yZWxlYXNlcy9sYXRlc3QiIC1Vc2VCYXNpY1BhcnNpbmcpLmxpbmtzIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgaHJlZiB8IFNlbGVjdC1TdHJpbmcgIndpbmRvd3MtYW1kNjQubXNpJCIgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxKQokdmVsb2NpcmFwdG9yTVNJUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx2ZWxvY2lyYXB0b3IubXNpJwokdmVsb2NpcmFwdG9yTG9nRmlsZSA9ICdjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx2ZWxvY2lyYXB0b3JfaW5zdGFsbC5sb2cnCklmICgtbm90KFRlc3QtUGF0aCAkdmVsb2NpcmFwdG9yTG9nRmlsZSkgLW9yICgkVXBkYXRlIC1lcSAkdHJ1ZSkpIHsKICBpZiAoJFVwZGF0ZSAtZXEgJHRydWUpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBUaGUgdXBkYXRlIGZsYWcgd2FzIHNldC4gQXR0ZW1wdGluZyB0byB1cGRhdGUuLi4iCiAgfQogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBWZWxvY2lyYXB0b3IuLi4iCiAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJHZlbG9jaXJhcHRvckRvd25sb2FkVXJsIiAtT3V0RmlsZSAkdmVsb2NpcmFwdG9yTVNJUGF0aAogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIFZlbG9jaXJhcHRvci4uLiIKICBTdGFydC1Qcm9jZXNzIEM6XFdpbmRvd3NcU3lzdGVtMzJcbXNpZXhlYy5leGUgLUFyZ3VtZW50TGlzdCAiL2kgJHZlbG9jaXJhcHRvck1TSVBhdGggL3F1aWV0IC9xbiAvbm9yZXN0YXJ0IC9sb2cgJHZlbG9jaXJhcHRvckxvZ0ZpbGUiIC13YWl0CiAgQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1x2ZWxvY2lyYXB0b3JcVmVsb2NpcmFwdG9yLmNvbmZpZy55YW1sIiAiQzpcUHJvZ3JhbSBGaWxlc1xWZWxvY2lyYXB0b3IiCiAgUmVzdGFydC1TZXJ2aWNlIFZlbG9jaXJhcHRvcgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBWZWxvY2lyYXB0b3Igc3VjY2Vzc2Z1bGx5IGluc3RhbGxlZCEiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFZlbG9jaXJhcHRvciB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KSWYgKChHZXQtU2VydmljZSAtbmFtZSBWZWxvY2lyYXB0b3IpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgVGhyb3cgIlZlbG9jaXJhcHRvciBzZXJ2aWNlIGlzIG5vdCBydW5uaW5nIgp9CgoK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8A3F3FDC-E718-45F3-906D-69B7897BC18C
DEBUG winrmshell: [WinRM] creating command_id: 8A3F3FDC-E718-45F3-906D-69B7897BC18C on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8A3F3FDC-E718-45F3-906D-69B7897BC18C on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1D4C782A-CF1A-493D-A0D0-126F1A011116
DEBUG winrmshell: [WinRM] creating command_id: 1D4C782A-CF1A-493D-A0D0-126F1A011116 on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1D4C782A-CF1A-493D-A0D0-126F1A011116 on shell_id A604447F-195D-4411-9862-2E5C4F62C1BD
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-rw4dmo.ps1 to C:/tmp/vagrant-shell.ps1 (3.044 KB over 1 chunks) in (0m0.35s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m1.23s) stream_files: (0m0.35s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91cfde8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91cecb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90a3eb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F77E066E-7738-4001-BA6F-547DBB788C97
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5D82ED7A-FD82-450A-B378-254E2AE34930
DEBUG winrmshell: [WinRM] creating command_id: 5D82ED7A-FD82-450A-B378-254E2AE34930 on shell_id F77E066E-7738-4001-BA6F-547DBB788C97
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:47] Adding logger to the hosts file
 INFO interface: detail:     win10: [03:47] Adding logger to the hosts file
    win10: [03:47] Adding logger to the hosts file
 INFO interface: detail: [03:47] Determining latest release of Velociraptor...
 INFO interface: detail:     win10: [03:47] Determining latest release of Velociraptor...
    win10: [03:47] Determining latest release of Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:47] Downloading Velociraptor...
 INFO interface: detail:     win10: [03:47] Downloading Velociraptor...
    win10: [03:47] Downloading Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:47] Installing Velociraptor...
 INFO interface: detail:     win10: [03:47] Installing Velociraptor...
    win10: [03:47] Installing Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:47] Velociraptor successfully installed!
 INFO interface: detail:     win10: [03:47] Velociraptor successfully installed!
    win10: [03:47] Velociraptor successfully installed!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5D82ED7A-FD82-450A-B378-254E2AE34930 on shell_id F77E066E-7738-4001-BA6F-547DBB788C97
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8ea1810 @data=[{:stdout=>"[03:47] Adding logger to the hosts file\r\n"}, {:stdout=>"[03:47] Determining latest release of Velociraptor...\r\n"}, {:stdout=>"[03:47] Downloading Velociraptor...\r\n"}, {:stdout=>"[03:47] Installing Velociraptor...\r\n"}, {:stdout=>"[03:47] Velociraptor successfully installed!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd86c6938 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd913de20 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2216, 22=>2221, 5986=>2214}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 90AD2BD3-F8D2-4E1C-B3CD-6F4800DDFDDC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5C9D30FA-3FCE-4FDE-B635-C879057E2F1E
DEBUG winrmshell: [WinRM] creating command_id: 5C9D30FA-3FCE-4FDE-B635-C879057E2F1E on shell_id 90AD2BD3-F8D2-4E1C-B3CD-6F4800DDFDDC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5C9D30FA-3FCE-4FDE-B635-C879057E2F1E on shell_id 90AD2BD3-F8D2-4E1C-B3CD-6F4800DDFDDC
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8a2d860 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 5986=>2220, 22=>2221}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EC122D06-C7BF-49B0-9246-7FDB1EE6B84F
DEBUG winrmshell: [WinRM] Command created for hostname with id: 554909A2-945C-46B0-9457-53C4190FAB2B
DEBUG winrmshell: [WinRM] creating command_id: 554909A2-945C-46B0-9457-53C4190FAB2B on shell_id EC122D06-C7BF-49B0-9246-7FDB1EE6B84F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 554909A2-945C-46B0-9457-53C4190FAB2B on shell_id EC122D06-C7BF-49B0-9246-7FDB1EE6B84F
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d7fa68 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 5986=>2220, 22=>2221}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5F2B4673-6C85-48FC-ACCC-85D8D26701AA
DEBUG winrmshell: [WinRM] Command created for hostname with id: BB170571-880C-4EC9-8EAE-FACCCADF3983
DEBUG winrmshell: [WinRM] creating command_id: BB170571-880C-4EC9-8EAE-FACCCADF3983 on shell_id 5F2B4673-6C85-48FC-ACCC-85D8D26701AA
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BB170571-880C-4EC9-8EAE-FACCCADF3983 on shell_id 5F2B4673-6C85-48FC-ACCC-85D8D26701AA
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd9098218 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91c8db8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd91c3bb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90934e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2D7935F3-8967-48DD-B5DE-27031B5ABD67
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 81B9A03A-73BD-4890-94A9-DB8223B9F713
DEBUG winrmshell: [WinRM] creating command_id: 81B9A03A-73BD-4890-94A9-DB8223B9F713 on shell_id 2D7935F3-8967-48DD-B5DE-27031B5ABD67
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 81B9A03A-73BD-4890-94A9-DB8223B9F713 on shell_id 2D7935F3-8967-48DD-B5DE-27031B5ABD67
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8e8b1f0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd907b5a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9078f58 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e7b430 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DD165B06-5298-4DD5-8085-A10D3B1B1FC8
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 13AB8422-A471-4EA9-9266-6E5F11698405
DEBUG winrmshell: [WinRM] creating command_id: 13AB8422-A471-4EA9-9266-6E5F11698405 on shell_id DD165B06-5298-4DD5-8085-A10D3B1B1FC8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 13AB8422-A471-4EA9-9266-6E5F11698405 on shell_id DD165B06-5298-4DD5-8085-A10D3B1B1FC8
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d5a5d8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1x0zgb3.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d7c8b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8d779d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8c65d08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "04b00952985c8555d76eb259f2adab5966222b80" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-1x0zgb3.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 84F9B812-25EA-4A35-92A8-F741FAE7848F
DEBUG winrmshell: [WinRM] creating command_id: 84F9B812-25EA-4A35-92A8-F741FAE7848F on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 84F9B812-25EA-4A35-92A8-F741FAE7848F on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","04b00952985c8555d76eb259f2adab5966222b80","984c644c76a43d97a0e67d77a7ece323b8897b17","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1x0zgb3.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: EDB70EE0-A960-4974-9B3E-EE4003B38B30
DEBUG winrmshell: [WinRM] creating command_id: EDB70EE0-A960-4974-9B3E-EE4003B38B30 on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EDB70EE0-A960-4974-9B3E-EE4003B38B30 on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBBdXRvcnVuc1RvV2luRXZlbnRMb2cgZnJvbSB0aGUgUGFsYW50aXIgV0VGIHJlcG86IChodHRwczovL2dpdGh1Yi5jb20vcGFsYW50aXIvd2luZG93cy1ldmVudC1mb3J3YXJkaW5nL3RyZWUvbWFzdGVyL0F1dG9ydW5zVG9XaW5FdmVudExvZykKIyBUTDtEUiAtIExvZ3MgYWxsIGVudHJpZXMgZnJvbSBBdXRvcnVucyB0byB0aGUgV2luZG93cyBldmVudCBsb2cgdG8gYmUgaW5kZXhlZCBieSBTcGx1bmsKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQXV0b3J1bnNUb1dpbkV2ZW50TG9nLi4uIgpJZiAoKEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIiAtZWEgc2lsZW50KSAtZXEgJG51bGwpCnsKICAgICMgTW9kaWZ5IHRoZSBpbnN0YWxsZXIgdG8gYWRkIGFuIEhUVFAgZmFsbGJhY2sgdW50aWwgdGhpcyBnZXRzIGZpeGVkIHVwc3RyZWFtIGluIHRoZSB3aW5kb3dzLWV2ZW50LWZvd2FyZGluZyByZXBvCiAgICAjIFNlZSBodHRwczovL2dpdGh1Yi5jb20vY2xvbmcvRGV0ZWN0aW9uTGFiL2lzc3Vlcy81OTcKICAgIChHZXQtQ29udGVudCBjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3aW5kb3dzLWV2ZW50LWZvcndhcmRpbmctbWFzdGVyXEF1dG9ydW5zVG9XaW5FdmVudExvZ1xJbnN0YWxsLnBzMSAtUmF3KSAtcmVwbGFjZSAnSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vYXV0b3J1bnNjNjQuZXhlIiAtT3V0RmlsZSAiXCRhdXRvcnVuc1BhdGgiJywgJ1RyeSB7CiAgICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCcnaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vQXV0b3J1bnM2NC5leGUnJywgJGF1dG9ydW5zUGF0aCkKICB9IENhdGNoIHsKICAgIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAgIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJydodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL0F1dG9ydW5zNjQuZXhlJycsICRhdXRvcnVuc1BhdGgpCiAgfScgfCBTZXQtQ29udGVudCAtUGF0aCAiYzpcVXNlcnNcdmFncmFudFxBcHBEYXRhXExvY2FsXFRlbXBcd2luZG93cy1ldmVudC1mb3J3YXJkaW5nLW1hc3RlclxBdXRvcnVuc1RvV2luRXZlbnRMb2dcSW5zdGFsbC5wczEiCiAgICAuIGM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHdpbmRvd3MtZXZlbnQtZm9yd2FyZGluZy1tYXN0ZXJcQXV0b3J1bnNUb1dpbkV2ZW50TG9nXEluc3RhbGwucHMxCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQXV0b3J1bnNUb1dpbkV2ZW50TG9nIGluc3RhbGxlZC4gU3RhcnRpbmcgdGhlIHNjaGVkdWxlZCB0YXNrLiBGdXR1cmUgcnVucyB3aWxsIGJlZ2luIGF0IDExYW0iCiAgICBTdGFydC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIgogICAgIyBodHRwczovL21jcG1hZy5jb20vYXJ0aWNsZXMvMjAxOC8wMy8xNi93YWl0LWFjdGlvbi1mdW5jdGlvbi1wb3dlcnNoZWxsLmFzcHgKICAgICMgV2FpdCAzMCBzZWNvbmRzIGZvciB0aGUgc2NoZWR1bGVkIHRhc2sgdG8gZW50ZXIgdGhlICJSdW5uaW5nIiBzdGF0ZQogICAgJFRpbWVvdXQgPSAzMAogICAgJHRpbWVyID0gW0RpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkKICAgIHdoaWxlICgoJHRpbWVyLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1sdCAkVGltZW91dCkgLWFuZCAoKEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIikuU3RhdGUgLW5lICJSdW5uaW5nIikpIHsKICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAzCiAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFN0aWxsIHdhaXRpbmcgZm9yIHNjaGVkdWxlZCB0YXNrIHRvIHN0YXJ0IGFmdGVyICIkdGltZXIuRWxhcHNlZC5TZWNvbmRzIiBzZWNvbmRzLi4uIgogICAgfQogICAgJHRpbWVyLlN0b3AoKQogICAgJFRzayA9IEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIgogICAgaWYgKCRUc2suU3RhdGUgLW5lICJSdW5uaW5nIikKICAgIHsKICAgICAgICB0aHJvdyAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIHNjaGVkdWxlZCB0YXNrcyB3YXNuJ3QgcnVubmluZyBhZnRlciBzdGFydGluZyBpdCIKICAgIH0KfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBBdXRvcnVuc1RvV2luRXZlbnRMb2cgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 51956688-1943-415E-ADFB-60EF9BA7A6BD
DEBUG winrmshell: [WinRM] creating command_id: 51956688-1943-415E-ADFB-60EF9BA7A6BD on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 51956688-1943-415E-ADFB-60EF9BA7A6BD on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7CA36E3D-DF4B-4854-8DB7-04E33AED6819
DEBUG winrmshell: [WinRM] creating command_id: 7CA36E3D-DF4B-4854-8DB7-04E33AED6819 on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7CA36E3D-DF4B-4854-8DB7-04E33AED6819 on shell_id 3844C672-D7E9-4361-8C57-8FD3E5D504D3
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-1x0zgb3.ps1 to C:/tmp/vagrant-shell.ps1 (3.24 KB over 1 chunks) in (0m0.35s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m1.07s) stream_files: (0m0.35s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     win10: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
    win10: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b80c30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8b3ba40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd89a7f80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6039A1DE-54EA-4E74-A3DC-95B678FBD147
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B3BFF5B8-2A7D-4167-9A61-EB7DB6BA0B33
DEBUG winrmshell: [WinRM] creating command_id: B3BFF5B8-2A7D-4167-9A61-EB7DB6BA0B33 on shell_id 6039A1DE-54EA-4E74-A3DC-95B678FBD147
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:47] Installing AutorunsToWinEventLog...
 INFO interface: detail:     win10: [03:47] Installing AutorunsToWinEventLog...
    win10: [03:47] Installing AutorunsToWinEventLog...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail:     Directory: C:\Program Files
 INFO interface: detail:     win10:     Directory: C:\Program Files
    win10:     Directory: C:\Program Files
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     win10: Mode                LastWriteTime         Length Name
    win10: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     win10: ----                -------------         ------ ----
    win10: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   3:47 AM                AutorunsToWinEventLog
 INFO interface: detail:     win10: d-----        6/21/2022   3:47 AM                AutorunsToWinEventLog
    win10: d-----        6/21/2022   3:47 AM                AutorunsToWinEventLog
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail:     win10: Actions            : {MSFT_TaskExecAction}
    win10: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail: Author             :
 INFO interface: detail:     win10: Author             :
    win10: Author             :
 INFO interface: detail: Date               :
 INFO interface: detail:     win10: Date               :
    win10: Date               :
 INFO interface: detail: Description        :
 INFO interface: detail:     win10: Description        :
    win10: Description        :
 INFO interface: detail: Documentation      :
 INFO interface: detail:     win10: Documentation      :
    win10: Documentation      :
 INFO interface: detail: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail:     win10: Principal          : MSFT_TaskPrincipal2
    win10: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail: SecurityDescriptor :
 INFO interface: detail:     win10: SecurityDescriptor :
    win10: SecurityDescriptor :
 INFO interface: detail: Settings           : MSFT_TaskSettings3
 INFO interface: detail:     win10: Settings           : MSFT_TaskSettings3
    win10: Settings           : MSFT_TaskSettings3
 INFO interface: detail: Source             :
 INFO interface: detail:     win10: Source             :
    win10: Source             :
 INFO interface: detail: State              : Ready
 INFO interface: detail:     win10: State              : Ready
    win10: State              : Ready
 INFO interface: detail: TaskName           : AutorunsToWinEventLog
 INFO interface: detail:     win10: TaskName           : AutorunsToWinEventLog
    win10: TaskName           : AutorunsToWinEventLog
 INFO interface: detail: TaskPath           : \
 INFO interface: detail:     win10: TaskPath           : \
    win10: TaskPath           : \
 INFO interface: detail: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail:     win10: Triggers           : {MSFT_TaskDailyTrigger}
    win10: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail: URI                : \AutorunsToWinEventLog
 INFO interface: detail:     win10: URI                : \AutorunsToWinEventLog
    win10: URI                : \AutorunsToWinEventLog
 INFO interface: detail: Version            :
 INFO interface: detail:     win10: Version            :
    win10: Version            :
 INFO interface: detail: PSComputerName     :
 INFO interface: detail:     win10: PSComputerName     :
    win10: PSComputerName     :
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail:     win10: Actions            : {MSFT_TaskExecAction}
    win10: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail: Author             :
 INFO interface: detail:     win10: Author             :
    win10: Author             :
 INFO interface: detail: Date               :
 INFO interface: detail:     win10: Date               :
    win10: Date               :
 INFO interface: detail: Description        :
 INFO interface: detail:     win10: Description        :
    win10: Description        :
 INFO interface: detail: Documentation      :
 INFO interface: detail:     win10: Documentation      :
    win10: Documentation      :
 INFO interface: detail: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail:     win10: Principal          : MSFT_TaskPrincipal2
    win10: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail: SecurityDescriptor :
 INFO interface: detail:     win10: SecurityDescriptor :
    win10: SecurityDescriptor :
 INFO interface: detail: Settings           : MSFT_TaskSettings3
 INFO interface: detail:     win10: Settings           : MSFT_TaskSettings3
    win10: Settings           : MSFT_TaskSettings3
 INFO interface: detail: Source             :
 INFO interface: detail:     win10: Source             :
    win10: Source             :
 INFO interface: detail: State              : Ready
 INFO interface: detail:     win10: State              : Ready
    win10: State              : Ready
 INFO interface: detail: TaskName           : AutorunsToWinEventLog
 INFO interface: detail:     win10: TaskName           : AutorunsToWinEventLog
    win10: TaskName           : AutorunsToWinEventLog
 INFO interface: detail: TaskPath           : \
 INFO interface: detail:     win10: TaskPath           : \
    win10: TaskPath           : \
 INFO interface: detail: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail:     win10: Triggers           : {MSFT_TaskDailyTrigger}
    win10: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail: URI                : \AutorunsToWinEventLog
 INFO interface: detail:     win10: URI                : \AutorunsToWinEventLog
    win10: URI                : \AutorunsToWinEventLog
 INFO interface: detail: Version            :
 INFO interface: detail:     win10: Version            :
    win10: Version            :
 INFO interface: detail: PSComputerName     :
 INFO interface: detail:     win10: PSComputerName     :
    win10: PSComputerName     :
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: [03:47] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
 INFO interface: detail:     win10: [03:47] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
    win10: [03:47] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
 INFO interface: detail: 
 INFO interface: detail:     win10: 
    win10: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B3BFF5B8-2A7D-4167-9A61-EB7DB6BA0B33 on shell_id 6039A1DE-54EA-4E74-A3DC-95B678FBD147
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd88c4618 @data=[{:stdout=>"[03:47] Installing AutorunsToWinEventLog...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Program Files\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   3:47 AM                AutorunsToWinEventLog                            \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Actions            : {MSFT_TaskExecAction}\r\n"}, {:stdout=>"Author             : \r\n"}, {:stdout=>"Date               : \r\n"}, {:stdout=>"Description        : \r\n"}, {:stdout=>"Documentation      : \r\n"}, {:stdout=>"Principal          : MSFT_TaskPrincipal2\r\n"}, {:stdout=>"SecurityDescriptor : \r\n"}, {:stdout=>"Settings           : MSFT_TaskSettings3\r\n"}, {:stdout=>"Source             : \r\n"}, {:stdout=>"State              : Ready\r\n"}, {:stdout=>"TaskName           : AutorunsToWinEventLog\r\n"}, {:stdout=>"TaskPath           : \\\r\n"}, {:stdout=>"Triggers           : {MSFT_TaskDailyTrigger}\r\n"}, {:stdout=>"URI                : \\AutorunsToWinEventLog\r\n"}, {:stdout=>"Version            : \r\n"}, {:stdout=>"PSComputerName     : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Actions            : {MSFT_TaskExecAction}\r\n"}, {:stdout=>"Author             : \r\n"}, {:stdout=>"Date               : \r\n"}, {:stdout=>"Description        : \r\n"}, {:stdout=>"Documentation      : \r\n"}, {:stdout=>"Principal          : MSFT_TaskPrincipal2\r\n"}, {:stdout=>"SecurityDescriptor : \r\n"}, {:stdout=>"Settings           : MSFT_TaskSettings3\r\n"}, {:stdout=>"Source             : \r\n"}, {:stdout=>"State              : Ready\r\n"}, {:stdout=>"TaskName           : AutorunsToWinEventLog\r\n"}, {:stdout=>"TaskPath           : \\\r\n"}, {:stdout=>"Triggers           : {MSFT_TaskDailyTrigger}\r\n"}, {:stdout=>"URI                : \\AutorunsToWinEventLog\r\n"}, {:stdout=>"Version            : \r\n"}, {:stdout=>"PSComputerName     : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[03:47] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd913de20 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> win10: Running provisioner: shell...
==> win10: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000001efd9093308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31998
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 22=>2215, 5986=>2220}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8422F8C2-3169-4413-B56B-BC8245D6DEEB
DEBUG winrmshell: [WinRM] Command created for hostname with id: D13B82C0-E766-443A-A5D9-730072AE8D14
DEBUG winrmshell: [WinRM] creating command_id: D13B82C0-E766-443A-A5D9-730072AE8D14 on shell_id 8422F8C2-3169-4413-B56B-BC8245D6DEEB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D13B82C0-E766-443A-A5D9-730072AE8D14 on shell_id 8422F8C2-3169-4413-B56B-BC8245D6DEEB
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd896f838 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{5985=>2219, 22=>2215, 5986=>2217}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6D6980E0-0E81-44F9-A190-3ABEE3FAF0E8
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0FBD7615-A802-4648-A6EE-62137156F40B
DEBUG winrmshell: [WinRM] creating command_id: 0FBD7615-A802-4648-A6EE-62137156F40B on shell_id 6D6980E0-0E81-44F9-A190-3ABEE3FAF0E8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0FBD7615-A802-4648-A6EE-62137156F40B on shell_id 6D6980E0-0E81-44F9-A190-3ABEE3FAF0E8
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8c87b10 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = win10.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = windows_10.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win10\1.8\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='18363' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='18363.418' prettyName='Windows 10 Enterprise, 64-bit (Build 18363.418)'
DEBUG vmware_driver:   - guestos = windows9-64
DEBUG vmware_driver:   - guestos.detailed.data = 
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = windows_10.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Dyw7Hz4bOzAeNy8KDTY5HQ8OJyUNJy8XBjw/LCcvETY+OT4XKyIlFy0/FzQbIx07DR0bFzo9Jxw1FSY8KhsuPR8XOjEdDSsrEzY5Pik9Fjs8MjsbKS8KDzwuFRw8Jz4vLj41OzIVEwwoNSwZOxY/Pik9FiscMxM7GjYNNhc4DzU=
DEBUG vmware_driver:   - remotedisplay.vnc.password = Upk2o9go
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5963
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 69 b7 a3 88 f0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 6
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - uuid.location = 56 4d 96 d9 b7 a3 88 f8-a4 4a de f7 0b fb 4b c4
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -212327770261140810
DEBUG vmware_driver:   - vm.genidx = 6892556021860232927
DEBUG vmware_driver:   - vmci0.id = 1861462630
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:fb:4b:c4
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:fb:4b:ce
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:fb:4b:c4
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:fb:4b:c4' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:fb:4b:c4 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.132: {:tcp=>{22=>2221, 5985=>2213, 5986=>2220}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: win10 (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2219
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 905CF306-8D2B-42BC-B54C-E1FB60C1E8C2
DEBUG winrmshell: [WinRM] Command created for hostname with id: 196AEE6F-E5F5-4501-B153-A025C26230E4
DEBUG winrmshell: [WinRM] creating command_id: 196AEE6F-E5F5-4501-B153-A025C26230E4 on shell_id 905CF306-8D2B-42BC-B54C-E1FB60C1E8C2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 196AEE6F-E5F5-4501-B153-A025C26230E4 on shell_id 905CF306-8D2B-42BC-B54C-E1FB60C1E8C2
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8ea0b68 @data=[{:stdout=>"win10"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9083660 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd90824e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8e80de0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1D1CCCCD-3603-4D42-A4C2-0EA7B57B7E78
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0C021D8B-8F0B-4110-858D-423D1D094C17
DEBUG winrmshell: [WinRM] creating command_id: 0C021D8B-8F0B-4110-858D-423D1D094C17 on shell_id 1D1CCCCD-3603-4D42-A4C2-0EA7B57B7E78
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0C021D8B-8F0B-4110-858D-423D1D094C17 on shell_id 1D1CCCCD-3603-4D42-A4C2-0EA7B57B7E78
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd8d5b320 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7e553a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd7e544f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd83783f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4DB21624-1F68-454D-9A1C-55CFC1BEA41A
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 30CAAF10-FFCD-4D55-863B-C82992574CC7
DEBUG winrmshell: [WinRM] creating command_id: 30CAAF10-FFCD-4D55-863B-C82992574CC7 on shell_id 4DB21624-1F68-454D-9A1C-55CFC1BEA41A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 30CAAF10-FFCD-4D55-863B-C82992574CC7 on shell_id 4DB21624-1F68-454D-9A1C-55CFC1BEA41A
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd83b03e8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-9l1hgm to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8ce7d80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8ce5c60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd8ba1250 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "3ba33413fc46e8f8e4b61f0091f1e1c2dbd36820" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-13028-9l1hgm";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B4D77B61-2261-4CAC-BB99-C1FE19246437
DEBUG winrmshell: [WinRM] creating command_id: B4D77B61-2261-4CAC-BB99-C1FE19246437 on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B4D77B61-2261-4CAC-BB99-C1FE19246437 on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","3ba33413fc46e8f8e4b61f0091f1e1c2dbd36820","04b00952985c8555d76eb259f2adab5966222b80","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-9l1hgm to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7FF81AC5-BB3E-4130-B1A3-64A3954F12A7
DEBUG winrmshell: [WinRM] creating command_id: 7FF81AC5-BB3E-4130-B1A3-64A3954F12A7 on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7FF81AC5-BB3E-4130-B1A3-64A3954F12A7 on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('V3JpdGUtSG9zdCAnV2luMTAgUHJvdmlzaW9uaW5nIENvbXBsZXRlISc=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 59B1A497-78A9-43F8-85FD-0BC80D7264B9
DEBUG winrmshell: [WinRM] creating command_id: 59B1A497-78A9-43F8-85FD-0BC80D7264B9 on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 59B1A497-78A9-43F8-85FD-0BC80D7264B9 on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5D20CEDB-C7DB-4200-B3CB-586AE5318FBB
DEBUG winrmshell: [WinRM] creating command_id: 5D20CEDB-C7DB-4200-B3CB-586AE5318FBB on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5D20CEDB-C7DB-4200-B3CB-586AE5318FBB on shell_id 694533E6-41CA-4014-A1DF-4C7911368EA4
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-13028-9l1hgm to C:/tmp/vagrant-shell.ps1 (0.052 KB over 1 chunks) in (0m0.24s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.89s) stream_files: (0m0.24s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     win10: Running: inline PowerShell script
    win10: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2219/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd73b4818 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd73acc30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.18362.145</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.18362.145</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.18362.145</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000001efd9224618 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3CBA6C94-618B-4335-A245-CAD01F0E5BE5
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B960B69E-180A-4C20-BE68-4C0D93A2B38E
DEBUG winrmshell: [WinRM] creating command_id: B960B69E-180A-4C20-BE68-4C0D93A2B38E on shell_id 3CBA6C94-618B-4335-A245-CAD01F0E5BE5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Win10 Provisioning Complete!
 INFO interface: detail:     win10: Win10 Provisioning Complete!
    win10: Win10 Provisioning Complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B960B69E-180A-4C20-BE68-4C0D93A2B38E on shell_id 3CBA6C94-618B-4335-A245-CAD01F0E5BE5
DEBUG winrmshell: Output: #<WinRM::Output:0x000001efd913db78 @data=[{:stdout=>"Win10 Provisioning Complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000001efd9093308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Provision:0x000001efd82f0660>
 INFO warden: Calling OUT action: #<Proc:0x000001efd89242e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd736bca8>
 INFO warden: Calling OUT action: VMware Middleware: PruneForwardedPorts
 INFO warden: Calling OUT action: VMware Middleware: CheckExistingNetwork
 INFO warden: Calling OUT action: #<Proc:0x000001efd70cc948 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd83709f0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x000001efd8339950>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000001efd7f40290 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000001efd8372340 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000001efd82c0b18 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd7f40308>
 INFO warden: Calling OUT action: VMware Middleware: DiscardSuspendedState
 INFO warden: Calling OUT action: #<Proc:0x000001efd74ca9f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd830b118>
 INFO warden: Calling OUT action: VMware Middleware: CheckVMware
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::ConfigValidate:0x000001efd82f0110>
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: #<Proc:0x000001efd8419be0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000001efd7f3df68>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO interface: Machine: action ["reload", "end", {:target=>:win10}]
 INFO environment: Released process lock: machine-action-214247f541928e3ff1900db7ca1788f7
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 4

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\win10\vmware_desktop\605be27b-5823-4a72-8c1b-b76fa4cbf6a0\windows_10.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO environment: Running hook: environment_unload
 INFO runner: Running action: environment_unload #<Vagrant::Action::Builder:0x000001efd8ba3f50>
