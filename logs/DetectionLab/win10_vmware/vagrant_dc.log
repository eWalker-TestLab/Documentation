 INFO global: Vagrant version: 2.2.19
 INFO global: Ruby version: 2.7.4
 INFO global: RubyGems version: 3.1.6
 INFO global: VAGRANT_EXECUTABLE="C:\\Program_Files\\HashiCorp\\Vagrant\\embedded\\gems\\2.2.19\\gems\\vagrant-2.2.19\\bin\\vagrant"
 INFO global: VAGRANT_INSTALLER_EMBEDDED_DIR="C:\\Program_Files\\HashiCorp\\Vagrant\\embedded"
 INFO global: VAGRANT_INSTALLER_ENV="1"
 INFO global: VAGRANT_INSTALLER_VERSION="2"
 INFO global: VAGRANT_LOG="debug"
 WARN global: resolv replacement has not been enabled!
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/autocomplete/plugin.rb
 INFO manager: Registered plugin: autocomplete command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/box/plugin.rb
 INFO manager: Registered plugin: box command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/cap/plugin.rb
 INFO manager: Registered plugin: cap command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/cloud/plugin.rb
 INFO manager: Registered plugin: vagrant-cloud
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/destroy/plugin.rb
 INFO manager: Registered plugin: destroy command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/global-status/plugin.rb
 INFO manager: Registered plugin: global-status command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/halt/plugin.rb
 INFO manager: Registered plugin: halt command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/help/plugin.rb
 INFO manager: Registered plugin: help command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/init/plugin.rb
 INFO manager: Registered plugin: init command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/list-commands/plugin.rb
 INFO manager: Registered plugin: list-commands command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/login/plugin.rb
 INFO manager: Registered plugin: vagrant-login
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/package/plugin.rb
 INFO manager: Registered plugin: package command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/plugin/plugin.rb
 INFO manager: Registered plugin: plugin command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/port/plugin.rb
 INFO manager: Registered plugin: port command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/powershell/plugin.rb
 INFO manager: Registered plugin: powershell command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/provider/plugin.rb
 INFO manager: Registered plugin: provider command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/provision/plugin.rb
 INFO manager: Registered plugin: provision command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/push/plugin.rb
 INFO manager: Registered plugin: push command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/rdp/plugin.rb
 INFO manager: Registered plugin: rdp command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/reload/plugin.rb
 INFO manager: Registered plugin: reload command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/resume/plugin.rb
 INFO manager: Registered plugin: resume command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/snapshot/plugin.rb
 INFO manager: Registered plugin: snapshot command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/ssh/plugin.rb
 INFO manager: Registered plugin: ssh command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/ssh_config/plugin.rb
 INFO manager: Registered plugin: ssh-config command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/status/plugin.rb
 INFO manager: Registered plugin: status command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/suspend/plugin.rb
 INFO manager: Registered plugin: suspend command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/up/plugin.rb
 INFO manager: Registered plugin: up command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/upload/plugin.rb
 INFO manager: Registered plugin: upload command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/validate/plugin.rb
 INFO manager: Registered plugin: validate command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/version/plugin.rb
 INFO manager: Registered plugin: version command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/winrm/plugin.rb
 INFO manager: Registered plugin: winrm command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/winrm_config/plugin.rb
 INFO manager: Registered plugin: winrm-config command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/ssh/plugin.rb
 INFO manager: Registered plugin: ssh communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/winrm/plugin.rb
 INFO manager: Registered plugin: winrm communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/winssh/plugin.rb
 INFO manager: Registered plugin: windows ssh communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/alpine/plugin.rb
 INFO manager: Registered plugin: Alpine guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/alt/plugin.rb
 INFO manager: Registered plugin: ALT Platform guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/amazon/plugin.rb
 INFO manager: Registered plugin: Amazon Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/arch/plugin.rb
 INFO manager: Registered plugin: Arch guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/atomic/plugin.rb
 INFO manager: Registered plugin: Atomic Host guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/bsd/plugin.rb
 INFO manager: Registered plugin: BSD-based guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/centos/plugin.rb
 INFO manager: Registered plugin: CentOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/coreos/plugin.rb
 INFO manager: Registered plugin: CoreOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/darwin/plugin.rb
 INFO manager: Registered plugin: Darwin guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/debian/plugin.rb
 INFO manager: Registered plugin: Debian guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/dragonflybsd/plugin.rb
 INFO manager: Registered plugin: DragonFly BSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/elementary/plugin.rb
 INFO manager: Registered plugin: Elementary guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/esxi/plugin.rb
 INFO manager: Registered plugin: ESXi guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/fedora/plugin.rb
 INFO manager: Registered plugin: Fedora guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/freebsd/plugin.rb
 INFO manager: Registered plugin: FreeBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/funtoo/plugin.rb
 INFO manager: Registered plugin: Funtoo guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/gentoo/plugin.rb
 INFO manager: Registered plugin: Gentoo guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/haiku/plugin.rb
 INFO manager: Registered plugin: Haiku guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/kali/plugin.rb
 INFO manager: Registered plugin: Kali guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/linux/plugin.rb
 INFO manager: Registered plugin: Linux guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/mint/plugin.rb
 INFO manager: Registered plugin: Mint guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/netbsd/plugin.rb
 INFO manager: Registered plugin: NetBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/nixos/plugin.rb
 INFO manager: Registered plugin: NixOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/omnios/plugin.rb
 INFO manager: Registered plugin: OmniOS guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/openbsd/plugin.rb
 INFO manager: Registered plugin: OpenBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/openwrt/plugin.rb
 INFO manager: Registered plugin: OpenWrt guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/photon/plugin.rb
 INFO manager: Registered plugin: VMware Photon guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/pld/plugin.rb
 INFO manager: Registered plugin: PLD Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/redhat/plugin.rb
 INFO manager: Registered plugin: Red Hat Enterprise Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/rocky/plugin.rb
 INFO manager: Registered plugin: Rocky guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/slackware/plugin.rb
 INFO manager: Registered plugin: Slackware guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/smartos/plugin.rb
 INFO manager: Registered plugin: SmartOS guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/solaris/plugin.rb
 INFO manager: Registered plugin: Solaris guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/solaris11/plugin.rb
 INFO manager: Registered plugin: Solaris 11 guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/suse/plugin.rb
 INFO manager: Registered plugin: SUSE guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/tinycore/plugin.rb
 INFO manager: Registered plugin: TinyCore Linux guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/trisquel/plugin.rb
 INFO manager: Registered plugin: Trisquel guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/ubuntu/plugin.rb
 INFO manager: Registered plugin: Ubuntu guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/windows/plugin.rb
 INFO manager: Registered plugin: Windows guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/alt/plugin.rb
 INFO manager: Registered plugin: ALT Platform host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/arch/plugin.rb
 INFO manager: Registered plugin: Arch host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/bsd/plugin.rb
 INFO manager: Registered plugin: BSD host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/darwin/plugin.rb
 INFO manager: Registered plugin: Mac OS X host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/freebsd/plugin.rb
 INFO manager: Registered plugin: FreeBSD host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/gentoo/plugin.rb
 INFO manager: Registered plugin: Gentoo host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/linux/plugin.rb
 INFO manager: Registered plugin: Linux host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/null/plugin.rb
 INFO manager: Registered plugin: null host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/redhat/plugin.rb
 INFO manager: Registered plugin: Red Hat Enterprise Linux host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/slackware/plugin.rb
 INFO manager: Registered plugin: Slackware host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/suse/plugin.rb
 INFO manager: Registered plugin: SUSE host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/void/plugin.rb
 INFO manager: Registered plugin: Void host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/windows/plugin.rb
 INFO manager: Registered plugin: Windows host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/kernel_v1/plugin.rb
 INFO manager: Registered plugin: kernel
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/kernel_v2/plugin.rb
 INFO manager: Registered plugin: kernel
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb
 INFO manager: Registered plugin: docker-provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb
 INFO manager: Registered plugin: Hyper-V provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb
 INFO manager: Registered plugin: VirtualBox provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/ansible/plugin.rb
 INFO manager: Registered plugin: ansible
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/cfengine/plugin.rb
 INFO manager: Registered plugin: CFEngine Provisioner
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/chef/plugin.rb
 INFO manager: Registered plugin: chef
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/container/plugin.rb
 INFO manager: Registered plugin: container
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/docker/plugin.rb
 INFO manager: Registered plugin: docker
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/file/plugin.rb
 INFO manager: Registered plugin: file
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/podman/plugin.rb
 INFO manager: Registered plugin: podman
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/puppet/plugin.rb
 INFO manager: Registered plugin: puppet
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/salt/plugin.rb
 INFO manager: Registered plugin: salt
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/shell/plugin.rb
 INFO manager: Registered plugin: shell
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/atlas/plugin.rb
 INFO manager: Registered plugin: atlas
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/ftp/plugin.rb
 INFO manager: Registered plugin: ftp
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/heroku/plugin.rb
 INFO manager: Registered plugin: heroku
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/local-exec/plugin.rb
 INFO manager: Registered plugin: local-exec
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/noop/plugin.rb
 INFO manager: Registered plugin: noop
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/nfs/plugin.rb
 INFO manager: Registered plugin: NFS synced folders
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/rsync/plugin.rb
 INFO manager: Registered plugin: RSync synced folders
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb
 INFO manager: Registered plugin: SMB synced folders
 INFO vagrant: `vagrant` invoked: ["up", "dc", "--debug"]
DEBUG vagrant: Creating Vagrant environment
 INFO environment: Environment initialized (#<Vagrant::Environment:0x0000027c214b16b8>)
 INFO environment:   - cwd: D:/workspace/eWalker/DetectionLab/Vagrant
 INFO environment: Home path: D:/yzhao/.vagrant.d
DEBUG environment: Effective local data path: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
 INFO environment: Local data path: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
DEBUG environment: Creating: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
DEBUG manager: Enabling localized plugins
 INFO manager: Plugins:
DEBUG solution_file: new solution file instance plugin_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json solution_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol
DEBUG solution_file: missing file so skipping loading
DEBUG bundler: solution file in use for init: <Vagrant::Bundler::SolutionFile:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol:invalid>
DEBUG bundler: Generating new builtin set instance.
DEBUG bundler: Generating new plugin set instance. Skip gems - []
DEBUG bundler: generating solution set for configured plugins
DEBUG bundler: Current generated plugin dependency list: []
DEBUG bundler: resolving solution from available specification set
DEBUG bundler: solution set for configured plugins has been resolved
DEBUG bundler: activating solution set
DEBUG bundler: Activating solution set: []
DEBUG solution_file: plugin file does not exist, not storing solution
DEBUG bundler: solution set stored to - <Vagrant::Bundler::SolutionFile:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol:invalid>
 INFO manager: Loading plugins...
DEBUG manager: Enabling globalized plugins
 INFO manager: Plugins:
 INFO manager:   - vagrant-reload = [installed: 0.0.1 constraint: > 0]
 INFO manager:   - vagrant-vmware-desktop = [installed: 3.0.1 constraint: > 0]
DEBUG solution_file: new solution file instance plugin_file=D:/yzhao/.vagrant.d/plugins.json solution_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol
DEBUG solution_file: reading solution file - D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol
DEBUG solution_file: solution validation check CHECKSUM 9fcfcffe612e5ad699ff689b31abbda7e7dbd14525fe86e49533ab494f410560 <-> 9fcfcffe612e5ad699ff689b31abbda7e7dbd14525fe86e49533ab494f410560 VERSION 2.2.19 <-> 2.2.19
DEBUG solution_file: loading solution dependency list
DEBUG solution_file: solution dependency list: [#<Gem::Resolver::DependencyRequest:0x0000027c220b98c0 @dependency=<Gem::Dependency type=:runtime name="vagrant-reload" requirements="= 0.0.1">, @requester=nil>, #<Gem::Resolver::DependencyRequest:0x0000027c220b95f0 @dependency=<Gem::Dependency type=:runtime name="vagrant-vmware-desktop" requirements="= 3.0.1">, @requester=nil>]
DEBUG bundler: solution file in use for init: <Vagrant::Bundler::SolutionFile:D:/yzhao/.vagrant.d/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol:valid>
DEBUG bundler: Generating new builtin set instance.
DEBUG bundler: Generating new plugin set instance. Skip gems - []
DEBUG bundler: loading cached solution set
DEBUG bundler: activating solution set
DEBUG bundler: Activating solution set: ["vagrant-reload-0.0.1", "vagrant-vmware-desktop-3.0.1"]
DEBUG bundler: Activating gem vagrant-reload-0.0.1
DEBUG bundler: Activating gem vagrant-vmware-desktop-3.0.1
 INFO manager: Loading plugins...
 INFO manager: Loading plugin `vagrant-reload` with default require: `vagrant-reload`
 INFO manager: Registered plugin: Reload
DEBUG manager: Successfully loaded plugin `vagrant-reload`.
 INFO manager: Loading plugin `vagrant-vmware-desktop` with default require: `vagrant-vmware-desktop`
 INFO manager: Registered plugin: VMware Workstation Provider
DEBUG manager: Successfully loaded plugin `vagrant-vmware-desktop`.
 INFO loader: Set :root = ["#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile
 INFO loader: Loading configuration in order: [:home, :root]
DEBUG loader: Loading from: root (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO subprocess: Starting process: ["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\/powershell.EXE", "-NoLogo", "-NoProfile", "-NonInteractive", "-ExecutionPolicy", "Bypass", "-Command", "Write-Output $PSVersionTable.PSVersion.Major"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 5
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 30
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\/powershell.EXE", "-NoLogo", "-NoProfile", "-NonInteractive", "-ExecutionPolicy", "Bypass", "-Command", "(new-object System.Security.Principal.WindowsPrincipal([System.Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([System.Security.Principal.WindowsBuiltInRole]::Administrator)"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: True
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_logger" = ["[\"2\", #<Proc:0x0000027c21df2678 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:3>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c21df2678 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:3>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_logger"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: bento/ubuntu-20.04 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO host: Autodetecting host type for [#<Vagrant::Environment: D:/workspace/eWalker/DetectionLab/Vagrant>]
DEBUG host: Trying: alt
DEBUG host: Trying: arch
DEBUG host: Trying: darwin
DEBUG host: Trying: freebsd
DEBUG host: Trying: gentoo
DEBUG host: Trying: redhat
DEBUG host: Trying: slackware
DEBUG host: Trying: suse
DEBUG host: Trying: void
DEBUG host: Trying: bsd
DEBUG host: Trying: linux
DEBUG host: Trying: null
DEBUG host: Trying: windows
 INFO host: Detected: windows!
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x0000027c210304b8>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c21c872c0>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c21c872c0>
 INFO loader: Set :"3060_bento/ubuntu-20.04_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile
 INFO loader: Loading configuration in order: [:"3060_bento/ubuntu-20.04_vmware_desktop", :home, :root, "2860_machine_logger"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c21e20488>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c21e20488>]
 INFO loader: Loading configuration in order: [:"3060_bento/ubuntu-20.04_vmware_desktop", :home, :root, "2860_machine_logger", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (cache)
DEBUG loader: Loading from: 2860_vm_logger_bento/ubuntu-20.04_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_dc" = ["[\"2\", #<Proc:0x0000027c21df24e8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c21df24e8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x0000027c2288cde0>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c228161e0>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c228161e0>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile
 INFO root: Version requirements from Vagrantfile: [">= 1.6.2"]
 INFO root:   - Version requirements satisfied!
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_dc_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c22b063c8>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c22b063c8>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Loading from: 2860_vm_dc_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_wef" = ["[\"2\", #<Proc:0x0000027c21df22e0 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c21df22e0 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x0000027c22864728>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c227c27c0>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c227c27c0>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_wef_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c20fce768>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c20fce768>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Loading from: 2860_vm_wef_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_win10" = ["[\"2\", #<Proc:0x0000027c21df20b0 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c21df20b0 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box not found: detectionlab/win10 (vmware_desktop)
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c216320c8>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000027c216320c8>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 WARN vagrantfile: Failed to locate detectionlab/win10 with version 
 WARN vagrantfile: Performing lookup with initial values detectionlab/win10 with version 
 INFO box_collection: Box not found: detectionlab/win10 (vmware_desktop)
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c216320c8>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box not found: detectionlab/win10 (vmware_desktop)
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c216320c8>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO environment: Running hook: environment_plugins_loaded
 INFO runner: Running action: environment_plugins_loaded #<Vagrant::Action::Builder:0x0000027c227d8ed0>
 INFO environment: Running hook: environment_load
 INFO runner: Running action: environment_load #<Vagrant::Action::Builder:0x0000027c226f1490>
 INFO warden: Calling IN action: #<HashiCorp::VagrantVMwareDesktop::SetupPlugin:0x0000027c2261eb58>
DEBUG checkpoint_client: starting plugin check
DEBUG checkpoint_client: starting utility check
 INFO warden: Calling OUT action: #<HashiCorp::VagrantVMwareDesktop::SetupPlugin:0x0000027c2261eb58>
DEBUG checkpoint_client: plugin check complete
DEBUG checkpoint_client: starting plugin check
 INFO cli: CLI: [] "up" ["dc"]
DEBUG checkpoint_client: plugin check complete
DEBUG cli: Invoking command class: VagrantPlugins::CommandUp::Command ["dc"]
DEBUG checkpoint_client: no information received from checkpoint
DEBUG command: 'Up' each target VM...
DEBUG command: Getting target VMs for command. Arguments:
DEBUG command:  -- names: ["dc"]
DEBUG command:  -- options: {:provider=>nil}
 INFO vmware_driver: VMX file: 
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG command: Finding machine that match name: dc
 INFO loader: Set "2860_machine_dc" = ["[\"2\", #<Proc:0x0000027c21df24e8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 WARN vagrantfile: Failed to locate detectionlab/win2016 with version 
 WARN vagrantfile: Performing lookup with initial values detectionlab/win2016 with version 
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` detected in configuration and usable.
 INFO environment: Getting machine: dc (vmware_desktop)
 INFO environment: Uncached load of machine.
 INFO loader: Set "2860_machine_dc" = ["[\"2\", #<Proc:0x0000027c21df24e8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x0000027c21c8f088>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c21b24900>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000027c21b24900>
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_dc_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x0000027c22b063c8>]"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Loading from: 2860_vm_dc_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
 INFO machine: Initializing machine: dc
 INFO machine:   - Provider: HashiCorp::VagrantVMwareDesktop::Provider
 INFO machine:   - Box: #<Vagrant::Box:0x0000027c22aa2d78>
 INFO machine:   - Data dir: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop
DEBUG vmware: Re-initializing driver for new ID: nil
 INFO vmware_driver: VMX file: 
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
DEBUG vmware_driver: discovered vmware NAT device: vmnet8
DEBUG checkpoint_client: getting utility version
DEBUG vmware_driver: Getting version from vagrant-vmware-utility
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG checkpoint_client: got utility version: "1.0.21"
DEBUG checkpoint_client: running utility checkpoint check
DEBUG checkpoint_client: utility check complete
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
DEBUG vmware_driver: discovered vmware NAT device: vmnet8
DEBUG machine: Eager loading WinRM communicator to avoid GH-3390
 INFO winrm: Initializing WinRMCommunicator
DEBUG vmware: VM state requested. Current state: not_created
 INFO machine: New machine ID: nil
DEBUG vmware: Re-initializing driver for new ID: nil
 INFO vmware_driver: VMX file: 
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
 INFO interface: Machine: metadata ["provider", :vmware_desktop, {:target=>:dc}]
DEBUG vmware: VM state requested. Current state: not_created
DEBUG vmware: VM state requested. Current state: not_created
 INFO command: With machine: dc (#<HashiCorp::VagrantVMwareDesktop::Provider:0x0000027c22656558 @logger=#<Log4r::Logger:0x0000027c22656508 @fullname="hashicorp::vagrant::vmware", @outputters=[], @additive=true, @name="vmware", @path="hashicorp::vagrant", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @machine=#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, @driver=#<HashiCorp::VagrantVMwareDesktop::Driver::Base:0x0000027c22a39300 @config=#<HashiCorp::VagrantVMwareDesktop::Config:0x0000027c2292a5b8 @allowlist_verified=false, @base_address=nil, @base_mac=nil, @clone_directory=nil, @functional_hgfs=true, @unmount_default_hgfs=true, @enable_vmrun_ip_lookup=true, @gui=true, @force_vmware_license=nil, @linked_clone=true, @nat_device="vmnet8", @network_adapters={0=>[:nat, {:auto_config=>false}]}, @shared_folder_special_char="-", @verify_vmnet=true, @vmx={"displayname"=>"dc.windomain.local", "memsize"=>"3072", "numvcpus"=>"2"}, @port_forward_network_pause=0, @ssh_info_public=false, @utility_host="127.0.0.1", @utility_port=9922, @utility_certificate_path="C:/ProgramData/HashiCorp/vagrant-vmware-desktop/certificates", @logger=#<Log4r::Logger:0x0000027c229795f0 @fullname="hashicorp::provider::vmware::config", @outputters=[], @additive=true, @name="config", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @__invalid_methods=#<Set: {}>>, @logger=#<Log4r::Logger:0x0000027c22a392b0 @fullname="hashicorp::provider::vmware_driver", @outputters=[], @additive=true, @name="vmware_driver", @path="hashicorp::provider", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @vmx_path=nil, @vm_dir=nil, @vagrant_utility=#<HashiCorp::VagrantVMwareDesktop::Helper::VagrantUtility:0x0000027c229b9ad8 @logger=#<Log4r::Logger:0x0000027c229b9a60 @fullname="hashicorp::provider::vmware::vagrant_utility", @outputters=[], @additive=true, @name="vagrant_utility", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @connection=#<Net::HTTP 127.0.0.1:9922 open=false>, @headers={"Content-Type"=>"application/vnd.hashicorp.vagrant.vmware.rest-v1+json", "Origin"=>"https://127.0.0.1:9922", "User-Agent"=>"Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4)  - VagrantVMWareDesktop/STUB", "X-Requested-With"=>"Vagrant"}>, @license="workstation", @pro_license=true, @version="16.2.3", @product_name="Workstation", @vmrun_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", @vmware_vmx_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\x64\\vmware-vmx.exe", @vmware_vdiskmanager_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmware-vdiskmanager.exe", @utility_version=#<Gem::Version "1.0.21">>, @cap_logger=#<Log4r::Logger:0x0000027c2252f328 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::provider", @outputters=[], @additive=true, @name="provider", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x0000027c21639d50 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware_desktop, #<#<Class:0x0000027c2252fe40>:0x0000027c21f3ee50>]], @cap_args=[#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:docker=>#<Vagrant::Registry:0x0000027c2252fc88 @items={:public_address=>#<Proc:0x0000027c21ba5a00 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:60>, :proxy_machine=>#<Proc:0x0000027c21ba5910 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:65>, :has_communicator=>#<Proc:0x0000027c21ba5820 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:70>}, @results_cache={}>, :hyperv=>#<Vagrant::Registry:0x0000027c2252fbe8 @items={:public_address=>#<Proc:0x0000027c21f64420 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:25>, :snapshot_list=>#<Proc:0x0000027c21f643a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:30>, :configure_disks=>#<Proc:0x0000027c21f64380 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:35>, :cleanup_disks=>#<Proc:0x0000027c21f64358 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:40>, :validate_disk_ext=>#<Proc:0x0000027c21f64330 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:45>, :default_disk_exts=>#<Proc:0x0000027c21f64308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:50>, :set_default_disk_ext=>#<Proc:0x0000027c21f642e0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:55>}, @results_cache={}>, :virtualbox=>#<Vagrant::Registry:0x0000027c2252f7d8 @items={:forwarded_ports=>#<Proc:0x0000027c21bcb728 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:27>, :nic_mac_addresses=>#<Proc:0x0000027c21bcb700 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:32>, :public_address=>#<Proc:0x0000027c21bcb6d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:37>, :configure_disks=>#<Proc:0x0000027c21bcb6b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:42>, :cleanup_disks=>#<Proc:0x0000027c21bcb688 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:47>, :validate_disk_ext=>#<Proc:0x0000027c21bcb660 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:52>, :default_disk_exts=>#<Proc:0x0000027c21bcb638 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:57>, :set_default_disk_ext=>#<Proc:0x0000027c21bcb610 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:62>, :snapshot_list=>#<Proc:0x0000027c21bcb5e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:67>}, @results_cache={}>, :vmware_desktop=>#<Vagrant::Registry:0x0000027c2252f5f8 @items={:snapshot_list=>#<Proc:0x0000027c214c0b40 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x0000027c214c0b18 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x0000027c214c0af0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x0000027c214c0668 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x0000027c214c05a0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x0000027c214c0500 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x0000027c214c04b0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>, :vmware_workstation=>#<Vagrant::Registry:0x0000027c2252f558 @items={:snapshot_list=>#<Proc:0x0000027c214bbe38 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x0000027c214bbe10 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x0000027c214bbde8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x0000027c214bbc30 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x0000027c214bbb68 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x0000027c214bba78 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x0000027c214bb230 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>}>)
DEBUG vmware: VM state requested. Current state: not_created
DEBUG command: Getting target VMs for command. Arguments:
DEBUG command:  -- names: ["dc"]
DEBUG command:  -- options: {:provider=>nil}
DEBUG command: Finding machine that match name: dc
 INFO loader: Set "2860_machine_dc" = ["[\"2\", #<Proc:0x0000027c21df24e8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 WARN vagrantfile: Failed to locate detectionlab/win2016 with version 
 WARN vagrantfile: Performing lookup with initial values detectionlab/win2016 with version 
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` detected in configuration and usable.
 INFO environment: Getting machine: dc (vmware_desktop)
 INFO environment: Returning cached machine: dc (vmware_desktop)
DEBUG vmware: VM state requested. Current state: not_created
DEBUG vmware: VM state requested. Current state: not_created
 INFO command: With machine: dc (#<HashiCorp::VagrantVMwareDesktop::Provider:0x0000027c22656558 @logger=#<Log4r::Logger:0x0000027c22656508 @fullname="hashicorp::vagrant::vmware", @outputters=[], @additive=true, @name="vmware", @path="hashicorp::vagrant", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @machine=#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, @driver=#<HashiCorp::VagrantVMwareDesktop::Driver::Base:0x0000027c22a39300 @config=#<HashiCorp::VagrantVMwareDesktop::Config:0x0000027c2292a5b8 @allowlist_verified=false, @base_address=nil, @base_mac=nil, @clone_directory=nil, @functional_hgfs=true, @unmount_default_hgfs=true, @enable_vmrun_ip_lookup=true, @gui=true, @force_vmware_license=nil, @linked_clone=true, @nat_device="vmnet8", @network_adapters={0=>[:nat, {:auto_config=>false}]}, @shared_folder_special_char="-", @verify_vmnet=true, @vmx={"displayname"=>"dc.windomain.local", "memsize"=>"3072", "numvcpus"=>"2"}, @port_forward_network_pause=0, @ssh_info_public=false, @utility_host="127.0.0.1", @utility_port=9922, @utility_certificate_path="C:/ProgramData/HashiCorp/vagrant-vmware-desktop/certificates", @logger=#<Log4r::Logger:0x0000027c229795f0 @fullname="hashicorp::provider::vmware::config", @outputters=[], @additive=true, @name="config", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @__invalid_methods=#<Set: {}>>, @logger=#<Log4r::Logger:0x0000027c22a392b0 @fullname="hashicorp::provider::vmware_driver", @outputters=[], @additive=true, @name="vmware_driver", @path="hashicorp::provider", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @vmx_path=nil, @vm_dir=nil, @vagrant_utility=#<HashiCorp::VagrantVMwareDesktop::Helper::VagrantUtility:0x0000027c229b9ad8 @logger=#<Log4r::Logger:0x0000027c229b9a60 @fullname="hashicorp::provider::vmware::vagrant_utility", @outputters=[], @additive=true, @name="vagrant_utility", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @connection=#<Net::HTTP 127.0.0.1:9922 open=false>, @headers={"Content-Type"=>"application/vnd.hashicorp.vagrant.vmware.rest-v1+json", "Origin"=>"https://127.0.0.1:9922", "User-Agent"=>"Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4)  - VagrantVMWareDesktop/STUB", "X-Requested-With"=>"Vagrant"}>, @license="workstation", @pro_license=true, @version="16.2.3", @product_name="Workstation", @vmrun_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", @vmware_vmx_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\x64\\vmware-vmx.exe", @vmware_vdiskmanager_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmware-vdiskmanager.exe", @utility_version=#<Gem::Version "1.0.21">>, @cap_logger=#<Log4r::Logger:0x0000027c2252f328 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::provider", @outputters=[], @additive=true, @name="provider", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x0000027c21639d50 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware_desktop, #<#<Class:0x0000027c2252fe40>:0x0000027c21f3ee50>]], @cap_args=[#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:docker=>#<Vagrant::Registry:0x0000027c2252fc88 @items={:public_address=>#<Proc:0x0000027c21ba5a00 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:60>, :proxy_machine=>#<Proc:0x0000027c21ba5910 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:65>, :has_communicator=>#<Proc:0x0000027c21ba5820 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:70>}, @results_cache={}>, :hyperv=>#<Vagrant::Registry:0x0000027c2252fbe8 @items={:public_address=>#<Proc:0x0000027c21f64420 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:25>, :snapshot_list=>#<Proc:0x0000027c21f643a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:30>, :configure_disks=>#<Proc:0x0000027c21f64380 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:35>, :cleanup_disks=>#<Proc:0x0000027c21f64358 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:40>, :validate_disk_ext=>#<Proc:0x0000027c21f64330 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:45>, :default_disk_exts=>#<Proc:0x0000027c21f64308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:50>, :set_default_disk_ext=>#<Proc:0x0000027c21f642e0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:55>}, @results_cache={}>, :virtualbox=>#<Vagrant::Registry:0x0000027c2252f7d8 @items={:forwarded_ports=>#<Proc:0x0000027c21bcb728 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:27>, :nic_mac_addresses=>#<Proc:0x0000027c21bcb700 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:32>, :public_address=>#<Proc:0x0000027c21bcb6d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:37>, :configure_disks=>#<Proc:0x0000027c21bcb6b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:42>, :cleanup_disks=>#<Proc:0x0000027c21bcb688 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:47>, :validate_disk_ext=>#<Proc:0x0000027c21bcb660 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:52>, :default_disk_exts=>#<Proc:0x0000027c21bcb638 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:57>, :set_default_disk_ext=>#<Proc:0x0000027c21bcb610 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:62>, :snapshot_list=>#<Proc:0x0000027c21bcb5e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:67>}, @results_cache={}>, :vmware_desktop=>#<Vagrant::Registry:0x0000027c2252f5f8 @items={:snapshot_list=>#<Proc:0x0000027c214c0b40 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x0000027c214c0b18 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x0000027c214c0af0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x0000027c214c0668 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x0000027c214c05a0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x0000027c214c0500 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x0000027c214c04b0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>, :vmware_workstation=>#<Vagrant::Registry:0x0000027c2252f558 @items={:snapshot_list=>#<Proc:0x0000027c214bbe38 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x0000027c214bbe10 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x0000027c214bbde8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x0000027c214bbc30 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x0000027c214bbb68 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x0000027c214bba78 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x0000027c214bb230 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>}>)
 INFO interface: info: Bringing machine 'dc' up with 'vmware_desktop' provider...
Bringing machine 'dc' up with 'vmware_desktop' provider...
DEBUG vmware: VM state requested. Current state: not_created
 INFO batch_action: Enabling parallelization by default.
 INFO batch_action: Disabling parallelization because provider doesn't support it: vmware_desktop
 INFO batch_action: Batch action will parallelize: false
 INFO batch_action: Starting action: #<Vagrant::Machine:0x0000027c227a86b8> up {:destroy_on_error=>true, :install_provider=>false, :parallel=>true, :provision_ignore_sentinel=>false, :provision_types=>nil}
 INFO machine: Calling action: up on provider VMware Workstation
DEBUG environment: Attempting to acquire process-lock: machine-action-72e3d0cc61eeeff22d74ebfe7711adc4
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: machine-action-72e3d0cc61eeeff22d74ebfe7711adc4
 INFO interface: Machine: action ["up", "start", {:target=>:dc}]
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Builder:0x0000027c226d2a90>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000027c225b40f0>
DEBUG syncedfolder: Searching for cap: default_fstab_modification
DEBUG syncedfolder: Checking in: vmware
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: VMware Middleware: CheckVMware
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c21c847f0>
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Builder:0x0000027c236c6398>
 INFO warden: Calling IN action: VMware Middleware: Created
DEBUG vmware: VM state requested. Current state: not_created
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2370c168>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2370c168>
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Warden:0x0000027c23afb2b0>
 INFO warden: Calling IN action: #<Proc:0x0000027c21541448 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleBox:0x0000027c23afb210>
 INFO handle_box: Machine already has box. HandleBox will not run.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::PrepareClone:0x0000027c23b10688>
 INFO warden: Calling IN action: VMware Middleware: Import
 INFO import: VMX file not in metadata, attempting to discover...
DEBUG import: Cloning into: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/ef966a7e-e2da-4049-b298-3e4c7ef9c443
 INFO import: VMX file: D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/WindowsServer2016.vmx
 INFO interface: info: Cloning VMware VM: 'detectionlab/win2016'. This can take some time...
 INFO interface: info: ==> dc: Cloning VMware VM: 'detectionlab/win2016'. This can take some time...
==> dc: Cloning VMware VM: 'detectionlab/win2016'. This can take some time...
 INFO vmware_driver: Cloning machine using VMware linked clones.
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "clone", "D:\\yzhao\\.vagrant.d\\boxes\\detectionlab-VAGRANTSLASH-win2016\\1.9\\vmware_desktop\\WindowsServer2016.vmx", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "linked"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31998
DEBUG subprocess: Exit status: 0
 INFO vmware_driver: VMX file: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/ef966a7e-e2da-4049-b298-3e4c7ef9c443/WindowsServer2016.vmx
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = Clone of WindowsServer2016
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.bsdname = en0
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.displayname = Ethernet
DEBUG vmware_driver:   - ethernet0.linkstatepropagation.enable = FALSE
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet0.vnet = 
DEBUG vmware_driver:   - ethernet0.wakeonpcktrcv = FALSE
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 8192
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 80001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 8
DEBUG vmware_driver:   - numvcpus = 8
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6d 3d b1 24 10
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 
DEBUG vmware_driver:   - uuid.location = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462627
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 134217728
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - invmteam = FALSE
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "Clone of WindowsServer2016"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.bsdname = "en0"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.displayname = "Ethernet"
DEBUG vmware_driver:   - SET ethernet0.linkstatepropagation.enable = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet0.vnet = ""
DEBUG vmware_driver:   - SET ethernet0.wakeonpcktrcv = "FALSE"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET invmteam = "FALSE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "8192"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "80001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "8"
DEBUG vmware_driver:   - SET numvcpus = "8"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6d 3d b1 24 10"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = ""
DEBUG vmware_driver:   - SET uuid.location = ""
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vmci0.id = "1861462627"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "134217728"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO machine: New machine ID: "D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/ef966a7e-e2da-4049-b298-3e4c7ef9c443/WindowsServer2016.vmx"
DEBUG vmware: Re-initializing driver for new ID: "D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/ef966a7e-e2da-4049-b298-3e4c7ef9c443/WindowsServer2016.vmx"
 INFO vmware_driver: VMX file: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/ef966a7e-e2da-4049-b298-3e4c7ef9c443/WindowsServer2016.vmx
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
 INFO warden: Calling IN action: VMware Middleware: SetDisplayName
 INFO vmx_modify: Setting the default display name: Vagrant: dc
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = Clone of WindowsServer2016
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.bsdname = en0
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.displayname = Ethernet
DEBUG vmware_driver:   - ethernet0.linkstatepropagation.enable = FALSE
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet0.vnet = 
DEBUG vmware_driver:   - ethernet0.wakeonpcktrcv = FALSE
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - invmteam = FALSE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 8192
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 80001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 8
DEBUG vmware_driver:   - numvcpus = 8
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6d 3d b1 24 10
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 
DEBUG vmware_driver:   - uuid.location = 
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462627
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 134217728
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "Vagrant: dc"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.bsdname = "en0"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.displayname = "Ethernet"
DEBUG vmware_driver:   - SET ethernet0.linkstatepropagation.enable = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet0.vnet = ""
DEBUG vmware_driver:   - SET ethernet0.wakeonpcktrcv = "FALSE"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET invmteam = "FALSE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "8192"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "80001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "8"
DEBUG vmware_driver:   - SET numvcpus = "8"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6d 3d b1 24 10"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = ""
DEBUG vmware_driver:   - SET uuid.location = ""
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vmci0.id = "1861462627"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "134217728"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000027c21eabfb0>
 INFO interface: output: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO interface: output: ==> dc: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
==> dc: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO environment: Running hook: authenticate_box_downloader
 INFO runner: Running action: authenticate_box_downloader #<Vagrant::Action::Builder:0x0000027c237979e8>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddDownloaderAuthentication:0x0000027c236fd7a8>
DEBUG client: No authentication token in environment or D:/yzhao/.vagrant.d/data/vagrant_login_token
DEBUG client: No authentication token in environment or D:/yzhao/.vagrant.d/data/vagrant_login_token
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddDownloaderAuthentication:0x0000027c236fd7a8>
 INFO downloader: Downloader starting download: 
 INFO downloader:   -- Source: https://vagrantcloud.com/detectionlab/win2016
 INFO downloader:   -- Destination: D:/yzhao/AppData/Local/Temp/vagrant-load-metadata20220620-572-k9qzeo
 INFO subprocess: Starting process: ["C:\\Program_Files\\HashiCorp\\Vagrant\\embedded\\bin/curl.EXE", "-q", "--fail", "--location", "--max-redirs", "10", "--verbose", "--user-agent", "Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4) ", "-H", "Accept: application/json", "--output", "D:/yzhao/AppData/Local/Temp/vagrant-load-metadata20220620-572-k9qzeo", "https://vagrantcloud.com/detectionlab/win2016"]
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stderr:   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current

                                 Dload  Upload   Total   Spent    Left  Speed


  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0*   Trying 108.138.94.124:443...

* Connected to vagrantcloud.com (108.138.94.124) port 443 (#0)

* schannel: ALPN, offering http/1.1

* ALPN, server did not agree to a protocol

> GET /detectionlab/win2016 HTTP/1.1


> Host: vagrantcloud.com


> User-Agent: Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4) 


> Accept: application/json


> 


* Mark bundle as not supporting multiuse

< HTTP/1.1 301 Moved Permanently


< Content-Type: text/html


< Content-Length: 117


< Connection: keep-alive


< Server: Cowboy


< Date: Mon, 20 Jun 2022 14:29:07 GMT


< Location: https://vagrantcloud.com/detectionlab/boxes/win2016


< Cache-Control: no-cache


< X-Request-Id: f503c0a5-5600-43c1-a1a6-aedd80d3c523


< X-Runtime: 0.001058


< Via: 1.1 vegur, 1.1 020978022b22df6352245f09cfbc410c.cloudfront.net (CloudFront)


< X-Cache: Miss from cloudfront


< X-Amz-Cf-Pop: SEA73-P2


< X-Amz-Cf-Id: CnsNiy_5qfzXpCAJh1euBEtJkkmqYquFoVbUriMEisZQlIS7a8j8Lw==


< 


* Ignoring the response-body

{ [117 bytes data]


100   117  100   117    0     0    129      0 --:--:-- --:--:-- --:--:--   128
100   117  100   117    0     0    128      0 --:--:-- --:--:-- --:--:--   128

* Connection #0 to host vagrantcloud.com left intact

* Issue another request to this URL: 'https://vagrantcloud.com/detectionlab/boxes/win2016'

* Found bundle for host vagrantcloud.com: 0x187bf20b920 [serially]

* Re-using existing connection! (#0) with host vagrantcloud.com

* Connected to vagrantcloud.com (108.138.94.124) port 443 (#0)

> GET /detectionlab/boxes/win2016 HTTP/1.1


> Host: vagrantcloud.com


> User-Agent: Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4) 


> Accept: application/json


> 


* Mark bundle as not supporting multiuse

< HTTP/1.1 200 OK


< Content-Type: application/json; charset=utf-8


< Transfer-Encoding: chunked


< Connection: keep-alive


< Server: Cowboy


< Date: Mon, 20 Jun 2022 14:29:08 GMT


< X-Frame-Options: SAMEORIGIN


< X-Xss-Protection: 1; mode=block


< X-Content-Type-Options: nosniff


< X-Download-Options: noopen


< X-Permitted-Cross-Domain-Policies: none


< Referrer-Policy: strict-origin-when-cross-origin


< Strict-Transport-Security: max-age=31536000; includeSubDomains; preload


< Etag: W/"112fee6a3386bab4f83b7bd08a98e466"


< Cache-Control: max-age=0, private, must-revalidate


< X-Request-Id: 5225007d-c94a-47ee-916c-8972989a5539


< X-Runtime: 0.051184


< Via: 1.1 vegur, 1.1 020978022b22df6352245f09cfbc410c.cloudfront.net (CloudFront)


< X-Cache: Miss from cloudfront


< X-Amz-Cf-Pop: SEA73-P2


< X-Amz-Cf-Id: AhqJ789oGlXmDYD3hSC-ZFi2IO0cICr_6tw55z26Qa-48ZrqIeiL_w==


< 


* schannel: failed to decrypt data, need more data

{ [4279 bytes data]


100  4266    0  4266    0     0   3143      0 --:--:--  0:00:01 --:--:--  3143

* Connection #0 to host vagrantcloud.com left intact
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c23ba19f8>
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Builder:0x0000027c22616390>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2156a2f8>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2156a2f8>
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Warden:0x0000027c23a82c48>
 INFO warden: Calling IN action: #<Proc:0x0000027c2381e5b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: CheckExistingNetwork
 INFO check_existing_network: Checking if the vmnet devices are healthy...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Verifying vmnet devices are healthy...
 INFO interface: info: ==> dc: Verifying vmnet devices are healthy...
==> dc: Verifying vmnet devices are healthy...
DEBUG vagrant_utility: request METHOD=POST PATH=/vmnet/verify RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: PruneForwardedPorts
 INFO prune_forwarded_ports: Pruning forwarded ports...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
DEBUG vmware_driver: requesting prune of unused port forwards
DEBUG vagrant_utility: request METHOD=DELETE PATH=/portforwards RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c23a223e8>
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Builder:0x0000027c236fe1a8>
 INFO warden: Calling IN action: VMware Middleware: Suspended
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
DEBUG suspended: result: false
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2363c260>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2363c260>
 INFO warden: Calling OUT action: VMware Middleware: Suspended
 INFO runner: Running action: machine_action_up #<Vagrant::Action::Warden:0x0000027c239611c0>
 INFO warden: Calling IN action: #<Proc:0x0000027c23b616f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Provision:0x0000027c23960cc0>
 INFO provision: Checking provisioner sentinel file...
 INFO warden: Calling IN action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x0000027c2371f240>
DEBUG host: Searching for cap: nfs_prune
DEBUG host: Checking in: windows
 INFO nfs: Host doesn't support pruning NFS. Skipping.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x0000027c23636860>
 INFO synced_folder_cleanup: Invoking synced folder cleanup for: vmware
 INFO synced_folder: Clearing shared folders
 INFO vmware_driver: Clearing shared folders...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = Vagrant: dc
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.bsdname = en0
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.displayname = Ethernet
DEBUG vmware_driver:   - ethernet0.linkstatepropagation.enable = FALSE
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet0.vnet = 
DEBUG vmware_driver:   - ethernet0.wakeonpcktrcv = FALSE
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - invmteam = FALSE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 8192
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 80001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 8
DEBUG vmware_driver:   - numvcpus = 8
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6d 3d b1 24 10
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 
DEBUG vmware_driver:   - uuid.location = 
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462627
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 134217728
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "Vagrant: dc"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.bsdname = "en0"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.displayname = "Ethernet"
DEBUG vmware_driver:   - SET ethernet0.linkstatepropagation.enable = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet0.vnet = ""
DEBUG vmware_driver:   - SET ethernet0.wakeonpcktrcv = "FALSE"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET invmteam = "FALSE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "8192"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "80001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "8"
DEBUG vmware_driver:   - SET numvcpus = "8"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6d 3d b1 24 10"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = ""
DEBUG vmware_driver:   - SET uuid.location = ""
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vmci0.id = "1861462627"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "134217728"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Delayed:0x0000027c22896de0>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolders:0x0000027c22896d68>
 INFO synced_folders: SyncedFolders loading from cache: false
 INFO synced_folders: Synced Folder Implementation: vmware
 INFO synced_folders:   - /vagrant: . => /vagrant
 INFO synced_folders: Invoking synced folder prepare for: vmware
 INFO warden: Calling IN action: VMware Middleware: PrepareNFSSettings
 INFO warden: Calling IN action: VMware Middleware: Network
DEBUG network: Available slots for high-level adapters: #<Set: {1, 2, 3, 4, 5, 6, 7, 8}>
 INFO network: Determining network adapters required for high-level configuration...
 INFO network:  -- Slot 1: hostonly
 INFO network: Determining adapters and compiling network configuration...
 INFO network: Slot 0. Type: nat
DEBUG network: Normalized configuration: {:auto_config=>false, :type=>:dhcp}
DEBUG network: Adapter configuration: {:type=>:nat, :slot=>0}
DEBUG network: Network configuration: {:type=>:dhcp, :auto_config=>false}
 INFO network: Slot 1. Type: hostonly
DEBUG network: Normalized configuration: {:auto_config=>true, :netmask=>"255.255.255.0", :type=>:static, :ip=>"192.168.56.102", :gateway=>"192.168.56.1", :dns=>"8.8.8.8", :protocol=>"tcp", :id=>"c614ec4e-a58f-4a8f-8fcf-b7ff8ba317cf", :subnet_ip=>"192.168.56.0", :adapter_ip=>"192.168.56.1"}
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
 INFO network: Found matching vmnet device: vmnet2
 INFO network: Checking for hostonly network collisions...
 INFO subprocess: Starting process: ["C:\\WINDOWS\\system32/netsh.exe", "interface", "ip", "show", "route"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 

Publish  Type      Met  Prefix                    Idx  Gateway/Interface Name

-------  --------  ---  ------------------------  ---  ------------------------

No       Manual    100  0.0.0.0/0                  18  10.89.255.254

No       System    256  10.89.0.0/16               18  Wi-Fi

No       System    256  10.89.78.193/32            18  Wi-Fi

No       System    256  10.89.255.255/32           18  Wi-Fi

No       System    256  127.0.0.0/8                 1  Loopback Pseudo-Interface 1

No       System    256  127.0.0.1/32                1  Loopback Pseudo-Interface 1

No       System    256  127.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  169.254.0.0/16             90  VMware Network Adapter VMnet2

No       System    256  169.254.140.76/32          90  VMware Network Adapter VMnet2

No       System    256  169.254.255.255/32         90  VMware Network Adapter VMnet2

No       System    256  172.19.112.0/20            73  vEthernet (vEthernet (NAT )

No       System    256  172.19.112.1/32            73  vEthernet (vEthernet (NAT )

No       System    256  172.19.127.255/32          73  vEthernet (vEthernet (NAT )

No       System    256  172.19.176.0/20            30  vEthernet (Default Switch)

No       System    256  172.19.176.1/32            30  vEthernet (Default Switch)

No       System    256  172.19.191.255/32          30  vEthernet (Default Switch)

No       System    256  172.21.80.0/20             91  vEthernet (Ethernet 6)

No       System    256  172.21.80.1/32             91  vEthernet (Ethernet 6)

No       System    256  172.21.95.255/32           91  vEthernet (Ethernet 6)

No       System    256  172.21.160.0/20            47  vEthernet (Ethernet)

No       System    256  172.21.160.1/32            47  vEthernet (Ethernet)

No       System    256  172.21.175.255/32          47  vEthernet (Ethernet)

No       System    256  172.22.192.0/20            22  vEthernet (VMware Network )

No       System    256  172.22.192.1/32            22  vEthernet (VMware Network )

No       System    256  172.22.207.255/32          22  vEthernet (VMware Network )

No       System    256  172.26.144.0/20            97  vEthernet (Wi-Fi)

No       System    256  172.26.144.1/32            97  vEthernet (Wi-Fi)

No       System    256  172.26.159.255/32          97  vEthernet (Wi-Fi)

No       System    256  172.27.128.0/20            84  vEthernet (VMware Network ) 2

No       System    256  172.27.128.1/32            84  vEthernet (VMware Network ) 2

No       System    256  172.27.143.255/32          84  vEthernet (VMware Network ) 2

No       System    256  192.168.44.0/24             4  VMware Network Adapter VMnet1

No       System    256  192.168.44.1/32             4  VMware Network Adapter VMnet1

No       System    256  192.168.44.255/32           4  VMware Network Adapter VMnet1

No       System    256  192.168.222.0/24           20  VMware Network Adapter VMnet8

No       System    256  192.168.222.1/32           20  VMware Network Adapter VMnet8

No       System    256  192.168.222.255/32         20  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 1  Loopback Pseudo-Interface 1

No       System    256  224.0.0.0/4                13  OpenVPN Wintun

No       System    256  224.0.0.0/4                24  vEthernet (NAT vSwitch)

No       System    256  224.0.0.0/4                 6  Ethernet

No       System    256  224.0.0.0/4                18  Wi-Fi

No       System    256  224.0.0.0/4                47  vEthernet (Ethernet)

No       System    256  224.0.0.0/4                30  vEthernet (Default Switch)

No       System    256  224.0.0.0/4                73  vEthernet (vEthernet (NAT )

No       System    256  224.0.0.0/4                97  vEthernet (Wi-Fi)

No       System    256  224.0.0.0/4                33  Local Area Connection* 2

No       System    256  224.0.0.0/4                 4  VMware Network Adapter VMnet1

No       System    256  224.0.0.0/4                20  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                22  vEthernet (VMware Network )

No       System    256  224.0.0.0/4                84  vEthernet (VMware Network ) 2

No       System    256  224.0.0.0/4                90  VMware Network Adapter VMnet2

No       System    256  224.0.0.0/4                91  vEthernet (Ethernet 6)

No       System    256  255.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  255.255.255.255/32         13  OpenVPN Wintun

No       System    256  255.255.255.255/32         24  vEthernet (NAT vSwitch)

No       System    256  255.255.255.255/32          6  Ethernet

No       System    256  255.255.255.255/32         18  Wi-Fi

No       System    256  255.255.255.255/32         47  vEthernet (Ethernet)

No       System    256  255.255.255.255/32         30  vEthernet (Default Switch)

No       System    256  255.255.255.255/32         73  vEthernet (vEthernet (NAT )

No       System    256  255.255.255.255/32         97  vEthernet (Wi-Fi)

No       System    256  255.255.255.255/32         33  Local Area Connection* 2

No       System    256  255.255.255.255/32          4  VMware Network Adapter VMnet1

No       System    256  255.255.255.255/32         20  VMware Network Adapter VMnet8

No       System    256  255.255.255.255/32         22  vEthernet (VMware Network )

No       System    256  255.255.255.255/32         84  vEthernet (VMware Network ) 2

No       System    256  255.255.255.255/32         90  VMware Network Adapter VMnet2

No       System    256  255.255.255.255/32         91  vEthernet (Ethernet 6)


DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG network: Adapter configuration: {:type=>:custom, :mac_address=>nil, :vnet=>"vmnet2", :slot=>1}
DEBUG network: Network configuration: {:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.102", :netmask=>"255.255.255.0", :auto_config=>true}
 INFO network: Enabling 2 adapters...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Preparing network adapters...
 INFO interface: info: ==> dc: Preparing network adapters...
==> dc: Preparing network adapters...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = Vagrant: dc
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.bsdname = en0
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.displayname = Ethernet
DEBUG vmware_driver:   - ethernet0.linkstatepropagation.enable = FALSE
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet0.vnet = 
DEBUG vmware_driver:   - ethernet0.wakeonpcktrcv = FALSE
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - invmteam = FALSE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 8192
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 80001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 8
DEBUG vmware_driver:   - numvcpus = 8
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6d 3d b1 24 10
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 
DEBUG vmware_driver:   - uuid.location = 
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462627
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 134217728
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.bsdname
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.displayname
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.linkstatepropagation.enable
WARNING: The VMX file for this box contains a setting that is automatically overwritten by Vagrant
WARNING: when started. Vagrant will stop overwriting this setting in an upcoming release which may
WARNING: prevent proper networking setup. Below is the detected VMX setting:
WARNING: 
WARNING:   ethernet0.pcislotnumber = "33"
WARNING: 
WARNING: If networking fails to properly configure, it may require this VMX setting. It can be manually
WARNING: applied via the Vagrantfile:
WARNING: 
WARNING:   Vagrant.configure(2) do |config|
WARNING:     config.vm.provider :vmware_desktop do |vmware|
WARNING:       vmware.vmx["ethernet0.pcislotnumber"] = "33"
WARNING:     end
WARNING:   end
WARNING: 
WARNING: For more information: https://www.vagrantup.com/docs/vmware/boxes.html#vmx-allowlisting
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet0.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.vnet
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.wakeonpcktrcv
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "Vagrant: dc"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET invmteam = "FALSE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "8192"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "80001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "8"
DEBUG vmware_driver:   - SET numvcpus = "8"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6d 3d b1 24 10"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = ""
DEBUG vmware_driver:   - SET uuid.location = ""
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vmci0.id = "1861462627"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "134217728"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: BaseMacToIp
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SetHostname:0x0000027c23756740>
 INFO warden: Calling IN action: VMware Middleware: VMXModify
 INFO vmx_modify: Modifying VMX file according to user config...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = Vagrant: dc
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - invmteam = FALSE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 8192
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 80001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 8
DEBUG vmware_driver:   - numvcpus = 8
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6d 3d b1 24 10
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 
DEBUG vmware_driver:   - uuid.location = 
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462627
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 134217728
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmx_modify:   - Set: displayname = 'dc.windomain.local'
 INFO vmx_modify:   - Set: memsize = '3072'
 INFO vmx_modify:   - Set: numvcpus = '2'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "dc.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET invmteam = "FALSE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "80001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "8"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6d 3d b1 24 10"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = ""
DEBUG vmware_driver:   - SET uuid.location = ""
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vmci0.id = "1861462627"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "134217728"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: PrepareForwardedPortCollisionParams
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}]
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x0000027c23b5a440>
DEBUG environment: Attempting to acquire process-lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: fpcollision
 INFO handle_port_collisions: Detecting any forwarded port collisions...
DEBUG handle_port_collisions: Extra in use: {2222=>#<Set: {"*"}>}
DEBUG handle_port_collisions: Remap: {}
DEBUG handle_port_collisions: Repair: true
 INFO handle_port_collisions: Attempting to repair FP collision: 2222
 INFO handle_port_collisions: Repaired FP collision: 2222 to 2200
 INFO interface: info: Fixed port collision for 22 => 2222. Now on port 2200.
 INFO interface: info: ==> dc: Fixed port collision for 22 => 2222. Now on port 2200.
==> dc: Fixed port collision for 22 => 2222. Now on port 2200.
 INFO environment: Released process lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: Boot
 INFO interface: info: Starting the VMware VM...
 INFO interface: info: ==> dc: Starting the VMware VM...
==> dc: Starting the VMware VM...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "start", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "gui"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 42
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: VMware Middleware: WaitForAddress
 INFO interface: info: Waiting for the VM to receive an address...
 INFO interface: info: ==> dc: Waiting for the VM to receive an address...
==> dc: Waiting for the VM to receive an address...
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:14
DEBUG vmware_driver: Trying to get MAC address for ethernet1
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:1e
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:1e' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:1e RESPONSE=400 ERROR=No entry found for MAC 00:0c:29:a1:2f:1e
 INFO vmware_driver: Trying vmrun getGuestIPAddress...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "getGuestIPAddress", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Error: The VMware Tools are not running in the virtual machine: D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 4294967295
 INFO vmware_driver: vmrun getGuestIPAddress failed: VMRunError
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
 INFO warden: Calling IN action: VMware Middleware: ForwardPorts
DEBUG forward_ports: Building up ports to forward...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}]
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
 INFO interface: info: Forwarding ports...
 INFO interface: info: ==> dc: Forwarding ports...
==> dc: Forwarding ports...
 INFO interface: detail: -- 5985 => 55985
 INFO interface: detail:     dc: -- 5985 => 55985
    dc: -- 5985 => 55985
 INFO interface: detail: -- 5986 => 55986
 INFO interface: detail:     dc: -- 5986 => 55986
    dc: -- 5986 => 55986
 INFO interface: detail: -- 22 => 2200
 INFO interface: detail:     dc: -- 22 => 2200
    dc: -- 22 => 2200
DEBUG vmware_driver: requesting ports to be forwarded: [{:device=>"vmnet8", :guest_port=>5985, :host_port=>55985, :protocol=>"tcp", :guest_ip=>"192.168.222.129"}, {:device=>"vmnet8", :guest_port=>5986, :host_port=>55986, :protocol=>"tcp", :guest_ip=>"192.168.222.129"}, {:device=>"vmnet8", :guest_port=>22, :host_port=>2200, :protocol=>"tcp", :guest_ip=>"192.168.222.129"}]
DEBUG vmware_driver: forwarding ports via collection method
DEBUG vagrant_utility: request METHOD=PUT PATH=/vmnet/vmnet8/portforward RESPONSE=200 
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x0000027c240ac920>
 INFO interface: output: Waiting for machine to boot. This may take a few minutes...
 INFO interface: output: ==> dc: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
==> dc: Waiting for machine to boot. This may take a few minutes...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO interface: detail: WinRM address: 127.0.0.1:55985
 INFO interface: detail:     dc: WinRM address: 127.0.0.1:55985
    dc: WinRM address: 127.0.0.1:55985
 INFO interface: detail: WinRM username: vagrant
 INFO interface: detail:     dc: WinRM username: vagrant
    dc: WinRM username: vagrant
 INFO interface: detail: WinRM execution_time_limit: PT2H
 INFO interface: detail:     dc: WinRM execution_time_limit: PT2H
    dc: WinRM execution_time_limit: PT2H
 INFO interface: detail: WinRM transport: plaintext
 INFO interface: detail:     dc: WinRM transport: plaintext
    dc: WinRM transport: plaintext
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 75A0F9EF-D4EA-4D51-AE38-1CBD59A70032
DEBUG winrmshell: [WinRM] Command created for hostname with id: 14CBA006-5612-4614-A5EC-8EFF34E149D1
DEBUG winrmshell: [WinRM] creating command_id: 14CBA006-5612-4614-A5EC-8EFF34E149D1 on shell_id 75A0F9EF-D4EA-4D51-AE38-1CBD59A70032
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 14CBA006-5612-4614-A5EC-8EFF34E149D1 on shell_id 75A0F9EF-D4EA-4D51-AE38-1CBD59A70032
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2429edf0 @data=[{:stdout=>"vagrant-2016"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
 INFO interface: output: Machine booted and ready!
 INFO interface: output: ==> dc: Machine booted and ready!
==> dc: Machine booted and ready!
 INFO warden: Calling IN action: #<Proc:0x0000027c240ac8d0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x0000027c23a22370 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
DEBUG checkpoint: checkpoint data processing complete
 INFO warden: Calling IN action: #<Proc:0x0000027c23c03d88 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c20f1d800>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c20f1d800>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c23c03d60>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c23c03d60>
 INFO warden: Calling OUT action: #<Proc:0x0000027c23c03d88 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c23a22348>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c23a22348>
 INFO warden: Calling OUT action: #<Proc:0x0000027c23a22370 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c240ac8a8>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c240ac8a8>
 INFO warden: Calling OUT action: #<Proc:0x0000027c240ac8d0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x0000027c240ac920>
 INFO warden: Calling OUT action: VMware Middleware: ForwardPorts
 INFO warden: Calling OUT action: VMware Middleware: WaitForAddress
 INFO warden: Calling OUT action: VMware Middleware: Boot
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x0000027c23b5a440>
 INFO warden: Calling OUT action: VMware Middleware: PrepareForwardedPortCollisionParams
 INFO warden: Calling OUT action: VMware Middleware: VMXModify
 INFO interface: info: Setting hostname...
 INFO interface: info: ==> dc: Setting hostname...
==> dc: Setting hostname...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 737B5F7E-CCE7-4A37-991E-36ABD5BF5F72
DEBUG winrmshell: [WinRM] Command created for hostname with id: 45F0AD5C-AEED-4518-B492-ED5D4A0C1685
DEBUG winrmshell: [WinRM] creating command_id: 45F0AD5C-AEED-4518-B492-ED5D4A0C1685 on shell_id 737B5F7E-CCE7-4A37-991E-36ABD5BF5F72
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 45F0AD5C-AEED-4518-B492-ED5D4A0C1685 on shell_id 737B5F7E-CCE7-4A37-991E-36ABD5BF5F72
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a8d5e8 @data=[{:stdout=>"vagrant-2016"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: change_host_name
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: change_host_name in windows
 INFO guest: Execute capability: change_host_name [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, "dc"] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2415c190 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241572a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240bc280 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 16277B25-BA85-4B16-AF61-7F69F0DAC0AE
DEBUG winrmshell: [WinRM] Command created for if ([System.Net.Dns]::GetHostName() -eq 'dc') { exit 0 } exit 1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B420035D-6978-4068-9F29-F33A38486D08
DEBUG winrmshell: [WinRM] creating command_id: B420035D-6978-4068-9F29-F33A38486D08 on shell_id 16277B25-BA85-4B16-AF61-7F69F0DAC0AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B420035D-6978-4068-9F29-F33A38486D08 on shell_id 16277B25-BA85-4B16-AF61-7F69F0DAC0AE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23a807b8 @data=[], @exitcode=1>
DEBUG winrm: powershell executing:
            $computer = Get-WmiObject -Class Win32_ComputerSystem
            $retval = $computer.rename("dc").returnvalue
            exit $retval

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245499d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24548b50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2448a4e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E1730001-D5F7-4A0F-B1D7-031601F5C41B
DEBUG winrmshell: [WinRM] Command created for             $computer = Get-WmiObject -Class Win32_ComputerSystem
            $retval = $computer.rename("dc").returnvalue
            exit $retval


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C238B3FE-2775-4F55-AE15-17F7FE08E970
DEBUG winrmshell: [WinRM] creating command_id: C238B3FE-2775-4F55-AE15-17F7FE08E970 on shell_id E1730001-D5F7-4A0F-B1D7-031601F5C41B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C238B3FE-2775-4F55-AE15-17F7FE08E970 on shell_id E1730001-D5F7-4A0F-B1D7-031601F5C41B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24344700 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 93A5E4A3-D44C-4700-857E-7CFDAF9A3B66
DEBUG winrmshell: [WinRM] Command created for hostname with id: 66D39289-6BBF-4378-8321-347D1D4F4785
DEBUG winrmshell: [WinRM] creating command_id: 66D39289-6BBF-4378-8321-347D1D4F4785 on shell_id 93A5E4A3-D44C-4700-857E-7CFDAF9A3B66
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 66D39289-6BBF-4378-8321-347D1D4F4785 on shell_id 93A5E4A3-D44C-4700-857E-7CFDAF9A3B66
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a0ed88 @data=[{:stdout=>"vagrant-2016"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: reboot in windows
 INFO guest: Execute capability: reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242047c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241ff8e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24177ee0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5D98E347-5F74-4C9D-A097-74FF91A276B6
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3D66C0D0-A225-4344-8586-A3CEA8FCF948
DEBUG winrmshell: [WinRM] creating command_id: 3D66C0D0-A225-4344-8586-A3CEA8FCF948 on shell_id 5D98E347-5F74-4C9D-A097-74FF91A276B6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3D66C0D0-A225-4344-8586-A3CEA8FCF948 on shell_id 5D98E347-5F74-4C9D-A097-74FF91A276B6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240cc770 @data=[], @exitcode=0>
DEBUG reboot: Issuing reboot command for guest
DEBUG winrm: powershell executing:
shutdown /r /t 5 /f /d p:4:1 /c "Vagrant Reboot Computer"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c246130d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24612220 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2454b238 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8892315B-A2AC-4733-93C0-6D4E248A8182
DEBUG winrmshell: [WinRM] Command created for shutdown /r /t 5 /f /d p:4:1 /c "Vagrant Reboot Computer"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 641BCDBF-1B89-468B-B85D-79BC4C546DE3
DEBUG winrmshell: [WinRM] creating command_id: 641BCDBF-1B89-468B-B85D-79BC4C546DE3 on shell_id 8892315B-A2AC-4733-93C0-6D4E248A8182
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 641BCDBF-1B89-468B-B85D-79BC4C546DE3 on shell_id 8892315B-A2AC-4733-93C0-6D4E248A8182
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24483b20 @data=[], @exitcode=0>
 INFO interface: info: Waiting for machine to reboot...
 INFO interface: info: ==> dc: Waiting for machine to reboot...
==> dc: Waiting for machine to reboot...
DEBUG reboot: Waiting for machine to finish rebooting
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3A11544A-95AF-46EE-8F5D-6F01B3C7194B
DEBUG winrmshell: [WinRM] Command created for hostname with id: 69508B31-C683-4444-8C4C-82478723A543
DEBUG winrmshell: [WinRM] creating command_id: 69508B31-C683-4444-8C4C-82478723A543 on shell_id 3A11544A-95AF-46EE-8F5D-6F01B3C7194B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 69508B31-C683-4444-8C4C-82478723A543 on shell_id 3A11544A-95AF-46EE-8F5D-6F01B3C7194B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c237b8cb0 @data=[{:stdout=>"vagrant-2016"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244bf9b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244beb30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243665d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1BE62A3C-8009-49DE-A34F-7F2D0BDD454A
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F3988E3C-AC8C-4DC3-A748-71209E95F1DD
DEBUG winrmshell: [WinRM] creating command_id: F3988E3C-AC8C-4DC3-A748-71209E95F1DD on shell_id 1BE62A3C-8009-49DE-A34F-7F2D0BDD454A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F3988E3C-AC8C-4DC3-A748-71209E95F1DD on shell_id 1BE62A3C-8009-49DE-A34F-7F2D0BDD454A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242b4cb8 @data=[{:stderr=>"shutdown.exe : A system shutdown has already been scheduled.(1190)\n    + CategoryInfo          : NotSpecified: (A system shutdo...cheduled.(1190):String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n"}], @exitcode=2>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EC8BDF0E-E52D-481F-AD6D-D9E85B163C10
DEBUG winrmshell: [WinRM] Command created for hostname with id: 37DBCEED-F928-4C03-9ABA-84EFD6B826A7
DEBUG winrmshell: [WinRM] creating command_id: 37DBCEED-F928-4C03-9ABA-84EFD6B826A7 on shell_id EC8BDF0E-E52D-481F-AD6D-D9E85B163C10
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 37DBCEED-F928-4C03-9ABA-84EFD6B826A7 on shell_id EC8BDF0E-E52D-481F-AD6D-D9E85B163C10
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c246f0778 @data=[{:stdout=>"vagrant-2016"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23b51b38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237f24b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22a300e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 0C2EE198-CBAD-4D8E-934C-DA7BDD700689
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1E5C1536-826D-4859-9C79-6B986A109A84
DEBUG winrmshell: [WinRM] creating command_id: 1E5C1536-826D-4859-9C79-6B986A109A84 on shell_id 0C2EE198-CBAD-4D8E-934C-DA7BDD700689
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1E5C1536-826D-4859-9C79-6B986A109A84 on shell_id 0C2EE198-CBAD-4D8E-934C-DA7BDD700689
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b4d5a0 @data=[{:stderr=>"shutdown.exe : A system shutdown is in progress.(1115)\n    + CategoryInfo          : NotSpecified: (A system shutdown is in progress.(1115):String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n"}], @exitcode=2>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C35253C0-057B-4DC8-9F4D-88DE312E6177
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5ADDB741-5BA2-4A3A-B0CC-68EF37C9A79A
DEBUG winrmshell: [WinRM] creating command_id: 5ADDB741-5BA2-4A3A-B0CC-68EF37C9A79A on shell_id C35253C0-057B-4DC8-9F4D-88DE312E6177
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5ADDB741-5BA2-4A3A-B0CC-68EF37C9A79A on shell_id C35253C0-057B-4DC8-9F4D-88DE312E6177
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24156bc8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2471c8f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c246f3978 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245d84d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 00439362-A8E8-46FE-B0FB-F80F10077FC3
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4F19BEFB-1002-48B4-90CF-68CDEDC7C3D5
DEBUG winrmshell: [WinRM] creating command_id: 4F19BEFB-1002-48B4-90CF-68CDEDC7C3D5 on shell_id 00439362-A8E8-46FE-B0FB-F80F10077FC3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4F19BEFB-1002-48B4-90CF-68CDEDC7C3D5 on shell_id 00439362-A8E8-46FE-B0FB-F80F10077FC3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24523cb0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22940ac0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c229313e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b3d0d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 538CD829-B2A1-4162-AA1B-E0D1A1D9DB37
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C2682C11-B16C-49BE-B469-43E0EFED2F8E
DEBUG winrmshell: [WinRM] creating command_id: C2682C11-B16C-49BE-B469-43E0EFED2F8E on shell_id 538CD829-B2A1-4162-AA1B-E0D1A1D9DB37
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C2682C11-B16C-49BE-B469-43E0EFED2F8E on shell_id 538CD829-B2A1-4162-AA1B-E0D1A1D9DB37
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249e65b8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SetHostname:0x0000027c23756740>
 INFO warden: Calling OUT action: VMware Middleware: BaseMacToIp
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
 INFO interface: info: Configuring network adapters within the VM...
 INFO interface: info: ==> dc: Configuring network adapters within the VM...
==> dc: Configuring network adapters within the VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F027CBD8-DD55-4FAF-B062-31E8BF4ED6A7
DEBUG winrmshell: [WinRM] Command created for hostname with id: B8A8275E-77A1-4CFD-A1F3-6F3E5AC0F8A6
DEBUG winrmshell: [WinRM] creating command_id: B8A8275E-77A1-4CFD-A1F3-6F3E5AC0F8A6 on shell_id F027CBD8-DD55-4FAF-B062-31E8BF4ED6A7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B8A8275E-77A1-4CFD-A1F3-6F3E5AC0F8A6 on shell_id F027CBD8-DD55-4FAF-B062-31E8BF4ED6A7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24217df0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: configure_networks
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: configure_networks in windows
 INFO guest: Execute capability: configure_networks [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.102", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]] (windows)
DEBUG configure_networks: Networks: [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.102", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]
 INFO interface: warn: Configuring secondary network adapters through VMware 
 INFO interface: warn: ==> dc: Configuring secondary network adapters through VMware 
==> dc: Configuring secondary network adapters through VMware 
 INFO interface: warn: on Windows is not yet supported. You will need to manually
 INFO interface: warn: ==> dc: on Windows is not yet supported. You will need to manually
==> dc: on Windows is not yet supported. You will need to manually
 INFO interface: warn: configure the network adapter.
 INFO interface: warn: ==> dc: configure the network adapter.
==> dc: configure the network adapter.
 INFO warden: Calling OUT action: VMware Middleware: Network
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
 INFO warden: Calling OUT action: VMware Middleware: PrepareNFSSettings
 INFO synced_folders: Invoking synced folder enable: vmware
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E6F22855-E625-4E0A-AA16-A16B654DE360
DEBUG winrmshell: [WinRM] Command created for hostname with id: F078566B-0C72-4F02-9B5E-5757CADFECB6
DEBUG winrmshell: [WinRM] creating command_id: F078566B-0C72-4F02-9B5E-5757CADFECB6 on shell_id E6F22855-E625-4E0A-AA16-A16B654DE360
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F078566B-0C72-4F02-9B5E-5757CADFECB6 on shell_id E6F22855-E625-4E0A-AA16-A16B654DE360
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c248b5518 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: verify_vmware_hgfs
DEBUG guest: Checking in: windows
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
==> dc: Enabling and configuring shared folders...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
 INFO synced_folder: Preparing shared folders with VMX...
 INFO interface: info: Enabling and configuring shared folders...
 INFO interface: info: ==> dc: Enabling and configuring shared folders...
 INFO vmware_driver: Enabling shared folders...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "enableSharedFolders", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO interface: detail: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO interface: detail:     dc: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
    dc: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO vmware_driver: Adding a shared folder '-vagrant': D:/workspace/eWalker/DetectionLab/Vagrant
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "addSharedFolder", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "setSharedFolderState", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant", "writable"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 94CB2F38-39D4-49C0-85D8-64B75F29EE48
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5EEBE618-E38E-428F-917E-F100796AE565
DEBUG winrmshell: [WinRM] creating command_id: 5EEBE618-E38E-428F-917E-F100796AE565 on shell_id 94CB2F38-39D4-49C0-85D8-64B75F29EE48
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5EEBE618-E38E-428F-917E-F100796AE565 on shell_id 94CB2F38-39D4-49C0-85D8-64B75F29EE48
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c238bc8a0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: mount_vmware_shared_folder
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: mount_vmware_shared_folder in windows
 INFO guest: Execute capability: mount_vmware_shared_folder [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, "-vagrant", "/vagrant", {:guestpath=>"/vagrant", :hostpath=>"D:/workspace/eWalker/DetectionLab/Vagrant", :disabled=>false, :__vagrantfile=>true, :plugin=>#<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000027c242edfb8 @logger=#<Log4r::Logger:0x0000027c242edf40 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_logger=#<Log4r::Logger:0x0000027c2432e900 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::syncedfolder", @outputters=[], @additive=true, @name="syncedfolder", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x0000027c21639d50 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware, #<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000027c2396ac20 @logger=#<Log4r::Logger:0x0000027c2396ab30 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>>]], @cap_args=[#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:virtualbox=>#<Vagrant::Registry:0x0000027c2432eb08 @items={:mount_options=>#<Proc:0x0000027c21bcb4a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:72>, :mount_type=>#<Proc:0x0000027c21bcb3e0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:77>, :mount_name=>#<Proc:0x0000027c21bcb318 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:82>}, @results_cache={}>, :smb=>#<Vagrant::Registry:0x0000027c2432ea68 @items={:default_fstab_modification=>#<Proc:0x0000027c21538e38 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:26>, :mount_options=>#<Proc:0x0000027c21538d98 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:31>, :mount_name=>#<Proc:0x0000027c21538c58 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:36>, :mount_type=>#<Proc:0x0000027c21538af0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:41>}, @results_cache={}>}>, :owner=>"vagrant", :group=>"vagrant"}] (windows)
DEBUG winrm: powershell executing:
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244dd558 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244dc4f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2436de20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8AF95D0E-DC87-41A5-91A3-47431347FB63
DEBUG winrmshell: [WinRM] Command created for function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1CE87164-BA45-462D-B9FE-6EA9A1EE5456
DEBUG winrmshell: [WinRM] creating command_id: 1CE87164-BA45-462D-B9FE-6EA9A1EE5456 on shell_id 8AF95D0E-DC87-41A5-91A3-47431347FB63
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1CE87164-BA45-462D-B9FE-6EA9A1EE5456 on shell_id 8AF95D0E-DC87-41A5-91A3-47431347FB63
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242b5cf8 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 54178FD8-DC4B-4D61-B027-225ECB0430BD
DEBUG winrmshell: [WinRM] Command created for hostname with id: C86752C1-070C-4B32-8A1B-F8841E945B8F
DEBUG winrmshell: [WinRM] creating command_id: C86752C1-070C-4B32-8A1B-F8841E945B8F on shell_id 54178FD8-DC4B-4D61-B027-225ECB0430BD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C86752C1-070C-4B32-8A1B-F8841E945B8F on shell_id 54178FD8-DC4B-4D61-B027-225ECB0430BD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24aa5af8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: persist_mount_shared_folder
DEBUG guest: Checking in: windows
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolders:0x0000027c22896d68>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Delayed:0x0000027c22896de0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x0000027c23636860>
 INFO warden: Calling OUT action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x0000027c2371f240>
 INFO warden: Calling OUT action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO provision: Writing provisioning sentinel so we don't provision again
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c24633308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A18FC650-4B8C-4F0F-82B1-4DB9BA0899D9
DEBUG winrmshell: [WinRM] Command created for hostname with id: ACAD55FE-1872-4DAA-9038-DE98D91D2CC9
DEBUG winrmshell: [WinRM] creating command_id: ACAD55FE-1872-4DAA-9038-DE98D91D2CC9 on shell_id A18FC650-4B8C-4F0F-82B1-4DB9BA0899D9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ACAD55FE-1872-4DAA-9038-DE98D91D2CC9 on shell_id A18FC650-4B8C-4F0F-82B1-4DB9BA0899D9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242578d8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9565D0A7-C6BA-4EF0-B6AE-534E23374F27
DEBUG winrmshell: [WinRM] Command created for hostname with id: F17032A5-6DD5-475B-988A-2DA8E8AE21F0
DEBUG winrmshell: [WinRM] creating command_id: F17032A5-6DD5-475B-988A-2DA8E8AE21F0 on shell_id 9565D0A7-C6BA-4EF0-B6AE-534E23374F27
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F17032A5-6DD5-475B-988A-2DA8E8AE21F0 on shell_id 9565D0A7-C6BA-4EF0-B6AE-534E23374F27
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249f4258 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 810E3A0C-000B-4E51-8E8A-2588837ADDDD
DEBUG winrmshell: [WinRM] Command created for hostname with id: FED34FAD-F2A7-40F5-94CB-0857C4F5671F
DEBUG winrmshell: [WinRM] creating command_id: FED34FAD-F2A7-40F5-94CB-0857C4F5671F on shell_id 810E3A0C-000B-4E51-8E8A-2588837ADDDD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FED34FAD-F2A7-40F5-94CB-0857C4F5671F on shell_id 810E3A0C-000B-4E51-8E8A-2588837ADDDD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2429e9e0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24923c20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24922d98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2485f5f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4E76F829-13B3-4C77-98E9-725535D03961
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BE613AB5-CE66-454F-BE0E-BAFDD012BB4F
DEBUG winrmshell: [WinRM] creating command_id: BE613AB5-CE66-454F-BE0E-BAFDD012BB4F on shell_id 4E76F829-13B3-4C77-98E9-725535D03961
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BE613AB5-CE66-454F-BE0E-BAFDD012BB4F on shell_id 4E76F829-13B3-4C77-98E9-725535D03961
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2471eb00 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23a42dc8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23a3bf28 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23694488 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4E694B84-31E2-4D38-AE2A-A2382AEA04F8
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 69EDBD0A-AD81-48B1-A678-DCB46D052D99
DEBUG winrmshell: [WinRM] creating command_id: 69EDBD0A-AD81-48B1-A678-DCB46D052D99 on shell_id 4E694B84-31E2-4D38-AE2A-A2382AEA04F8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 69EDBD0A-AD81-48B1-A678-DCB46D052D99 on shell_id 4E694B84-31E2-4D38-AE2A-A2382AEA04F8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c21d1a228 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1gqynar.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24244300 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2423f2b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241b63c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "df3bb7a140e7cb3fdabbde32ca410ed38003dcb4" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1gqynar.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A08851D1-A011-44A4-96F2-8CDEDD119DDB
DEBUG winrmshell: [WinRM] creating command_id: A08851D1-A011-44A4-96F2-8CDEDD119DDB on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A08851D1-A011-44A4-96F2-8CDEDD119DDB on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"False","df3bb7a140e7cb3fdabbde32ca410ed38003dcb4",,"True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1gqynar.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 44586B67-F917-4BAE-909A-B9EE86CDCBFF
DEBUG winrmshell: [WinRM] creating command_id: 44586B67-F917-4BAE-909A-B9EE86CDCBFF on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 44586B67-F917-4BAE-909A-B9EE86CDCBFF on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBTb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9TdGVmYW5TY2hlcmVyL2FkZnMyCnBhcmFtIChbU3RyaW5nXSAkaXAsIFtTdHJpbmddICRkbnMsIFtTdHJpbmddICRnYXRld2F5KQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFJ1bm5pbmcgZml4LXNlY29uZC1uZXR3b3JrLnBzMS4uLiIKCmlmICggKEdldC1OZXRBZGFwdGVyIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IEludGVyZmFjZURlc2NyaXB0aW9uKS5Db250YWlucygnUmVkIEhhdCBWaXJ0SU8nKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIE5ldHdvcmsgQ29uZmlndXJhdGlvbiBmb3IgTGliVmlydCBpbnRlcmZhY2UiCiAgJHN1Ym5ldCA9ICRpcCAtcmVwbGFjZSAiXC5cZCskIiwgIiIKICAkbmFtZSA9IChHZXQtTmV0SVBBZGRyZXNzIC1BZGRyZXNzRmFtaWx5IElQdjQgYAogICAgIHwgV2hlcmUtT2JqZWN0IC1GaWx0ZXJTY3JpcHQgeyAoJF8uSVBBZGRyZXNzKS5TdGFydHNXaXRoKCIkc3VibmV0IikgfSBgCiAgICAgKS5JbnRlcmZhY2VBbGlhcwogIGlmICgkbmFtZSkgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldCBJUCBhZGRyZXNzIHRvICRpcCBvZiBpbnRlcmZhY2UgJG5hbWUiCiAgICAmIG5ldHNoLmV4ZSBpbnQgaXAgc2V0IGFkZHJlc3MgIiRuYW1lIiBzdGF0aWMgJGlwIDI1NS4yNTUuMjU1LjAgIiRnYXRld2F5IgogICAgaWYgKCRkbnMpIHsKICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldCBETlMgc2VydmVyIGFkZHJlc3MgdG8gJGRucyBvZiBpbnRlcmZhY2UgJG5hbWUiCiAgICAgICYgbmV0c2guZXhlIGludGVyZmFjZSBpcHY0IGFkZCBkbnNzZXJ2ZXIgIiRuYW1lIiBhZGRyZXNzPSRkbnMgaW5kZXg9MQogICAgfQogIH0gZWxzZSB7CiAgICBXcml0ZS1FcnJvciAiQ291bGQgbm90IGZpbmQgYSBpbnRlcmZhY2Ugd2l0aCBzdWJuZXQgJHN1Ym5ldC54eCIKICB9CiAgZXhpdCAwCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE5vIFZpcnRJTyBhZGFwdGVycywgbW92aW5nIG9uLi4uIgp9CgppZiAoISAoVGVzdC1QYXRoICdDOlxQcm9ncmFtIEZpbGVzXFZNd2FyZVxWTXdhcmUgVG9vbHMnKSApIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVk13YXJlIFRvb2xzIG5vdCBmb3VuZCwgbm8gbmVlZCB0byBjb250aW51ZS4gRXhpdGluZy4iCiAgZXhpdCAwCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSIKV3JpdGUtSG9zdCAiU2V0dGluZyBJUCBhZGRyZXNzIGFuZCBETlMgaW5mb3JtYXRpb24gZm9yIHRoZSBFdGhlcm5ldDEgaW50ZXJmYWNlIgpXcml0ZS1Ib3N0ICJJZiB0aGlzIHN0ZXAgdGltZXMgb3V0LCBpdCdzIGJlY2F1c2UgdmFncmFudCBpcyBjb25uZWN0aW5nIHRvIHRoZSBWTSBvbiB0aGUgd3JvbmcgaW50ZXJmYWNlIgpXcml0ZS1Ib3N0ICJTZWUgaHR0cHM6Ly9naXRodWIuY29tL2Nsb25nL0RldGVjdGlvbkxhYi9pc3N1ZXMvMTE0IGZvciBtb3JlIGluZm9ybWF0aW9uIgoKJHN1Ym5ldCA9ICRpcCAtcmVwbGFjZSAiXC5cZCskIiwgIiIKJG5hbWUgPSAoR2V0LU5ldElQQWRkcmVzcyAtQWRkcmVzc0ZhbWlseSBJUHY0IGAKICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7ICgkXy5JUEFkZHJlc3MpLlN0YXJ0c1dpdGgoJHN1Ym5ldCkgfSBgCiAgICkuSW50ZXJmYWNlQWxpYXMKaWYgKCEkbmFtZSkgewogICRuYW1lID0gKEdldC1OZXRJUEFkZHJlc3MgLUFkZHJlc3NGYW1pbHkgSVB2NCBgCiAgICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7ICgkXy5JUEFkZHJlc3MpLlN0YXJ0c1dpdGgoIjE2OS4yNTQuIikgfSBgCiAgICAgKS5JbnRlcmZhY2VBbGlhcwp9CmlmICgkbmFtZSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXQgSVAgYWRkcmVzcyB0byAkaXAgb2YgaW50ZXJmYWNlICRuYW1lIgogICYgbmV0c2guZXhlIGludCBpcCBzZXQgYWRkcmVzcyAiJG5hbWUiIHN0YXRpYyAkaXAgMjU1LjI1NS4yNTUuMCAiJHN1Ym5ldC4xIgogIGlmICgkZG5zKSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU2V0IEROUyBzZXJ2ZXIgYWRkcmVzcyB0byAkZG5zIG9mIGludGVyZmFjZSAkbmFtZSIKICAgICYgbmV0c2guZXhlIGludGVyZmFjZSBpcHY0IGFkZCBkbnNzZXJ2ZXIgIiRuYW1lIiBhZGRyZXNzPSRkbnMgaW5kZXg9MQogIH0KfSBlbHNlIHsKICBXcml0ZS1FcnJvciAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIENvdWxkIG5vdCBmaW5kIGEgaW50ZXJmYWNlIHdpdGggc3VibmV0ICRzdWJuZXQueHgiCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B57D31DC-19F5-44D1-8048-FCE601EAB776
DEBUG winrmshell: [WinRM] creating command_id: B57D31DC-19F5-44D1-8048-FCE601EAB776 on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B57D31DC-19F5-44D1-8048-FCE601EAB776 on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9F4CF9AF-20F8-4881-B7EE-8E396B955EDA
DEBUG winrmshell: [WinRM] creating command_id: 9F4CF9AF-20F8-4881-B7EE-8E396B955EDA on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9F4CF9AF-20F8-4881-B7EE-8E396B955EDA on shell_id 21793F70-AC41-4D41-954A-55943AF211C4
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1gqynar.ps1 to C:/tmp/vagrant-shell.ps1 (3.296 KB over 1 chunks) in (0m0.19s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.39s) stream_files: (0m0.19s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: elevated executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1" -ip 192.168.56.102 -dns 8.8.8.8 -gateway 192.168.56.1
DEBUG winrmshell: creating hash for file c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22877148 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c228674f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b34398 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "0c527249f107e16fa04dd1063f6aa865c8b394d6" = @{
    "target" = "c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1";
    "src_basename" = "c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1";
    "dst" = "c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 64C12731-A7D5-4603-9E0F-1635257584F7
DEBUG winrmshell: [WinRM] creating command_id: 64C12731-A7D5-4603-9E0F-1635257584F7 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 64C12731-A7D5-4603-9E0F-1635257584F7 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"False","0c527249f107e16fa04dd1063f6aa865c8b394d6",,"True","False","False"


DEBUG winrmshell: Uploading #<StringIO:0x0000027c2427c2c8> to c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 962E70E0-42DF-4914-806B-8AF43B2D690E
DEBUG winrmshell: [WinRM] creating command_id: 962E70E0-42DF-4914-806B-8AF43B2D690E on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 962E70E0-42DF-4914-806B-8AF43B2D690E on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('77u/cG93ZXJzaGVsbCAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtT3V0cHV0Rm9ybWF0IFRleHQgLWZpbGUgIkM6XHRtcFx2YWdyYW50LXNoZWxsLnBzMSIgLWlwIDE5Mi4xNjguNTYuMTAyIC1kbnMgOC44LjguOCAtZ2F0ZXdheSAxOTIuMTY4LjU2LjENCiRIb3N0LlNldFNob3VsZEV4aXQoJExBU1RFWElUQ09ERSk=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B26B87EF-8FC3-4862-AA2F-B20506ED25A5
DEBUG winrmshell: [WinRM] creating command_id: B26B87EF-8FC3-4862-AA2F-B20506ED25A5 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B26B87EF-8FC3-4862-AA2F-B20506ED25A5 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B55965E2-3719-4477-AA5F-F66F12D8D5D4
DEBUG winrmshell: [WinRM] creating command_id: B55965E2-3719-4477-AA5F-F66F12D8D5D4 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B55965E2-3719-4477-AA5F-F66F12D8D5D4 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: Finished uploading #<StringIO:0x0000027c2427c2c8> to c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1 (0.236 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.35s) stream_files: (0m0.16s) extract: (0m0.00s) 
DEBUG winrmshell: [WinRM] Command created for $username = 'vagrant'
$password = 'vagrant'
$script_file = 'c:/windows/temp/winrm-elevated-shell-24e9d1eb-1f81-4a24-803c-d9da790a3f4b.ps1'

$interactive = 'false'
$pass_to_use = $password
$logon_type = 1
$logon_type_xml = "<LogonType>Password</LogonType>"
if($pass_to_use.length -eq 0) {
  $pass_to_use = $null
  $logon_type = 5
  $logon_type_xml = ""
}
if($interactive -eq 'true') {
  $logon_type = 3
  $logon_type_xml = "<LogonType>InteractiveTokenOrPassword</LogonType>"
}

$task_name = "WinRM_Elevated_Shell_" + [guid]::NewGuid()
$out_file = [System.IO.Path]::GetTempFileName()
$err_file = [System.IO.Path]::GetTempFileName()

$task_xml = @'
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <Principals>
    <Principal id="Author">
      <UserId>{username}</UserId>
      {logon_type}
      <RunLevel>HighestAvailable</RunLevel>
    </Principal>
  </Principals>
  <Settings>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>
    <AllowHardTerminate>true</AllowHardTerminate>
    <StartWhenAvailable>false</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <StopOnIdleEnd>false</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>PT24H</ExecutionTimeLimit>
    <Priority>4</Priority>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>cmd</Command>
      <Arguments>{arguments}</Arguments>
    </Exec>
  </Actions>
</Task>
'@

$arguments = "/c powershell.exe -executionpolicy bypass -NoProfile -File $script_file &gt; $out_file 2&gt;$err_file"

$task_xml = $task_xml.Replace("{arguments}", $arguments)
$task_xml = $task_xml.Replace("{username}", $username)
$task_xml = $task_xml.Replace("{logon_type}", $logon_type_xml)

try {
    $schedule = New-Object -ComObject "Schedule.Service"
    $schedule.Connect()
    $task = $schedule.NewTask($null)
    $task.XmlText = $task_xml
    $folder = $schedule.GetFolder("\")
    $folder.RegisterTaskDefinition($task_name, $task, 6, $username, $pass_to_use, $logon_type, $null) | Out-Null

    $registered_task = $folder.GetTask("\$task_name")
    $registered_task.Run($null) | Out-Null

    $timeout = 10
    $sec = 0
    while ( (!($registered_task.state -eq 4)) -and ($sec -lt $timeout) ) {
        Start-Sleep -s 1
        $sec++
    }
} catch {
    Write-Error -ErrorRecord $PSItem
    exit $PSItem.Exception.HResult
}

function SlurpOutput($file, $cur_line, $out_type) {
  if (Test-Path $file) {
    $fs = New-Object -TypeName System.IO.FileStream -ArgumentList @(
      $file,
      [system.io.filemode]::Open,
      [System.io.FileAccess]::Read,
      [System.IO.FileShare]::ReadWrite
    )
    try {
      $enc = [System.Text.Encoding]::GetEncoding($Host.CurrentCulture.TextInfo.OEMCodePage)
      $bytes = [System.Byte[]]::CreateInstance([System.Byte], $fs.Length)
      if ($fs.Read($bytes, 0, $fs.Length) -gt 0) {
        $text = $enc.GetString($bytes)
        $text.TrimEnd("`n").TrimEnd("`r").Split(@("`r`n", "`n"), [StringSplitOptions]::None) | Select-Object -skip $cur_line | ForEach-Object {
          $cur_line += 1
          if ($out_type -eq 'err') {
            $host.ui.WriteErrorLine("$_")
          } else {
            $host.ui.WriteLine("$_")
          }
        }
      }
    }
    finally { $fs.Close() }
  }
  return $cur_line
}

$err_cur_line = 0
$out_cur_line = 0
$timeout = 86400
$startDate = Get-Date
do {
  Start-Sleep -m 100
  $out_cur_line = SlurpOutput $out_file $out_cur_line 'out'
  $err_cur_line = SlurpOutput $err_file $err_cur_line 'err'
} while( (!($registered_task.state -eq 3)) -and ($startDate.AddSeconds($timeout) -gt (Get-Date)) )

# We'll make a best effort to clean these files
# But a reboot could possibly end the task while the process
# still runs and locks the file. If we can't delete we don't want to fail
try { Remove-Item $out_file -ErrorAction Stop } catch {}
try { Remove-Item $err_file -ErrorAction Stop } catch {}
try { Remove-Item $script_file -ErrorAction Stop } catch {}

$exit_code = $registered_task.LastTaskResult

try {
  # Clean current task
  $folder.DeleteTask($task_name, 0)
  # Clean old tasks if required
  $old_tasks_filter_date = [datetime]::Now.AddSeconds(-86400)
  $old_tasks_to_kill = $folder.GetTasks(0) | Select Name,LastRunTime | Where-Object {
    ($_.Name -like "WinRM_Elevated_Shell*") -and ($_.LastRunTime -le $old_tasks_filter_date) -and ($_.Name -ne $task_name)
  }
  $old_tasks_to_kill | ForEach-Object { try { $folder.DeleteTask($_.Name, 0) } catch {} }
}
catch {}

[System.Runtime.Interopservices.Marshal]::ReleaseComObject($schedule) | Out-Null

exit $exit_code


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 603C9638-7043-42F2-8DF2-0369699C0137
DEBUG winrmshell: [WinRM] creating command_id: 603C9638-7043-42F2-8DF2-0369699C0137 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [07:31] Running fix-second-network.ps1...
 INFO interface: detail:     dc: [07:31] Running fix-second-network.ps1...
    dc: [07:31] Running fix-second-network.ps1...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [07:31] No VirtIO adapters, moving on...
 INFO interface: detail:     dc: [07:31] No VirtIO adapters, moving on...
    dc: [07:31] No VirtIO adapters, moving on...
 INFO interface: detail: [07:31]
 INFO interface: detail:     dc: [07:31]
    dc: [07:31]
 INFO interface: detail: Setting IP address and DNS information for the Ethernet1 interface
 INFO interface: detail:     dc: Setting IP address and DNS information for the Ethernet1 interface
    dc: Setting IP address and DNS information for the Ethernet1 interface
 INFO interface: detail: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
 INFO interface: detail:     dc: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
    dc: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
 INFO interface: detail: See https://github.com/clong/DetectionLab/issues/114 for more information
 INFO interface: detail:     dc: See https://github.com/clong/DetectionLab/issues/114 for more information
    dc: See https://github.com/clong/DetectionLab/issues/114 for more information
 INFO interface: detail: [07:31] Set IP address to 192.168.56.102 of interface Ethernet1
 INFO interface: detail:     dc: [07:31] Set IP address to 192.168.56.102 of interface Ethernet1
    dc: [07:31] Set IP address to 192.168.56.102 of interface Ethernet1
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [07:31] Set DNS server address to 8.8.8.8 of interface Ethernet1
 INFO interface: detail:     dc: [07:31] Set DNS server address to 8.8.8.8 of interface Ethernet1
    dc: [07:31] Set DNS server address to 8.8.8.8 of interface Ethernet1
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 603C9638-7043-42F2-8DF2-0369699C0137 on shell_id A1C7AD52-8072-4404-92BA-3028068C21C8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c22875cf8 @data=[{:stdout=>"[07:31] Running fix-second-network.ps1...\r\n"}, {:stdout=>"[07:31] No VirtIO adapters, moving on...\r\n"}, {:stdout=>"[07:31]\r\n"}, {:stdout=>"Setting IP address and DNS information for the Ethernet1 interface\r\n"}, {:stdout=>"If this step times out, it's because vagrant is connecting to the VM on the wrong interface\r\n"}, {:stdout=>"See https://github.com/clong/DetectionLab/issues/114 for more information\r\n"}, {:stdout=>"[07:31] Set IP address to 192.168.56.102 of interface Ethernet1\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:31] Set DNS server address to 8.8.8.8 of interface Ethernet1\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24633308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c2435dd68 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 178C7037-7EC9-4FEF-9525-C973EBDF8D19
DEBUG winrmshell: [WinRM] Command created for hostname with id: 415A6CC7-8886-4AF3-A418-AF9493721E64
DEBUG winrmshell: [WinRM] creating command_id: 415A6CC7-8886-4AF3-A418-AF9493721E64 on shell_id 178C7037-7EC9-4FEF-9525-C973EBDF8D19
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 415A6CC7-8886-4AF3-A418-AF9493721E64 on shell_id 178C7037-7EC9-4FEF-9525-C973EBDF8D19
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2408f898 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>55986, 22=>2200, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 734969B4-57C3-4E22-9D42-72274F3839D1
DEBUG winrmshell: [WinRM] Command created for hostname with id: A20FA9CF-C972-44A3-A00F-5F9586434A4F
DEBUG winrmshell: [WinRM] creating command_id: A20FA9CF-C972-44A3-A00F-5F9586434A4F on shell_id 734969B4-57C3-4E22-9D42-72274F3839D1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A20FA9CF-C972-44A3-A00F-5F9586434A4F on shell_id 734969B4-57C3-4E22-9D42-72274F3839D1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c246e9fe0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7D85B595-0507-4F87-8B47-49CCCA85756F
DEBUG winrmshell: [WinRM] Command created for hostname with id: F2A86F11-2B88-4946-88AE-A2408A18646E
DEBUG winrmshell: [WinRM] creating command_id: F2A86F11-2B88-4946-88AE-A2408A18646E on shell_id 7D85B595-0507-4F87-8B47-49CCCA85756F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F2A86F11-2B88-4946-88AE-A2408A18646E on shell_id 7D85B595-0507-4F87-8B47-49CCCA85756F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240c7978 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2459b620 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2459a798 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244f7688 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D85F6259-CF46-4E6C-9109-3BA6ED52A121
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 787D3707-F5BD-460D-BDF5-AEAC650CDDAC
DEBUG winrmshell: [WinRM] creating command_id: 787D3707-F5BD-460D-BDF5-AEAC650CDDAC on shell_id D85F6259-CF46-4E6C-9109-3BA6ED52A121
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 787D3707-F5BD-460D-BDF5-AEAC650CDDAC on shell_id D85F6259-CF46-4E6C-9109-3BA6ED52A121
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c243ae5b0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24ac3030 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24ac21a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2496c998 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 62D24DA8-D43F-4E53-A83E-1C6F50B7C493
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CE379EA4-0A18-4BAA-825E-B19A188BEB56
DEBUG winrmshell: [WinRM] creating command_id: CE379EA4-0A18-4BAA-825E-B19A188BEB56 on shell_id 62D24DA8-D43F-4E53-A83E-1C6F50B7C493
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CE379EA4-0A18-4BAA-825E-B19A188BEB56 on shell_id 62D24DA8-D43F-4E53-A83E-1C6F50B7C493
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c248a4600 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1h59bbn.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23af9af0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23ae9da8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23796c00 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "91103d0ccbde4757bd913a8feb78e434a7d2d5dc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1h59bbn.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4A5A3E2F-1140-42E8-97F5-1B19C8DDE292
DEBUG winrmshell: [WinRM] creating command_id: 4A5A3E2F-1140-42E8-97F5-1B19C8DDE292 on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4A5A3E2F-1140-42E8-97F5-1B19C8DDE292 on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","df3bb7a140e7cb3fdabbde32ca410ed38003dcb4","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1h59bbn.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 74FF9E6B-63D3-4C05-810D-CCB47D31CAD3
DEBUG winrmshell: [WinRM] creating command_id: 74FF9E6B-63D3-4C05-810D-CCB47D31CAD3 on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 74FF9E6B-63D3-4C05-810D-CCB47D31CAD3 on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBTZXRzIHRpbWV6b25lIHRvIFVUQywgc2V0cyBob3N0bmFtZSwgY3JlYXRlcy9qb2lucyBkb21haW4uCiMgU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vU3RlZmFuU2NoZXJlci9hZGZzMgoKJFByb2ZpbGVQYXRoID0gIkM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwcm9maWxlLnBzMSIKJGJveCA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggSEtMTTpTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxDb21wdXRlck5hbWVcQ29tcHV0ZXJOYW1lIC1OYW1lICJDb21wdXRlck5hbWUiCiRib3ggPSAkYm94LkNvbXB1dGVyTmFtZS5Ub1N0cmluZygpLlRvTG93ZXIoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldHRpbmcgdGltZXpvbmUgdG8gVVRDLi4uIgpjOlx3aW5kb3dzXHN5c3RlbTMyXHR6dXRpbC5leGUgL3MgIlVUQyIKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDaGVja2luZyBpZiBXaW5kb3dzIGV2YWx1YXRpb24gaXMgZXhwaXJpbmcgc29vbiBvciBleHBpcmVkLi4uIgouIGM6XHZhZ3JhbnRcc2NyaXB0c1xmaXgtd2luZG93cy1leHBpcmF0aW9uLnBzMQoKSWYgKCEoVGVzdC1QYXRoICRQcm9maWxlUGF0aCkpIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGlzYWJsaW5nIHRoZSBJbnZva2UtV2ViUmVxdWVzdCBkb3dubG9hZCBwcm9ncmVzcyBiYXIgZ2xvYmFsbHkgZm9yIHNwZWVkIGltcHJvdmVtZW50cy4iIAogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZWUgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOCBmb3IgbW9yZSBpbmZvIgogIE5ldy1JdGVtIC1QYXRoICRQcm9maWxlUGF0aCB8IE91dC1OdWxsCiAgSWYgKCEoR2V0LUNvbnRlbnQgJFByb2ZpbGVwYXRofCAlIHsgJF8gLW1hdGNoICJTaWxlbnRseUNvbnRpbnVlIiB9ICkpIHsKICAgIEFkZC1Db250ZW50IC1QYXRoICRQcm9maWxlUGF0aCAtVmFsdWUgIiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZSciCiAgfQp9CgojIFBpbmcgRGV0ZWN0aW9uTGFiIHNlcnZlciBmb3IgdXNhZ2Ugc3RhdGlzdGljcwpUcnkgewogIGN1cmwgLXVzZXJBZ2VudCAiRGV0ZWN0aW9uTGFiLSRib3giICJodHRwczovL3BpbmcuZGV0ZWN0aW9ubGFiLm5ldHdvcmsvJGJveCIgLVVzZUJhc2ljUGFyc2luZyB8IG91dC1udWxsCn0gQ2F0Y2ggewogIFdyaXRlLUhvc3QgIlVuYWJsZSB0byBjb25uZWN0IHRvIHBpbmcuZGV0ZWN0aW9ubGFiLm5ldHdvcmsiCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEaXNhYmxpbmcgSVB2NiBvbiBhbGwgbmV0d29yayBhZGF0cGVycy4uLiIKR2V0LU5ldEFkYXB0ZXJCaW5kaW5nIC1Db21wb25lbnRJRCBtc190Y3BpcDYgfCBGb3JFYWNoLU9iamVjdCB7RGlzYWJsZS1OZXRBZGFwdGVyQmluZGluZyAtTmFtZSAkXy5OYW1lIC1Db21wb25lbnRJRCBtc190Y3BpcDZ9CkdldC1OZXRBZGFwdGVyQmluZGluZyAtQ29tcG9uZW50SUQgbXNfdGNwaXA2IAojIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLWdiL2hlbHAvOTI5ODUyL2d1aWRhbmNlLWZvci1jb25maWd1cmluZy1pcHY2LWluLXdpbmRvd3MtZm9yLWFkdmFuY2VkLXVzZXJzCnJlZyBhZGQgIkhLRVlfTE9DQUxfTUFDSElORVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcVGNwaXA2XFBhcmFtZXRlcnMiIC92IERpc2FibGVkQ29tcG9uZW50cyAvdCBSRUdfRFdPUkQgL2QgMjU1IC9mCgppZiAoJGVudjpDT01QVVRFUk5BTUUgLWltYXRjaCAndmFncmFudCcpIHsKCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEhvc3RuYW1lIGlzIHN0aWxsIHRoZSBvcmlnaW5hbCBvbmUsIHNraXAgcHJvdmlzaW9uaW5nIGZvciByZWJvb3QuLi4iCgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIGJnaW5mby4uLiIKICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xpbnN0YWxsLWJnaW5mby5wczEKCn0gZWxzZWlmICgoZ3dtaSB3aW4zMl9jb21wdXRlcnN5c3RlbSkucGFydG9mZG9tYWluIC1lcSAkZmFsc2UpIHsKCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEN1cnJlbnQgZG9tYWluIGlzIHNldCB0byAnd29ya2dyb3VwJy4gVGltZSB0byBqb2luIHRoZSBkb21haW4hIgoKICBpZiAoIShUZXN0LVBhdGggJ2M6XFByb2dyYW0gRmlsZXNcc3lzaW50ZXJuYWxzXGJnaW5mby5leGUnKSkgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgYmdpbmZvLi4uIgogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcaW5zdGFsbC1iZ2luZm8ucHMxCiAgICAjIFNldCBiYWNrZ3JvdW5kIHRvIGJlICJmaXR0ZWQiIGluc3RlYWQgb2YgInRpbGVkIgogICAgU2V0LUl0ZW1Qcm9wZXJ0eSAnSEtDVTpcQ29udHJvbCBQYW5lbFxEZXNrdG9wJyAtTmFtZSBUaWxlV2FsbHBhcGVyIC1WYWx1ZSAnMCcKICAgIFNldC1JdGVtUHJvcGVydHkgJ0hLQ1U6XENvbnRyb2wgUGFuZWxcRGVza3RvcCcgLU5hbWUgV2FsbHBhcGVyU3R5bGUgLVZhbHVlICc2JwogICAgIyBTZXQgVGFzayBNYW5hZ2VyIHByZWZzCiAgICByZWcgaW1wb3J0ICJjOlx2YWdyYW50XHJlc291cmNlc1x3aW5kb3dzXFRhc2tNYW5hZ2VyLnJlZyIgMj4mMSB8IG91dC1udWxsCiAgfQoKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgTXkgaG9zdG5hbWUgaXMgJGVudjpDT01QVVRFUk5BTUUiCiAgaWYgKCRlbnY6Q09NUFVURVJOQU1FIC1pbWF0Y2ggJ2RjJykgewogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcY3JlYXRlLWRvbWFpbi5wczEgMTkyLjE2OC41Ni4xMDIKICB9IGVsc2UgewogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcam9pbi1kb21haW4ucHMxCiAgfQp9IGVsc2UgewogIFdyaXRlLUhvc3QgLWZvcmUgZ3JlZW4gIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJIGFtIGRvbWFpbiBqb2luZWQhIgogIGlmICghKFRlc3QtUGF0aCAnYzpcUHJvZ3JhbSBGaWxlc1xzeXNpbnRlcm5hbHNcYmdpbmZvLmV4ZScpKSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW5zdGFsbGluZyBiZ2luZm8uLi4iCiAgICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xpbnN0YWxsLWJnaW5mby5wczEKICB9CgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIHRoZSByZWdpc3RyeSBmb3IgYXV0by1sb2dpbi4uLiIKICBTZXQtSXRlbVByb3BlcnR5ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxXaW5sb2dvbiIgLU5hbWUgQXV0b0FkbWluTG9nb24gLVZhbHVlIDEgLVR5cGUgU3RyaW5nCiAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC1OYW1lIERlZmF1bHRVc2VyTmFtZSAtVmFsdWUgInZhZ3JhbnQiCiAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC1OYW1lIERlZmF1bHRQYXNzd29yZCAtVmFsdWUgInZhZ3JhbnQiCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFByb3Zpc2lvbmluZyBhZnRlciBqb2luaW5nIGRvbWFpbi4uLiIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8113C113-6414-4A13-8BF9-5A0965E0CA1D
DEBUG winrmshell: [WinRM] creating command_id: 8113C113-6414-4A13-8BF9-5A0965E0CA1D on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8113C113-6414-4A13-8BF9-5A0965E0CA1D on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 71034FA6-DE69-4D0F-AB41-FC828AB82B69
DEBUG winrmshell: [WinRM] creating command_id: 71034FA6-DE69-4D0F-AB41-FC828AB82B69 on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 71034FA6-DE69-4D0F-AB41-FC828AB82B69 on shell_id 1C4F3B00-1FB3-489D-95B4-ED30E4620559
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1h59bbn.ps1 to C:/tmp/vagrant-shell.ps1 (5.112 KB over 1 chunks) in (0m0.14s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.39s) stream_files: (0m0.14s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c248be528 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c248bd6a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24776350 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B9CDDD35-4D23-49A6-BDA1-C0587B971D67
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 48862E25-F246-4B87-9B03-9606824BFBB0
DEBUG winrmshell: [WinRM] creating command_id: 48862E25-F246-4B87-9B03-9606824BFBB0 on shell_id B9CDDD35-4D23-49A6-BDA1-C0587B971D67
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [07:31] Setting timezone to UTC...
 INFO interface: detail:     dc: [07:31] Setting timezone to UTC...
    dc: [07:31] Setting timezone to UTC...
 INFO interface: detail: [07:31] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail:     dc: [07:31] Checking if Windows evaluation is expiring soon or expired...
    dc: [07:31] Checking if Windows evaluation is expiring soon or expired...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [07:31] 10 days remaining before expiration
 INFO interface: detail:     dc: [07:31] 10 days remaining before expiration
    dc: [07:31] 10 days remaining before expiration
 INFO interface: detail: [07:31] Less than 30 days remaining before Windows expiration. Attempting to rearm...
 INFO interface: detail:     dc: [07:31] Less than 30 days remaining before Windows expiration. Attempting to rearm...
    dc: [07:31] Less than 30 days remaining before Windows expiration. Attempting to rearm...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Microsoft (R) Windows Script Host Version 5.812
 INFO interface: detail:     dc: Microsoft (R) Windows Script Host Version 5.812
    dc: Microsoft (R) Windows Script Host Version 5.812
 INFO interface: detail: Copyright (C) Microsoft Corporation. All rights reserved.
 INFO interface: detail:     dc: Copyright (C) Microsoft Corporation. All rights reserved.
    dc: Copyright (C) Microsoft Corporation. All rights reserved.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Activating Windows(R), ServerStandardEval edition (9dfa8ec0-7665-4b9d-b2cb-bfc2dc37c9f4) ...
 INFO interface: detail:     dc: Activating Windows(R), ServerStandardEval edition (9dfa8ec0-7665-4b9d-b2cb-bfc2dc37c9f4) ...
    dc: Activating Windows(R), ServerStandardEval edition (9dfa8ec0-7665-4b9d-b2cb-bfc2dc37c9f4) ...
 INFO interface: detail: Product activated successfully.
 INFO interface: detail:     dc: Product activated successfully.
    dc: Product activated successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [07:32] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
 INFO interface: detail:     dc: [07:32] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
    dc: [07:32] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
 INFO interface: detail: [07:32] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
 INFO interface: detail:     dc: [07:32] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
    dc: [07:32] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
 INFO interface: detail: Unable to connect to ping.detectionlab.network
 INFO interface: detail:     dc: Unable to connect to ping.detectionlab.network
    dc: Unable to connect to ping.detectionlab.network
 INFO interface: detail: [07:32] Disabling IPv6 on all network adatpers...
 INFO interface: detail:     dc: [07:32] Disabling IPv6 on all network adatpers...
    dc: [07:32] Disabling IPv6 on all network adatpers...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Name                           DisplayName                                        ComponentID
 INFO interface: detail:     dc: Name                           DisplayName                                        ComponentID
    dc: Name                           DisplayName                                        ComponentID
 INFO interface: detail: ----                           -----------                                        -----------
 INFO interface: detail:     dc: ----                           -----------                                        -----------
    dc: ----                           -----------                                        -----------
 INFO interface: detail: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     dc: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    dc: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     dc: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    dc: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: The operation completed successfully.
 INFO interface: detail:     dc: The operation completed successfully.
    dc: The operation completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [07:32] Current domain is set to 'workgroup'. Time to join the domain!
 INFO interface: detail:     dc: [07:32] Current domain is set to 'workgroup'. Time to join the domain!
    dc: [07:32] Current domain is set to 'workgroup'. Time to join the domain!
 INFO interface: detail: [07:32] Installing bginfo...
 INFO interface: detail:     dc: [07:32] Installing bginfo...
    dc: [07:32] Installing bginfo...
 INFO interface: detail: [07:32] Installing BGInfo...
 INFO interface: detail:     dc: [07:32] Installing BGInfo...
    dc: [07:32] Installing BGInfo...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
 INFO interface: detail:     dc: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
    dc: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
 INFO interface: detail: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
 INFO interface: detail:     dc: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
    dc: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
 INFO interface: detail: PSChildName       : sysinternals
 INFO interface: detail:     dc: PSChildName       : sysinternals
    dc: PSChildName       : sysinternals
 INFO interface: detail: PSDrive           : C
 INFO interface: detail:     dc: PSDrive           : C
    dc: PSDrive           : C
 INFO interface: detail: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail:     dc: PSProvider        : Microsoft.PowerShell.Core\FileSystem
    dc: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail: PSIsContainer     : True
 INFO interface: detail:     dc: PSIsContainer     : True
    dc: PSIsContainer     : True
 INFO interface: detail: Name              : sysinternals
 INFO interface: detail:     dc: Name              : sysinternals
    dc: Name              : sysinternals
 INFO interface: detail: FullName          : C:\Program Files\sysinternals
 INFO interface: detail:     dc: FullName          : C:\Program Files\sysinternals
    dc: FullName          : C:\Program Files\sysinternals
 INFO interface: detail: Parent            : Program Files
 INFO interface: detail:     dc: Parent            : Program Files
    dc: Parent            : Program Files
 INFO interface: detail: Exists            : True
 INFO interface: detail:     dc: Exists            : True
    dc: Exists            : True
 INFO interface: detail: Root              : C:\
 INFO interface: detail:     dc: Root              : C:\
    dc: Root              : C:\
 INFO interface: detail: Extension         :
 INFO interface: detail:     dc: Extension         :
    dc: Extension         :
 INFO interface: detail: CreationTime      : 6/20/2022 7:32:12 AM
 INFO interface: detail:     dc: CreationTime      : 6/20/2022 7:32:12 AM
    dc: CreationTime      : 6/20/2022 7:32:12 AM
 INFO interface: detail: CreationTimeUtc   : 6/20/2022 2:32:12 PM
 INFO interface: detail:     dc: CreationTimeUtc   : 6/20/2022 2:32:12 PM
    dc: CreationTimeUtc   : 6/20/2022 2:32:12 PM
 INFO interface: detail: LastAccessTime    : 6/20/2022 7:32:12 AM
 INFO interface: detail:     dc: LastAccessTime    : 6/20/2022 7:32:12 AM
    dc: LastAccessTime    : 6/20/2022 7:32:12 AM
 INFO interface: detail: LastAccessTimeUtc : 6/20/2022 2:32:12 PM
 INFO interface: detail:     dc: LastAccessTimeUtc : 6/20/2022 2:32:12 PM
    dc: LastAccessTimeUtc : 6/20/2022 2:32:12 PM
 INFO interface: detail: LastWriteTime     : 6/20/2022 7:32:12 AM
 INFO interface: detail:     dc: LastWriteTime     : 6/20/2022 7:32:12 AM
    dc: LastWriteTime     : 6/20/2022 7:32:12 AM
 INFO interface: detail: LastWriteTimeUtc  : 6/20/2022 2:32:12 PM
 INFO interface: detail:     dc: LastWriteTimeUtc  : 6/20/2022 2:32:12 PM
    dc: LastWriteTimeUtc  : 6/20/2022 2:32:12 PM
 INFO interface: detail: Attributes        : Directory
 INFO interface: detail:     dc: Attributes        : Directory
    dc: Attributes        : Directory
 INFO interface: detail: Mode              : d-----
 INFO interface: detail:     dc: Mode              : d-----
    dc: Mode              : d-----
 INFO interface: detail: BaseName          : sysinternals
 INFO interface: detail:     dc: BaseName          : sysinternals
    dc: BaseName          : sysinternals
 INFO interface: detail: Target            : {}
 INFO interface: detail:     dc: Target            : {}
    dc: Target            : {}
 INFO interface: detail: LinkType          :
 INFO interface: detail:     dc: LinkType          :
    dc: LinkType          :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [07:32] My hostname is DC
 INFO interface: detail:     dc: [07:32] My hostname is DC
    dc: [07:32] My hostname is DC
 INFO interface: detail: [07:32] Installing RSAT tools
 INFO interface: detail:     dc: [07:32] Installing RSAT tools
    dc: [07:32] Installing RSAT tools
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Success       : True
 INFO interface: detail:     dc: Success       : True
    dc: Success       : True
 INFO interface: detail: RestartNeeded : No
 INFO interface: detail:     dc: RestartNeeded : No
    dc: RestartNeeded : No
 INFO interface: detail: FeatureResult : {Remote Server Administration Tools, Active Directory Administrative Center,
 INFO interface: detail:     dc: FeatureResult : {Remote Server Administration Tools, Active Directory Administrative Center,
    dc: FeatureResult : {Remote Server Administration Tools, Active Directory Administrative Center,
 INFO interface: detail:                 Active Directory module for Windows PowerShell, AD DS and AD LDS Tools...}
 INFO interface: detail:     dc:                 Active Directory module for Windows PowerShell, AD DS and AD LDS Tools...}
    dc:                 Active Directory module for Windows PowerShell, AD DS and AD LDS Tools...}
 INFO interface: detail: ExitCode      : Success
 INFO interface: detail:     dc: ExitCode      : Success
    dc: ExitCode      : Success
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [07:32] Creating domain controller...
 INFO interface: detail:     dc: [07:32] Creating domain controller...
    dc: [07:32] Creating domain controller...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: The task has completed successfully.
 INFO interface: detail:     dc: The task has completed successfully.
    dc: The task has completed successfully.
 INFO interface: detail: See log %windir%\security\logs\scesrv.log for detail info.
 INFO interface: detail:     dc: See log %windir%\security\logs\scesrv.log for detail info.
    dc: See log %windir%\security\logs\scesrv.log for detail info.
 INFO interface: detail: Completed 5 percent (0/18) 	Process Security Policy area
 INFO interface: detail:     dc: Completed 5 percent (0/18) 	Process Security Policy area
    dc: Completed 5 percent (0/18) 	Process Security Policy area
 INFO interface: detail: Completed 22 percent (3/18) 	Process Security Policy area
 INFO interface: detail:     dc: Completed 22 percent (3/18) 	Process Security Policy area
    dc: Completed 22 percent (3/18) 	Process Security Policy area
 INFO interface: detail: Completed 44 percent (7/18) 	Process Security Policy area
 INFO interface: detail:     dc: Completed 44 percent (7/18) 	Process Security Policy area
    dc: Completed 44 percent (7/18) 	Process Security Policy area
 INFO interface: detail: Completed 61 percent (10/18) 	Process Security Policy area
 INFO interface: detail:     dc: Completed 61 percent (10/18) 	Process Security Policy area
    dc: Completed 61 percent (10/18) 	Process Security Policy area
 INFO interface: detail: Completed 77 percent (13/18) 	Process Security Policy area
 INFO interface: detail:     dc: Completed 77 percent (13/18) 	Process Security Policy area
    dc: Completed 77 percent (13/18) 	Process Security Policy area
 INFO interface: detail: Completed 100 percent (18/18) 	Process Security Policy area
 INFO interface: detail:     dc: Completed 100 percent (18/18) 	Process Security Policy area
    dc: Completed 100 percent (18/18) 	Process Security Policy area
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: The task has completed successfully.
 INFO interface: detail:     dc: The task has completed successfully.
    dc: The task has completed successfully.
 INFO interface: detail: See log %windir%\security\logs\scesrv.log for detail info.
 INFO interface: detail:     dc: See log %windir%\security\logs\scesrv.log for detail info.
    dc: See log %windir%\security\logs\scesrv.log for detail info.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Success       : True
 INFO interface: detail:     dc: Success       : True
    dc: Success       : True
 INFO interface: detail: RestartNeeded : No
 INFO interface: detail:     dc: RestartNeeded : No
    dc: RestartNeeded : No
 INFO interface: detail: FeatureResult : {Active Directory Domain Services}
 INFO interface: detail:     dc: FeatureResult : {Active Directory Domain Services}
    dc: FeatureResult : {Active Directory Domain Services}
 INFO interface: detail: ExitCode      : Success
 INFO interface: detail:     dc: ExitCode      : Success
    dc: ExitCode      : Success
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Windows Server 2016 domain controllers have a default for the security setting named
 INFO interface: detail:     dc: WARNING: Windows Server 2016 domain controllers have a default for the security setting named
    dc: WARNING: Windows Server 2016 domain controllers have a default for the security setting named
 INFO interface: detail: "Allow cryptography algorithms compatible with Windows NT 4.0" that prevents weaker cryptography
 INFO interface: detail:     dc: "Allow cryptography algorithms compatible with Windows NT 4.0" that prevents weaker cryptography
    dc: "Allow cryptography algorithms compatible with Windows NT 4.0" that prevents weaker cryptography
 INFO interface: detail: algorithms when establishing security channel sessions.
 INFO interface: detail:     dc: algorithms when establishing security channel sessions.
    dc: algorithms when establishing security channel sessions.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: For more information about this setting, see Knowledge Base article 942564
 INFO interface: detail:     dc: For more information about this setting, see Knowledge Base article 942564
    dc: For more information about this setting, see Knowledge Base article 942564
 INFO interface: detail: (http://go.microsoft.com/fwlink/?LinkId=104751).
 INFO interface: detail:     dc: (http://go.microsoft.com/fwlink/?LinkId=104751).
    dc: (http://go.microsoft.com/fwlink/?LinkId=104751).
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: This computer has at least one physical network adapter that does not have static IP
 INFO interface: detail:     dc: WARNING: This computer has at least one physical network adapter that does not have static IP
    dc: WARNING: This computer has at least one physical network adapter that does not have static IP
 INFO interface: detail: address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network
 INFO interface: detail:     dc: address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network
    dc: address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network
 INFO interface: detail: adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6
 INFO interface: detail:     dc: adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6
    dc: adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6
 INFO interface: detail: Properties of the physical network adapter. Such static IP address(es) assignment should be done
 INFO interface: detail:     dc: Properties of the physical network adapter. Such static IP address(es) assignment should be done
    dc: Properties of the physical network adapter. Such static IP address(es) assignment should be done
 INFO interface: detail: to all the physical network adapters for reliable Domain Name System (DNS) operation.
 INFO interface: detail:     dc: to all the physical network adapters for reliable Domain Name System (DNS) operation.
    dc: to all the physical network adapters for reliable Domain Name System (DNS) operation.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone
 INFO interface: detail:     dc: WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone
    dc: WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone
 INFO interface: detail: cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS
 INFO interface: detail:     dc: cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS
    dc: cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS
 INFO interface: detail:  infrastructure, you should manually create a delegation to this DNS server in the parent zone to
 INFO interface: detail:     dc:  infrastructure, you should manually create a delegation to this DNS server in the parent zone to
    dc:  infrastructure, you should manually create a delegation to this DNS server in the parent zone to
 INFO interface: detail: ensure reliable name resolution from outside the domain "windomain.local". Otherwise, no action is
 INFO interface: detail:     dc: ensure reliable name resolution from outside the domain "windomain.local". Otherwise, no action is
    dc: ensure reliable name resolution from outside the domain "windomain.local". Otherwise, no action is
 INFO interface: detail:  required.
 INFO interface: detail:     dc:  required.
    dc:  required.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: WARNING: Windows Server 2016 domain controllers have a default for the security setting named
 INFO interface: detail:     dc: WARNING: Windows Server 2016 domain controllers have a default for the security setting named
    dc: WARNING: Windows Server 2016 domain controllers have a default for the security setting named
 INFO interface: detail: "Allow cryptography algorithms compatible with Windows NT 4.0" that prevents weaker cryptography
 INFO interface: detail:     dc: "Allow cryptography algorithms compatible with Windows NT 4.0" that prevents weaker cryptography
    dc: "Allow cryptography algorithms compatible with Windows NT 4.0" that prevents weaker cryptography
 INFO interface: detail: algorithms when establishing security channel sessions.
 INFO interface: detail:     dc: algorithms when establishing security channel sessions.
    dc: algorithms when establishing security channel sessions.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: For more information about this setting, see Knowledge Base article 942564
 INFO interface: detail:     dc: For more information about this setting, see Knowledge Base article 942564
    dc: For more information about this setting, see Knowledge Base article 942564
 INFO interface: detail: (http://go.microsoft.com/fwlink/?LinkId=104751).
 INFO interface: detail:     dc: (http://go.microsoft.com/fwlink/?LinkId=104751).
    dc: (http://go.microsoft.com/fwlink/?LinkId=104751).
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: This computer has at least one physical network adapter that does not have static IP
 INFO interface: detail:     dc: WARNING: This computer has at least one physical network adapter that does not have static IP
    dc: WARNING: This computer has at least one physical network adapter that does not have static IP
 INFO interface: detail: address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network
 INFO interface: detail:     dc: address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network
    dc: address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network
 INFO interface: detail: adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6
 INFO interface: detail:     dc: adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6
    dc: adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6
 INFO interface: detail: Properties of the physical network adapter. Such static IP address(es) assignment should be done
 INFO interface: detail:     dc: Properties of the physical network adapter. Such static IP address(es) assignment should be done
    dc: Properties of the physical network adapter. Such static IP address(es) assignment should be done
 INFO interface: detail: to all the physical network adapters for reliable Domain Name System (DNS) operation.
 INFO interface: detail:     dc: to all the physical network adapters for reliable Domain Name System (DNS) operation.
    dc: to all the physical network adapters for reliable Domain Name System (DNS) operation.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone
 INFO interface: detail:     dc: WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone
    dc: WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone
 INFO interface: detail: cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS
 INFO interface: detail:     dc: cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS
    dc: cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS
 INFO interface: detail:  infrastructure, you should manually create a delegation to this DNS server in the parent zone to
 INFO interface: detail:     dc:  infrastructure, you should manually create a delegation to this DNS server in the parent zone to
    dc:  infrastructure, you should manually create a delegation to this DNS server in the parent zone to
 INFO interface: detail: ensure reliable name resolution from outside the domain "windomain.local". Otherwise, no action is
 INFO interface: detail:     dc: ensure reliable name resolution from outside the domain "windomain.local". Otherwise, no action is
    dc: ensure reliable name resolution from outside the domain "windomain.local". Otherwise, no action is
 INFO interface: detail:  required.
 INFO interface: detail:     dc:  required.
    dc:  required.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Message        : You must restart this computer to complete the operation.
 INFO interface: detail:     dc: Message        : You must restart this computer to complete the operation.
    dc: Message        : You must restart this computer to complete the operation.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Context        : DCPromo.General.2
 INFO interface: detail:     dc: Context        : DCPromo.General.2
    dc: Context        : DCPromo.General.2
 INFO interface: detail: RebootRequired : True
 INFO interface: detail:     dc: RebootRequired : True
    dc: RebootRequired : True
 INFO interface: detail: Status         : Success
 INFO interface: detail:     dc: Status         : Success
    dc: Status         : Success
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [07:37] Setting DNS
 INFO interface: detail:     dc: [07:37] Setting DNS
    dc: [07:37] Setting DNS
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: __GENUS          : 2
 INFO interface: detail:     dc: __GENUS          : 2
    dc: __GENUS          : 2
 INFO interface: detail: __CLASS          : __PARAMETERS
 INFO interface: detail:     dc: __CLASS          : __PARAMETERS
    dc: __CLASS          : __PARAMETERS
 INFO interface: detail: __SUPERCLASS     :
 INFO interface: detail:     dc: __SUPERCLASS     :
    dc: __SUPERCLASS     :
 INFO interface: detail: __DYNASTY        : __PARAMETERS
 INFO interface: detail:     dc: __DYNASTY        : __PARAMETERS
    dc: __DYNASTY        : __PARAMETERS
 INFO interface: detail: __RELPATH        :
 INFO interface: detail:     dc: __RELPATH        :
    dc: __RELPATH        :
 INFO interface: detail: __PROPERTY_COUNT : 1
 INFO interface: detail:     dc: __PROPERTY_COUNT : 1
    dc: __PROPERTY_COUNT : 1
 INFO interface: detail: __DERIVATION     : {}
 INFO interface: detail:     dc: __DERIVATION     : {}
    dc: __DERIVATION     : {}
 INFO interface: detail: __SERVER         :
 INFO interface: detail:     dc: __SERVER         :
    dc: __SERVER         :
 INFO interface: detail: __NAMESPACE      :
 INFO interface: detail:     dc: __NAMESPACE      :
    dc: __NAMESPACE      :
 INFO interface: detail: __PATH           :
 INFO interface: detail:     dc: __PATH           :
    dc: __PATH           :
 INFO interface: detail: ReturnValue      : 0
 INFO interface: detail:     dc: ReturnValue      : 0
    dc: ReturnValue      : 0
 INFO interface: detail: PSComputerName   :
 INFO interface: detail:     dc: PSComputerName   :
    dc: PSComputerName   :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [07:37] Setting timezone to UTC
 INFO interface: detail:     dc: [07:37] Setting timezone to UTC
    dc: [07:37] Setting timezone to UTC
 INFO interface: detail: [07:37] Excluding NAT interface from DNS
 INFO interface: detail:     dc: [07:37] Excluding NAT interface from DNS
    dc: [07:37] Excluding NAT interface from DNS
 INFO interface: detail: ListenAddresses reset successful.
 INFO interface: detail:     dc: ListenAddresses reset successful.
    dc: ListenAddresses reset successful.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Command completed successfully.
 INFO interface: detail:     dc: Command completed successfully.
    dc: Command completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 48862E25-F246-4B87-9B03-9606824BFBB0 on shell_id B9CDDD35-4D23-49A6-BDA1-C0587B971D67
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c245e8d08 @data=[{:stdout=>"[07:31] Setting timezone to UTC...\r\n"}, {:stdout=>"[07:31] Checking if Windows evaluation is expiring soon or expired...\r\n"}, {:stdout=>"[07:31] 10 days remaining before expiration\r\n"}, {:stdout=>"[07:31] Less than 30 days remaining before Windows expiration. Attempting to rearm...\r\n"}, {:stdout=>"Microsoft (R) Windows Script Host Version 5.812\r\n"}, {:stdout=>"Copyright (C) Microsoft Corporation. All rights reserved.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Activating Windows(R), ServerStandardEval edition (9dfa8ec0-7665-4b9d-b2cb-bfc2dc37c9f4) ...\r\n"}, {:stdout=>"Product activated successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:32] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.\r\n"}, {:stdout=>"[07:32] See https://github.com/PowerShell/PowerShell/issues/2138 for more info\r\n"}, {:stdout=>"Unable to connect to ping.detectionlab.network\r\n"}, {:stdout=>"[07:32] Disabling IPv6 on all network adatpers...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           DisplayName                                        ComponentID     \r\n"}, {:stdout=>"----                           -----------                                        -----------     \r\n"}, {:stdout=>"Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"The operation completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:32] Current domain is set to 'workgroup'. Time to join the domain!\r\n"}, {:stdout=>"[07:32] Installing bginfo...\r\n"}, {:stdout=>"[07:32] Installing BGInfo...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Program Files\\sysinternals\r\n"}, {:stdout=>"PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\Program Files\r\n"}, {:stdout=>"PSChildName       : sysinternals\r\n"}, {:stdout=>"PSDrive           : C\r\n"}, {:stdout=>"PSProvider        : Microsoft.PowerShell.Core\\FileSystem\r\n"}, {:stdout=>"PSIsContainer     : True\r\n"}, {:stdout=>"Name              : sysinternals\r\n"}, {:stdout=>"FullName          : C:\\Program Files\\sysinternals\r\n"}, {:stdout=>"Parent            : Program Files\r\n"}, {:stdout=>"Exists            : True\r\n"}, {:stdout=>"Root              : C:\\\r\n"}, {:stdout=>"Extension         : \r\n"}, {:stdout=>"CreationTime      : 6/20/2022 7:32:12 AM\r\n"}, {:stdout=>"CreationTimeUtc   : 6/20/2022 2:32:12 PM\r\n"}, {:stdout=>"LastAccessTime    : 6/20/2022 7:32:12 AM\r\n"}, {:stdout=>"LastAccessTimeUtc : 6/20/2022 2:32:12 PM\r\n"}, {:stdout=>"LastWriteTime     : 6/20/2022 7:32:12 AM\r\n"}, {:stdout=>"LastWriteTimeUtc  : 6/20/2022 2:32:12 PM\r\n"}, {:stdout=>"Attributes        : Directory\r\n"}, {:stdout=>"Mode              : d-----\r\n"}, {:stdout=>"BaseName          : sysinternals\r\n"}, {:stdout=>"Target            : {}\r\n"}, {:stdout=>"LinkType          : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:32] My hostname is DC\r\n"}, {:stdout=>"[07:32] Installing RSAT tools\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Success       : True\r\n"}, {:stdout=>"RestartNeeded : No\r\n"}, {:stdout=>"FeatureResult : {Remote Server Administration Tools, Active Directory Administrative Center, \r\n"}, {:stdout=>"                Active Directory module for Windows PowerShell, AD DS and AD LDS Tools...}\r\n"}, {:stdout=>"ExitCode      : Success\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:32] Creating domain controller...\r\n"}, {:stdout=>"                                                                           \r\n"}, {:stdout=>"The task has completed successfully.\r\n"}, {:stdout=>"See log %windir%\\security\\logs\\scesrv.log for detail info.\r\n"}, {:stdout=>"Completed 5 percent (0/18) \tProcess Security Policy area        \r\n"}, {:stdout=>"Completed 22 percent (3/18) \tProcess Security Policy area        \r\n"}, {:stdout=>"Completed 44 percent (7/18) \tProcess Security Policy area        \r\n"}, {:stdout=>"Completed 61 percent (10/18) \tProcess Security Policy area        \r\n"}, {:stdout=>"Completed 77 percent (13/18) \tProcess Security Policy area        \r\n"}, {:stdout=>"Completed 100 percent (18/18) \tProcess Security Policy area        \r\n"}, {:stdout=>"                                                                           \r\n"}, {:stdout=>"The task has completed successfully.\r\n"}, {:stdout=>"See log %windir%\\security\\logs\\scesrv.log for detail info.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Success       : True\r\n"}, {:stdout=>"RestartNeeded : No\r\n"}, {:stdout=>"FeatureResult : {Active Directory Domain Services}\r\n"}, {:stdout=>"ExitCode      : Success\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: Windows Server 2016 domain controllers have a default for the security setting named \r\n"}, {:stdout=>"\"Allow cryptography algorithms compatible with Windows NT 4.0\" that prevents weaker cryptography \r\n"}, {:stdout=>"algorithms when establishing security channel sessions.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"For more information about this setting, see Knowledge Base article 942564 \r\n"}, {:stdout=>"(http://go.microsoft.com/fwlink/?LinkId=104751).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: This computer has at least one physical network adapter that does not have static IP \r\n"}, {:stdout=>"address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network \r\n"}, {:stdout=>"adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6 \r\n"}, {:stdout=>"Properties of the physical network adapter. Such static IP address(es) assignment should be done \r\n"}, {:stdout=>"to all the physical network adapters for reliable Domain Name System (DNS) operation.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone \r\n"}, {:stdout=>"cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS\r\n"}, {:stdout=>" infrastructure, you should manually create a delegation to this DNS server in the parent zone to \r\n"}, {:stdout=>"ensure reliable name resolution from outside the domain \"windomain.local\". Otherwise, no action is\r\n"}, {:stdout=>" required.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: Windows Server 2016 domain controllers have a default for the security setting named \r\n"}, {:stdout=>"\"Allow cryptography algorithms compatible with Windows NT 4.0\" that prevents weaker cryptography \r\n"}, {:stdout=>"algorithms when establishing security channel sessions.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"For more information about this setting, see Knowledge Base article 942564 \r\n"}, {:stdout=>"(http://go.microsoft.com/fwlink/?LinkId=104751).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: This computer has at least one physical network adapter that does not have static IP \r\n"}, {:stdout=>"address(es) assigned to its IP Properties. If both IPv4 and IPv6 are enabled for a network \r\n"}, {:stdout=>"adapter, both IPv4 and IPv6 static IP addresses should be assigned to both IPv4 and IPv6 \r\n"}, {:stdout=>"Properties of the physical network adapter. Such static IP address(es) assignment should be done \r\n"}, {:stdout=>"to all the physical network adapters for reliable Domain Name System (DNS) operation.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: A delegation for this DNS server cannot be created because the authoritative parent zone \r\n"}, {:stdout=>"cannot be found or it does not run Windows DNS server. If you are integrating with an existing DNS\r\n"}, {:stdout=>" infrastructure, you should manually create a delegation to this DNS server in the parent zone to \r\n"}, {:stdout=>"ensure reliable name resolution from outside the domain \"windomain.local\". Otherwise, no action is\r\n"}, {:stdout=>" required.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Message        : You must restart this computer to complete the operation.\r\n"}, {:stdout=>"                 \r\n"}, {:stdout=>"Context        : DCPromo.General.2\r\n"}, {:stdout=>"RebootRequired : True\r\n"}, {:stdout=>"Status         : Success\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:37] Setting DNS\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"__GENUS          : 2\r\n"}, {:stdout=>"__CLASS          : __PARAMETERS\r\n"}, {:stdout=>"__SUPERCLASS     : \r\n"}, {:stdout=>"__DYNASTY        : __PARAMETERS\r\n"}, {:stdout=>"__RELPATH        : \r\n"}, {:stdout=>"__PROPERTY_COUNT : 1\r\n"}, {:stdout=>"__DERIVATION     : {}\r\n"}, {:stdout=>"__SERVER         : \r\n"}, {:stdout=>"__NAMESPACE      : \r\n"}, {:stdout=>"__PATH           : \r\n"}, {:stdout=>"ReturnValue      : 0\r\n"}, {:stdout=>"PSComputerName   : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[07:37] Setting timezone to UTC\r\n"}, {:stdout=>"[07:37] Excluding NAT interface from DNS\r\n"}, {:stdout=>"ListenAddresses reset successful.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Command completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2435dd68 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: reload...
 INFO interface: info: ==> dc: Running provisioner: reload...
==> dc: Running provisioner: reload...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c239eadf8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO machine: Calling action: reload on provider VMware Workstation
 INFO interface: Machine: action ["reload", "start", {:target=>:dc}]
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c2386f398>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c214f9a80>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c24ad91c8>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000027c2454bda0>
 INFO warden: Calling IN action: #<Proc:0x0000027c242ed6d0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000027c2454bcd8>
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: VMware Middleware: CheckVMware
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c245283f0>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c24285be8>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000027c240e61e8>
 INFO warden: Calling IN action: #<Proc:0x0000027c23a4b3d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: DiscardSuspendedState
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - unity.wascapable = TRUE
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "FALSE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "dc.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:a1:2f:14"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:a1:2f:1e"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6b b8 79 c2 d0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "1"
DEBUG vmware_driver:   - SET sharedfolder0.enabled = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.expiration = "never"
DEBUG vmware_driver:   - SET sharedfolder0.guestname = "-vagrant"
DEBUG vmware_driver:   - SET sharedfolder0.hostpath = "D:\workspace\eWalker\DetectionLab\Vagrant"
DEBUG vmware_driver:   - SET sharedfolder0.present = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.readaccess = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.writeaccess = "TRUE"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET unity.wascapable = "TRUE"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET uuid.location = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "6286996480328961601"
DEBUG vmware_driver:   - SET vm.genidx = "3171757620272964659"
DEBUG vmware_driver:   - SET vmci0.id = "1861462628"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c240bd8d8>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c21e82c78>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000027c24956940>
 INFO warden: Calling IN action: #<Proc:0x0000027c24896190 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c24956878>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c247e3c20>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::GracefulHalt:0x0000027c246e25d8>
 INFO graceful_halt: Verifying source state of machine: :running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO interface: output: Attempting graceful shutdown of VM...
 INFO interface: output: ==> dc: Attempting graceful shutdown of VM...
==> dc: Attempting graceful shutdown of VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 55985
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C0A359EC-7F86-4EF7-A1BF-BAF31D78F162
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1A6B3BAA-353A-404A-819E-E2D885305B6E
DEBUG winrmshell: [WinRM] creating command_id: 1A6B3BAA-353A-404A-819E-E2D885305B6E on shell_id C0A359EC-7F86-4EF7-A1BF-BAF31D78F162
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1A6B3BAA-353A-404A-819E-E2D885305B6E on shell_id C0A359EC-7F86-4EF7-A1BF-BAF31D78F162
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241850e0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: halt
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: halt in windows
 INFO guest: Execute capability: halt [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
DEBUG winrm: powershell executing:
shutdown -a
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245a0df0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245a0f08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244de660 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 95A277B1-4FD1-4D10-A96E-6DFF7C782564
DEBUG winrmshell: [WinRM] Command created for shutdown -a

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: ECDDD343-2FB9-49B4-BCDB-1FE97BFF8155
DEBUG winrmshell: [WinRM] creating command_id: ECDDD343-2FB9-49B4-BCDB-1FE97BFF8155 on shell_id 95A277B1-4FD1-4D10-A96E-6DFF7C782564
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ECDDD343-2FB9-49B4-BCDB-1FE97BFF8155 on shell_id 95A277B1-4FD1-4D10-A96E-6DFF7C782564
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2435ca30 @data=[{:stderr=>"shutdown.exe : Unable to abort the system shutdown because no shutdown was in progress.(1116)\n    + CategoryInfo          : NotSpecified: (Unable to abort...progress.(1116):String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n"}], @exitcode=1116>
DEBUG winrm: powershell executing:
shutdown /s /t 1 /c "Vagrant Halt" /f /d p:4:1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:55985/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244880f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24483148 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24304c68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4E9EDC21-3A59-4BF0-923B-07F885C88D78
DEBUG winrmshell: [WinRM] Command created for shutdown /s /t 1 /c "Vagrant Halt" /f /d p:4:1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B35A6334-D4DD-4041-9141-35380A6D3FFC
DEBUG winrmshell: [WinRM] creating command_id: B35A6334-D4DD-4041-9141-35380A6D3FFC on shell_id 4E9EDC21-3A59-4BF0-923B-07F885C88D78
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B35A6334-D4DD-4041-9141-35380A6D3FFC on shell_id 4E9EDC21-3A59-4BF0-923B-07F885C88D78
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2425ce50 @data=[], @exitcode=0>
DEBUG graceful_halt: Waiting for target graceful halt state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO graceful_halt: Gracefully halted.
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::GracefulHalt:0x0000027c246e25d8>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000027c24580460>
 INFO warden: Calling IN action: #<Proc:0x0000027c244345e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: WaitForVMXHalt
 INFO wait_for_vmx_halt: Waiting for VMX process to go away...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
 INFO warden: Calling IN action: #<Proc:0x0000027c24542048 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x0000027c24956800 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x0000027c240bd860 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
DEBUG checkpoint: checkpoint data processing complete
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000027c244be310>
 INFO interface: output: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO interface: output: ==> dc: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
==> dc: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO box: box update check is under the interval threshold
 INFO box: Skipping box update check
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c24436578>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c242d7c18>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000027c2411de40>
 INFO warden: Calling IN action: #<Proc:0x0000027c239e2838 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: CheckExistingNetwork
 INFO check_existing_network: Checking if the vmnet devices are healthy...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Verifying vmnet devices are healthy...
 INFO interface: info: ==> dc: Verifying vmnet devices are healthy...
==> dc: Verifying vmnet devices are healthy...
DEBUG vagrant_utility: request METHOD=POST PATH=/vmnet/verify RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: PruneForwardedPorts
 INFO prune_forwarded_ports: Pruning forwarded ports...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
DEBUG vmware_driver: requesting prune of unused port forwards
DEBUG vagrant_utility: request METHOD=DELETE PATH=/portforwards RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000027c240be738>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000027c236b6998>
 INFO warden: Calling IN action: VMware Middleware: Suspended
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
DEBUG suspended: result: false
 INFO warden: Calling OUT action: VMware Middleware: Suspended
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000027c24523ad0>
 INFO warden: Calling IN action: #<Proc:0x0000027c240e4960 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Provision:0x0000027c24523a30>
 INFO provision: Checking provisioner sentinel file...
 INFO provision: Sentinel found! Not provisioning.
 INFO warden: Calling IN action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 1

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x0000027c244ef500>
DEBUG host: Searching for cap: nfs_prune
DEBUG host: Checking in: windows
 INFO nfs: Host doesn't support pruning NFS. Skipping.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x0000027c24480fd8>
 INFO synced_folder_cleanup: Invoking synced folder cleanup for: vmware
 INFO synced_folder: Clearing shared folders
 INFO vmware_driver: Clearing shared folders...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "dc.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:a1:2f:14"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:a1:2f:1e"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6b b8 79 c2 d0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET uuid.location = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "6286996480328961601"
DEBUG vmware_driver:   - SET vm.genidx = "3171757620272964659"
DEBUG vmware_driver:   - SET vmci0.id = "1861462628"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Delayed:0x0000027c2440de70>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolders:0x0000027c2440de48>
 INFO synced_folders: SyncedFolders loading from cache: false
 INFO synced_folders: Synced Folder Implementation: vmware
 INFO synced_folders:   - /vagrant: . => /vagrant
 INFO synced_folders: Invoking synced folder prepare for: vmware
 INFO warden: Calling IN action: VMware Middleware: PrepareNFSSettings
 INFO warden: Calling IN action: VMware Middleware: Network
DEBUG network: Available slots for high-level adapters: #<Set: {1, 2, 3, 4, 5, 6, 7, 8}>
 INFO network: Determining network adapters required for high-level configuration...
 INFO network:  -- Slot 1: hostonly
 INFO network: Determining adapters and compiling network configuration...
 INFO network: Slot 0. Type: nat
DEBUG network: Normalized configuration: {:auto_config=>false, :type=>:dhcp}
DEBUG network: Adapter configuration: {:type=>:nat, :slot=>0}
DEBUG network: Network configuration: {:type=>:dhcp, :auto_config=>false}
 INFO network: Slot 1. Type: hostonly
DEBUG network: Normalized configuration: {:auto_config=>true, :netmask=>"255.255.255.0", :type=>:static, :ip=>"192.168.56.102", :gateway=>"192.168.56.1", :dns=>"8.8.8.8", :protocol=>"tcp", :id=>"c614ec4e-a58f-4a8f-8fcf-b7ff8ba317cf", :subnet_ip=>"192.168.56.0", :adapter_ip=>"192.168.56.1"}
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
 INFO network: Found matching vmnet device: vmnet2
 INFO network: Checking for hostonly network collisions...
 INFO subprocess: Starting process: ["C:\\WINDOWS\\system32/netsh.exe", "interface", "ip", "show", "route"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 

Publish  Type      Met  Prefix                    Idx  Gateway/Interface Name

-------  --------  ---  ------------------------  ---  ------------------------

No       Manual    100  0.0.0.0/0                  18  10.89.255.254

No       System    256  10.89.0.0/16               18  Wi-Fi

No       System    256  10.89.78.193/32            18  Wi-Fi

No       System    256  10.89.255.255/32           18  Wi-Fi

No       System    256  127.0.0.0/8                 1  Loopback Pseudo-Interface 1

No       System    256  127.0.0.1/32                1  Loopback Pseudo-Interface 1

No       System    256  127.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  169.254.0.0/16             90  VMware Network Adapter VMnet2

No       System    256  169.254.140.76/32          90  VMware Network Adapter VMnet2

No       System    256  169.254.255.255/32         90  VMware Network Adapter VMnet2

No       System    256  172.19.112.0/20            73  vEthernet (vEthernet (NAT )

No       System    256  172.19.112.1/32            73  vEthernet (vEthernet (NAT )

No       System    256  172.19.127.255/32          73  vEthernet (vEthernet (NAT )

No       System    256  172.19.176.0/20            30  vEthernet (Default Switch)

No       System    256  172.19.176.1/32            30  vEthernet (Default Switch)

No       System    256  172.19.191.255/32          30  vEthernet (Default Switch)

No       System    256  172.21.80.0/20             91  vEthernet (Ethernet 6)

No       System    256  172.21.80.1/32             91  vEthernet (Ethernet 6)

No       System    256  172.21.95.255/32           91  vEthernet (Ethernet 6)

No       System    256  172.21.160.0/20            47  vEthernet (Ethernet)

No       System    256  172.21.160.1/32            47  vEthernet (Ethernet)

No       System    256  172.21.175.255/32          47  vEthernet (Ethernet)

No       System    256  172.22.192.0/20            22  vEthernet (VMware Network )

No       System    256  172.22.192.1/32            22  vEthernet (VMware Network )

No       System    256  172.22.207.255/32          22  vEthernet (VMware Network )

No       System    256  172.26.144.0/20            97  vEthernet (Wi-Fi)

No       System    256  172.26.144.1/32            97  vEthernet (Wi-Fi)

No       System    256  172.26.159.255/32          97  vEthernet (Wi-Fi)

No       System    256  172.27.128.0/20            84  vEthernet (VMware Network ) 2

No       System    256  172.27.128.1/32            84  vEthernet (VMware Network ) 2

No       System    256  172.27.143.255/32          84  vEthernet (VMware Network ) 2

No       System    256  192.168.44.0/24             4  VMware Network Adapter VMnet1

No       System    256  192.168.44.1/32             4  VMware Network Adapter VMnet1

No       System    256  192.168.44.255/32           4  VMware Network Adapter VMnet1

No       System    256  192.168.222.0/24           20  VMware Network Adapter VMnet8

No       System    256  192.168.222.1/32           20  VMware Network Adapter VMnet8

No       System    256  192.168.222.255/32         20  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 1  Loopback Pseudo-Interface 1

No       System    256  224.0.0.0/4                13  OpenVPN Wintun

No       System    256  224.0.0.0/4                24  vEthernet (NAT vSwitch)

No       System    256  224.0.0.0/4                 6  Ethernet

No       System    256  224.0.0.0/4                18  Wi-Fi

No       System    256  224.0.0.0/4                47  vEthernet (Ethernet)

No       System    256  224.0.0.0/4                30  vEthernet (Default Switch)

No       System    256  224.0.0.0/4                73  vEthernet (vEthernet (NAT )

No       System    256  224.0.0.0/4                97  vEthernet (Wi-Fi)

No       System    256  224.0.0.0/4                33  Local Area Connection* 2

No       System    256  224.0.0.0/4                 4  VMware Network Adapter VMnet1

No       System    256  224.0.0.0/4                20  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                22  vEthernet (VMware Network )

No       System    256  224.0.0.0/4                84  vEthernet (VMware Network ) 2

No       System    256  224.0.0.0/4                90  VMware Network Adapter VMnet2

No       System    256  224.0.0.0/4                91  vEthernet (Ethernet 6)

No       System    256  255.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  255.255.255.255/32         13  OpenVPN Wintun

No       System    256  255.255.255.255/32         24  vEthernet (NAT vSwitch)

No       System    256  255.255.255.255/32          6  Ethernet

No       System    256  255.255.255.255/32         18  Wi-Fi

No       System    256  255.255.255.255/32         47  vEthernet (Ethernet)

No       System    256  255.255.255.255/32         30  vEthernet (Default Switch)

No       System    256  255.255.255.255/32         73  vEthernet (vEthernet (NAT )

No       System    256  255.255.255.255/32         97  vEthernet (Wi-Fi)

No       System    256  255.255.255.255/32         33  Local Area Connection* 2

No       System    256  255.255.255.255/32          4  VMware Network Adapter VMnet1

No       System    256  255.255.255.255/32         20  VMware Network Adapter VMnet8

No       System    256  255.255.255.255/32         22  vEthernet (VMware Network )

No       System    256  255.255.255.255/32         84  vEthernet (VMware Network ) 2

No       System    256  255.255.255.255/32         90  VMware Network Adapter VMnet2

No       System    256  255.255.255.255/32         91  vEthernet (Ethernet 6)


DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG network: Adapter configuration: {:type=>:custom, :mac_address=>nil, :vnet=>"vmnet2", :slot=>1}
DEBUG network: Network configuration: {:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.102", :netmask=>"255.255.255.0", :auto_config=>true}
 INFO network: Enabling 2 adapters...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Preparing network adapters...
 INFO interface: info: ==> dc: Preparing network adapters...
==> dc: Preparing network adapters...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet0.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddressoffset
WARNING: The VMX file for this box contains a setting that is automatically overwritten by Vagrant
WARNING: when started. Vagrant will stop overwriting this setting in an upcoming release which may
WARNING: prevent proper networking setup. Below is the detected VMX setting:
WARNING: 
WARNING:   ethernet1.pcislotnumber = "33"
WARNING: 
WARNING: If networking fails to properly configure, it may require this VMX setting. It can be manually
WARNING: applied via the Vagrantfile:
WARNING: 
WARNING:   Vagrant.configure(2) do |config|
WARNING:     config.vm.provider :vmware_desktop do |vmware|
WARNING:       vmware.vmx["ethernet1.pcislotnumber"] = "33"
WARNING:     end
WARNING:   end
WARNING: 
WARNING: For more information: https://www.vagrantup.com/docs/vmware/boxes.html#vmx-allowlisting
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet1.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.vnet
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "dc.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6b b8 79 c2 d0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET uuid.location = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "6286996480328961601"
DEBUG vmware_driver:   - SET vm.genidx = "3171757620272964659"
DEBUG vmware_driver:   - SET vmci0.id = "1861462628"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: BaseMacToIp
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SetHostname:0x0000027c242b4740>
 INFO warden: Calling IN action: VMware Middleware: VMXModify
 INFO vmx_modify: Modifying VMX file according to user config...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmx_modify:   - Set: displayname = 'dc.windomain.local'
 INFO vmx_modify:   - Set: memsize = '3072'
 INFO vmx_modify:   - Set: numvcpus = '2'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "dc.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "3072"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 6b b8 79 c2 d0"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET uuid.location = "56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "6286996480328961601"
DEBUG vmware_driver:   - SET vm.genidx = "3171757620272964659"
DEBUG vmware_driver:   - SET vmci0.id = "1861462628"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: PrepareForwardedPortCollisionParams
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}]
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x0000027c24235788>
DEBUG environment: Attempting to acquire process-lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: fpcollision
 INFO handle_port_collisions: Detecting any forwarded port collisions...
DEBUG handle_port_collisions: Extra in use: {2200=>#<Set: {"*"}>, 2222=>#<Set: {"*"}>, 55985=>#<Set: {"*"}>, 55986=>#<Set: {"*"}>}
DEBUG handle_port_collisions: Remap: {}
DEBUG handle_port_collisions: Repair: true
 INFO handle_port_collisions: Attempting to repair FP collision: 55985
 INFO handle_port_collisions: Repaired FP collision: 55985 to 2201
 INFO interface: info: Fixed port collision for 5985 => 55985. Now on port 2201.
 INFO interface: info: ==> dc: Fixed port collision for 5985 => 55985. Now on port 2201.
==> dc: Fixed port collision for 5985 => 55985. Now on port 2201.
 INFO handle_port_collisions: Attempting to repair FP collision: 55986
 INFO handle_port_collisions: Repaired FP collision: 55986 to 2202
 INFO interface: info: Fixed port collision for 5986 => 55986. Now on port 2202.
 INFO interface: info: ==> dc: Fixed port collision for 5986 => 55986. Now on port 2202.
==> dc: Fixed port collision for 5986 => 55986. Now on port 2202.
 INFO handle_port_collisions: Attempting to repair FP collision: 2200
 INFO handle_port_collisions: Repaired FP collision: 2200 to 2203
 INFO interface: info: Fixed port collision for 22 => 2200. Now on port 2203.
 INFO interface: info: ==> dc: Fixed port collision for 22 => 2200. Now on port 2203.
==> dc: Fixed port collision for 22 => 2200. Now on port 2203.
 INFO environment: Released process lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: Boot
 INFO interface: info: Starting the VMware VM...
 INFO interface: info: ==> dc: Starting the VMware VM...
==> dc: Starting the VMware VM...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "start", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "gui"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 44
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: VMware Middleware: WaitForAddress
 INFO interface: info: Waiting for the VM to receive an address...
 INFO interface: info: ==> dc: Waiting for the VM to receive an address...
==> dc: Waiting for the VM to receive an address...
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
 INFO warden: Calling IN action: VMware Middleware: ForwardPorts
DEBUG forward_ports: Building up ports to forward...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}]
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
 INFO interface: info: Forwarding ports...
 INFO interface: info: ==> dc: Forwarding ports...
==> dc: Forwarding ports...
 INFO interface: detail: -- 5985 => 2201
 INFO interface: detail:     dc: -- 5985 => 2201
    dc: -- 5985 => 2201
 INFO interface: detail: -- 5986 => 2202
 INFO interface: detail:     dc: -- 5986 => 2202
    dc: -- 5986 => 2202
 INFO interface: detail: -- 22 => 2203
 INFO interface: detail:     dc: -- 22 => 2203
    dc: -- 22 => 2203
DEBUG vmware_driver: requesting ports to be forwarded: [{:device=>"vmnet8", :guest_port=>5985, :host_port=>2201, :protocol=>"tcp", :guest_ip=>"192.168.222.129"}, {:device=>"vmnet8", :guest_port=>5986, :host_port=>2202, :protocol=>"tcp", :guest_ip=>"192.168.222.129"}, {:device=>"vmnet8", :guest_port=>22, :host_port=>2203, :protocol=>"tcp", :guest_ip=>"192.168.222.129"}]
DEBUG vmware_driver: forwarding ports via collection method
DEBUG vagrant_utility: request METHOD=PUT PATH=/vmnet/vmnet8/portforward RESPONSE=200 
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x0000027c241b5ba0>
 INFO interface: output: Waiting for machine to boot. This may take a few minutes...
 INFO interface: output: ==> dc: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
==> dc: Waiting for machine to boot. This may take a few minutes...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
 INFO interface: detail: WinRM address: 127.0.0.1:55985
 INFO interface: detail:     dc: WinRM address: 127.0.0.1:55985
    dc: WinRM address: 127.0.0.1:55985
 INFO interface: detail: WinRM username: vagrant
 INFO interface: detail:     dc: WinRM username: vagrant
    dc: WinRM username: vagrant
 INFO interface: detail: WinRM execution_time_limit: PT2H
 INFO interface: detail:     dc: WinRM execution_time_limit: PT2H
    dc: WinRM execution_time_limit: PT2H
 INFO interface: detail: WinRM transport: plaintext
 INFO interface: detail:     dc: WinRM transport: plaintext
    dc: WinRM transport: plaintext
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4C5933C3-0D7D-411C-A8AB-59E91392ABF3
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8F07C6C7-89E5-430B-98F0-56C684FDB243
DEBUG winrmshell: [WinRM] creating command_id: 8F07C6C7-89E5-430B-98F0-56C684FDB243 on shell_id 4C5933C3-0D7D-411C-A8AB-59E91392ABF3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8F07C6C7-89E5-430B-98F0-56C684FDB243 on shell_id 4C5933C3-0D7D-411C-A8AB-59E91392ABF3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c236de7e0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO interface: output: Machine booted and ready!
 INFO interface: output: ==> dc: Machine booted and ready!
==> dc: Machine booted and ready!
 INFO warden: Calling IN action: #<Proc:0x0000027c241b5b50 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x0000027c240be6c0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<Proc:0x0000027c2440d998 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x0000027c2440d998 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x0000027c240be6c0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x0000027c241b5b50 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x0000027c241b5ba0>
 INFO warden: Calling OUT action: VMware Middleware: ForwardPorts
 INFO warden: Calling OUT action: VMware Middleware: WaitForAddress
 INFO warden: Calling OUT action: VMware Middleware: Boot
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x0000027c24235788>
 INFO warden: Calling OUT action: VMware Middleware: PrepareForwardedPortCollisionParams
 INFO warden: Calling OUT action: VMware Middleware: VMXModify
 INFO interface: info: Setting hostname...
 INFO interface: info: ==> dc: Setting hostname...
==> dc: Setting hostname...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B7149BE9-1653-4D53-BE38-BCA6C66E06B7
DEBUG winrmshell: [WinRM] Command created for hostname with id: 72DEAEDB-286B-493D-8A1D-C9D9BEE18CC3
DEBUG winrmshell: [WinRM] creating command_id: 72DEAEDB-286B-493D-8A1D-C9D9BEE18CC3 on shell_id B7149BE9-1653-4D53-BE38-BCA6C66E06B7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 72DEAEDB-286B-493D-8A1D-C9D9BEE18CC3 on shell_id B7149BE9-1653-4D53-BE38-BCA6C66E06B7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242f5830 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: change_host_name
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: change_host_name in windows
 INFO guest: Execute capability: change_host_name [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, "dc"] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2481ff40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2481ee88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245da6e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6323A2CB-E7D5-48FB-8012-BCF13E9389AD
DEBUG winrmshell: [WinRM] Command created for if ([System.Net.Dns]::GetHostName() -eq 'dc') { exit 0 } exit 1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CF92CB35-D44B-425C-B245-FB22E0543CE5
DEBUG winrmshell: [WinRM] creating command_id: CF92CB35-D44B-425C-B245-FB22E0543CE5 on shell_id 6323A2CB-E7D5-48FB-8012-BCF13E9389AD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CF92CB35-D44B-425C-B245-FB22E0543CE5 on shell_id 6323A2CB-E7D5-48FB-8012-BCF13E9389AD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c244eeb50 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SetHostname:0x0000027c242b4740>
 INFO warden: Calling OUT action: VMware Middleware: BaseMacToIp
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
 INFO interface: info: Configuring network adapters within the VM...
 INFO interface: info: ==> dc: Configuring network adapters within the VM...
==> dc: Configuring network adapters within the VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CAACE21D-C175-405D-9EE3-DD6C89C0C01B
DEBUG winrmshell: [WinRM] Command created for hostname with id: DD48684B-B487-4DC6-9307-E05DC982F144
DEBUG winrmshell: [WinRM] creating command_id: DD48684B-B487-4DC6-9307-E05DC982F144 on shell_id CAACE21D-C175-405D-9EE3-DD6C89C0C01B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DD48684B-B487-4DC6-9307-E05DC982F144 on shell_id CAACE21D-C175-405D-9EE3-DD6C89C0C01B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a8c7b0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: configure_networks
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: configure_networks in windows
 INFO guest: Execute capability: configure_networks [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.102", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]] (windows)
DEBUG configure_networks: Networks: [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.102", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]
 INFO interface: warn: Configuring secondary network adapters through VMware 
 INFO interface: warn: ==> dc: Configuring secondary network adapters through VMware 
==> dc: Configuring secondary network adapters through VMware 
 INFO interface: warn: on Windows is not yet supported. You will need to manually
 INFO interface: warn: ==> dc: on Windows is not yet supported. You will need to manually
==> dc: on Windows is not yet supported. You will need to manually
 INFO interface: warn: configure the network adapter.
 INFO interface: warn: ==> dc: configure the network adapter.
==> dc: configure the network adapter.
 INFO warden: Calling OUT action: VMware Middleware: Network
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
 INFO warden: Calling OUT action: VMware Middleware: PrepareNFSSettings
 INFO synced_folders: Invoking synced folder enable: vmware
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 49000C72-7E1B-463C-85C1-6E4028E660B4
DEBUG winrmshell: [WinRM] Command created for hostname with id: B3DCB8A9-6610-4E1F-80AC-E6E14E80AC71
DEBUG winrmshell: [WinRM] creating command_id: B3DCB8A9-6610-4E1F-80AC-E6E14E80AC71 on shell_id 49000C72-7E1B-463C-85C1-6E4028E660B4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B3DCB8A9-6610-4E1F-80AC-E6E14E80AC71 on shell_id 49000C72-7E1B-463C-85C1-6E4028E660B4
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240aeb58 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: verify_vmware_hgfs
DEBUG guest: Checking in: windows
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
 INFO synced_folder: Preparing shared folders with VMX...
 INFO interface: info: Enabling and configuring shared folders...
 INFO interface: info: ==> dc: Enabling and configuring shared folders...
==> dc: Enabling and configuring shared folders...
 INFO vmware_driver: Enabling shared folders...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "enableSharedFolders", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO interface: detail: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO interface: detail:     dc: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
    dc: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO vmware_driver: Adding a shared folder '-vagrant': D:/workspace/eWalker/DetectionLab/Vagrant
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "addSharedFolder", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "setSharedFolderState", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant", "writable"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2203, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6C8E3901-B4C3-4C3E-8E27-3E3635C1F37F
DEBUG winrmshell: [WinRM] Command created for hostname with id: 44C34E3E-4DAE-49A8-858F-8A8AD59B0A43
DEBUG winrmshell: [WinRM] creating command_id: 44C34E3E-4DAE-49A8-858F-8A8AD59B0A43 on shell_id 6C8E3901-B4C3-4C3E-8E27-3E3635C1F37F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 44C34E3E-4DAE-49A8-858F-8A8AD59B0A43 on shell_id 6C8E3901-B4C3-4C3E-8E27-3E3635C1F37F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2419c4c0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: mount_vmware_shared_folder
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: mount_vmware_shared_folder in windows
 INFO guest: Execute capability: mount_vmware_shared_folder [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>, "-vagrant", "/vagrant", {:guestpath=>"/vagrant", :hostpath=>"D:/workspace/eWalker/DetectionLab/Vagrant", :disabled=>false, :__vagrantfile=>true, :plugin=>#<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000027c24a9d088 @logger=#<Log4r::Logger:0x0000027c24a9d010 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_logger=#<Log4r::Logger:0x0000027c249f4320 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::syncedfolder", @outputters=[], @additive=true, @name="syncedfolder", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x0000027c21639d50 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware, #<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000027c249c45d0 @logger=#<Log4r::Logger:0x0000027c249c4530 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000027c225fea60 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x0000027c21603bd8 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x0000027c215f18c0 @formatter=#<Log4r::BasicFormatter:0x0000027c215f2a90 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x0000027c21639be8 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>>]], @cap_args=[#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:virtualbox=>#<Vagrant::Registry:0x0000027c249f4528 @items={:mount_options=>#<Proc:0x0000027c21bcb4a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:72>, :mount_type=>#<Proc:0x0000027c21bcb3e0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:77>, :mount_name=>#<Proc:0x0000027c21bcb318 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:82>}, @results_cache={}>, :smb=>#<Vagrant::Registry:0x0000027c249f4488 @items={:default_fstab_modification=>#<Proc:0x0000027c21538e38 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:26>, :mount_options=>#<Proc:0x0000027c21538d98 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:31>, :mount_name=>#<Proc:0x0000027c21538c58 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:36>, :mount_type=>#<Proc:0x0000027c21538af0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:41>}, @results_cache={}>}>, :owner=>"vagrant", :group=>"vagrant"}] (windows)
DEBUG winrm: powershell executing:
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24434278 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2442f520 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242dfd28 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DC83AEB3-1E37-4551-AE98-1E65C9023B82
DEBUG winrmshell: [WinRM] Command created for function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 06DF0B93-9C22-4F2D-B27D-E9AD742AA756
DEBUG winrmshell: [WinRM] creating command_id: 06DF0B93-9C22-4F2D-B27D-E9AD742AA756 on shell_id DC83AEB3-1E37-4551-AE98-1E65C9023B82
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 06DF0B93-9C22-4F2D-B27D-E9AD742AA756 on shell_id DC83AEB3-1E37-4551-AE98-1E65C9023B82
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24235e68 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9F9A0214-4B5F-4332-A0B9-82987A6225FF
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5CBB44F5-B1BE-475C-A396-B79821154FA8
DEBUG winrmshell: [WinRM] creating command_id: 5CBB44F5-B1BE-475C-A396-B79821154FA8 on shell_id 9F9A0214-4B5F-4332-A0B9-82987A6225FF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5CBB44F5-B1BE-475C-A396-B79821154FA8 on shell_id 9F9A0214-4B5F-4332-A0B9-82987A6225FF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c245a3690 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: persist_mount_shared_folder
DEBUG guest: Checking in: windows
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolders:0x0000027c2440de48>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Delayed:0x0000027c2440de70>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x0000027c24480fd8>
 INFO warden: Calling OUT action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x0000027c244ef500>
 INFO warden: Calling OUT action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO interface: info: Machine already provisioned. Run `vagrant provision` or use the `--provision`
flag to force provisioning. Provisioners marked to run always will still run.
 INFO interface: info: ==> dc: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> dc: flag to force provisioning. Provisioners marked to run always will still run.
==> dc: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> dc: flag to force provisioning. Provisioners marked to run always will still run.
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Provision:0x0000027c24523a30>
 INFO warden: Calling OUT action: #<Proc:0x0000027c240e4960 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c240be738>
 INFO warden: Calling OUT action: VMware Middleware: PruneForwardedPorts
 INFO warden: Calling OUT action: VMware Middleware: CheckExistingNetwork
 INFO warden: Calling OUT action: #<Proc:0x0000027c239e2838 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c24436578>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000027c244be310>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x0000027c240bd860 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24956800 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24542048 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: WaitForVMXHalt
 INFO warden: Calling OUT action: #<Proc:0x0000027c244345e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c24956878>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24896190 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c240bd8d8>
 INFO warden: Calling OUT action: VMware Middleware: DiscardSuspendedState
 INFO warden: Calling OUT action: #<Proc:0x0000027c23a4b3d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c245283f0>
 INFO warden: Calling OUT action: VMware Middleware: CheckVMware
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000027c2454bcd8>
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: #<Proc:0x0000027c242ed6d0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c214f9a80>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO interface: Machine: action ["reload", "end", {:target=>:dc}]
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8697EF7A-5DDA-462B-B66B-1E855BF38CE0
DEBUG winrmshell: [WinRM] Command created for hostname with id: 110B03B1-E7F8-4934-AFBE-54DCF2034324
DEBUG winrmshell: [WinRM] creating command_id: 110B03B1-E7F8-4934-AFBE-54DCF2034324 on shell_id 8697EF7A-5DDA-462B-B66B-1E855BF38CE0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 110B03B1-E7F8-4934-AFBE-54DCF2034324 on shell_id 8697EF7A-5DDA-462B-B66B-1E855BF38CE0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c214fb2b8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO warden: Calling OUT action: #<Proc:0x0000027c239eadf8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c2471d5c0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2203, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 21F48D97-8B3B-4C28-A353-B29481F3C6B8
DEBUG winrmshell: [WinRM] Command created for hostname with id: B73988E6-35E2-4D4F-A836-20AC6789C12C
DEBUG winrmshell: [WinRM] creating command_id: B73988E6-35E2-4D4F-A836-20AC6789C12C on shell_id 21F48D97-8B3B-4C28-A353-B29481F3C6B8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B73988E6-35E2-4D4F-A836-20AC6789C12C on shell_id 21F48D97-8B3B-4C28-A353-B29481F3C6B8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241afdb8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 40C4B63A-E4F6-4187-9EDD-7B645588DB6E
DEBUG winrmshell: [WinRM] Command created for hostname with id: ABD5C233-4FEC-46B4-8811-A5DD458EE3D7
DEBUG winrmshell: [WinRM] creating command_id: ABD5C233-4FEC-46B4-8811-A5DD458EE3D7 on shell_id 40C4B63A-E4F6-4187-9EDD-7B645588DB6E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ABD5C233-4FEC-46B4-8811-A5DD458EE3D7 on shell_id 40C4B63A-E4F6-4187-9EDD-7B645588DB6E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c246317d8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2085305A-4F3E-413A-9DBE-B1FCCF3FE52A
DEBUG winrmshell: [WinRM] Command created for hostname with id: F882E96D-AFB1-43C7-BE67-48573857AD1B
DEBUG winrmshell: [WinRM] creating command_id: F882E96D-AFB1-43C7-BE67-48573857AD1B on shell_id 2085305A-4F3E-413A-9DBE-B1FCCF3FE52A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F882E96D-AFB1-43C7-BE67-48573857AD1B on shell_id 2085305A-4F3E-413A-9DBE-B1FCCF3FE52A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c22814b10 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241a52a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241a4418 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2409ea28 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 19CB09BA-86B1-489B-A359-0DCE2BC79768
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 111E0015-5504-4DBA-828C-96CB4F5313FB
DEBUG winrmshell: [WinRM] creating command_id: 111E0015-5504-4DBA-828C-96CB4F5313FB on shell_id 19CB09BA-86B1-489B-A359-0DCE2BC79768
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 111E0015-5504-4DBA-828C-96CB4F5313FB on shell_id 19CB09BA-86B1-489B-A359-0DCE2BC79768
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23774678 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24235ee0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24234d10 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24197b50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A665EF2B-E35D-4C3F-9DC4-E3F04CD5D188
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 49333C56-2F33-44AF-ADEE-A0275561745E
DEBUG winrmshell: [WinRM] creating command_id: 49333C56-2F33-44AF-ADEE-A0275561745E on shell_id A665EF2B-E35D-4C3F-9DC4-E3F04CD5D188
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 49333C56-2F33-44AF-ADEE-A0275561745E on shell_id A665EF2B-E35D-4C3F-9DC4-E3F04CD5D188
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23c8a310 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-b30xr1.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24245368 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24244148 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241a60b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2E8A795A-8A92-481B-B6BC-F5E38A8A0B09
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "91103d0ccbde4757bd913a8feb78e434a7d2d5dc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-b30xr1.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6DC6DF1B-DFCD-4361-B946-97A16752B93F
DEBUG winrmshell: [WinRM] creating command_id: 6DC6DF1B-DFCD-4361-B946-97A16752B93F on shell_id 2E8A795A-8A92-481B-B6BC-F5E38A8A0B09
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6DC6DF1B-DFCD-4361-B946-97A16752B93F on shell_id 2E8A795A-8A92-481B-B6BC-F5E38A8A0B09
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","False","True","False"


DEBUG winrmshell: File C:/tmp/vagrant-shell.ps1 is up to date, skipping
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.47s) stream_files: (0m0.00s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2426fd48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2426ecb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241cdf48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D8F5FC9D-9E18-42BE-84AB-93B5A50A9CEA
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 555679A5-4389-4004-AB5A-6FA7AF08D847
DEBUG winrmshell: [WinRM] creating command_id: 555679A5-4389-4004-AB5A-6FA7AF08D847 on shell_id D8F5FC9D-9E18-42BE-84AB-93B5A50A9CEA
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:39] Setting timezone to UTC...
 INFO interface: detail:     dc: [14:39] Setting timezone to UTC...
    dc: [14:39] Setting timezone to UTC...
 INFO interface: detail: [14:39] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail:     dc: [14:39] Checking if Windows evaluation is expiring soon or expired...
    dc: [14:39] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail: [14:39] 180 days left until expiration, no need to rearm.
 INFO interface: detail:     dc: [14:39] 180 days left until expiration, no need to rearm.
    dc: [14:39] 180 days left until expiration, no need to rearm.
 INFO interface: detail: Unable to connect to ping.detectionlab.network
 INFO interface: detail:     dc: Unable to connect to ping.detectionlab.network
    dc: Unable to connect to ping.detectionlab.network
 INFO interface: detail: [14:39] Disabling IPv6 on all network adatpers...
 INFO interface: detail:     dc: [14:39] Disabling IPv6 on all network adatpers...
    dc: [14:39] Disabling IPv6 on all network adatpers...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Name                           DisplayName                                        ComponentID
 INFO interface: detail:     dc: Name                           DisplayName                                        ComponentID
    dc: Name                           DisplayName                                        ComponentID
 INFO interface: detail: ----                           -----------                                        -----------
 INFO interface: detail:     dc: ----                           -----------                                        -----------
    dc: ----                           -----------                                        -----------
 INFO interface: detail: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     dc: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    dc: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     dc: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    dc: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: The operation completed successfully.
 INFO interface: detail:     dc: The operation completed successfully.
    dc: The operation completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:39] I am domain joined!
 INFO interface: detail:     dc: [14:39] I am domain joined!
    dc: [14:39] I am domain joined!
 INFO interface: detail: [14:39] Setting the registry for auto-login...
 INFO interface: detail:     dc: [14:39] Setting the registry for auto-login...
    dc: [14:39] Setting the registry for auto-login...
 INFO interface: detail: [14:39] Provisioning after joining domain...
 INFO interface: detail:     dc: [14:39] Provisioning after joining domain...
    dc: [14:39] Provisioning after joining domain...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 555679A5-4389-4004-AB5A-6FA7AF08D847 on shell_id D8F5FC9D-9E18-42BE-84AB-93B5A50A9CEA
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240c7a40 @data=[{:stdout=>"[14:39] Setting timezone to UTC...\r\n"}, {:stdout=>"[14:39] Checking if Windows evaluation is expiring soon or expired...\r\n"}, {:stdout=>"[14:39] 180 days left until expiration, no need to rearm.\r\n"}, {:stdout=>"Unable to connect to ping.detectionlab.network\r\n"}, {:stdout=>"[14:39] Disabling IPv6 on all network adatpers...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           DisplayName                                        ComponentID     \r\n"}, {:stdout=>"----                           -----------                                        -----------     \r\n"}, {:stdout=>"Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"The operation completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:39] I am domain joined!\r\n"}, {:stdout=>"[14:39] Setting the registry for auto-login...\r\n"}, {:stdout=>"[14:39] Provisioning after joining domain...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2471d5c0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c245d9178 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2BF25B9C-C6A2-459B-83C3-48BE4D9E0DF5
DEBUG winrmshell: [WinRM] Command created for hostname with id: 90A71559-7441-4FF1-9E8F-12EE91CC7205
DEBUG winrmshell: [WinRM] creating command_id: 90A71559-7441-4FF1-9E8F-12EE91CC7205 on shell_id 2BF25B9C-C6A2-459B-83C3-48BE4D9E0DF5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 90A71559-7441-4FF1-9E8F-12EE91CC7205 on shell_id 2BF25B9C-C6A2-459B-83C3-48BE4D9E0DF5
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241471c8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 77B935B1-BB4D-45FA-8BB9-D9FCD7DF05A9
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1F9CDC4C-68FA-4C38-A4A0-73054098A175
DEBUG winrmshell: [WinRM] creating command_id: 1F9CDC4C-68FA-4C38-A4A0-73054098A175 on shell_id 77B935B1-BB4D-45FA-8BB9-D9FCD7DF05A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1F9CDC4C-68FA-4C38-A4A0-73054098A175 on shell_id 77B935B1-BB4D-45FA-8BB9-D9FCD7DF05A9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2454b828 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 28BCD850-C4FD-4CF9-BF38-9F57AC0C976E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1FF6FF23-93C1-47E4-8694-43C780E15BA5
DEBUG winrmshell: [WinRM] creating command_id: 1FF6FF23-93C1-47E4-8694-43C780E15BA5 on shell_id 28BCD850-C4FD-4CF9-BF38-9F57AC0C976E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1FF6FF23-93C1-47E4-8694-43C780E15BA5 on shell_id 28BCD850-C4FD-4CF9-BF38-9F57AC0C976E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b37868 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240bf1d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240bc4b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2381cc38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A5E02F4B-9F39-4289-838C-0D0C58410D6B
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 293C1DDF-B521-48AD-89CF-300269B3E47E
DEBUG winrmshell: [WinRM] creating command_id: 293C1DDF-B521-48AD-89CF-300269B3E47E on shell_id A5E02F4B-9F39-4289-838C-0D0C58410D6B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 293C1DDF-B521-48AD-89CF-300269B3E47E on shell_id A5E02F4B-9F39-4289-838C-0D0C58410D6B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2288edc0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241a40a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2419f198 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2409cef8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BA090B9B-4873-40B4-9CCC-3189B0C10B32
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E64FA83D-9EBB-4446-9A5E-91834216DD51
DEBUG winrmshell: [WinRM] creating command_id: E64FA83D-9EBB-4446-9A5E-91834216DD51 on shell_id BA090B9B-4873-40B4-9CCC-3189B0C10B32
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E64FA83D-9EBB-4446-9A5E-91834216DD51 on shell_id BA090B9B-4873-40B4-9CCC-3189B0C10B32
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2372de08 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-kgnsmx.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2419c3d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24197308 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2408d2f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "09c377ee7e4e922ca5e8af4143bc0682a8350493" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-kgnsmx.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: FDCB86EA-CD50-4BF8-9725-A03AD349DD0F
DEBUG winrmshell: [WinRM] creating command_id: FDCB86EA-CD50-4BF8-9725-A03AD349DD0F on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FDCB86EA-CD50-4BF8-9725-A03AD349DD0F on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","09c377ee7e4e922ca5e8af4143bc0682a8350493","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-kgnsmx.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E7E7ADBC-09D1-419B-91A4-B288E936FFE4
DEBUG winrmshell: [WinRM] creating command_id: E7E7ADBC-09D1-419B-91A4-B288E936FFE4 on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E7E7ADBC-09D1-419B-91A4-B288E936FFE4 on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIHVuemlwcyBhIGNvcHkgb2YgdGhlIFBhbGFudGlyIFdFRiBHaXRodWIgUmVwby4gVGhpcyBpbmNsdWRlcyBXRUYgc3Vic2NyaXB0aW9ucyBhbmQgY3VzdG9tIFdFRiBjaGFubmVscy4KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBhbmQgdW56aXBwaW5nIHRoZSBQYWxhbnRpciBXaW5kb3dzIEV2ZW50IEZvcndhcmRpbmcgUmVwbyBmcm9tIEdpdGh1Yi4uLiIKCiR3ZWZSZXBvUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3ZWYtTWFzdGVyLnppcCcKCklmICgtbm90IChUZXN0LVBhdGggJHdlZlJlcG9QYXRoKSkKewogICAgIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzEvMjAxOAogICAgW05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMgogICAgIyBEaXNhYmxpbmcgdGhlIHByb2dyZXNzIGJhciBzcGVlZHMgdXAgSVdSIGh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwvaXNzdWVzLzIxMzgKICAgICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICAgIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgImh0dHBzOi8vZ2l0aHViLmNvbS9wYWxhbnRpci93aW5kb3dzLWV2ZW50LWZvcndhcmRpbmcvYXJjaGl2ZS9tYXN0ZXIuemlwIiAtT3V0RmlsZSAkd2VmUmVwb1BhdGgKICAgIEV4cGFuZC1BcmNoaXZlIC1wYXRoICIkd2VmUmVwb1BhdGgiIC1kZXN0aW5hdGlvbnBhdGggJ2M6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wJyAtRm9yY2UKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSAkd2VmUmVwb1BhdGggYWxyZWFkeSBleGlzdHMuIE1vdmluZyBPbi4iCn0KV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFBhbGFudGlyIFdFRiBkb3dubG9hZCBjb21wbGV0ZSEiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9DA569D4-FA83-4106-8BE0-B8E6773CF370
DEBUG winrmshell: [WinRM] creating command_id: 9DA569D4-FA83-4106-8BE0-B8E6773CF370 on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9DA569D4-FA83-4106-8BE0-B8E6773CF370 on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 601D05CC-8370-4325-81C4-121F872674E9
DEBUG winrmshell: [WinRM] creating command_id: 601D05CC-8370-4325-81C4-121F872674E9 on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 601D05CC-8370-4325-81C4-121F872674E9 on shell_id 3CF24E05-C78C-4798-9202-6ACAF9B701E9
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-kgnsmx.ps1 to C:/tmp/vagrant-shell.ps1 (1.384 KB over 1 chunks) in (0m0.15s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.45s) stream_files: (0m0.15s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243a7d28 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243a64f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24294b98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 97CC38FB-99B0-4224-84DB-7F772251569B
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B8EDF7E1-F6E1-4C1B-8944-ADF8BCC2353B
DEBUG winrmshell: [WinRM] creating command_id: B8EDF7E1-F6E1-4C1B-8944-ADF8BCC2353B on shell_id 97CC38FB-99B0-4224-84DB-7F772251569B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
 INFO interface: detail:     dc: [14:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
    dc: [14:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:39] Palantir WEF download complete!
 INFO interface: detail:     dc: [14:39] Palantir WEF download complete!
    dc: [14:39] Palantir WEF download complete!
DEBUG winrmshell: [WinRM] cleaning up command_id: B8EDF7E1-F6E1-4C1B-8944-ADF8BCC2353B on shell_id 97CC38FB-99B0-4224-84DB-7F772251569B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241e6a48 @data=[{:stdout=>"[14:39] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...\r\n"}, {:stdout=>"[14:39] Palantir WEF download complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c245d9178 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c24aa6bb0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: ED1EDED5-EF7D-4E2C-AE38-F39B21FAD8A8
DEBUG winrmshell: [WinRM] Command created for hostname with id: E7AC3C89-73D4-4877-B27B-CE34363408EF
DEBUG winrmshell: [WinRM] creating command_id: E7AC3C89-73D4-4877-B27B-CE34363408EF on shell_id ED1EDED5-EF7D-4E2C-AE38-F39B21FAD8A8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E7AC3C89-73D4-4877-B27B-CE34363408EF on shell_id ED1EDED5-EF7D-4E2C-AE38-F39B21FAD8A8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2440e9d8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 16DBEBA0-A830-4943-9E0F-4BB9E877AFB1
DEBUG winrmshell: [WinRM] Command created for hostname with id: CEEE12A9-A0D2-47F8-8750-6D45789BCA0B
DEBUG winrmshell: [WinRM] creating command_id: CEEE12A9-A0D2-47F8-8750-6D45789BCA0B on shell_id 16DBEBA0-A830-4943-9E0F-4BB9E877AFB1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CEEE12A9-A0D2-47F8-8750-6D45789BCA0B on shell_id 16DBEBA0-A830-4943-9E0F-4BB9E877AFB1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249cf3b8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3671A4AE-9961-4E14-AE9C-57A099D7FEA2
DEBUG winrmshell: [WinRM] Command created for hostname with id: AE264D29-B6C5-4B55-BB1B-64B02EAE7147
DEBUG winrmshell: [WinRM] creating command_id: AE264D29-B6C5-4B55-BB1B-64B02EAE7147 on shell_id 3671A4AE-9961-4E14-AE9C-57A099D7FEA2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AE264D29-B6C5-4B55-BB1B-64B02EAE7147 on shell_id 3671A4AE-9961-4E14-AE9C-57A099D7FEA2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240dc328 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242f7108 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242f5380 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2424e5d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2C8DDA12-7AA1-4EB0-A27E-A69CC1DB949D
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5CE6EC86-6A2E-4B95-8013-4E50A49B820A
DEBUG winrmshell: [WinRM] creating command_id: 5CE6EC86-6A2E-4B95-8013-4E50A49B820A on shell_id 2C8DDA12-7AA1-4EB0-A27E-A69CC1DB949D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5CE6EC86-6A2E-4B95-8013-4E50A49B820A on shell_id 2C8DDA12-7AA1-4EB0-A27E-A69CC1DB949D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241a5ae8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2441eb80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2441d9b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242bfde8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 79A6DF72-BA63-49C3-BFD2-A589079C3FB9
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 86E9B4F3-0976-4402-858B-37FE9FB2A43F
DEBUG winrmshell: [WinRM] creating command_id: 86E9B4F3-0976-4402-858B-37FE9FB2A43F on shell_id 79A6DF72-BA63-49C3-BFD2-A589079C3FB9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 86E9B4F3-0976-4402-858B-37FE9FB2A43F on shell_id 79A6DF72-BA63-49C3-BFD2-A589079C3FB9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24214470 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-15afult.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c244053b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243ffd98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242ac298 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "2ccc385c1b1113d499646914f2abe476d7a690be" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-15afult.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B486DD03-7A0A-49CF-9724-F2C8BB7CB6E0
DEBUG winrmshell: [WinRM] creating command_id: B486DD03-7A0A-49CF-9724-F2C8BB7CB6E0 on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B486DD03-7A0A-49CF-9724-F2C8BB7CB6E0 on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","2ccc385c1b1113d499646914f2abe476d7a690be","09c377ee7e4e922ca5e8af4143bc0682a8350493","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-15afult.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: FF5F4877-7071-4375-8B86-A5DD8FD60D7C
DEBUG winrmshell: [WinRM] creating command_id: FF5F4877-7071-4375-8B86-A5DD8FD60D7C on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FF5F4877-7071-4375-8B86-A5DD8FD60D7C on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBjaG9jb2xhdGV5IHBhY2thZ2UgbWFuYWdlciwgdGhlbiBpbnN0YWxscyBjdXN0b20gdXRpbGl0aWVzIGZyb20gQ2hvY28uCgpJZiAoLW5vdCAoVGVzdC1QYXRoICJDOlxQcm9ncmFtRGF0YVxjaG9jb2xhdGV5IikpIHsKICBbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ2hvY29sYXRleSIKICBJbnZva2UtRXhwcmVzc2lvbiAoKG5ldy1vYmplY3QgbmV0LndlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vY2hvY29sYXRleS5vcmcvaW5zdGFsbC5wczEnKSkKfSBlbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ2hvY29sYXRleSBpcyBhbHJlYWR5IGluc3RhbGxlZC4iCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIHV0aWxpdGllcy4uLiIKSWYgKCQoaG9zdG5hbWUpIC1lcSAid2luMTAiKSB7CiAgIyBCZWNhdXNlIHRoZSBXaW5kb3dzMTAgc3RhcnQgbWVudSBzdWNrcwogIGNob2NvIGluc3RhbGwgLXkgLS1saW1pdC1vdXRwdXQgLS1uby1wcm9ncmVzcyBjbGFzc2ljLXNoZWxsIC1pbnN0YWxsQXJncyBBRERMT0NBTD1DbGFzc2ljU3RhcnRNZW51CiAgJiAiQzpcUHJvZ3JhbSBGaWxlc1xDbGFzc2ljIFNoZWxsXENsYXNzaWNTdGFydE1lbnUuZXhlIiAiLXhtbCIgImM6XHZhZ3JhbnRccmVzb3VyY2VzXHdpbmRvd3NcTWVudVNldHRpbmdzLnhtbCIKICByZWdlZGl0IC9zIGM6XHZhZ3JhbnRccmVzb3VyY2VzXHdpbmRvd3NcTWVudVN0eWxlX0RlZmF1bHRfV2luNy5yZWcKfQpjaG9jbyBpbnN0YWxsIC15IC0tbGltaXQtb3V0cHV0IC0tbm8tcHJvZ3Jlc3MgTm90ZXBhZFBsdXNQbHVzIFdpblJhciBwcm9jZXNzaGFja2VyCgojIFRoaXMgcmVwbyBvZnRlbiBjYXVzZXMgZmFpbHVyZXMgZHVlIHRvIGluY29ycmVjdCBjaGVja3N1bXMsIHNvIHdlIGlnbm9yZSB0aGVtIGZvciBDaHJvbWUKY2hvY28gaW5zdGFsbCAteSAtLWxpbWl0LW91dHB1dCAtLW5vLXByb2dyZXNzIC0taWdub3JlLWNoZWNrc3VtcyBHb29nbGVDaHJvbWUgCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVXRpbHRpZXMgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 170EAACD-DC4D-4CAC-B163-D981A41FAC61
DEBUG winrmshell: [WinRM] creating command_id: 170EAACD-DC4D-4CAC-B163-D981A41FAC61 on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 170EAACD-DC4D-4CAC-B163-D981A41FAC61 on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5532E470-6C75-4634-8347-8D43669D2057
DEBUG winrmshell: [WinRM] creating command_id: 5532E470-6C75-4634-8347-8D43669D2057 on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5532E470-6C75-4634-8347-8D43669D2057 on shell_id 74CD9934-8A60-452E-B07A-838F0E714453
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-15afult.ps1 to C:/tmp/vagrant-shell.ps1 (1.66 KB over 1 chunks) in (0m0.14s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.48s) stream_files: (0m0.15s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c247d4400 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c247a7590 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245a02d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DE09CFF1-B8BD-4051-BAAB-9C3AB3D86212
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F72AC944-69C8-43EA-9E78-5FA0E23CE2FF
DEBUG winrmshell: [WinRM] creating command_id: F72AC944-69C8-43EA-9E78-5FA0E23CE2FF on shell_id DE09CFF1-B8BD-4051-BAAB-9C3AB3D86212
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:39] Installing Chocolatey
 INFO interface: detail:     dc: [14:39] Installing Chocolatey
    dc: [14:39] Installing Chocolatey
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
 INFO interface: detail:     dc: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
    dc: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
 INFO interface: detail: Getting latest version of the Chocolatey package for download.
 INFO interface: detail:     dc: Getting latest version of the Chocolatey package for download.
    dc: Getting latest version of the Chocolatey package for download.
 INFO interface: detail: Not using proxy.
 INFO interface: detail:     dc: Not using proxy.
    dc: Not using proxy.
 INFO interface: detail: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
 INFO interface: detail:     dc: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
    dc: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
 INFO interface: detail: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
 INFO interface: detail:     dc: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
    dc: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
 INFO interface: detail: Not using proxy.
 INFO interface: detail:     dc: Not using proxy.
    dc: Not using proxy.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
 INFO interface: detail:     dc: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
    dc: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing Chocolatey on the local machine
 INFO interface: detail:     dc: Installing Chocolatey on the local machine
    dc: Installing Chocolatey on the local machine
 INFO interface: detail: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
 INFO interface: detail:     dc: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
    dc: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
 INFO interface: detail:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
 INFO interface: detail:     dc:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
    dc:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
 INFO interface: detail: WARNING: It's very likely you will need to close and reopen your shell
 INFO interface: detail:     dc: WARNING: It's very likely you will need to close and reopen your shell
    dc: WARNING: It's very likely you will need to close and reopen your shell
 INFO interface: detail:   before you can use choco.
 INFO interface: detail:     dc:   before you can use choco.
    dc:   before you can use choco.
 INFO interface: detail: Restricting write permissions to Administrators
 INFO interface: detail:     dc: Restricting write permissions to Administrators
    dc: Restricting write permissions to Administrators
 INFO interface: detail: We are setting up the Chocolatey package repository.
 INFO interface: detail:     dc: We are setting up the Chocolatey package repository.
    dc: We are setting up the Chocolatey package repository.
 INFO interface: detail: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
 INFO interface: detail:     dc: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
    dc: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
 INFO interface: detail:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
 INFO interface: detail:     dc:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
    dc:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
 INFO interface: detail: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
 INFO interface: detail:     dc: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
    dc: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
 INFO interface: detail:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
 INFO interface: detail:     dc:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
    dc:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Creating Chocolatey folders if they do not already exist.
 INFO interface: detail:     dc: Creating Chocolatey folders if they do not already exist.
    dc: Creating Chocolatey folders if they do not already exist.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: WARNING: You can safely ignore errors related to missing log files when
 INFO interface: detail:     dc: WARNING: You can safely ignore errors related to missing log files when
    dc: WARNING: You can safely ignore errors related to missing log files when
 INFO interface: detail:   upgrading from a version of Chocolatey less than 0.9.9.
 INFO interface: detail:     dc:   upgrading from a version of Chocolatey less than 0.9.9.
    dc:   upgrading from a version of Chocolatey less than 0.9.9.
 INFO interface: detail:   'Batch file could not be found' is also safe to ignore.
 INFO interface: detail:     dc:   'Batch file could not be found' is also safe to ignore.
    dc:   'Batch file could not be found' is also safe to ignore.
 INFO interface: detail:   'The system cannot find the file specified' - also safe.
 INFO interface: detail:     dc:   'The system cannot find the file specified' - also safe.
    dc:   'The system cannot find the file specified' - also safe.
 INFO interface: detail: chocolatey.nupkg file not installed in lib.
 INFO interface: detail:     dc: chocolatey.nupkg file not installed in lib.
    dc: chocolatey.nupkg file not installed in lib.
 INFO interface: detail:  Attempting to locate it from bootstrapper.
 INFO interface: detail:     dc:  Attempting to locate it from bootstrapper.
    dc:  Attempting to locate it from bootstrapper.
 INFO interface: detail: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
 INFO interface: detail:     dc: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
    dc: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
 INFO interface: detail: WARNING: Not setting tab completion: Profile file does not exist at
 INFO interface: detail:     dc: WARNING: Not setting tab completion: Profile file does not exist at
    dc: WARNING: Not setting tab completion: Profile file does not exist at
 INFO interface: detail: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
 INFO interface: detail:     dc: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
    dc: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
 INFO interface: detail: Chocolatey (choco.exe) is now ready.
 INFO interface: detail:     dc: Chocolatey (choco.exe) is now ready.
    dc: Chocolatey (choco.exe) is now ready.
 INFO interface: detail: You can call choco from anywhere, command line or powershell by typing choco.
 INFO interface: detail:     dc: You can call choco from anywhere, command line or powershell by typing choco.
    dc: You can call choco from anywhere, command line or powershell by typing choco.
 INFO interface: detail: Run choco /? for a list of functions.
 INFO interface: detail:     dc: Run choco /? for a list of functions.
    dc: Run choco /? for a list of functions.
 INFO interface: detail: You may need to shut down and restart powershell and/or consoles
 INFO interface: detail:     dc: You may need to shut down and restart powershell and/or consoles
    dc: You may need to shut down and restart powershell and/or consoles
 INFO interface: detail:  first prior to using choco.
 INFO interface: detail:     dc:  first prior to using choco.
    dc:  first prior to using choco.
 INFO interface: detail: Ensuring Chocolatey commands are on the path
 INFO interface: detail:     dc: Ensuring Chocolatey commands are on the path
    dc: Ensuring Chocolatey commands are on the path
 INFO interface: detail: Ensuring chocolatey.nupkg is in the lib folder
 INFO interface: detail:     dc: Ensuring chocolatey.nupkg is in the lib folder
    dc: Ensuring chocolatey.nupkg is in the lib folder
 INFO interface: detail: [14:39] Installing utilities...
 INFO interface: detail:     dc: [14:39] Installing utilities...
    dc: [14:39] Installing utilities...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     dc: Installing the following packages:
    dc: Installing the following packages:
 INFO interface: detail: NotepadPlusPlus;WinRar;processhacker
 INFO interface: detail:     dc: NotepadPlusPlus;WinRar;processhacker
    dc: NotepadPlusPlus;WinRar;processhacker
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     dc: By installing, you accept licenses for the packages.
    dc: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: chocolatey-compatibility.extension v1.0.0 [Approved]
 INFO interface: detail:     dc: chocolatey-compatibility.extension v1.0.0 [Approved]
    dc: chocolatey-compatibility.extension v1.0.0 [Approved]
 INFO interface: detail: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
    dc: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-compatibility extensions.
 INFO interface: detail:     dc:  Installed/updated chocolatey-compatibility extensions.
    dc:  Installed/updated chocolatey-compatibility extensions.
 INFO interface: detail:  The install of chocolatey-compatibility.extension was successful.
 INFO interface: detail:     dc:  The install of chocolatey-compatibility.extension was successful.
    dc:  The install of chocolatey-compatibility.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
 INFO interface: detail:     dc:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
    dc:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: chocolatey-core.extension v1.4.0 [Approved]
 INFO interface: detail:     dc: chocolatey-core.extension v1.4.0 [Approved]
    dc: chocolatey-core.extension v1.4.0 [Approved]
 INFO interface: detail: chocolatey-core.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: chocolatey-core.extension package files install completed. Performing other installation steps.
    dc: chocolatey-core.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-core extensions.
 INFO interface: detail:     dc:  Installed/updated chocolatey-core extensions.
    dc:  Installed/updated chocolatey-core extensions.
 INFO interface: detail:  The install of chocolatey-core.extension was successful.
 INFO interface: detail:     dc:  The install of chocolatey-core.extension was successful.
    dc:  The install of chocolatey-core.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
 INFO interface: detail:     dc:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
    dc:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: notepadplusplus.install v8.4.2 [Approved]
 INFO interface: detail:     dc: notepadplusplus.install v8.4.2 [Approved]
    dc: notepadplusplus.install v8.4.2 [Approved]
 INFO interface: detail: notepadplusplus.install package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: notepadplusplus.install package files install completed. Performing other installation steps.
    dc: notepadplusplus.install package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing 64-bit notepadplusplus.install...
 INFO interface: detail:     dc: Installing 64-bit notepadplusplus.install...
    dc: Installing 64-bit notepadplusplus.install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: notepadplusplus.install has been installed.
 INFO interface: detail:     dc: notepadplusplus.install has been installed.
    dc: notepadplusplus.install has been installed.
 INFO interface: detail: WARNING: No registry key found based on  'Notepad\+\+*'
 INFO interface: detail:     dc: WARNING: No registry key found based on  'Notepad\+\+*'
    dc: WARNING: No registry key found based on  'Notepad\+\+*'
 INFO interface: detail: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
 INFO interface: detail:     dc: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
    dc: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
 INFO interface: detail: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
 INFO interface: detail:     dc: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
    dc: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
 INFO interface: detail:   notepadplusplus.install can be automatically uninstalled.
 INFO interface: detail:     dc:   notepadplusplus.install can be automatically uninstalled.
    dc:   notepadplusplus.install can be automatically uninstalled.
 INFO interface: detail:  The install of notepadplusplus.install was successful.
 INFO interface: detail:     dc:  The install of notepadplusplus.install was successful.
    dc:  The install of notepadplusplus.install was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     dc:   Software installed as 'exe', install location is likely default.
    dc:   Software installed as 'exe', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: notepadplusplus v8.4.2 [Approved]
 INFO interface: detail:     dc: notepadplusplus v8.4.2 [Approved]
    dc: notepadplusplus v8.4.2 [Approved]
 INFO interface: detail: notepadplusplus package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: notepadplusplus package files install completed. Performing other installation steps.
    dc: notepadplusplus package files install completed. Performing other installation steps.
 INFO interface: detail:  The install of notepadplusplus was successful.
 INFO interface: detail:     dc:  The install of notepadplusplus was successful.
    dc:  The install of notepadplusplus was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: winrar v6.11.0.20220504 [Approved]
 INFO interface: detail:     dc: winrar v6.11.0.20220504 [Approved]
    dc: winrar v6.11.0.20220504 [Approved]
 INFO interface: detail: winrar package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: winrar package files install completed. Performing other installation steps.
    dc: winrar package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading winrar 64 bit
 INFO interface: detail:     dc: Downloading winrar 64 bit
    dc: Downloading winrar 64 bit
 INFO interface: detail:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
 INFO interface: detail:     dc:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
    dc:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Download of winrar-x64-611.exe (3.32 MB) completed.
 INFO interface: detail:     dc: Download of winrar-x64-611.exe (3.32 MB) completed.
    dc: Download of winrar-x64-611.exe (3.32 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     dc: Hashes match.
    dc: Hashes match.
 INFO interface: detail: Installing winrar...
 INFO interface: detail:     dc: Installing winrar...
    dc: Installing winrar...
 INFO interface: detail: winrar has been installed.
 INFO interface: detail:     dc: winrar has been installed.
    dc: winrar has been installed.
 INFO interface: detail:  The install of winrar was successful.
 INFO interface: detail:     dc:  The install of winrar was successful.
    dc:  The install of winrar was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     dc:   Software installed as 'exe', install location is likely default.
    dc:   Software installed as 'exe', install location is likely default.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
 INFO interface: detail:     dc: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
    dc: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
 INFO interface: detail: processhacker.install package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: processhacker.install package files install completed. Performing other installation steps.
    dc: processhacker.install package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading processhacker.install
 INFO interface: detail:     dc: Downloading processhacker.install
    dc: Downloading processhacker.install
 INFO interface: detail:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
 INFO interface: detail:     dc:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
    dc:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
 INFO interface: detail:     dc: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
    dc: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     dc: Hashes match.
    dc: Hashes match.
 INFO interface: detail: Installing processhacker.install...
 INFO interface: detail:     dc: Installing processhacker.install...
    dc: Installing processhacker.install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: processhacker.install has been installed.
 INFO interface: detail:     dc: processhacker.install has been installed.
    dc: processhacker.install has been installed.
 INFO interface: detail:   processhacker.install can be automatically uninstalled.
 INFO interface: detail:     dc:   processhacker.install can be automatically uninstalled.
    dc:   processhacker.install can be automatically uninstalled.
 INFO interface: detail:  The install of processhacker.install was successful.
 INFO interface: detail:     dc:  The install of processhacker.install was successful.
    dc:  The install of processhacker.install was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\Process Hacker 2\'
 INFO interface: detail:     dc:   Software installed to 'C:\Program Files\Process Hacker 2\'
    dc:   Software installed to 'C:\Program Files\Process Hacker 2\'
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: processhacker v2.39 [Approved] - Possibly broken
 INFO interface: detail:     dc: processhacker v2.39 [Approved] - Possibly broken
    dc: processhacker v2.39 [Approved] - Possibly broken
 INFO interface: detail: processhacker package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: processhacker package files install completed. Performing other installation steps.
    dc: processhacker package files install completed. Performing other installation steps.
 INFO interface: detail:  The install of processhacker was successful.
 INFO interface: detail:     dc:  The install of processhacker was successful.
    dc:  The install of processhacker was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Chocolatey installed 7/7 packages.
 INFO interface: detail:     dc: Chocolatey installed 7/7 packages.
    dc: Chocolatey installed 7/7 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Installed:
 INFO interface: detail:     dc: Installed:
    dc: Installed:
 INFO interface: detail:  - processhacker.install v2.39
 INFO interface: detail:     dc:  - processhacker.install v2.39
    dc:  - processhacker.install v2.39
 INFO interface: detail:  - notepadplusplus.install v8.4.2
 INFO interface: detail:     dc:  - notepadplusplus.install v8.4.2
    dc:  - notepadplusplus.install v8.4.2
 INFO interface: detail:  - chocolatey-core.extension v1.4.0
 INFO interface: detail:     dc:  - chocolatey-core.extension v1.4.0
    dc:  - chocolatey-core.extension v1.4.0
 INFO interface: detail:  - winrar v6.11.0.20220504
 INFO interface: detail:     dc:  - winrar v6.11.0.20220504
    dc:  - winrar v6.11.0.20220504
 INFO interface: detail:  - chocolatey-compatibility.extension v1.0.0
 INFO interface: detail:     dc:  - chocolatey-compatibility.extension v1.0.0
    dc:  - chocolatey-compatibility.extension v1.0.0
 INFO interface: detail:  - notepadplusplus v8.4.2
 INFO interface: detail:     dc:  - notepadplusplus v8.4.2
    dc:  - notepadplusplus v8.4.2
 INFO interface: detail:  - processhacker v2.39
 INFO interface: detail:     dc:  - processhacker v2.39
    dc:  - processhacker v2.39
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     dc: Installing the following packages:
    dc: Installing the following packages:
 INFO interface: detail: GoogleChrome
 INFO interface: detail:     dc: GoogleChrome
    dc: GoogleChrome
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     dc: By installing, you accept licenses for the packages.
    dc: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: GoogleChrome v102.0.5005.115 [Approved]
 INFO interface: detail:     dc: GoogleChrome v102.0.5005.115 [Approved]
    dc: GoogleChrome v102.0.5005.115 [Approved]
 INFO interface: detail: googlechrome package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: googlechrome package files install completed. Performing other installation steps.
    dc: googlechrome package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading googlechrome 64 bit
 INFO interface: detail:     dc: Downloading googlechrome 64 bit
    dc: Downloading googlechrome 64 bit
 INFO interface: detail:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
 INFO interface: detail:     dc:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
    dc:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
 INFO interface: detail:     dc: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
    dc: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
 INFO interface: detail:     dc: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
    dc: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
 INFO interface: detail: Installing googlechrome...
 INFO interface: detail:     dc: Installing googlechrome...
    dc: Installing googlechrome...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: googlechrome has been installed.
 INFO interface: detail:     dc: googlechrome has been installed.
    dc: googlechrome has been installed.
 INFO interface: detail:   googlechrome may be able to be automatically uninstalled.
 INFO interface: detail:     dc:   googlechrome may be able to be automatically uninstalled.
    dc:   googlechrome may be able to be automatically uninstalled.
 INFO interface: detail:  The install of googlechrome was successful.
 INFO interface: detail:     dc:  The install of googlechrome was successful.
    dc:  The install of googlechrome was successful.
 INFO interface: detail:   Software installed as 'MSI', install location is likely default.
 INFO interface: detail:     dc:   Software installed as 'MSI', install location is likely default.
    dc:   Software installed as 'MSI', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     dc: Chocolatey installed 1/1 packages.
    dc: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: [14:41] Utilties installation complete!
 INFO interface: detail:     dc: [14:41] Utilties installation complete!
    dc: [14:41] Utilties installation complete!
DEBUG winrmshell: [WinRM] cleaning up command_id: F72AC944-69C8-43EA-9E78-5FA0E23CE2FF on shell_id DE09CFF1-B8BD-4051-BAAB-9C3AB3D86212
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24434e80 @data=[{:stdout=>"[14:39] Installing Chocolatey\r\n"}, {:stdout=>"Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)\r\n"}, {:stdout=>"Getting latest version of the Chocolatey package for download.\r\n"}, {:stdout=>"Not using proxy.\r\n"}, {:stdout=>"Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.\r\n"}, {:stdout=>"Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\\chocolatey.zip\r\n"}, {:stdout=>"Not using proxy.\r\n"}, {:stdout=>"Extracting C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\\chocolatey.zip to C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\r\n"}, {:stdout=>"Installing Chocolatey on the local machine\r\n"}, {:stdout=>"Creating ChocolateyInstall as an environment variable (targeting 'Machine') \r\n"}, {:stdout=>"  Setting ChocolateyInstall to 'C:\\ProgramData\\chocolatey'\r\n"}, {:stdout=>"WARNING: It's very likely you will need to close and reopen your shell \r\n"}, {:stdout=>"  before you can use choco.\r\n"}, {:stdout=>"Restricting write permissions to Administrators\r\n"}, {:stdout=>"We are setting up the Chocolatey package repository.\r\n"}, {:stdout=>"The packages themselves go to 'C:\\ProgramData\\chocolatey\\lib'\r\n"}, {:stdout=>"  (i.e. C:\\ProgramData\\chocolatey\\lib\\yourPackageName).\r\n"}, {:stdout=>"A shim file for the command line goes to 'C:\\ProgramData\\chocolatey\\bin'\r\n"}, {:stdout=>"  and points to an executable in 'C:\\ProgramData\\chocolatey\\lib\\yourPackageName'.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Creating Chocolatey folders if they do not already exist.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: You can safely ignore errors related to missing log files when \r\n"}, {:stdout=>"  upgrading from a version of Chocolatey less than 0.9.9. \r\n"}, {:stdout=>"  'Batch file could not be found' is also safe to ignore. \r\n"}, {:stdout=>"  'The system cannot find the file specified' - also safe.\r\n"}, {:stdout=>"chocolatey.nupkg file not installed in lib.\r\n"}, {:stdout=>" Attempting to locate it from bootstrapper.\r\n"}, {:stdout=>"PATH environment variable does not have C:\\ProgramData\\chocolatey\\bin in it. Adding...\r\n"}, {:stdout=>"WARNING: Not setting tab completion: Profile file does not exist at \r\n"}, {:stdout=>"'C:\\Users\\vagrant\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'.\r\n"}, {:stdout=>"Chocolatey (choco.exe) is now ready.\r\n"}, {:stdout=>"You can call choco from anywhere, command line or powershell by typing choco.\r\n"}, {:stdout=>"Run choco /? for a list of functions.\r\n"}, {:stdout=>"You may need to shut down and restart powershell and/or consoles\r\n"}, {:stdout=>" first prior to using choco.\r\n"}, {:stdout=>"Ensuring Chocolatey commands are on the path\r\n"}, {:stdout=>"Ensuring chocolatey.nupkg is in the lib folder\r\n"}, {:stdout=>"[14:39] Installing utilities...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"NotepadPlusPlus;WinRar;processhacker\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-compatibility.extension v1.0.0 [Approved]\r\n"}, {:stdout=>"chocolatey-compatibility.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-compatibility extensions.\r\n"}, {:stdout=>" The install of chocolatey-compatibility.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-compatibility'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-core.extension v1.4.0 [Approved]\r\n"}, {:stdout=>"chocolatey-core.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-core extensions.\r\n"}, {:stdout=>" The install of chocolatey-core.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-core'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"notepadplusplus.install v8.4.2 [Approved]\r\n"}, {:stdout=>"notepadplusplus.install package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing 64-bit notepadplusplus.install...\r\n"}, {:stdout=>"notepadplusplus.install has been installed.\r\n"}, {:stdout=>"WARNING: No registry key found based on  'Notepad\\+\\+*'\r\n"}, {:stdout=>"notepadplusplus.install installed to 'C:\\Program Files\\Notepad++'\r\n"}, {:stdout=>"Added C:\\ProgramData\\chocolatey\\bin\\notepad++.exe shim pointed to 'c:\\program files\\notepad++\\notepad++.exe'.\r\n"}, {:stdout=>"  notepadplusplus.install can be automatically uninstalled.\r\n"}, {:stdout=>" The install of notepadplusplus.install was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"notepadplusplus v8.4.2 [Approved]\r\n"}, {:stdout=>"notepadplusplus package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" The install of notepadplusplus was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"winrar v6.11.0.20220504 [Approved]\r\n"}, {:stdout=>"winrar package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading winrar 64 bit\r\n"}, {:stdout=>"  from 'https://www.rarlab.com/rar/winrar-x64-611.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of winrar-x64-611.exe (3.32 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing winrar...\r\n"}, {:stdout=>"winrar has been installed.\r\n"}, {:stdout=>" The install of winrar was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)\r\n"}, {:stdout=>"processhacker.install package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading processhacker.install \r\n"}, {:stdout=>"  from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of processhacker-2.39-setup.exe (2.16 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing processhacker.install...\r\n"}, {:stdout=>"processhacker.install has been installed.\r\n"}, {:stdout=>"  processhacker.install can be automatically uninstalled.\r\n"}, {:stdout=>" The install of processhacker.install was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\Process Hacker 2\\'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"processhacker v2.39 [Approved] - Possibly broken\r\n"}, {:stdout=>"processhacker package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" The install of processhacker was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 7/7 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Installed:\r\n"}, {:stdout=>" - processhacker.install v2.39\r\n"}, {:stdout=>" - notepadplusplus.install v8.4.2\r\n"}, {:stdout=>" - chocolatey-core.extension v1.4.0\r\n"}, {:stdout=>" - winrar v6.11.0.20220504\r\n"}, {:stdout=>" - chocolatey-compatibility.extension v1.0.0\r\n"}, {:stdout=>" - notepadplusplus v8.4.2\r\n"}, {:stdout=>" - processhacker v2.39\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"GoogleChrome\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"GoogleChrome v102.0.5005.115 [Approved]\r\n"}, {:stdout=>"googlechrome package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading googlechrome 64 bit\r\n"}, {:stdout=>"  from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.\r\n"}, {:stdout=>"WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.\r\n"}, {:stdout=>"Installing googlechrome...\r\n"}, {:stdout=>"googlechrome has been installed.\r\n"}, {:stdout=>"  googlechrome may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of googlechrome was successful.\r\n"}, {:stdout=>"  Software installed as 'MSI', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"[14:41] Utilties installation complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24aa6bb0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c2434c1a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2203, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: FBFF79CE-C004-4089-A277-E787DB2A2654
DEBUG winrmshell: [WinRM] Command created for hostname with id: B83EADAB-A3B9-4763-98A2-367B267825F5
DEBUG winrmshell: [WinRM] creating command_id: B83EADAB-A3B9-4763-98A2-367B267825F5 on shell_id FBFF79CE-C004-4089-A277-E787DB2A2654
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B83EADAB-A3B9-4763-98A2-367B267825F5 on shell_id FBFF79CE-C004-4089-A277-E787DB2A2654
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2362ffb0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B25E8A14-37D0-41A0-B166-78E84DA002E2
DEBUG winrmshell: [WinRM] Command created for hostname with id: 288D518B-4D7C-42F4-BC8A-6F776FF5682F
DEBUG winrmshell: [WinRM] creating command_id: 288D518B-4D7C-42F4-BC8A-6F776FF5682F on shell_id B25E8A14-37D0-41A0-B166-78E84DA002E2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 288D518B-4D7C-42F4-BC8A-6F776FF5682F on shell_id B25E8A14-37D0-41A0-B166-78E84DA002E2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24294198 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D9C5922D-6000-4733-95A3-C21946908BF4
DEBUG winrmshell: [WinRM] Command created for hostname with id: C439B890-1CE9-48A5-B027-43529B06EA93
DEBUG winrmshell: [WinRM] creating command_id: C439B890-1CE9-48A5-B027-43529B06EA93 on shell_id D9C5922D-6000-4733-95A3-C21946908BF4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C439B890-1CE9-48A5-B027-43529B06EA93 on shell_id D9C5922D-6000-4733-95A3-C21946908BF4
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24878938 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b4d7f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b4c970 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24a0c470 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 20C078D7-011B-4EED-A3A9-6F63293F08AE
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8BFF9BEA-7F99-4433-AD9A-519631E146D7
DEBUG winrmshell: [WinRM] creating command_id: 8BFF9BEA-7F99-4433-AD9A-519631E146D7 on shell_id 20C078D7-011B-4EED-A3A9-6F63293F08AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8BFF9BEA-7F99-4433-AD9A-519631E146D7 on shell_id 20C078D7-011B-4EED-A3A9-6F63293F08AE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c248ed508 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c225b6198 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c225a5870 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24ac3828 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E199F527-8E31-471D-8BDF-B58C51B3588B
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4D80CF3E-5B97-4A09-B6CD-8806370145CA
DEBUG winrmshell: [WinRM] creating command_id: 4D80CF3E-5B97-4A09-B6CD-8806370145CA on shell_id E199F527-8E31-471D-8BDF-B58C51B3588B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4D80CF3E-5B97-4A09-B6CD-8806370145CA on shell_id E199F527-8E31-471D-8BDF-B58C51B3588B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2494e9e8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-bp7nep.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b47358 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b45f80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249f6710 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "c7314f1931cc68e64e30c31ffa092d2063d36af1" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-bp7nep.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5036A565-8A6B-4D3D-91BC-08A079148A45
DEBUG winrmshell: [WinRM] creating command_id: 5036A565-8A6B-4D3D-91BC-08A079148A45 on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5036A565-8A6B-4D3D-91BC-08A079148A45 on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","c7314f1931cc68e64e30c31ffa092d2063d36af1","2ccc385c1b1113d499646914f2abe476d7a690be","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-bp7nep.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 104CDC1F-DF71-43E6-A25D-1543CAA98652
DEBUG winrmshell: [WinRM] creating command_id: 104CDC1F-DF71-43E6-A25D-1543CAA98652 on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 104CDC1F-DF71-43E6-A25D-1543CAA98652 on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBNaW1pa2F0eiBhbmQgUG93ZXJzcGxvaXQgaW50byBjOlxUb29sc1xNaW1pa2F0ei4gVXNlZCB0byBpbnN0YWxsIHJlZHRlYW0gcmVsYXRlZCB0b29saW5nLgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgUmVkIFRlYW0gVG9vbGluZy4uLiIKJGhvc3RuYW1lID0gJChob3N0bmFtZSkKCiMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzI3CltOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSBbTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTIKCiMgV2luZG93cyBEZWZlbmRlciBzaG91bGQgYmUgZGlzYWJsZWQgYWxyZWFkeSBieSBPJk8gU2h1dFVwMTAgYW5kIHRoZSBHUE8KSWYgKCRob3N0bmFtZSAtZXEgIndpbjEwIiAtQW5kIChHZXQtU2VydmljZSAtTmFtZSBXaW5EZWZlbmQpLlN0YXJ0VHlwZSAtbmUgJ0Rpc2FibGVkJyApIHsKICAjIEFkZGluZyBEZWZlbmRlciBleGNsdXNpb25zIGp1c3QgaW4gY2FzZQogIFNldC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblBhdGggIkM6XFRvb2xzIgogIEFkZC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblBhdGggIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wIgoKICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xJbnZva2UtQ29tbWFuZEFzLnBzMQogIEludm9rZS1Db21tYW5kQXMgJ05UIFNFUlZJQ0VcVHJ1c3RlZEluc3RhbGxlcicgewogICAgU2V0LVNlcnZpY2UgV2luRGVmZW5kIC1TdGFydHVwVHlwZSBEaXNhYmxlZAogICAgU3RvcC1TZXJ2aWNlIFdpbkRlZmVuZAogIH0KfQoKIyBXaW5kb3dzIERlZmVuZGVyIHNob3VsZCBiZSBkaXNhYmxlZCBieSB0aGUgR1BPIG9yIHVuaW5zdGFsbGVkIGFscmVhZHksIGJ1dCB3ZSdsbCBrZWVwIHRoaXMganVzdCBpbiBjYXNlCklmICgkaG9zdG5hbWUgLW5lICJ3aW4xMCIgLUFuZCAoR2V0LVNlcnZpY2UgLU5hbWUgV2luRGVmZW5kIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKS5zdGF0dXMgLWVxICdSdW5uaW5nJykgewogICMgVW5pbnN0YWxsaW5nIFdpbmRvd3MgRGVmZW5kZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9TdGVmYW5TY2hlcmVyL3BhY2tlci13aW5kb3dzL2lzc3Vlcy8yMDEpCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVW5pbnN0YWxsaW5nIFdpbmRvd3MgRGVmZW5kZXIuLi4iCiAgVHJ5IHsKICAgIFVuaW5zdGFsbC1XaW5kb3dzRmVhdHVyZSBXaW5kb3dzLURlZmVuZGVyIC1FcnJvckFjdGlvbiBTdG9wCiAgICBVbmluc3RhbGwtV2luZG93c0ZlYXR1cmUgV2luZG93cy1EZWZlbmRlci1GZWF0dXJlcyAtRXJyb3JBY3Rpb24gU3RvcAogIH0gQ2F0Y2ggewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdpbmRvd3MgRGVmZW5kZXIgZGlkIG5vdCB1bmluc3RhbGwgc3VjY2Vzc2Z1bGx5Li4uIgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdlJ2xsIHRyeSBhZ2FpbiBkdXJpbmcgaW5zdGFsbC1yZWQtdGVhbS5wczEiCiAgfQp9IEVsc2UgIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV2luZG93cyBEZWZlbmRlciBoYXMgYWxyZWFkeSBiZWVuIGRpc2FibGVkIG9yIHVuaW5zdGFsbGVkLiIKfQoKIyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIHVuemlwcyBhIGNvcHkgb2YgdGhlIGxhdGVzdCBNaW1pa2F0eiB0cnVuawpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGV0ZXJtaW5pbmcgbGF0ZXN0IHJlbGVhc2Ugb2YgTWltaWthdHouLi4iCiR0YWcgPSAoSW52b2tlLVdlYlJlcXVlc3QgImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvZ2VudGlsa2l3aS9taW1pa2F0ei9yZWxlYXNlcyIgLVVzZUJhc2ljUGFyc2luZyB8IENvbnZlcnRGcm9tLUpzb24pWzBdLnRhZ19uYW1lCiRtaW1pa2F0ekRvd25sb2FkVXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbS9nZW50aWxraXdpL21pbWlrYXR6L3JlbGVhc2VzL2Rvd25sb2FkLyR0YWcvbWltaWthdHpfdHJ1bmsuemlwIgokbWltaWthdHpSZXBvUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFxtaW1pa2F0el90cnVuay56aXAnCklmICgtbm90IChUZXN0LVBhdGggJG1pbWlrYXR6UmVwb1BhdGgpKSB7CiAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJG1pbWlrYXR6RG93bmxvYWRVcmwiIC1PdXRGaWxlICRtaW1pa2F0elJlcG9QYXRoCiAgRXhwYW5kLUFyY2hpdmUgLXBhdGggIiRtaW1pa2F0elJlcG9QYXRoIiAtZGVzdGluYXRpb25wYXRoICdjOlxUb29sc1xNaW1pa2F0eicgLUZvcmNlCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE1pbWlrYXR6IHdhcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQoKIyBEb3dubG9hZCBhbmQgdW56aXAgYSBjb3B5IG9mIFBvd2VyU3Bsb2l0CldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBQb3dlcnNwbG9pdC4uLiIKJHBvd2Vyc3Bsb2l0RG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdC9hcmNoaXZlL2Rldi56aXAiCiRwb3dlcnNwbG9pdFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHBvd2Vyc3Bsb2l0LnppcCIKSWYgKC1ub3QgKFRlc3QtUGF0aCAkcG93ZXJzcGxvaXRSZXBvUGF0aCkpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkcG93ZXJzcGxvaXREb3dubG9hZFVybCIgLU91dEZpbGUgJHBvd2Vyc3Bsb2l0UmVwb1BhdGgKICBFeHBhbmQtQXJjaGl2ZSAtcGF0aCAiJHBvd2Vyc3Bsb2l0UmVwb1BhdGgiIC1kZXN0aW5hdGlvbnBhdGggJ2M6XFRvb2xzXFBvd2VyU3Bsb2l0JyAtRm9yY2UKICBDb3B5LUl0ZW0gImM6XFRvb2xzXFBvd2VyU3Bsb2l0XFBvd2VyU3Bsb2l0LWRldlwqIiAiJEVudjp3aW5kaXJcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxNb2R1bGVzIiAtUmVjdXJzZSAtRm9yY2UKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgUG93ZXJTcGxvaXQgd2FzIGFscmVhZHkgaW5zdGFsbGVkLiBNb3ZpbmcgT24uIgp9CgojIERvd25sb2FkIGFuZCB1bnppcCBhIGNvcHkgb2YgQmFkQmxvb2QKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIEJhZEJsb29kLi4uIgokYmFkYmxvb2REb3dubG9hZFVybCA9ICJodHRwczovL2dpdGh1Yi5jb20vZGF2aWRwcm93ZS9CYWRCbG9vZC9hcmNoaXZlL21hc3Rlci56aXAiCiRiYWRibG9vZFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXGJhZGJsb29kLnppcCIKSWYgKC1ub3QgKFRlc3QtUGF0aCAkYmFkYmxvb2RSZXBvUGF0aCkpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkYmFkYmxvb2REb3dubG9hZFVybCIgLU91dEZpbGUgIiRiYWRibG9vZFJlcG9QYXRoIgogIEV4cGFuZC1BcmNoaXZlIC1wYXRoICIkYmFkYmxvb2RSZXBvUGF0aCIgLWRlc3RpbmF0aW9ucGF0aCAnYzpcVG9vbHNcQmFkQmxvb2QnIC1Gb3JjZQogICMgTG93ZXIgdGhlIG51bWJlciBvZiBkZWZhdWx0IHVzZXJzIHRvIGJlIGNyZWF0ZWQgYnkgQmFkQmxvb2QKICAkaW52b2tlQmFkQmxvb2RQYXRoID0gImM6XFRvb2xzXEJhZEJsb29kXEJhZEJsb29kLW1hc3RlclxJbnZva2UtQmFkQmxvb2QucHMxIgogICgoR2V0LUNvbnRlbnQgLXBhdGggJGludm9rZUJhZEJsb29kUGF0aCAtUmF3KSAtcmVwbGFjZSAnMTAwMC4uNTAwMCcsJzUwMC4uMTUwMCcpIHwgU2V0LUNvbnRlbnQgLVBhdGggJGludm9rZUJhZEJsb29kUGF0aAp9IEVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBCYWRCbG9vZCB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgRG93bmxvYWQgYW5kIGluc3RhbGwgSW52b2tlLUF0b21pY1JlZFRlYW0KV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIEludm9rZS1BdG9taWNSZWRUZWFtIGFuZCBhdG9taWMgdGVzdHMuLi4iCklmICgtbm90IChUZXN0LVBhdGggIkM6XFRvb2xzXEF0b21pY1JlZFRlYW0iKSkgewogIEluc3RhbGwtUGFja2FnZVByb3ZpZGVyIC1OYW1lIE51R2V0IC1Gb3JjZQogIEluc3RhbGwtTW9kdWxlIC1OYW1lIHBvd2Vyc2hlbGwteWFtbCAtRm9yY2UKICBJRVggKElXUiAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2ludm9rZS1hdG9taWNyZWR0ZWFtL21hc3Rlci9pbnN0YWxsLWF0b21pY3JlZHRlYW0ucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsKICBJbnN0YWxsLUF0b21pY1JlZFRlYW0gLWdldEF0b21pY3MgLUluc3RhbGxQYXRoICJjOlxUb29sc1xBdG9taWNSZWRUZWFtIgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBVcGRhdGluZyBQcm9maWxlLnBzMSB0byBpbXBvcnQgdGhlIEludm9rZS1BdG9taWNSZWRUZWFtIG1vZHVsZS4uLiIKICBBZGQtQ29udGVudCAtUGF0aCBDOlxXaW5kb3dzXFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBcUHJvZmlsZS5wczEgJ0ltcG9ydC1Nb2R1bGUgIkM6XFRvb2xzXEF0b21pY1JlZFRlYW1caW52b2tlLWF0b21pY3JlZHRlYW1cSW52b2tlLUF0b21pY1JlZFRlYW0ucHNkMSIgLUZvcmNlCiRQU0RlZmF1bHRQYXJhbWV0ZXJWYWx1ZXMgPSBAeyJJbnZva2UtQXRvbWljVGVzdDpQYXRoVG9BdG9taWNzRm9sZGVyIj0iQzpcVG9vbHNcQXRvbWljUmVkVGVhbVxhdG9taWNzIn0nIC1Gb3JjZQp9IEVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnZva2UtQXRvbWljUmVkVGVhbSB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgUHVycG9zZTogRG93bmxvYWRzIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBQdXJwbGVTaGFycE5ld3RvbnNvZnQuSnNvbi5kbGwKSWYgKC1ub3QgKFRlc3QtUGF0aCAiYzpcVG9vbHNcUHVycGxlU2hhcnAiKSkgewogIE5ldy1JdGVtIC1QYXRoICJjOlxUb29sc1wiIC1OYW1lICJQdXJwbGVTaGFycCIgLUl0ZW1UeXBlICJkaXJlY3RvcnkiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFB1cnBsZVNoYXJwIGZvbGRlciBhbHJlYWR5IGV4aXN0cy4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERldGVybWluaW5nIGxhdGVzdCByZWxlYXNlIG9mIFB1cnBsZXNoYXJwLi4uIgokdGFnID0gKEludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL212ZWxhemMwL1B1cnBsZVNoYXJwL3JlbGVhc2VzIiAtVXNlQmFzaWNQYXJzaW5nIHwgQ29udmVydEZyb20tSnNvbilbMF0udGFnX25hbWUKJHB1cnBsZXNoYXJwRG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL212ZWxhemMwL1B1cnBsZVNoYXJwL3JlbGVhc2VzL2Rvd25sb2FkLyR0YWcvUHVycGxlU2hhcnBfeDY0LmV4ZSIKSWYgKC1ub3QgKFRlc3QtUGF0aCAiYzpcVG9vbHNcUHVycGxlU2hhcnBcUHVycGxlU2hhcnAuZXhlIikpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICRwdXJwbGVzaGFycERvd25sb2FkVXJsIC1PdXRGaWxlICJjOlxUb29sc1xQdXJwbGVTaGFycFxQdXJwbGVTaGFycC5leGUiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFB1cnBsZVNoYXJwIHdhcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFJlZCBUZWFtIHRvb2xpbmcgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 122E2CE4-53C4-48D2-8444-677469859CE3
DEBUG winrmshell: [WinRM] creating command_id: 122E2CE4-53C4-48D2-8444-677469859CE3 on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 122E2CE4-53C4-48D2-8444-677469859CE3 on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B45667CE-3208-42FC-920F-070DD8D28A2A
DEBUG winrmshell: [WinRM] creating command_id: B45667CE-3208-42FC-920F-070DD8D28A2A on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B45667CE-3208-42FC-920F-070DD8D28A2A on shell_id 8389FAC6-C67A-4948-BC99-0AC81FDE0282
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-bp7nep.ps1 to C:/tmp/vagrant-shell.ps1 (8.2 KB over 1 chunks) in (0m0.15s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m1.42s) stream_files: (0m0.15s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c239b8060 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c239ab8d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22a30020 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7700FF49-CD01-44DF-82DE-347D8AD80576
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 017AD2D9-A455-40AD-9445-1A3823ED2FCB
DEBUG winrmshell: [WinRM] creating command_id: 017AD2D9-A455-40AD-9445-1A3823ED2FCB on shell_id 7700FF49-CD01-44DF-82DE-347D8AD80576
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:41] Installing Red Team Tooling...
 INFO interface: detail:     dc: [14:41] Installing Red Team Tooling...
    dc: [14:41] Installing Red Team Tooling...
 INFO interface: detail: [14:41] Windows Defender has already been disabled or uninstalled.
 INFO interface: detail:     dc: [14:41] Windows Defender has already been disabled or uninstalled.
    dc: [14:41] Windows Defender has already been disabled or uninstalled.
 INFO interface: detail: [14:41] Determining latest release of Mimikatz...
 INFO interface: detail:     dc: [14:41] Determining latest release of Mimikatz...
    dc: [14:41] Determining latest release of Mimikatz...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:41] Downloading Powersploit...
 INFO interface: detail:     dc: [14:41] Downloading Powersploit...
    dc: [14:41] Downloading Powersploit...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:41] Downloading BadBlood...
 INFO interface: detail:     dc: [14:41] Downloading BadBlood...
    dc: [14:41] Downloading BadBlood...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:41] Downloading Invoke-AtomicRedTeam and atomic tests...
 INFO interface: detail:     dc: [14:41] Downloading Invoke-AtomicRedTeam and atomic tests...
    dc: [14:41] Downloading Invoke-AtomicRedTeam and atomic tests...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Name                           Version          Source           Summary
 INFO interface: detail:     dc: Name                           Version          Source           Summary
    dc: Name                           Version          Source           Summary
 INFO interface: detail: ----                           -------          ------           -------
 INFO interface: detail:     dc: ----                           -------          ------           -------
    dc: ----                           -------          ------           -------
 INFO interface: detail: nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...
 INFO interface: detail:     dc: nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...
    dc: nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function
 INFO interface: detail:     dc: Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function
    dc: Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function
 INFO interface: detail: See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details
 INFO interface: detail:     dc: See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details
    dc: See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details
 INFO interface: detail: [14:42] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...
 INFO interface: detail:     dc: [14:42] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...
    dc: [14:42] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Tools\PurpleSharp
 INFO interface: detail:     dc: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Tools\PurpleSharp
    dc: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Tools\PurpleSharp
 INFO interface: detail: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Tools
 INFO interface: detail:     dc: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Tools
    dc: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Tools
 INFO interface: detail: PSChildName       : PurpleSharp
 INFO interface: detail:     dc: PSChildName       : PurpleSharp
    dc: PSChildName       : PurpleSharp
 INFO interface: detail: PSDrive           : C
 INFO interface: detail:     dc: PSDrive           : C
    dc: PSDrive           : C
 INFO interface: detail: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail:     dc: PSProvider        : Microsoft.PowerShell.Core\FileSystem
    dc: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail: PSIsContainer     : True
 INFO interface: detail:     dc: PSIsContainer     : True
    dc: PSIsContainer     : True
 INFO interface: detail: Name              : PurpleSharp
 INFO interface: detail:     dc: Name              : PurpleSharp
    dc: Name              : PurpleSharp
 INFO interface: detail: FullName          : C:\Tools\PurpleSharp
 INFO interface: detail:     dc: FullName          : C:\Tools\PurpleSharp
    dc: FullName          : C:\Tools\PurpleSharp
 INFO interface: detail: Parent            : Tools
 INFO interface: detail:     dc: Parent            : Tools
    dc: Parent            : Tools
 INFO interface: detail: Exists            : True
 INFO interface: detail:     dc: Exists            : True
    dc: Exists            : True
 INFO interface: detail: Root              : C:\
 INFO interface: detail:     dc: Root              : C:\
    dc: Root              : C:\
 INFO interface: detail: Extension         :
 INFO interface: detail:     dc: Extension         :
    dc: Extension         :
 INFO interface: detail: CreationTime      : 6/20/2022 2:42:47 PM
 INFO interface: detail:     dc: CreationTime      : 6/20/2022 2:42:47 PM
    dc: CreationTime      : 6/20/2022 2:42:47 PM
 INFO interface: detail: CreationTimeUtc   : 6/20/2022 2:42:47 PM
 INFO interface: detail:     dc: CreationTimeUtc   : 6/20/2022 2:42:47 PM
    dc: CreationTimeUtc   : 6/20/2022 2:42:47 PM
 INFO interface: detail: LastAccessTime    : 6/20/2022 2:42:47 PM
 INFO interface: detail:     dc: LastAccessTime    : 6/20/2022 2:42:47 PM
    dc: LastAccessTime    : 6/20/2022 2:42:47 PM
 INFO interface: detail: LastAccessTimeUtc : 6/20/2022 2:42:47 PM
 INFO interface: detail:     dc: LastAccessTimeUtc : 6/20/2022 2:42:47 PM
    dc: LastAccessTimeUtc : 6/20/2022 2:42:47 PM
 INFO interface: detail: LastWriteTime     : 6/20/2022 2:42:47 PM
 INFO interface: detail:     dc: LastWriteTime     : 6/20/2022 2:42:47 PM
    dc: LastWriteTime     : 6/20/2022 2:42:47 PM
 INFO interface: detail: LastWriteTimeUtc  : 6/20/2022 2:42:47 PM
 INFO interface: detail:     dc: LastWriteTimeUtc  : 6/20/2022 2:42:47 PM
    dc: LastWriteTimeUtc  : 6/20/2022 2:42:47 PM
 INFO interface: detail: Attributes        : Directory
 INFO interface: detail:     dc: Attributes        : Directory
    dc: Attributes        : Directory
 INFO interface: detail: Mode              : d-----
 INFO interface: detail:     dc: Mode              : d-----
    dc: Mode              : d-----
 INFO interface: detail: BaseName          : PurpleSharp
 INFO interface: detail:     dc: BaseName          : PurpleSharp
    dc: BaseName          : PurpleSharp
 INFO interface: detail: Target            : {}
 INFO interface: detail:     dc: Target            : {}
    dc: Target            : {}
 INFO interface: detail: LinkType          :
 INFO interface: detail:     dc: LinkType          :
    dc: LinkType          :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:42] Determining latest release of Purplesharp...
 INFO interface: detail:     dc: [14:42] Determining latest release of Purplesharp...
    dc: [14:42] Determining latest release of Purplesharp...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:42] Red Team tooling installation complete!
 INFO interface: detail:     dc: [14:42] Red Team tooling installation complete!
    dc: [14:42] Red Team tooling installation complete!
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 017AD2D9-A455-40AD-9445-1A3823ED2FCB on shell_id 7700FF49-CD01-44DF-82DE-347D8AD80576
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b252f8 @data=[{:stdout=>"[14:41] Installing Red Team Tooling...\r\n"}, {:stdout=>"[14:41] Windows Defender has already been disabled or uninstalled.\r\n"}, {:stdout=>"[14:41] Determining latest release of Mimikatz...\r\n"}, {:stdout=>"[14:41] Downloading Powersploit...\r\n"}, {:stdout=>"[14:41] Downloading BadBlood...\r\n"}, {:stdout=>"[14:41] Downloading Invoke-AtomicRedTeam and atomic tests...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           Version          Source           Summary                          \r\n"}, {:stdout=>"----                           -------          ------           -------                          \r\n"}, {:stdout=>"nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...\r\n"}, {:stdout=>"Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function\r\n"}, {:stdout=>"See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details\r\n"}, {:stdout=>"[14:42] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Tools\\PurpleSharp\r\n"}, {:stdout=>"PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\Tools\r\n"}, {:stdout=>"PSChildName       : PurpleSharp\r\n"}, {:stdout=>"PSDrive           : C\r\n"}, {:stdout=>"PSProvider        : Microsoft.PowerShell.Core\\FileSystem\r\n"}, {:stdout=>"PSIsContainer     : True\r\n"}, {:stdout=>"Name              : PurpleSharp\r\n"}, {:stdout=>"FullName          : C:\\Tools\\PurpleSharp\r\n"}, {:stdout=>"Parent            : Tools\r\n"}, {:stdout=>"Exists            : True\r\n"}, {:stdout=>"Root              : C:\\\r\n"}, {:stdout=>"Extension         : \r\n"}, {:stdout=>"CreationTime      : 6/20/2022 2:42:47 PM\r\n"}, {:stdout=>"CreationTimeUtc   : 6/20/2022 2:42:47 PM\r\n"}, {:stdout=>"LastAccessTime    : 6/20/2022 2:42:47 PM\r\n"}, {:stdout=>"LastAccessTimeUtc : 6/20/2022 2:42:47 PM\r\n"}, {:stdout=>"LastWriteTime     : 6/20/2022 2:42:47 PM\r\n"}, {:stdout=>"LastWriteTimeUtc  : 6/20/2022 2:42:47 PM\r\n"}, {:stdout=>"Attributes        : Directory\r\n"}, {:stdout=>"Mode              : d-----\r\n"}, {:stdout=>"BaseName          : PurpleSharp\r\n"}, {:stdout=>"Target            : {}\r\n"}, {:stdout=>"LinkType          : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:42] Determining latest release of Purplesharp...\r\n"}, {:stdout=>"[14:42] Red Team tooling installation complete!\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2434c1a8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c24551228 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E6BDCE35-7846-4101-992B-EC760452E6DC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 7862864A-204D-4E39-9264-CACC998FD10D
DEBUG winrmshell: [WinRM] creating command_id: 7862864A-204D-4E39-9264-CACC998FD10D on shell_id E6BDCE35-7846-4101-992B-EC760452E6DC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7862864A-204D-4E39-9264-CACC998FD10D on shell_id E6BDCE35-7846-4101-992B-EC760452E6DC
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24084560 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>55986, 22=>2200, 5985=>2201}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 24CB8097-D2E5-45BE-834A-578ADD5EBECB
DEBUG winrmshell: [WinRM] Command created for hostname with id: CA3E9C41-4D76-416C-B2CC-D9598391D7C6
DEBUG winrmshell: [WinRM] creating command_id: CA3E9C41-4D76-416C-B2CC-D9598391D7C6 on shell_id 24CB8097-D2E5-45BE-834A-578ADD5EBECB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CA3E9C41-4D76-416C-B2CC-D9598391D7C6 on shell_id 24CB8097-D2E5-45BE-834A-578ADD5EBECB
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2441e518 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F151122D-B92E-4DA3-9E1E-E1F66C7ED133
DEBUG winrmshell: [WinRM] Command created for hostname with id: E4B66D3A-4F88-407B-B53D-CA3FF1092BF6
DEBUG winrmshell: [WinRM] creating command_id: E4B66D3A-4F88-407B-B53D-CA3FF1092BF6 on shell_id F151122D-B92E-4DA3-9E1E-E1F66C7ED133
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E4B66D3A-4F88-407B-B53D-CA3FF1092BF6 on shell_id F151122D-B92E-4DA3-9E1E-E1F66C7ED133
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249b5918 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2363dcc8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c236360b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b4d7f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 594BBFD1-EADE-4484-BFCE-B2F34FF31F08
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DFAA2BD0-5B84-4120-BCDE-D4CDBF19F718
DEBUG winrmshell: [WinRM] creating command_id: DFAA2BD0-5B84-4120-BCDE-D4CDBF19F718 on shell_id 594BBFD1-EADE-4484-BFCE-B2F34FF31F08
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DFAA2BD0-5B84-4120-BCDE-D4CDBF19F718 on shell_id 594BBFD1-EADE-4484-BFCE-B2F34FF31F08
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249e7968 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2372ca80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23726ba8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22535200 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C5868C74-5291-4173-8F91-F915EE4F6AA3
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8702F81C-7D70-402C-8AE3-CF04CB4D406E
DEBUG winrmshell: [WinRM] creating command_id: 8702F81C-7D70-402C-8AE3-CF04CB4D406E on shell_id C5868C74-5291-4173-8F91-F915EE4F6AA3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8702F81C-7D70-402C-8AE3-CF04CB4D406E on shell_id C5868C74-5291-4173-8F91-F915EE4F6AA3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a9f4c8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1kvxufx.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22a9ba00 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22a92d38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b36878 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "81883041f088db0f0d4a349f41739c56f60c7961" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1kvxufx.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2E3E0C17-A932-4DD5-9DE8-5DE7E581EF6C
DEBUG winrmshell: [WinRM] creating command_id: 2E3E0C17-A932-4DD5-9DE8-5DE7E581EF6C on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2E3E0C17-A932-4DD5-9DE8-5DE7E581EF6C on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","81883041f088db0f0d4a349f41739c56f60c7961","c7314f1931cc68e64e30c31ffa092d2063d36af1","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1kvxufx.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D1B5E03A-52EA-4899-8ABA-2DF918394D42
DEBUG winrmshell: [WinRM] creating command_id: D1B5E03A-52EA-4899-8ABA-2DF918394D42 on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D1B5E03A-52EA-4899-8ABA-2DF918394D42 on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIGFkZGl0aW9uYWwgcGFja2FnZXMgZnJvbSBDaG9jb2xhdGV5LgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgYWRkaXRpb25hbCBDaG9jbyBwYWNrYWdlcy4uLiIKCklmICgtbm90IChUZXN0LVBhdGggIkM6XFByb2dyYW1EYXRhXGNob2NvbGF0ZXkiKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIENob2NvbGF0ZXkiCiAgaWV4ICgobmV3LW9iamVjdCBuZXQud2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cHM6Ly9jaG9jb2xhdGV5Lm9yZy9pbnN0YWxsLnBzMScpKQp9IGVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDaG9jb2xhdGV5IGlzIGFscmVhZHkgaW5zdGFsbGVkLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ2hvY29sYXRleSBleHRyYXMuLi4iCmNob2NvIGluc3RhbGwgLXkgLS1saW1pdC1vdXRwdXQgLS1uby1wcm9ncmVzcyB3aXJlc2hhcmsgd2lucGNhcAoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIENob2NvIGFkZG9ucyBjb21wbGV0ZSEiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 05361269-45A5-45DB-B3B6-94CA6225728D
DEBUG winrmshell: [WinRM] creating command_id: 05361269-45A5-45DB-B3B6-94CA6225728D on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 05361269-45A5-45DB-B3B6-94CA6225728D on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 67F8169D-31DE-47E2-8665-A3D2BE320157
DEBUG winrmshell: [WinRM] creating command_id: 67F8169D-31DE-47E2-8665-A3D2BE320157 on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 67F8169D-31DE-47E2-8665-A3D2BE320157 on shell_id 402A501E-8B03-4E4A-B16D-F4D78FFF4FF6
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1kvxufx.ps1 to C:/tmp/vagrant-shell.ps1 (0.864 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.46s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240aeec8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240ad960 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237ba920 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32E7719A-D4CC-4E55-AECE-6A92A11D5B54
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DD6F6D16-37F0-4C09-A925-FFD53F91798B
DEBUG winrmshell: [WinRM] creating command_id: DD6F6D16-37F0-4C09-A925-FFD53F91798B on shell_id 32E7719A-D4CC-4E55-AECE-6A92A11D5B54
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:42] Installing additional Choco packages...
 INFO interface: detail:     dc: [14:42] Installing additional Choco packages...
    dc: [14:42] Installing additional Choco packages...
 INFO interface: detail: [14:42] Chocolatey is already installed.
 INFO interface: detail:     dc: [14:42] Chocolatey is already installed.
    dc: [14:42] Chocolatey is already installed.
 INFO interface: detail: [14:42] Installing Chocolatey extras...
 INFO interface: detail:     dc: [14:42] Installing Chocolatey extras...
    dc: [14:42] Installing Chocolatey extras...
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     dc: Installing the following packages:
    dc: Installing the following packages:
 INFO interface: detail: wireshark;winpcap
 INFO interface: detail:     dc: wireshark;winpcap
    dc: wireshark;winpcap
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     dc: By installing, you accept licenses for the packages.
    dc: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: chocolatey-windowsupdate.extension v1.0.4 [Approved]
 INFO interface: detail:     dc: chocolatey-windowsupdate.extension v1.0.4 [Approved]
    dc: chocolatey-windowsupdate.extension v1.0.4 [Approved]
 INFO interface: detail: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
    dc: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-windowsupdate extensions.
 INFO interface: detail:     dc:  Installed/updated chocolatey-windowsupdate extensions.
    dc:  Installed/updated chocolatey-windowsupdate extensions.
 INFO interface: detail:  The install of chocolatey-windowsupdate.extension was successful.
 INFO interface: detail:     dc:  The install of chocolatey-windowsupdate.extension was successful.
    dc:  The install of chocolatey-windowsupdate.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
 INFO interface: detail:     dc:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
    dc:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: KB3035131 v1.0.3 [Approved]
 INFO interface: detail:     dc: KB3035131 v1.0.3 [Approved]
    dc: KB3035131 v1.0.3 [Approved]
 INFO interface: detail: kb3035131 package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: kb3035131 package files install completed. Performing other installation steps.
    dc: kb3035131 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:     dc: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
    dc: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:  The install of kb3035131 was successful.
 INFO interface: detail:     dc:  The install of kb3035131 was successful.
    dc:  The install of kb3035131 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: KB3033929 v1.0.5 [Approved]
 INFO interface: detail:     dc: KB3033929 v1.0.5 [Approved]
    dc: KB3033929 v1.0.5 [Approved]
 INFO interface: detail: kb3033929 package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: kb3033929 package files install completed. Performing other installation steps.
    dc: kb3033929 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:     dc: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
    dc: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:  The install of kb3033929 was successful.
 INFO interface: detail:     dc:  The install of kb3033929 was successful.
    dc:  The install of kb3033929 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: KB2919442 v1.0.20160915 [Approved]
 INFO interface: detail:     dc: KB2919442 v1.0.20160915 [Approved]
    dc: KB2919442 v1.0.20160915 [Approved]
 INFO interface: detail: kb2919442 package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: kb2919442 package files install completed. Performing other installation steps.
    dc: kb2919442 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:     dc: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
    dc: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:  The install of kb2919442 was successful.
 INFO interface: detail:     dc:  The install of kb2919442 was successful.
    dc:  The install of kb2919442 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: KB2919355 v1.0.20160915 [Approved]
 INFO interface: detail:     dc: KB2919355 v1.0.20160915 [Approved]
    dc: KB2919355 v1.0.20160915 [Approved]
 INFO interface: detail: kb2919355 package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: kb2919355 package files install completed. Performing other installation steps.
    dc: kb2919355 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:     dc: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
    dc: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:  The install of kb2919355 was successful.
 INFO interface: detail:     dc:  The install of kb2919355 was successful.
    dc:  The install of kb2919355 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: KB2999226 v1.0.20181019 [Approved] - Possibly broken
 INFO interface: detail:     dc: KB2999226 v1.0.20181019 [Approved] - Possibly broken
    dc: KB2999226 v1.0.20181019 [Approved] - Possibly broken
 INFO interface: detail: kb2999226 package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: kb2999226 package files install completed. Performing other installation steps.
    dc: kb2999226 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:     dc: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
    dc: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:  The install of kb2999226 was successful.
 INFO interface: detail:     dc:  The install of kb2999226 was successful.
    dc:  The install of kb2999226 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: vcredist140 v14.32.31326 [Approved]
 INFO interface: detail:     dc: vcredist140 v14.32.31326 [Approved]
    dc: vcredist140 v14.32.31326 [Approved]
 INFO interface: detail: vcredist140 package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: vcredist140 package files install completed. Performing other installation steps.
    dc: vcredist140 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading vcredist140-x86
 INFO interface: detail:     dc: Downloading vcredist140-x86
    dc: Downloading vcredist140-x86
 INFO interface: detail:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
 INFO interface: detail:     dc:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
    dc:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Download of VC_redist.x86.exe (13.1 MB) completed.
 INFO interface: detail:     dc: Download of VC_redist.x86.exe (13.1 MB) completed.
    dc: Download of VC_redist.x86.exe (13.1 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     dc: Hashes match.
    dc: Hashes match.
 INFO interface: detail: Installing vcredist140-x86...
 INFO interface: detail:     dc: Installing vcredist140-x86...
    dc: Installing vcredist140-x86...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: vcredist140-x86 has been installed.
 INFO interface: detail:     dc: vcredist140-x86 has been installed.
    dc: vcredist140-x86 has been installed.
 INFO interface: detail: Downloading vcredist140-x64 64 bit
 INFO interface: detail:     dc: Downloading vcredist140-x64 64 bit
    dc: Downloading vcredist140-x64 64 bit
 INFO interface: detail:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
 INFO interface: detail:     dc:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
    dc:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Download of VC_redist.x64.exe (24.16 MB) completed.
 INFO interface: detail:     dc: Download of VC_redist.x64.exe (24.16 MB) completed.
    dc: Download of VC_redist.x64.exe (24.16 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     dc: Hashes match.
    dc: Hashes match.
 INFO interface: detail: Installing vcredist140-x64...
 INFO interface: detail:     dc: Installing vcredist140-x64...
    dc: Installing vcredist140-x64...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: vcredist140-x64 has been installed.
 INFO interface: detail:     dc: vcredist140-x64 has been installed.
    dc: vcredist140-x64 has been installed.
 INFO interface: detail:   vcredist140 may be able to be automatically uninstalled.
 INFO interface: detail:     dc:   vcredist140 may be able to be automatically uninstalled.
    dc:   vcredist140 may be able to be automatically uninstalled.
 INFO interface: detail:  The install of vcredist140 was successful.
 INFO interface: detail:     dc:  The install of vcredist140 was successful.
    dc:  The install of vcredist140 was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     dc:   Software installed as 'exe', install location is likely default.
    dc:   Software installed as 'exe', install location is likely default.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: wireshark v3.6.6 [Approved]
 INFO interface: detail:     dc: wireshark v3.6.6 [Approved]
    dc: wireshark v3.6.6 [Approved]
 INFO interface: detail: wireshark package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: wireshark package files install completed. Performing other installation steps.
    dc: wireshark package files install completed. Performing other installation steps.
 INFO interface: detail: Installing 64-bit wireshark...
 INFO interface: detail:     dc: Installing 64-bit wireshark...
    dc: Installing 64-bit wireshark...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: wireshark has been installed.
 INFO interface: detail:     dc: wireshark has been installed.
    dc: wireshark has been installed.
 INFO interface: detail:   wireshark can be automatically uninstalled.
 INFO interface: detail:     dc:   wireshark can be automatically uninstalled.
    dc:   wireshark can be automatically uninstalled.
 INFO interface: detail:  The install of wireshark was successful.
 INFO interface: detail:     dc:  The install of wireshark was successful.
    dc:  The install of wireshark was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\Wireshark'
 INFO interface: detail:     dc:   Software installed to 'C:\Program Files\Wireshark'
    dc:   Software installed to 'C:\Program Files\Wireshark'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: autohotkey.portable v1.1.34.03 [Approved]
 INFO interface: detail:     dc: autohotkey.portable v1.1.34.03 [Approved]
    dc: autohotkey.portable v1.1.34.03 [Approved]
 INFO interface: detail: autohotkey.portable package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: autohotkey.portable package files install completed. Performing other installation steps.
    dc: autohotkey.portable package files install completed. Performing other installation steps.
 INFO interface: detail: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
 INFO interface: detail:     dc: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
    dc: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
 INFO interface: detail: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
 INFO interface: detail:     dc: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
    dc: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
 INFO interface: detail: Removing ANSI-32 version
 INFO interface: detail:     dc: Removing ANSI-32 version
    dc: Removing ANSI-32 version
 INFO interface: detail:  ShimGen has successfully created a shim for AutoHotkey.exe
 INFO interface: detail:     dc:  ShimGen has successfully created a shim for AutoHotkey.exe
    dc:  ShimGen has successfully created a shim for AutoHotkey.exe
 INFO interface: detail:  ShimGen has successfully created a shim for Ahk2Exe.exe
 INFO interface: detail:     dc:  ShimGen has successfully created a shim for Ahk2Exe.exe
    dc:  ShimGen has successfully created a shim for Ahk2Exe.exe
 INFO interface: detail:  The install of autohotkey.portable was successful.
 INFO interface: detail:     dc:  The install of autohotkey.portable was successful.
    dc:  The install of autohotkey.portable was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
 INFO interface: detail:     dc:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
    dc:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: WinPcap v4.1.3.20161116 [Approved]
 INFO interface: detail:     dc: WinPcap v4.1.3.20161116 [Approved]
    dc: WinPcap v4.1.3.20161116 [Approved]
 INFO interface: detail: winpcap package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: winpcap package files install completed. Performing other installation steps.
    dc: winpcap package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading WinPcap
 INFO interface: detail:     dc: Downloading WinPcap
    dc: Downloading WinPcap
 INFO interface: detail:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
 INFO interface: detail:     dc:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
    dc:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Download of WinPcapInstall.exe (893.68 KB) completed.
 INFO interface: detail:     dc: Download of WinPcapInstall.exe (893.68 KB) completed.
    dc: Download of WinPcapInstall.exe (893.68 KB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     dc: Hashes match.
    dc: Hashes match.
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
 INFO interface: detail:     dc: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
    dc: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
 INFO interface: detail: Running Autohotkey installer
 INFO interface: detail:     dc: Running Autohotkey installer
    dc: Running Autohotkey installer
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of winpcap was successful.
 INFO interface: detail:     dc:  The install of winpcap was successful.
    dc:  The install of winpcap was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Chocolatey installed 10/10 packages.
 INFO interface: detail:     dc: Chocolatey installed 10/10 packages.
    dc: Chocolatey installed 10/10 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Installed:
 INFO interface: detail:     dc: Installed:
    dc: Installed:
 INFO interface: detail:  - kb2919355 v1.0.20160915
 INFO interface: detail:     dc:  - kb2919355 v1.0.20160915
    dc:  - kb2919355 v1.0.20160915
 INFO interface: detail:  - kb3033929 v1.0.5
 INFO interface: detail:     dc:  - kb3033929 v1.0.5
    dc:  - kb3033929 v1.0.5
 INFO interface: detail:  - kb2999226 v1.0.20181019
 INFO interface: detail:     dc:  - kb2999226 v1.0.20181019
    dc:  - kb2999226 v1.0.20181019
 INFO interface: detail:  - wireshark v3.6.6
 INFO interface: detail:     dc:  - wireshark v3.6.6
    dc:  - wireshark v3.6.6
 INFO interface: detail:  - kb2919442 v1.0.20160915
 INFO interface: detail:     dc:  - kb2919442 v1.0.20160915
    dc:  - kb2919442 v1.0.20160915
 INFO interface: detail:  - autohotkey.portable v1.1.34.03
 INFO interface: detail:     dc:  - autohotkey.portable v1.1.34.03
    dc:  - autohotkey.portable v1.1.34.03
 INFO interface: detail:  - vcredist140 v14.32.31326
 INFO interface: detail:     dc:  - vcredist140 v14.32.31326
    dc:  - vcredist140 v14.32.31326
 INFO interface: detail:  - winpcap v4.1.3.20161116
 INFO interface: detail:     dc:  - winpcap v4.1.3.20161116
    dc:  - winpcap v4.1.3.20161116
 INFO interface: detail:  - kb3035131 v1.0.3
 INFO interface: detail:     dc:  - kb3035131 v1.0.3
    dc:  - kb3035131 v1.0.3
 INFO interface: detail:  - chocolatey-windowsupdate.extension v1.0.4
 INFO interface: detail:     dc:  - chocolatey-windowsupdate.extension v1.0.4
    dc:  - chocolatey-windowsupdate.extension v1.0.4
 INFO interface: detail: [14:46] Choco addons complete!
 INFO interface: detail:     dc: [14:46] Choco addons complete!
    dc: [14:46] Choco addons complete!
DEBUG winrmshell: [WinRM] cleaning up command_id: DD6F6D16-37F0-4C09-A925-FFD53F91798B on shell_id 32E7719A-D4CC-4E55-AECE-6A92A11D5B54
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c225cd2a8 @data=[{:stdout=>"[14:42] Installing additional Choco packages...\r\n"}, {:stdout=>"[14:42] Chocolatey is already installed.\r\n"}, {:stdout=>"[14:42] Installing Chocolatey extras...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"wireshark;winpcap\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-windowsupdate.extension v1.0.4 [Approved]\r\n"}, {:stdout=>"chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-windowsupdate extensions.\r\n"}, {:stdout=>" The install of chocolatey-windowsupdate.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-windowsupdate'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB3035131 v1.0.3 [Approved]\r\n"}, {:stdout=>"kb3035131 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).\r\n"}, {:stdout=>" The install of kb3035131 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB3033929 v1.0.5 [Approved]\r\n"}, {:stdout=>"kb3033929 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).\r\n"}, {:stdout=>" The install of kb3033929 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2919442 v1.0.20160915 [Approved]\r\n"}, {:stdout=>"kb2919442 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.\r\n"}, {:stdout=>" The install of kb2919442 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2919355 v1.0.20160915 [Approved]\r\n"}, {:stdout=>"kb2919355 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.\r\n"}, {:stdout=>" The install of kb2919355 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2999226 v1.0.20181019 [Approved] - Possibly broken\r\n"}, {:stdout=>"kb2999226 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).\r\n"}, {:stdout=>" The install of kb2999226 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"vcredist140 v14.32.31326 [Approved]\r\n"}, {:stdout=>"vcredist140 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading vcredist140-x86 \r\n"}, {:stdout=>"  from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of VC_redist.x86.exe (13.1 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing vcredist140-x86...\r\n"}, {:stdout=>"vcredist140-x86 has been installed.\r\n"}, {:stdout=>"Downloading vcredist140-x64 64 bit\r\n"}, {:stdout=>"  from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of VC_redist.x64.exe (24.16 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing vcredist140-x64...\r\n"}, {:stdout=>"vcredist140-x64 has been installed.\r\n"}, {:stdout=>"  vcredist140 may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of vcredist140 was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"wireshark v3.6.6 [Approved]\r\n"}, {:stdout=>"wireshark package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing 64-bit wireshark...\r\n"}, {:stdout=>"wireshark has been installed.\r\n"}, {:stdout=>"  wireshark can be automatically uninstalled.\r\n"}, {:stdout=>" The install of wireshark was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\Wireshark'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"autohotkey.portable v1.1.34.03 [Approved]\r\n"}, {:stdout=>"autohotkey.portable package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Extracting C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools\\AutoHotkey_1.1.34.03.zip to C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools...\r\n"}, {:stdout=>"C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools\r\n"}, {:stdout=>"Removing ANSI-32 version\r\n"}, {:stdout=>" ShimGen has successfully created a shim for AutoHotkey.exe\r\n"}, {:stdout=>" ShimGen has successfully created a shim for Ahk2Exe.exe\r\n"}, {:stdout=>" The install of autohotkey.portable was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WinPcap v4.1.3.20161116 [Approved]\r\n"}, {:stdout=>"winpcap package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading WinPcap \r\n"}, {:stdout=>"  from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of WinPcapInstall.exe (893.68 KB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\WinPcap\\4.1.3.20161116\\WinPcapInstall.exe\r\n"}, {:stdout=>"Running Autohotkey installer\r\n"}, {:stdout=>" The install of winpcap was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 10/10 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Installed:\r\n"}, {:stdout=>" - kb2919355 v1.0.20160915\r\n"}, {:stdout=>" - kb3033929 v1.0.5\r\n"}, {:stdout=>" - kb2999226 v1.0.20181019\r\n"}, {:stdout=>" - wireshark v3.6.6\r\n"}, {:stdout=>" - kb2919442 v1.0.20160915\r\n"}, {:stdout=>" - autohotkey.portable v1.1.34.03\r\n"}, {:stdout=>" - vcredist140 v14.32.31326\r\n"}, {:stdout=>" - winpcap v4.1.3.20161116\r\n"}, {:stdout=>" - kb3035131 v1.0.3\r\n"}, {:stdout=>" - chocolatey-windowsupdate.extension v1.0.4\r\n"}, {:stdout=>"[14:46] Choco addons complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24551228 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c2485b518 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 90EE73BC-1909-4475-B062-173A1D7E7332
DEBUG winrmshell: [WinRM] Command created for hostname with id: B8579FE8-9720-4481-89A0-9B24838B67A3
DEBUG winrmshell: [WinRM] creating command_id: B8579FE8-9720-4481-89A0-9B24838B67A3 on shell_id 90EE73BC-1909-4475-B062-173A1D7E7332
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B8579FE8-9720-4481-89A0-9B24838B67A3 on shell_id 90EE73BC-1909-4475-B062-173A1D7E7332
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241f5a20 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2D7C0B86-E977-439D-B404-8A5A26B4CEE1
DEBUG winrmshell: [WinRM] Command created for hostname with id: C978221B-A498-474D-AA00-E03CDBFF2BB0
DEBUG winrmshell: [WinRM] creating command_id: C978221B-A498-474D-AA00-E03CDBFF2BB0 on shell_id 2D7C0B86-E977-439D-B404-8A5A26B4CEE1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C978221B-A498-474D-AA00-E03CDBFF2BB0 on shell_id 2D7C0B86-E977-439D-B404-8A5A26B4CEE1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c245e3038 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3C7DB195-4A7A-4502-8231-00C551D3F3EE
DEBUG winrmshell: [WinRM] Command created for hostname with id: 63851F60-8A50-449C-8C7B-72213E2A1079
DEBUG winrmshell: [WinRM] creating command_id: 63851F60-8A50-449C-8C7B-72213E2A1079 on shell_id 3C7DB195-4A7A-4502-8231-00C551D3F3EE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 63851F60-8A50-449C-8C7B-72213E2A1079 on shell_id 3C7DB195-4A7A-4502-8231-00C551D3F3EE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b3c368 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23c03040 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23bb9878 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23694ed8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2863C797-EA19-4509-822C-452EBA530F2A
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BC106EA9-D3F7-46F6-99EC-7FD6FAE53E99
DEBUG winrmshell: [WinRM] creating command_id: BC106EA9-D3F7-46F6-99EC-7FD6FAE53E99 on shell_id 2863C797-EA19-4509-822C-452EBA530F2A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BC106EA9-D3F7-46F6-99EC-7FD6FAE53E99 on shell_id 2863C797-EA19-4509-822C-452EBA530F2A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b4ff80 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24095680 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2408eda8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23727918 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 704BE62B-E2EE-4E80-B24B-7495B06CEAAF
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BDE2AEA0-0437-4BBE-AA61-7E333220372A
DEBUG winrmshell: [WinRM] creating command_id: BDE2AEA0-0437-4BBE-AA61-7E333220372A on shell_id 704BE62B-E2EE-4E80-B24B-7495B06CEAAF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BDE2AEA0-0437-4BBE-AA61-7E333220372A on shell_id 704BE62B-E2EE-4E80-B24B-7495B06CEAAF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c21549530 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1knzk4p.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23981858 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23978e88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c229337d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "299638e78893f8011af9474087001dd60f0e0bcc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1knzk4p.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1409C0C8-72D2-4705-AC19-D341E92C9F14
DEBUG winrmshell: [WinRM] creating command_id: 1409C0C8-72D2-4705-AC19-D341E92C9F14 on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1409C0C8-72D2-4705-AC19-D341E92C9F14 on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","299638e78893f8011af9474087001dd60f0e0bcc","81883041f088db0f0d4a349f41739c56f60c7961","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1knzk4p.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0DC99499-4A53-4C1C-B7C3-DE1724EE1CBC
DEBUG winrmshell: [WinRM] creating command_id: 0DC99499-4A53-4C1C-B7C3-DE1724EE1CBC on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0DC99499-4A53-4C1C-B7C3-DE1724EE1CBC on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBvc3F1ZXJ5IG9uIHRoZSBob3N0LiBPc3F1ZXJ5IGNvbm50ZWN0cyB0byBGbGVldCB2aWEgVExTLgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgb3NxdWVyeS4uLiIKJGZsYWdmaWxlID0gImM6XFByb2dyYW0gRmlsZXNcb3NxdWVyeVxvc3F1ZXJ5LmZsYWdzIgpjaG9jbyBpbnN0YWxsIC15IC0tbGltaXQtb3V0cHV0IC0tbm8tcHJvZ3Jlc3Mgb3NxdWVyeSB8IE91dC1TdHJpbmcgICMgQXBwYXJlbnRseSBPdXQtU3RyaW5nIG1ha2VzIHRoZSBwcm9jZXNzIHdhaXQKJHNlcnZpY2UgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9TZXJ2aWNlIC1GaWx0ZXIgIk5hbWU9J29zcXVlcnlkJyIKSWYgKC1ub3QgKCRzZXJ2aWNlKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIG9zcXVlcnkgdG8gcnVuIGFzIGEgc2VydmljZSIKICBOZXctU2VydmljZSAtTmFtZSAib3NxdWVyeWQiIC1CaW5hcnlQYXRoTmFtZSAiQzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XG9zcXVlcnlkXG9zcXVlcnlkLmV4ZSAtLWZsYWdmaWxlPWAiQzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XG9zcXVlcnkuZmxhZ3NgIiIKCiAgIyBEb3dubG9hZCB0aGUgZmxhZ3MgZmlsZSBmcm9tIHRoZSBQYWxhbnRpciBvc3F1ZXJ5LWNvbmZpZ3VyYXRpb24gR2l0aHViCiAgIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzEvMjAxOAogIFtOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSBbTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTIKICAjIERpc2FibGluZyB0aGUgcHJvZ3Jlc3MgYmFyIHNwZWVkcyB1cCBJV1IgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOAogICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcGFsYW50aXIvb3NxdWVyeS1jb25maWd1cmF0aW9uL21hc3Rlci9DbGFzc2ljL0VuZHBvaW50cy9XaW5kb3dzL29zcXVlcnkuZmxhZ3MiIC1PdXRGaWxlICRmbGFnZmlsZQoKICAjIyBVc2UgdGhlIFRMUyBjb25maWcKICAjIyBBZGQgZW50cnkgdG8gaG9zdHMgZmlsZSBmb3IgRmxlZXQgZm9yIFNTTCB2YWxpZGF0aW9uCiAgSWYgKFNlbGVjdC1TdHJpbmcgLVBhdGggImM6XHdpbmRvd3Ncc3lzdGVtMzJcZHJpdmVyc1xldGNcaG9zdHMiIC1QYXR0ZXJuICJmbGVldCIpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBIb3N0cyBmaWxlIGFscmVhZHkgdXBkYXRlZC4gTW92aW5nIG9uLiIKICB9CiAgRWxzZSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQWRkaW5nIEZsZWV0IHRvIHRoZSBob3N0cyBmaWxlIgogICAgQWRkLUNvbnRlbnQgImM6XHdpbmRvd3Ncc3lzdGVtMzJcZHJpdmVyc1xldGNcaG9zdHMiICIgICAgICAgIDE5Mi4xNjguNTYuMTA1ICAgIGZsZWV0IgogIH0KICAjIyBBZGQgRmxlZXQgc2VjcmV0IGFuZCBhdm9pZCBCT00KICAkVXRmOE5vQm9tRW5jb2RpbmcgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LlVURjhFbmNvZGluZyAkRmFsc2UKICBbU3lzdGVtLklPLkZpbGVdOjpXcml0ZUFsbExpbmVzKCJjOlxQcm9ncmFtIEZpbGVzXG9zcXVlcnlcZmxlZXRfc2VjcmV0LnR4dCIsICJlbnJvbGxtZW50c2VjcmV0ZW5yb2xsbWVudHNlY3JldCIsICRVdGY4Tm9Cb21FbmNvZGluZykKICAjIyBDaGFuZ2UgVExTIHNlcnZlciBob3N0bmFtZSBpbiB0aGUgZmxhZ3MgZmlsZQogIChHZXQtQ29udGVudCAkZmxhZ2ZpbGUpIC1yZXBsYWNlICd0bHMuZW5kcG9pbnQuc2VydmVyLmNvbScsICdmbGVldDo4NDEyJyB8IFNldC1Db250ZW50ICRmbGFnZmlsZQogICMjIENoYW5nZSBwYXRoIHRvIHNlY3JldHMgaW4gdGhlIGZsYWdzIGZpbGUKICAoR2V0LUNvbnRlbnQgJGZsYWdmaWxlKSAtcmVwbGFjZSAncGF0aFxcdG9cXGZpbGVcXGNvbnRhaW5pbmdcXHNlY3JldC50eHQnLCAnUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGZsZWV0X3NlY3JldC50eHQnIHwgU2V0LUNvbnRlbnQgJGZsYWdmaWxlCiAgIyMgQ2hhbmdlIHBhdGggdG8gY2VydGZpbGUgaW4gdGhlIGZsYWdzIGZpbGUKICAoR2V0LUNvbnRlbnQgJGZsYWdmaWxlKSAtcmVwbGFjZSAnYzpcXFByb2dyYW1EYXRhXFxvc3F1ZXJ5XFxjZXJ0ZmlsZS5jcnQnLCAnYzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGNlcnRmaWxlLmNydCcgfCBTZXQtQ29udGVudCAkZmxhZ2ZpbGUKICAjIyBSZW1vdmUgdGhlIHZlcmJvc2UgZmxhZyBhbmQgcmVwbGFjZSBpdCB3aXRoIHRoZSBsb2dnZXJfbWluX3N0YXR1cz0xIG9wdGlvbiAoU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9vc3F1ZXJ5L29zcXVlcnkvaXNzdWVzLzUyMTIpCiAgKEdldC1Db250ZW50ICRmbGFnZmlsZSkgLXJlcGxhY2UgJy0tdmVyYm9zZT10cnVlJywgJy0tbG9nZ2VyX21pbl9zdGF0dXM9MScgfCBTZXQtQ29udGVudCAkZmxhZ2ZpbGUKICAjIyBBZGQgY2VydGZpbGUuY3J0CiAgQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1xmbGVldFxzZXJ2ZXIuY3J0IiAiYzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGNlcnRmaWxlLmNydCIKICAjIyBTdGFydCB0aGUgc2VydmljZQogIFN0YXJ0LVNlcnZpY2Ugb3NxdWVyeWQKfQplbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgb3NxdWVyeSBpcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQpJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIG9zcXVlcnlkKS5TdGF0dXMgLW5lICJSdW5uaW5nIikKewogIHRocm93ICJvc3F1ZXJ5ZCBzZXJ2aWNlIHdhcyBub3QgcnVubmluZyIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2511117C-7A97-4287-8EA7-CEAFB89F16B7
DEBUG winrmshell: [WinRM] creating command_id: 2511117C-7A97-4287-8EA7-CEAFB89F16B7 on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2511117C-7A97-4287-8EA7-CEAFB89F16B7 on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 64AC6CD4-928A-42CC-A582-D8189AB4D575
DEBUG winrmshell: [WinRM] creating command_id: 64AC6CD4-928A-42CC-A582-D8189AB4D575 on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 64AC6CD4-928A-42CC-A582-D8189AB4D575 on shell_id 3CBC9650-6F91-4CC0-9156-814C5E45BAF8
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1knzk4p.ps1 to C:/tmp/vagrant-shell.ps1 (3.916 KB over 1 chunks) in (0m0.17s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.39s) stream_files: (0m0.17s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2415fed0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2415de50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23b7a010 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 10B7B339-BFA2-40D2-B14D-9D8B4E5462AF
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8220609F-1ED1-4654-9634-C34130EB45A5
DEBUG winrmshell: [WinRM] creating command_id: 8220609F-1ED1-4654-9634-C34130EB45A5 on shell_id 10B7B339-BFA2-40D2-B14D-9D8B4E5462AF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Installing osquery...
 INFO interface: detail:     dc: [14:46] Installing osquery...
    dc: [14:46] Installing osquery...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     dc: Installing the following packages:
    dc: Installing the following packages:
 INFO interface: detail: osquery
 INFO interface: detail:     dc: osquery
    dc: osquery
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     dc: By installing, you accept licenses for the packages.
    dc: By installing, you accept licenses for the packages.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: osquery v5.2.2 [Approved]
 INFO interface: detail:     dc: osquery v5.2.2 [Approved]
    dc: osquery v5.2.2 [Approved]
 INFO interface: detail: osquery package files install completed. Performing other installation steps.
 INFO interface: detail:     dc: osquery package files install completed. Performing other installation steps.
    dc: osquery package files install completed. Performing other installation steps.
 INFO interface: detail: C:\Program Files\osquery\log
 INFO interface: detail:     dc: C:\Program Files\osquery\log
    dc: C:\Program Files\osquery\log
 INFO interface: detail: True
 INFO interface: detail:     dc: True
    dc: True
 INFO interface: detail: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
 INFO interface: detail:     dc: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
    dc: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
 INFO interface: detail: Environment Vars (like PATH) have changed. Close/reopen your shell to
 INFO interface: detail:     dc: Environment Vars (like PATH) have changed. Close/reopen your shell to
    dc: Environment Vars (like PATH) have changed. Close/reopen your shell to
 INFO interface: detail:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
 INFO interface: detail:     dc:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
    dc:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
 INFO interface: detail:  ShimGen has successfully created a shim for osqueryi.exe
 INFO interface: detail:     dc:  ShimGen has successfully created a shim for osqueryi.exe
    dc:  ShimGen has successfully created a shim for osqueryi.exe
 INFO interface: detail:  ShimGen has successfully created a shim for osqueryd.exe
 INFO interface: detail:     dc:  ShimGen has successfully created a shim for osqueryd.exe
    dc:  ShimGen has successfully created a shim for osqueryd.exe
 INFO interface: detail:  The install of osquery was successful.
 INFO interface: detail:     dc:  The install of osquery was successful.
    dc:  The install of osquery was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     dc:   Software install location not explicitly set, it could be in package or
    dc:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     dc:   default install location of installer.
    dc:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     dc: Chocolatey installed 1/1 packages.
    dc: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    dc:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:46] Setting osquery to run as a service
 INFO interface: detail:     dc: [14:46] Setting osquery to run as a service
    dc: [14:46] Setting osquery to run as a service
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Status   Name               DisplayName
 INFO interface: detail:     dc: Status   Name               DisplayName
    dc: Status   Name               DisplayName
 INFO interface: detail: ------   ----               -----------
 INFO interface: detail:     dc: ------   ----               -----------
    dc: ------   ----               -----------
 INFO interface: detail: Stopped  osqueryd           osqueryd
 INFO interface: detail:     dc: Stopped  osqueryd           osqueryd
    dc: Stopped  osqueryd           osqueryd
 INFO interface: detail: [14:46] Adding Fleet to the hosts file
 INFO interface: detail:     dc: [14:46] Adding Fleet to the hosts file
    dc: [14:46] Adding Fleet to the hosts file
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 8220609F-1ED1-4654-9634-C34130EB45A5 on shell_id 10B7B339-BFA2-40D2-B14D-9D8B4E5462AF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23635dc0 @data=[{:stdout=>"[14:46] Installing osquery...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"osquery\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"osquery v5.2.2 [Approved]\r\n"}, {:stdout=>"osquery package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"C:\\Program Files\\osquery\\log\r\n"}, {:stdout=>"True\r\n"}, {:stdout=>"PATH environment variable does not have C:\\Program Files\\osquery in it. Adding...\r\n"}, {:stdout=>"Environment Vars (like PATH) have changed. Close/reopen your shell to\r\n"}, {:stdout=>" see the changes (or in powershell/cmd.exe just type `refreshenv`).\r\n"}, {:stdout=>" ShimGen has successfully created a shim for osqueryi.exe\r\n"}, {:stdout=>" ShimGen has successfully created a shim for osqueryd.exe\r\n"}, {:stdout=>" The install of osquery was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:46] Setting osquery to run as a service\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status   Name               DisplayName                           \r\n"}, {:stdout=>"------   ----               -----------                           \r\n"}, {:stdout=>"Stopped  osqueryd           osqueryd                              \r\n"}, {:stdout=>"[14:46] Adding Fleet to the hosts file\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2485b518 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c241ee040 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 25C5D912-3285-49FF-B30E-1E595E3729CB
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5ED6182E-C5B5-4DE1-9002-17AFA6F18A68
DEBUG winrmshell: [WinRM] creating command_id: 5ED6182E-C5B5-4DE1-9002-17AFA6F18A68 on shell_id 25C5D912-3285-49FF-B30E-1E595E3729CB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5ED6182E-C5B5-4DE1-9002-17AFA6F18A68 on shell_id 25C5D912-3285-49FF-B30E-1E595E3729CB
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a84100 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7F6CCB78-4E48-49FA-AB41-8A1CDC3288A6
DEBUG winrmshell: [WinRM] Command created for hostname with id: 76A579C5-EA9A-46A9-B19C-80EBE404AA75
DEBUG winrmshell: [WinRM] creating command_id: 76A579C5-EA9A-46A9-B19C-80EBE404AA75 on shell_id 7F6CCB78-4E48-49FA-AB41-8A1CDC3288A6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 76A579C5-EA9A-46A9-B19C-80EBE404AA75 on shell_id 7F6CCB78-4E48-49FA-AB41-8A1CDC3288A6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240b6f60 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 06FE7A84-0CC4-4081-9D24-CF64F1EF8C65
DEBUG winrmshell: [WinRM] Command created for hostname with id: CD4820D8-7A9B-47B3-9C44-02A2AF95597A
DEBUG winrmshell: [WinRM] creating command_id: CD4820D8-7A9B-47B3-9C44-02A2AF95597A on shell_id 06FE7A84-0CC4-4081-9D24-CF64F1EF8C65
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CD4820D8-7A9B-47B3-9C44-02A2AF95597A on shell_id 06FE7A84-0CC4-4081-9D24-CF64F1EF8C65
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c244162f0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2479ced8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24777f70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24569aa8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EA7BC9AB-C0F2-455F-97F2-B71EF3FAFED2
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9D9FF18E-5E4F-4835-9237-13C04EECAC44
DEBUG winrmshell: [WinRM] creating command_id: 9D9FF18E-5E4F-4835-9237-13C04EECAC44 on shell_id EA7BC9AB-C0F2-455F-97F2-B71EF3FAFED2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9D9FF18E-5E4F-4835-9237-13C04EECAC44 on shell_id EA7BC9AB-C0F2-455F-97F2-B71EF3FAFED2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24414b30 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24377d08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24376548 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245582f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D3CB712F-DE6A-4BFE-9369-BE82D93DA85C
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: ACB2931B-C0AF-4554-BE8C-56BC9FF74FC6
DEBUG winrmshell: [WinRM] creating command_id: ACB2931B-C0AF-4554-BE8C-56BC9FF74FC6 on shell_id D3CB712F-DE6A-4BFE-9369-BE82D93DA85C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ACB2931B-C0AF-4554-BE8C-56BC9FF74FC6 on shell_id D3CB712F-DE6A-4BFE-9369-BE82D93DA85C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24405e78 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-15fqhbc.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24572810 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24570470 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24424080 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "74ae4687be5f0897ea0e3af4033ec979f9cb4103" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-15fqhbc.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 085B718C-5244-4364-8F97-D7DE47477740
DEBUG winrmshell: [WinRM] creating command_id: 085B718C-5244-4364-8F97-D7DE47477740 on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 085B718C-5244-4364-8F97-D7DE47477740 on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","74ae4687be5f0897ea0e3af4033ec979f9cb4103","299638e78893f8011af9474087001dd60f0e0bcc","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-15fqhbc.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BB28D1B7-DB1A-4EA5-9383-DC0599A54911
DEBUG winrmshell: [WinRM] creating command_id: BB28D1B7-DB1A-4EA5-9383-DC0599A54911 on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BB28D1B7-DB1A-4EA5-9383-DC0599A54911 on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBhIGhhbmRmdWwgb2YgU3lzSW50ZXJuYWxzIHRvb2xzIG9uIHRoZSBob3N0IGludG8gYzpcVG9vbHNcU3lzaW50ZXJuYWxzCiMgQWxzbyBpbnN0YWxscyBTeXNtb24gYW5kIE9sYWYgSGFydG9uJ3MgU3lzbW9uIGNvbmZpZwoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgU3lzSW50ZXJuYWxzIFRvb2xpbmcuLi4iCiRzeXNpbnRlcm5hbHNEaXIgPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzIgokc3lzbW9uRGlyID0gIkM6XFByb2dyYW1EYXRhXFN5c21vbiIKSWYoISh0ZXN0LXBhdGggJHN5c2ludGVybmFsc0RpcikpIHsKICBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZSAtUGF0aCAkc3lzaW50ZXJuYWxzRGlyCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFRvb2xzIGRpcmVjdG9yeSBleGlzdHMsIG5vIG5lZWQgdG8gcmUtaW5zdGFsbC4gRXhpdGluZy4iCiAgZXhpdAp9CgpJZighKHRlc3QtcGF0aCAkc3lzbW9uRGlyKSkgewogIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRzeXNtb25EaXIKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3lzbW9uIGRpcmVjdG9yeSBleGlzdHMsIG5vIG5lZWQgdG8gcmUtaW5zdGFsbC4gRXhpdGluZy4iCiAgZXhpdAp9CgokYXV0b3J1bnNQYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xBdXRvcnVuczY0LmV4ZSIKJHByb2Ntb25QYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xQcm9jbW9uLmV4ZSIKJHBzZXhlY1BhdGggPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzXFBzRXhlYzY0LmV4ZSIKJHByb2NleHBQYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xwcm9jZXhwNjQuZXhlIgokc3lzbW9uUGF0aCA9ICJDOlxUb29sc1xTeXNpbnRlcm5hbHNcU3lzbW9uNjQuZXhlIgokc2RlbGV0ZVBhdGggPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzXFNkZWxldGU2NC5leGUiCiR0Y3B2aWV3UGF0aCA9ICJDOlxUb29sc1xTeXNpbnRlcm5hbHNcVGNwdmlldy5leGUiCiRzeXNtb25Db25maWdQYXRoID0gIiRzeXNtb25EaXJcc3lzbW9uQ29uZmlnLnhtbCIKJHNob3J0Y3V0TG9jYXRpb24gPSAiJEVOVjpBTExVU0VSU1BST0ZJTEVcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1wiCgokV1NjcmlwdFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuU2hlbGwKCiMgTWljcm9zb2Z0IGxpa2VzIFRMU3YxLjIgYXMgd2VsbApbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBBdXRvcnVuczY0LmV4ZS4uLiIKVHJ5IHsgCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vQXV0b3J1bnM2NC5leGUnLCAkYXV0b3J1bnNQYXRoKSAKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL0F1dG9ydW5zNjQuZXhlJywgJGF1dG9ydW5zUGF0aCkgCn0KJFNob3J0Y3V0ID0gJFdTY3JpcHRTaGVsbC5DcmVhdGVTaG9ydGN1dCgkU2hvcnRjdXRMb2NhdGlvbiArICJBdXRvcnVucy5sbmsiKQokU2hvcnRjdXQuVGFyZ2V0UGF0aCA9ICRhdXRvcnVuc1BhdGgKJFNob3J0Y3V0LlNhdmUoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIFByb2Ntb24uZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9Qcm9jbW9uLmV4ZScsICRwcm9jbW9uUGF0aCkKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1Byb2Ntb24uZXhlJywgJHByb2Ntb25QYXRoKQp9CiRTaG9ydGN1dCA9ICRXU2NyaXB0U2hlbGwuQ3JlYXRlU2hvcnRjdXQoJFNob3J0Y3V0TG9jYXRpb24gKyAiUHJvY2VzcyBNb25pdG9yLmxuayIpCiRTaG9ydGN1dC5UYXJnZXRQYXRoID0gJHByb2Ntb25QYXRoCiRTaG9ydGN1dC5TYXZlKCkKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBQc0V4ZWM2NC5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1BzRXhlYzY0LmV4ZScsICRwc2V4ZWNQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vUHNFeGVjNjQuZXhlJywgJHBzZXhlY1BhdGgpCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBwcm9jZXhwNjQuZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9wcm9jZXhwNjQuZXhlJywgJHByb2NleHBQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vcHJvY2V4cDY0LmV4ZScsICRwcm9jZXhwUGF0aCkKfQokU2hvcnRjdXQgPSAkV1NjcmlwdFNoZWxsLkNyZWF0ZVNob3J0Y3V0KCRTaG9ydGN1dExvY2F0aW9uICsgIlByb2Nlc3MgRXhwbG9yZXIubG5rIikKJFNob3J0Y3V0LlRhcmdldFBhdGggPSAkcHJvY2V4cFBhdGgKJFNob3J0Y3V0LlNhdmUoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIHNkZWxldGU2NC5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL3NkZWxldGU2NC5leGUnLCAkc2RlbGV0ZVBhdGgpCn0KQ2F0Y2ggeyAKICBXcml0ZS1Ib3N0ICJIVFRQUyBjb25uZWN0aW9uIGZhaWxlZC4gU3dpdGNoaW5nIHRvIEhUVFAgOigiCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cDovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9zZGVsZXRlNjQuZXhlJywgJHNkZWxldGVQYXRoKQp9CgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgU3lzbW9uNjQuZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9TeXNtb242NC5leGUnLCAkc3lzbW9uUGF0aCkKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1N5c21vbjY0LmV4ZScsICRzeXNtb25QYXRoKQp9CkNvcHktSXRlbSAkc3lzbW9uUGF0aCAkc3lzbW9uRGlyCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgVGNwdmlldy5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1RjcHZpZXcuZXhlJywgJHRjcHZpZXdQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vVGNwdmlldy5leGUnLCAkdGNwdmlld1BhdGgpCn0KJFNob3J0Y3V0ID0gJFdTY3JpcHRTaGVsbC5DcmVhdGVTaG9ydGN1dCgkU2hvcnRjdXRMb2NhdGlvbiArICJUY3B2aWV3LmxuayIpCiRTaG9ydGN1dC5UYXJnZXRQYXRoID0gJHRjcHZpZXdQYXRoCiRTaG9ydGN1dC5TYXZlKCkKCiMgUmVzdGFydCBFeHBsb3JlciBzbyB0aGUgdGFza2JhciBzaG9ydGN1dHMgc2hvdyB1cAppZiAoR2V0LVByb2Nlc3MgLVByb2Nlc3NOYW1lIGV4cGxvcmVyIC1FcnJvckFjdGlvbiAnc2lsZW50bHljb250aW51ZScpIHsKICBTdG9wLVByb2Nlc3MgLVByb2Nlc3NOYW1lIGV4cGxvcmVyIC1Gb3JjZQp9CgojIERvd25sb2FkIE9sYWYgSGFydG9uZ3MgU3lzbW9uIGNvbmZpZwpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgT2xhZiBIYXJ0b25nJ3MgU3lzbW9uIGNvbmZpZy4uLiIKKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL29sYWZoYXJ0b25nL3N5c21vbi1tb2R1bGFyL21hc3Rlci9zeXNtb25jb25maWcueG1sJywgIiRzeXNtb25Db25maWdQYXRoIikKIyBBbHRlcm5hdGl2ZTogRG93bmxvYWQgU3dpZnRPblNlY3VyaXR5J3MgU3lzbW9uIGNvbmZpZwojIFdyaXRlLUhvc3QgIkRvd25sb2FkaW5nIFN3aWZ0T25TZWN1cml0eSdzIFN5c21vbiBjb25maWcuLi4iCiMgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1N3aWZ0T25TZWN1cml0eS9zeXNtb24tY29uZmlnL21hc3Rlci9zeXNtb25jb25maWctZXhwb3J0LnhtbCcsICIkc3lzbW9uQ29uZmlnUGF0aCIpCgojIFN0YXJ0IFN5c21vbgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3RhcnRpbmcgU3lzbW9uLi4uIgpTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAiJHN5c21vbkRpclxTeXNtb242NC5leGUiIC1Bcmd1bWVudExpc3QgIi1hY2NlcHRldWxhIC1pICRzeXNtb25Db25maWdQYXRoIgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV2FpdGluZyA1IHNlY29uZHMgdG8gZ2l2ZSB0aGUgc2VydmljZSB0aW1lIHRvIGluc3RhbGwuLi4iClN0YXJ0LVNsZWVwIDUKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFZlcmlmeWluZyB0aGF0IHRoZSBTeXNtb24gc2VydmljZSBpcyBydW5uaW5nLi4uIgoKIyBQb2xsIHRoZSBzeXNtb24gc2VydmljZSBldmVyeSA1IHNlY29uZHMgdG8gc2VlIGlmIGl0IGhhcyBzdGFydGVkICh1cCB0byAyNSBzZWNvbmRzKQokdHJpZXMgPSAxCldoaWxlICgkdHJpZXMgLWx0IDYpIHsKICBJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIFN5c21vbjY0KS5TdGF0dXMgLW5lICJSdW5uaW5nIikgewogICAgV3JpdGUtSG9zdCAiV2FpdGluZyBmb3IgdGhlIFN5c21vbiBzZXJ2aWNlIHRvIHN0YXJ0Li4uIChBdHRlbXB0ICR0cmllcyBvZiA1KSIKICAgIFN0YXJ0LVNsZWVwIDUKICAgICR0cmllcyArPSAxCiAgfSBFbHNlIHsKICAgIFdyaXRlLUhvc3QgIlRoZSBTeXNtb24gc2VydmljZSBoYXMgc3RhcnRlZCBzdWNjZXNzZnVsbHkhIgogICAgYnJlYWsKICB9Cn0KCklmICgoR2V0LVNlcnZpY2UgLW5hbWUgU3lzbW9uNjQpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgdGhyb3cgIlRoZSBTeXNtb24gc2VydmljZSBmYWlsZWQgdG8gc3RhcnQgc3VjY2Vzc2Z1bGx5Igp9CgojIE1ha2UgdGhlIGV2ZW50IGxvZyBjaGFubmVsIHJlYWRhYmxlLiBGb3Igc29tZSByZWFzb24gdGhpcyBkb2Vzbid0IHdvcmsgaW4gdGhlIEdQTyBhbmQgb25seSB3b3JrcyB3aGVuIHJ1biBtYW51YWxseS4Kd2V2dHV0aWwgc2wgTWljcm9zb2Z0LVdpbmRvd3MtU3lzbW9uL09wZXJhdGlvbmFsICIvY2E6TzpCQUc6U1lEOihBOzsweDU7OztCQSkoQTs7MHgxOzs7Uy0xLTUtMjApKEE7OzB4MTs7O1MtMS01LTMyLTU3MykiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 04452064-D091-442D-8F10-CFB2938A6BD8
DEBUG winrmshell: [WinRM] creating command_id: 04452064-D091-442D-8F10-CFB2938A6BD8 on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 04452064-D091-442D-8F10-CFB2938A6BD8 on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B016CF27-A224-4EC0-83A6-C5BCA61FCCFA
DEBUG winrmshell: [WinRM] creating command_id: B016CF27-A224-4EC0-83A6-C5BCA61FCCFA on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B016CF27-A224-4EC0-83A6-C5BCA61FCCFA on shell_id 94DCF43A-F17D-4AE9-8C44-C35156AD1C3C
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-15fqhbc.ps1 to C:/tmp/vagrant-shell.ps1 (8.58 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.39s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24377f88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243769a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24558b68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4342EB61-C937-4286-BE1E-C745D2494832
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C54EDE15-5C19-402C-A5B3-ADF63D58C89C
DEBUG winrmshell: [WinRM] creating command_id: C54EDE15-5C19-402C-A5B3-ADF63D58C89C on shell_id 4342EB61-C937-4286-BE1E-C745D2494832
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Installing SysInternals Tooling...
 INFO interface: detail:     dc: [14:46] Installing SysInternals Tooling...
    dc: [14:46] Installing SysInternals Tooling...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail:     Directory: C:\Tools
 INFO interface: detail:     dc:     Directory: C:\Tools
    dc:     Directory: C:\Tools
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     dc: Mode                LastWriteTime         Length Name
    dc: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     dc: ----                -------------         ------ ----
    dc: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/20/2022   2:46 PM                Sysinternals
 INFO interface: detail:     dc: d-----        6/20/2022   2:46 PM                Sysinternals
    dc: d-----        6/20/2022   2:46 PM                Sysinternals
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail:     Directory: C:\ProgramData
 INFO interface: detail:     dc:     Directory: C:\ProgramData
    dc:     Directory: C:\ProgramData
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     dc: Mode                LastWriteTime         Length Name
    dc: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     dc: ----                -------------         ------ ----
    dc: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/20/2022   2:46 PM                Sysmon
 INFO interface: detail:     dc: d-----        6/20/2022   2:46 PM                Sysmon
    dc: d-----        6/20/2022   2:46 PM                Sysmon
 INFO interface: detail: [14:46] Downloading Autoruns64.exe...
 INFO interface: detail:     dc: [14:46] Downloading Autoruns64.exe...
    dc: [14:46] Downloading Autoruns64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading Procmon.exe...
 INFO interface: detail:     dc: [14:46] Downloading Procmon.exe...
    dc: [14:46] Downloading Procmon.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading PsExec64.exe...
 INFO interface: detail:     dc: [14:46] Downloading PsExec64.exe...
    dc: [14:46] Downloading PsExec64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading procexp64.exe...
 INFO interface: detail:     dc: [14:46] Downloading procexp64.exe...
    dc: [14:46] Downloading procexp64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading sdelete64.exe...
 INFO interface: detail:     dc: [14:46] Downloading sdelete64.exe...
    dc: [14:46] Downloading sdelete64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading Sysmon64.exe...
 INFO interface: detail:     dc: [14:46] Downloading Sysmon64.exe...
    dc: [14:46] Downloading Sysmon64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading Tcpview.exe...
 INFO interface: detail:     dc: [14:46] Downloading Tcpview.exe...
    dc: [14:46] Downloading Tcpview.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:46] Downloading Olaf Hartong's Sysmon config...
 INFO interface: detail:     dc: [14:46] Downloading Olaf Hartong's Sysmon config...
    dc: [14:46] Downloading Olaf Hartong's Sysmon config...
 INFO interface: detail: [14:46] Starting Sysmon...
 INFO interface: detail:     dc: [14:46] Starting Sysmon...
    dc: [14:46] Starting Sysmon...
 INFO interface: detail: [14:46] Waiting 5 seconds to give the service time to install...
 INFO interface: detail:     dc: [14:46] Waiting 5 seconds to give the service time to install...
    dc: [14:46] Waiting 5 seconds to give the service time to install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Verifying that the Sysmon service is running...
 INFO interface: detail:     dc: [14:47] Verifying that the Sysmon service is running...
    dc: [14:47] Verifying that the Sysmon service is running...
 INFO interface: detail: The Sysmon service has started successfully!
 INFO interface: detail:     dc: The Sysmon service has started successfully!
    dc: The Sysmon service has started successfully!
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: C54EDE15-5C19-402C-A5B3-ADF63D58C89C on shell_id 4342EB61-C937-4286-BE1E-C745D2494832
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24406328 @data=[{:stdout=>"[14:46] Installing SysInternals Tooling...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Tools\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/20/2022   2:46 PM                Sysinternals                                     \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\ProgramData\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/20/2022   2:46 PM                Sysmon                                           \r\n"}, {:stdout=>"[14:46] Downloading Autoruns64.exe...\r\n"}, {:stdout=>"[14:46] Downloading Procmon.exe...\r\n"}, {:stdout=>"[14:46] Downloading PsExec64.exe...\r\n"}, {:stdout=>"[14:46] Downloading procexp64.exe...\r\n"}, {:stdout=>"[14:46] Downloading sdelete64.exe...\r\n"}, {:stdout=>"[14:46] Downloading Sysmon64.exe...\r\n"}, {:stdout=>"[14:46] Downloading Tcpview.exe...\r\n"}, {:stdout=>"[14:46] Downloading Olaf Hartong's Sysmon config...\r\n"}, {:stdout=>"[14:46] Starting Sysmon...\r\n"}, {:stdout=>"[14:46] Waiting 5 seconds to give the service time to install...\r\n"}, {:stdout=>"[14:47] Verifying that the Sysmon service is running...\r\n"}, {:stdout=>"The Sysmon service has started successfully!\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c241ee040 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c22895dc8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 50F64DDB-C02E-4D36-A6CD-441BC9380D76
DEBUG winrmshell: [WinRM] Command created for hostname with id: FAC815B3-AA95-4268-A78C-849E04484A85
DEBUG winrmshell: [WinRM] creating command_id: FAC815B3-AA95-4268-A78C-849E04484A85 on shell_id 50F64DDB-C02E-4D36-A6CD-441BC9380D76
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FAC815B3-AA95-4268-A78C-849E04484A85 on shell_id 50F64DDB-C02E-4D36-A6CD-441BC9380D76
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24559a18 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>55986, 22=>2200, 5985=>2201}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 71E9BA48-0DA1-4821-94A9-0F3BF97B884E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 2328A7AF-7DEE-4868-BF0A-EB705FA42535
DEBUG winrmshell: [WinRM] creating command_id: 2328A7AF-7DEE-4868-BF0A-EB705FA42535 on shell_id 71E9BA48-0DA1-4821-94A9-0F3BF97B884E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2328A7AF-7DEE-4868-BF0A-EB705FA42535 on shell_id 71E9BA48-0DA1-4821-94A9-0F3BF97B884E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24aa4bf8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F89886C9-CC7A-4E2B-9ADC-1BB03C5060A7
DEBUG winrmshell: [WinRM] Command created for hostname with id: 78503AFE-48D8-4D96-9855-62FC585BE21D
DEBUG winrmshell: [WinRM] creating command_id: 78503AFE-48D8-4D96-9855-62FC585BE21D on shell_id F89886C9-CC7A-4E2B-9ADC-1BB03C5060A7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 78503AFE-48D8-4D96-9855-62FC585BE21D on shell_id F89886C9-CC7A-4E2B-9ADC-1BB03C5060A7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240dd908 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2428f238 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2428df28 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241e6610 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4ADA7474-EA49-419A-8DCB-BB3BE7BBC508
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4B291108-2ED6-4531-B158-BC756E83404B
DEBUG winrmshell: [WinRM] creating command_id: 4B291108-2ED6-4531-B158-BC756E83404B on shell_id 4ADA7474-EA49-419A-8DCB-BB3BE7BBC508
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4B291108-2ED6-4531-B158-BC756E83404B on shell_id 4ADA7474-EA49-419A-8DCB-BB3BE7BBC508
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240d4a88 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2427fc20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2427ed48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241d6080 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E17B2C4B-4D00-4D06-AE85-79B8F86FA923
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B39D3ECA-1787-4BA0-8299-91B2DF90BB7A
DEBUG winrmshell: [WinRM] creating command_id: B39D3ECA-1787-4BA0-8299-91B2DF90BB7A on shell_id E17B2C4B-4D00-4D06-AE85-79B8F86FA923
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B39D3ECA-1787-4BA0-8299-91B2DF90BB7A on shell_id E17B2C4B-4D00-4D06-AE85-79B8F86FA923
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240bfbb0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-d1niyt.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241dfec8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241de870 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240d70a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "984c644c76a43d97a0e67d77a7ece323b8897b17" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-d1niyt.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E48D63DD-2B9E-45D4-8028-AC75E20E302F
DEBUG winrmshell: [WinRM] creating command_id: E48D63DD-2B9E-45D4-8028-AC75E20E302F on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E48D63DD-2B9E-45D4-8028-AC75E20E302F on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","984c644c76a43d97a0e67d77a7ece323b8897b17","74ae4687be5f0897ea0e3af4033ec979f9cb4103","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-d1niyt.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C3C7FE31-2D2F-4292-A9E0-DF9370C98885
DEBUG winrmshell: [WinRM] creating command_id: C3C7FE31-2D2F-4292-A9E0-DF9370C98885 on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C3C7FE31-2D2F-4292-A9E0-DF9370C98885 on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyB2ZWxvY2lyYXB0b3Igb24gdGhlIGhvc3QKCnBhcmFtICgKICBbc3dpdGNoXSRVcGRhdGUKKQoKIyBBZGQgYSBob3N0cyBlbnRyeSB0byBhdm9pZCBETlMgaXNzdWVzCklmIChTZWxlY3QtU3RyaW5nIC1QYXRoICJjOlx3aW5kb3dzXHN5c3RlbTMyXGRyaXZlcnNcZXRjXGhvc3RzIiAtUGF0dGVybiAibG9nZ2VyIikgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBIb3N0cyBmaWxlIGFscmVhZHkgdXBkYXRlZC4gTW92aW5nIG9uLiIKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQWRkaW5nIGxvZ2dlciB0byB0aGUgaG9zdHMgZmlsZSIKICBBZGQtQ29udGVudCAiYzpcd2luZG93c1xzeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cyIgIiAgICAgICAgMTkyLjE2OC41Ni4xMDUgICAgbG9nZ2VyIgp9CgojIERvd25sb2FkcyBhbmQgaW5zdGFsbCB0aGUgbGF0ZXN0IFZlbG9jaXJhcHRvciByZWxlYXNlCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEZXRlcm1pbmluZyBsYXRlc3QgcmVsZWFzZSBvZiBWZWxvY2lyYXB0b3IuLi4iCiMgR2l0SHViIHJlcXVpcmVzIFRMUyAxLjIgYXMgb2YgMi8yNwpbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCiMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKJHZlbG9jaXJhcHRvckRvd25sb2FkVXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbSIgKyAoKEludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2dpdGh1Yi5jb20vVmVsb2NpZGV4L3ZlbG9jaXJhcHRvci9yZWxlYXNlcy9sYXRlc3QiIC1Vc2VCYXNpY1BhcnNpbmcpLmxpbmtzIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgaHJlZiB8IFNlbGVjdC1TdHJpbmcgIndpbmRvd3MtYW1kNjQubXNpJCIgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxKQokdmVsb2NpcmFwdG9yTVNJUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx2ZWxvY2lyYXB0b3IubXNpJwokdmVsb2NpcmFwdG9yTG9nRmlsZSA9ICdjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx2ZWxvY2lyYXB0b3JfaW5zdGFsbC5sb2cnCklmICgtbm90KFRlc3QtUGF0aCAkdmVsb2NpcmFwdG9yTG9nRmlsZSkgLW9yICgkVXBkYXRlIC1lcSAkdHJ1ZSkpIHsKICBpZiAoJFVwZGF0ZSAtZXEgJHRydWUpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBUaGUgdXBkYXRlIGZsYWcgd2FzIHNldC4gQXR0ZW1wdGluZyB0byB1cGRhdGUuLi4iCiAgfQogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBWZWxvY2lyYXB0b3IuLi4iCiAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJHZlbG9jaXJhcHRvckRvd25sb2FkVXJsIiAtT3V0RmlsZSAkdmVsb2NpcmFwdG9yTVNJUGF0aAogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIFZlbG9jaXJhcHRvci4uLiIKICBTdGFydC1Qcm9jZXNzIEM6XFdpbmRvd3NcU3lzdGVtMzJcbXNpZXhlYy5leGUgLUFyZ3VtZW50TGlzdCAiL2kgJHZlbG9jaXJhcHRvck1TSVBhdGggL3F1aWV0IC9xbiAvbm9yZXN0YXJ0IC9sb2cgJHZlbG9jaXJhcHRvckxvZ0ZpbGUiIC13YWl0CiAgQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1x2ZWxvY2lyYXB0b3JcVmVsb2NpcmFwdG9yLmNvbmZpZy55YW1sIiAiQzpcUHJvZ3JhbSBGaWxlc1xWZWxvY2lyYXB0b3IiCiAgUmVzdGFydC1TZXJ2aWNlIFZlbG9jaXJhcHRvcgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBWZWxvY2lyYXB0b3Igc3VjY2Vzc2Z1bGx5IGluc3RhbGxlZCEiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFZlbG9jaXJhcHRvciB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KSWYgKChHZXQtU2VydmljZSAtbmFtZSBWZWxvY2lyYXB0b3IpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgVGhyb3cgIlZlbG9jaXJhcHRvciBzZXJ2aWNlIGlzIG5vdCBydW5uaW5nIgp9CgoK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7407636A-E83F-417D-ABF5-A2F13DE575EB
DEBUG winrmshell: [WinRM] creating command_id: 7407636A-E83F-417D-ABF5-A2F13DE575EB on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7407636A-E83F-417D-ABF5-A2F13DE575EB on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1F100A27-95F1-47A0-80A2-DC8761B45FD6
DEBUG winrmshell: [WinRM] creating command_id: 1F100A27-95F1-47A0-80A2-DC8761B45FD6 on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1F100A27-95F1-47A0-80A2-DC8761B45FD6 on shell_id 9B9CF30F-4397-48FD-8FDD-950003ED1A07
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-d1niyt.ps1 to C:/tmp/vagrant-shell.ps1 (3.044 KB over 1 chunks) in (0m0.23s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.77s) stream_files: (0m0.23s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24267260 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24265fc8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241bc1d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8FC89CD0-C210-4853-AC84-06A453B79FFE
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CF82767D-F254-4E0A-99D1-9D9C687E47E5
DEBUG winrmshell: [WinRM] creating command_id: CF82767D-F254-4E0A-99D1-9D9C687E47E5 on shell_id 8FC89CD0-C210-4853-AC84-06A453B79FFE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Adding logger to the hosts file
 INFO interface: detail:     dc: [14:47] Adding logger to the hosts file
    dc: [14:47] Adding logger to the hosts file
 INFO interface: detail: [14:47] Determining latest release of Velociraptor...
 INFO interface: detail:     dc: [14:47] Determining latest release of Velociraptor...
    dc: [14:47] Determining latest release of Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Downloading Velociraptor...
 INFO interface: detail:     dc: [14:47] Downloading Velociraptor...
    dc: [14:47] Downloading Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Installing Velociraptor...
 INFO interface: detail:     dc: [14:47] Installing Velociraptor...
    dc: [14:47] Installing Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Velociraptor successfully installed!
 INFO interface: detail:     dc: [14:47] Velociraptor successfully installed!
    dc: [14:47] Velociraptor successfully installed!
DEBUG winrmshell: [WinRM] cleaning up command_id: CF82767D-F254-4E0A-99D1-9D9C687E47E5 on shell_id 8FC89CD0-C210-4853-AC84-06A453B79FFE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2409d4e8 @data=[{:stdout=>"[14:47] Adding logger to the hosts file\r\n"}, {:stdout=>"[14:47] Determining latest release of Velociraptor...\r\n"}, {:stdout=>"[14:47] Downloading Velociraptor...\r\n"}, {:stdout=>"[14:47] Installing Velociraptor...\r\n"}, {:stdout=>"[14:47] Velociraptor successfully installed!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c22895dc8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c2441d708 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E2ABDED5-9977-4DA0-9D4B-51CA39A2D1C2
DEBUG winrmshell: [WinRM] Command created for hostname with id: F40765D1-8D52-4663-B7B8-2675105E538C
DEBUG winrmshell: [WinRM] creating command_id: F40765D1-8D52-4663-B7B8-2675105E538C on shell_id E2ABDED5-9977-4DA0-9D4B-51CA39A2D1C2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F40765D1-8D52-4663-B7B8-2675105E538C on shell_id E2ABDED5-9977-4DA0-9D4B-51CA39A2D1C2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23665188 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1B91B516-1ACF-406D-BFA9-37FEEB8E4D18
DEBUG winrmshell: [WinRM] Command created for hostname with id: 43E9C1A8-83A0-4DFB-8FFB-F9D70C3BEEC4
DEBUG winrmshell: [WinRM] creating command_id: 43E9C1A8-83A0-4DFB-8FFB-F9D70C3BEEC4 on shell_id 1B91B516-1ACF-406D-BFA9-37FEEB8E4D18
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 43E9C1A8-83A0-4DFB-8FFB-F9D70C3BEEC4 on shell_id 1B91B516-1ACF-406D-BFA9-37FEEB8E4D18
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2425c1a8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2DA43E40-2ABB-4686-B56D-9FD8D4E6F436
DEBUG winrmshell: [WinRM] Command created for hostname with id: 93FF0B49-B6DC-484C-AA07-5B7BCA9F16DD
DEBUG winrmshell: [WinRM] creating command_id: 93FF0B49-B6DC-484C-AA07-5B7BCA9F16DD on shell_id 2DA43E40-2ABB-4686-B56D-9FD8D4E6F436
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 93FF0B49-B6DC-484C-AA07-5B7BCA9F16DD on shell_id 2DA43E40-2ABB-4686-B56D-9FD8D4E6F436
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c246ea5d0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2496f4e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2496e540 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24879b80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 02EA75F6-D8CD-4632-B7AE-788E64C1A8F0
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B5FF6F92-E452-4E49-BEB9-43115DF150F6
DEBUG winrmshell: [WinRM] creating command_id: B5FF6F92-E452-4E49-BEB9-43115DF150F6 on shell_id 02EA75F6-D8CD-4632-B7AE-788E64C1A8F0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B5FF6F92-E452-4E49-BEB9-43115DF150F6 on shell_id 02EA75F6-D8CD-4632-B7AE-788E64C1A8F0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c246286d8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24923540 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249225a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c247e3298 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D2C0068C-8A3B-4ED5-B858-1FC420200D3D
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 33B2A847-DFDA-4DF3-A162-A7E0FF847A78
DEBUG winrmshell: [WinRM] creating command_id: 33B2A847-DFDA-4DF3-A162-A7E0FF847A78 on shell_id D2C0068C-8A3B-4ED5-B858-1FC420200D3D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 33B2A847-DFDA-4DF3-A162-A7E0FF847A78 on shell_id D2C0068C-8A3B-4ED5-B858-1FC420200D3D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c245995f0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-x5904a.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24777458 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24776198 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2455b6b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "abc75869d2c442318ae35d8125086858862e4f13" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-x5904a.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A30973C4-3DB0-45F6-8E7B-F2C7A19BE0A9
DEBUG winrmshell: [WinRM] creating command_id: A30973C4-3DB0-45F6-8E7B-F2C7A19BE0A9 on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A30973C4-3DB0-45F6-8E7B-F2C7A19BE0A9 on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","abc75869d2c442318ae35d8125086858862e4f13","984c644c76a43d97a0e67d77a7ece323b8897b17","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-x5904a.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 87F38B63-71E1-49BD-86B0-9A601E11E9A8
DEBUG winrmshell: [WinRM] creating command_id: 87F38B63-71E1-49BD-86B0-9A601E11E9A8 on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 87F38B63-71E1-49BD-86B0-9A601E11E9A8 on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBTZXRzIHVwIHRoZSBTZXJ2ZXIgYW5kIFdvcmtzdGF0aW9ucyBPVXMKCiMgSGFyZGNvZGluZyBEQyBob3N0bmFtZSBpbiBob3N0cyBmaWxlIHRvIHNpZGVzdGVwIGFueSBETlMgaXNzdWVzCkFkZC1Db250ZW50ICJjOlx3aW5kb3dzXHN5c3RlbTMyXGRyaXZlcnNcZXRjXGhvc3RzIiAiICAgICAgICAxOTIuMTY4LjU2LjEwMiAgICBkYy53aW5kb21haW4ubG9jYWwiCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ3JlYXRpbmcgU2VydmVyIGFuZCBXb3Jrc3RhdGlvbiBPVXMuLi4iCiMgQ3JlYXRlIHRoZSBTZXJ2ZXJzIE9VIGlmIGl0IGRvZXNuJ3QgZXhpc3QKJHNlcnZlcnNfb3VfY3JlYXRlZCA9IDAKd2hpbGUgKCRzZXJ2ZXJzX291X2NyZWF0ZWQgLW5lIDEpIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ3JlYXRpbmcgU2VydmVyIE9VLi4uIgogIHRyeSB7CiAgICBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLUlkZW50aXR5ICdPVT1TZXJ2ZXJzLERDPXdpbmRvbWFpbixEQz1sb2NhbCcgfCBPdXQtTnVsbAogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNlcnZlcnMgT1UgYWxyZWFkeSBleGlzdHMuIE1vdmluZyBPbi4iCiAgICAkc2VydmVyc19vdV9jcmVhdGVkID0gMQogIH0KICBjYXRjaCBbTWljcm9zb2Z0LkFjdGl2ZURpcmVjdG9yeS5NYW5hZ2VtZW50LkFESWRlbnRpdHlOb3RGb3VuZEV4Y2VwdGlvbl0gewogICAgTmV3LUFET3JnYW5pemF0aW9uYWxVbml0IC1OYW1lICJTZXJ2ZXJzIiAtU2VydmVyICJkYy53aW5kb21haW4ubG9jYWwiCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ3JlYXRlZCBTZXJ2ZXJzIE9VLiIKICAgICRzZXJ2ZXJzX291X2NyZWF0ZWQgPSAxCiAgfQogIGNhdGNoIFtNaWNyb3NvZnQuQWN0aXZlRGlyZWN0b3J5Lk1hbmFnZW1lbnQuQURTZXJ2ZXJEb3duRXhjZXB0aW9uXSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVW5hYmxlIHRvIHJlYWNoIEFjdGl2ZSBEaXJlY3RvcnkuIFNsZWVwaW5nIGZvciA1IGFuZCB0cnlpbmcgYWdhaW4uLi4iCiAgICBTdGFydC1TbGVlcCA1CiAgfQogIGNhdGNoIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTb21ldGhpbmcgd2VudCB3cm9uZyBhdHRlbXB0aW5nIHRvIHJlYWNoIEFEIG9yIGNyZWF0ZSB0aGUgT1UuIgogIH0KfQoKIyBDcmVhdGUgdGhlIFdvcmtzdGF0aW9ucyBPVSBpZiBpdCBkb2Vzbid0IGV4aXN0CiR3b3Jrc3RhdGlvbnNfb3VfY3JlYXRlZCA9IDAKd2hpbGUgKCR3b3Jrc3RhdGlvbnNfb3VfY3JlYXRlZCAtbmUgMSkgewpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ3JlYXRpbmcgV29ya3N0YXRpb25zIE9VLi4uIgogIHRyeSB7CiAgICBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLUlkZW50aXR5ICdPVT1Xb3Jrc3RhdGlvbnMsREM9d2luZG9tYWluLERDPWxvY2FsJyB8IE91dC1OdWxsCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV29ya3N0YXRpb25zIE9VIGFscmVhZHkgZXhpc3RzLiBNb3ZpbmcgT24uIgogICAgJHdvcmtzdGF0aW9uc19vdV9jcmVhdGVkID0gMQogIH0KICBjYXRjaCBbTWljcm9zb2Z0LkFjdGl2ZURpcmVjdG9yeS5NYW5hZ2VtZW50LkFESWRlbnRpdHlOb3RGb3VuZEV4Y2VwdGlvbl0gewogICAgTmV3LUFET3JnYW5pemF0aW9uYWxVbml0IC1OYW1lICJXb3Jrc3RhdGlvbnMiIC1TZXJ2ZXIgImRjLndpbmRvbWFpbi5sb2NhbCIKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDcmVhdGVkIFdvcmtzdGF0aW9ucyBPVS4iCiAgICAkd29ya3N0YXRpb25zX291X2NyZWF0ZWQgPSAxCiAgfQogIGNhdGNoIFtNaWNyb3NvZnQuQWN0aXZlRGlyZWN0b3J5Lk1hbmFnZW1lbnQuQURTZXJ2ZXJEb3duRXhjZXB0aW9uXSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVW5hYmxlIHRvIHJlYWNoIEFjdGl2ZSBEaXJlY3RvcnkuIFNsZWVwaW5nIGZvciA1IGFuZCB0cnlpbmcgYWdhaW4uLi4iCiAgICBTdGFydC1TbGVlcCA1CiAgfQogIGNhdGNoIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTb21ldGhpbmcgd2VudCB3cm9uZyBhdHRlbXB0aW5nIHRvIHJlYWNoIEFEIG9yIGNyZWF0ZSB0aGUgT1UuIgogIH0KfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E7939E1C-DF4D-4BB3-BA1A-CBB43EECF6E9
DEBUG winrmshell: [WinRM] creating command_id: E7939E1C-DF4D-4BB3-BA1A-CBB43EECF6E9 on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E7939E1C-DF4D-4BB3-BA1A-CBB43EECF6E9 on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 211CB9CB-A019-4512-AC6C-E02ECA2D267A
DEBUG winrmshell: [WinRM] creating command_id: 211CB9CB-A019-4512-AC6C-E02ECA2D267A on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 211CB9CB-A019-4512-AC6C-E02ECA2D267A on shell_id 7DB34994-F0CB-4625-9DB4-233B3D3DE970
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-x5904a.ps1 to C:/tmp/vagrant-shell.ps1 (3.052 KB over 1 chunks) in (0m0.22s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.44s) stream_files: (0m0.22s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-ou.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-ou.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-ou.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24853818 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24852968 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245e8060 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 596D027A-1E5B-438B-8878-7847D4729639
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D664EF01-0AAF-4215-8BB9-B4165D316DAE
DEBUG winrmshell: [WinRM] creating command_id: D664EF01-0AAF-4215-8BB9-B4165D316DAE on shell_id 596D027A-1E5B-438B-8878-7847D4729639
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Creating Server and Workstation OUs...
 INFO interface: detail:     dc: [14:47] Creating Server and Workstation OUs...
    dc: [14:47] Creating Server and Workstation OUs...
 INFO interface: detail: [14:47] Creating Server OU...
 INFO interface: detail:     dc: [14:47] Creating Server OU...
    dc: [14:47] Creating Server OU...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Created Servers OU.
 INFO interface: detail:     dc: [14:47] Created Servers OU.
    dc: [14:47] Created Servers OU.
 INFO interface: detail: [14:47] Creating Workstations OU...
 INFO interface: detail:     dc: [14:47] Creating Workstations OU...
    dc: [14:47] Creating Workstations OU...
 INFO interface: detail: [14:47] Created Workstations OU.
 INFO interface: detail:     dc: [14:47] Created Workstations OU.
    dc: [14:47] Created Workstations OU.
DEBUG winrmshell: [WinRM] cleaning up command_id: D664EF01-0AAF-4215-8BB9-B4165D316DAE on shell_id 596D027A-1E5B-438B-8878-7847D4729639
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c244bfd50 @data=[{:stdout=>"[14:47] Creating Server and Workstation OUs...\r\n"}, {:stdout=>"[14:47] Creating Server OU...\r\n"}, {:stdout=>"[14:47] Created Servers OU.\r\n"}, {:stdout=>"[14:47] Creating Workstations OU...\r\n"}, {:stdout=>"[14:47] Created Workstations OU.\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2441d708 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c22a60950 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 55CF0B53-E1DA-42EE-AB77-DC251D3AD1D4
DEBUG winrmshell: [WinRM] Command created for hostname with id: DBA101C3-B33A-4679-95C5-DCB7E9610EA5
DEBUG winrmshell: [WinRM] creating command_id: DBA101C3-B33A-4679-95C5-DCB7E9610EA5 on shell_id 55CF0B53-E1DA-42EE-AB77-DC251D3AD1D4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DBA101C3-B33A-4679-95C5-DCB7E9610EA5 on shell_id 55CF0B53-E1DA-42EE-AB77-DC251D3AD1D4
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24598b00 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 30CC2F1B-27C9-455A-B321-26FD9859CBB0
DEBUG winrmshell: [WinRM] Command created for hostname with id: 60F77830-CD34-4372-8FED-B654FCB1330B
DEBUG winrmshell: [WinRM] creating command_id: 60F77830-CD34-4372-8FED-B654FCB1330B on shell_id 30CC2F1B-27C9-455A-B321-26FD9859CBB0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 60F77830-CD34-4372-8FED-B654FCB1330B on shell_id 30CC2F1B-27C9-455A-B321-26FD9859CBB0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a95c98 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 210F1D92-2419-4389-ADC3-88E5F98D6946
DEBUG winrmshell: [WinRM] Command created for hostname with id: 97FC6A6A-B817-4C37-9250-E6740699922C
DEBUG winrmshell: [WinRM] creating command_id: 97FC6A6A-B817-4C37-9250-E6740699922C on shell_id 210F1D92-2419-4389-ADC3-88E5F98D6946
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 97FC6A6A-B817-4C37-9250-E6740699922C on shell_id 210F1D92-2419-4389-ADC3-88E5F98D6946
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240ac060 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242454d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242440a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2418edc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 316B7C8D-9FC9-4622-8DCB-59E4650FEF4E
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4E0E05D4-FF8C-46D3-A915-39D3865A8876
DEBUG winrmshell: [WinRM] creating command_id: 4E0E05D4-FF8C-46D3-A915-39D3865A8876 on shell_id 316B7C8D-9FC9-4622-8DCB-59E4650FEF4E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4E0E05D4-FF8C-46D3-A915-39D3865A8876 on shell_id 316B7C8D-9FC9-4622-8DCB-59E4650FEF4E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23ba8780 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241ff340 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241fe080 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240fdca8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BF03F789-8077-4808-8DCE-A45DCB76612F
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3A7B32C3-F58D-45CF-963F-6B8DBE358B5C
DEBUG winrmshell: [WinRM] creating command_id: 3A7B32C3-F58D-45CF-963F-6B8DBE358B5C on shell_id BF03F789-8077-4808-8DCE-A45DCB76612F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3A7B32C3-F58D-45CF-963F-6B8DBE358B5C on shell_id BF03F789-8077-4808-8DCE-A45DCB76612F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23969d48 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-183gaqk.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240d4830 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240ced68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237c3390 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "95305de0f7932ffe68ea6291377338f5c5c9f3d6" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-183gaqk.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: FBDE3CCE-D792-485C-84F9-D744D1FCFD3A
DEBUG winrmshell: [WinRM] creating command_id: FBDE3CCE-D792-485C-84F9-D744D1FCFD3A on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FBDE3CCE-D792-485C-84F9-D744D1FCFD3A on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","95305de0f7932ffe68ea6291377338f5c5c9f3d6","abc75869d2c442318ae35d8125086858862e4f13","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-183gaqk.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3F990057-24D7-40C0-B9A4-FAA012278430
DEBUG winrmshell: [WinRM] creating command_id: 3F990057-24D7-40C0-B9A4-FAA012278430 on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3F990057-24D7-40C0-B9A4-FAA012278430 on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyB0aGUgR1BPcyBuZWVkZWQgdG8gc3BlY2lmeSBhIFdpbmRvd3MgRXZlbnQgQ29sbGVjdG9yIGFuZCBtYWtlcyBjZXJ0YWluIGV2ZW50IGNoYW5uZWxzIHJlYWRhYmxlIGJ5IEV2ZW50IExvZ2dlcgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW1wb3J0aW5nIHRoZSBHUE8gdG8gc3BlY2lmeSB0aGUgV0VGIGNvbGxlY3RvciIKJEdQT05hbWUgPSAnV2luZG93cyBFdmVudCBGb3J3YXJkaW5nIFNlcnZlcicKSW1wb3J0LUdQTyAtQmFja3VwR3BvTmFtZSAkR1BPTmFtZSAtUGF0aCAiYzpcdmFncmFudFxyZXNvdXJjZXNcR1BPXHdlZl9jb25maWd1cmF0aW9uIiAtVGFyZ2V0TmFtZSAkR1BPTmFtZSAtQ3JlYXRlSWZOZWVkZWQKJGdwTGlua3MgPSAkbnVsbAokT1UgPSAiT1U9U2VydmVycyxkYz13aW5kb21haW4sZGM9bG9jYWwiCgokZ1BMaW5rcyA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtU2VydmVyICJkYy53aW5kb21haW4ubG9jYWwiIC1JZGVudGl0eSAkT1UgLVByb3BlcnRpZXMgbmFtZSxkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKJEdQTyA9IEdldC1HUE8gLU5hbWUgJEdQT05hbWUKSWYgKCRnUExpbmtzLkxpbmtlZEdyb3VwUG9saWN5T2JqZWN0cyAtbm90Y29udGFpbnMgJGdwby5wYXRoKQp7CiAgICBOZXctR1BMaW5rIC1OYW1lICRHUE9OYW1lIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfSBlbHNlIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBHcExpbmsgJEdQT05hbWUgYWxyZWFkeSBsaW5rZWQgb24gJE9VLiBNb3ZpbmcgT24uIgp9CiRPVSA9ICJvdT1Eb21haW4gQ29udHJvbGxlcnMsZGM9d2luZG9tYWluLGRjPWxvY2FsIgokZ3BMaW5rcyA9ICRudWxsCiRnUExpbmtzID0gR2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1TZXJ2ZXIgImRjLndpbmRvbWFpbi5sb2NhbCIgLUlkZW50aXR5ICRPVSAtUHJvcGVydGllcyBuYW1lLGRpc3Rpbmd1aXNoZWROYW1lLCBnUExpbmssIGdQT3B0aW9ucwokR1BPID0gR2V0LUdQTyAtTmFtZSAkR1BPTmFtZQpJZiAoJGdQTGlua3MuTGlua2VkR3JvdXBQb2xpY3lPYmplY3RzIC1ub3Rjb250YWlucyAkZ3BvLnBhdGgpCnsKICAgIE5ldy1HUExpbmsgLU5hbWUgJEdQT05hbWUgLVRhcmdldCAkT1UgLUVuZm9yY2VkIHllcwp9IGVsc2UgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEdwTGluayAkR1BPTmFtZSBhbHJlYWR5IGxpbmtlZCBvbiAkT1UuIE1vdmluZyBPbi4iCn0KJE9VID0gIm91PVdvcmtzdGF0aW9ucyxkYz13aW5kb21haW4sZGM9bG9jYWwiCiRncExpbmtzID0gJG51bGwKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLVNlcnZlciAiZGMud2luZG9tYWluLmxvY2FsIiAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICRHUE9OYW1lCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAkR1BPTmFtZSAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0gZWxzZSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgR3BMaW5rICRHUE9OYW1lIGFscmVhZHkgbGlua2VkIG9uICRPVS4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEltcG9ydGluZyB0aGUgR1BPIHRvIG1vZGlmeSBBQ0xzIG9uIEN1c3RvbSBFdmVudCBDaGFubmVscyIKCiRHUE9OYW1lID0gJ0N1c3RvbSBFdmVudCBDaGFubmVsIFBlcm1pc3Npb25zJwpJbXBvcnQtR1BPIC1CYWNrdXBHcG9OYW1lICRHUE9OYW1lIC1QYXRoICJjOlx2YWdyYW50XHJlc291cmNlc1xHUE9cd2VmX2NvbmZpZ3VyYXRpb24iIC1UYXJnZXROYW1lICRHUE9OYW1lIC1DcmVhdGVJZk5lZWRlZAokZ3BMaW5rcyA9ICRudWxsCiRPVSA9ICJPVT1TZXJ2ZXJzLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLVNlcnZlciAiZGMud2luZG9tYWluLmxvY2FsIiAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICRHUE9OYW1lCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAkR1BPTmFtZSAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0KZWxzZQp7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgR3BMaW5rICRHUE9OYW1lIGFscmVhZHkgbGlua2VkIG9uICRPVS4gTW92aW5nIE9uLiIKfQokT1UgPSAib3U9RG9tYWluIENvbnRyb2xsZXJzLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLVNlcnZlciAiZGMud2luZG9tYWluLmxvY2FsIiAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICRHUE9OYW1lCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAkR1BPTmFtZSAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0KZWxzZQp7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgR3BMaW5rICRHUE9OYW1lIGFscmVhZHkgbGlua2VkIG9uICRPVS4gTW92aW5nIE9uLiIKfQokT1UgPSAib3U9V29ya3N0YXRpb25zLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLVNlcnZlciAiZGMud2luZG9tYWluLmxvY2FsIiAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICRHUE9OYW1lCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAkR1BPTmFtZSAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0KZWxzZQp7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgR3BMaW5rICRHUE9OYW1lIGFscmVhZHkgbGlua2VkIG9uICRPVS4gTW92aW5nIE9uLiIKfQoKZ3B1cGRhdGUgL2ZvcmNlCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8E8A64E9-9B52-482E-A409-4BF64F13A9A6
DEBUG winrmshell: [WinRM] creating command_id: 8E8A64E9-9B52-482E-A409-4BF64F13A9A6 on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8E8A64E9-9B52-482E-A409-4BF64F13A9A6 on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5024A339-F29F-4D56-9EB4-9646C8D39928
DEBUG winrmshell: [WinRM] creating command_id: 5024A339-F29F-4D56-9EB4-9646C8D39928 on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5024A339-F29F-4D56-9EB4-9646C8D39928 on shell_id 240F7832-75B7-4B35-B89E-E5CAFD4D085E
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-183gaqk.ps1 to C:/tmp/vagrant-shell.ps1 (4.504 KB over 1 chunks) in (0m0.17s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.43s) stream_files: (0m0.17s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-wef-gpo.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-wef-gpo.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-wef-gpo.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24104698 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240fe388 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c239a35e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B1BACEBB-5F6D-4B7C-8D66-5DA975F28866
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6D8D32BC-D2FB-44AA-8FB3-2D312D79588C
DEBUG winrmshell: [WinRM] creating command_id: 6D8D32BC-D2FB-44AA-8FB3-2D312D79588C on shell_id B1BACEBB-5F6D-4B7C-8D66-5DA975F28866
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Importing the GPO to specify the WEF collector
 INFO interface: detail:     dc: [14:47] Importing the GPO to specify the WEF collector
    dc: [14:47] Importing the GPO to specify the WEF collector
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName      : Windows Event Forwarding Server
 INFO interface: detail:     dc: DisplayName      : Windows Event Forwarding Server
    dc: DisplayName      : Windows Event Forwarding Server
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail:     dc: Id               : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
    dc: Id               : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:47:34 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:47:34 PM
    dc: CreationTime     : 6/20/2022 2:47:34 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:47:34 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:47:34 PM
    dc: ModificationTime : 6/20/2022 2:47:34 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Windows Event Forwarding Server
 INFO interface: detail:     dc: DisplayName   : Windows Event Forwarding Server
    dc: DisplayName   : Windows Event Forwarding Server
 INFO interface: detail: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail:     dc: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
    dc: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 1
 INFO interface: detail:     dc: Order         : 1
    dc: Order         : 1
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Windows Event Forwarding Server
 INFO interface: detail:     dc: DisplayName   : Windows Event Forwarding Server
    dc: DisplayName   : Windows Event Forwarding Server
 INFO interface: detail: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail:     dc: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
    dc: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 2
 INFO interface: detail:     dc: Order         : 2
    dc: Order         : 2
 INFO interface: detail: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
    dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Windows Event Forwarding Server
 INFO interface: detail:     dc: DisplayName   : Windows Event Forwarding Server
    dc: DisplayName   : Windows Event Forwarding Server
 INFO interface: detail: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail:     dc: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
    dc: GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 1
 INFO interface: detail:     dc: Order         : 1
    dc: Order         : 1
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:47] Importing the GPO to modify ACLs on Custom Event Channels
 INFO interface: detail:     dc: [14:47] Importing the GPO to modify ACLs on Custom Event Channels
    dc: [14:47] Importing the GPO to modify ACLs on Custom Event Channels
 INFO interface: detail: DisplayName      : Custom Event Channel Permissions
 INFO interface: detail:     dc: DisplayName      : Custom Event Channel Permissions
    dc: DisplayName      : Custom Event Channel Permissions
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail:     dc: Id               : 7db0dd36-84fd-40bf-bd80-67642d0827be
    dc: Id               : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:47:35 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:47:35 PM
    dc: CreationTime     : 6/20/2022 2:47:35 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:47:35 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:47:35 PM
    dc: ModificationTime : 6/20/2022 2:47:35 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Custom Event Channel Permissions
 INFO interface: detail:     dc: DisplayName   : Custom Event Channel Permissions
    dc: DisplayName   : Custom Event Channel Permissions
 INFO interface: detail: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail:     dc: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
    dc: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 2
 INFO interface: detail:     dc: Order         : 2
    dc: Order         : 2
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Custom Event Channel Permissions
 INFO interface: detail:     dc: DisplayName   : Custom Event Channel Permissions
    dc: DisplayName   : Custom Event Channel Permissions
 INFO interface: detail: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail:     dc: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
    dc: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 3
 INFO interface: detail:     dc: Order         : 3
    dc: Order         : 3
 INFO interface: detail: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
    dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Custom Event Channel Permissions
 INFO interface: detail:     dc: DisplayName   : Custom Event Channel Permissions
    dc: DisplayName   : Custom Event Channel Permissions
 INFO interface: detail: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail:     dc: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
    dc: GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 2
 INFO interface: detail:     dc: Order         : 2
    dc: Order         : 2
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Updating policy...
 INFO interface: detail:     dc: Updating policy...
    dc: Updating policy...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Computer Policy update has completed successfully.
 INFO interface: detail:     dc: Computer Policy update has completed successfully.
    dc: Computer Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: User Policy update has completed successfully.
 INFO interface: detail:     dc: User Policy update has completed successfully.
    dc: User Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 6D8D32BC-D2FB-44AA-8FB3-2D312D79588C on shell_id B1BACEBB-5F6D-4B7C-8D66-5DA975F28866
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c22857bb8 @data=[{:stdout=>"[14:47] Importing the GPO to specify the WEF collector\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName      : Windows Event Forwarding Server\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : 006c2628-fe3b-445e-aa96-b59f6caa2a9b\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:47:34 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:47:34 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Windows Event Forwarding Server\r\n"}, {:stdout=>"GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 1\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Windows Event Forwarding Server\r\n"}, {:stdout=>"GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 2\r\n"}, {:stdout=>"Target        : OU=Domain Controllers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Windows Event Forwarding Server\r\n"}, {:stdout=>"GpoId         : 006c2628-fe3b-445e-aa96-b59f6caa2a9b\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 1\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:47] Importing the GPO to modify ACLs on Custom Event Channels\r\n"}, {:stdout=>"DisplayName      : Custom Event Channel Permissions\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : 7db0dd36-84fd-40bf-bd80-67642d0827be\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:47:35 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:47:35 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Custom Event Channel Permissions\r\n"}, {:stdout=>"GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 2\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Custom Event Channel Permissions\r\n"}, {:stdout=>"GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 3\r\n"}, {:stdout=>"Target        : OU=Domain Controllers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Custom Event Channel Permissions\r\n"}, {:stdout=>"GpoId         : 7db0dd36-84fd-40bf-bd80-67642d0827be\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 2\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Updating policy...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Computer Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"User Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c22a60950 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c240c5ba0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>55986, 22=>2200, 5985=>2201}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 98F38E25-1266-4E1A-AE64-FD671E920DA0
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1D121A7D-A4BF-4A76-A028-DDA577C63EDE
DEBUG winrmshell: [WinRM] creating command_id: 1D121A7D-A4BF-4A76-A028-DDA577C63EDE on shell_id 98F38E25-1266-4E1A-AE64-FD671E920DA0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1D121A7D-A4BF-4A76-A028-DDA577C63EDE on shell_id 98F38E25-1266-4E1A-AE64-FD671E920DA0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24894a70 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C9748BB7-00E2-4F45-BD30-541C0EFCD5DF
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0C8EF632-9268-417D-8AB1-6AC50DB5DB2F
DEBUG winrmshell: [WinRM] creating command_id: 0C8EF632-9268-417D-8AB1-6AC50DB5DB2F on shell_id C9748BB7-00E2-4F45-BD30-541C0EFCD5DF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0C8EF632-9268-417D-8AB1-6AC50DB5DB2F on shell_id C9748BB7-00E2-4F45-BD30-541C0EFCD5DF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c22896660 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EBA1558E-EB70-443B-A478-DDC12A961BDE
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1A037581-846F-4EAE-93CE-A18A2968E9FB
DEBUG winrmshell: [WinRM] creating command_id: 1A037581-846F-4EAE-93CE-A18A2968E9FB on shell_id EBA1558E-EB70-443B-A478-DDC12A961BDE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1A037581-846F-4EAE-93CE-A18A2968E9FB on shell_id EBA1558E-EB70-443B-A478-DDC12A961BDE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241f6470 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24356e50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24355c80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24255fd8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 34D8358D-7662-48F8-8A94-0D981D176560
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8B0D897D-ACDE-41EC-8DD6-B8691C32071C
DEBUG winrmshell: [WinRM] creating command_id: 8B0D897D-ACDE-41EC-8DD6-B8691C32071C on shell_id 34D8358D-7662-48F8-8A94-0D981D176560
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8B0D897D-ACDE-41EC-8DD6-B8691C32071C on shell_id 34D8358D-7662-48F8-8A94-0D981D176560
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24194388 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242a7db0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242a67d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241fc280 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6E351082-460E-4481-9D55-F356D760EF63
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: AF273775-4258-4C4A-8164-99BE0E107FFC
DEBUG winrmshell: [WinRM] creating command_id: AF273775-4258-4C4A-8164-99BE0E107FFC on shell_id 6E351082-460E-4481-9D55-F356D760EF63
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AF273775-4258-4C4A-8164-99BE0E107FFC on shell_id 6E351082-460E-4481-9D55-F356D760EF63
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240dcd50 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-qenjc9.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241ad4c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241ac5f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24095130 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "7e3c7cc40d1e33b691456a87b83efec7a187e648" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-qenjc9.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8087ADA7-F557-4B1C-84EE-101D57675E6A
DEBUG winrmshell: [WinRM] creating command_id: 8087ADA7-F557-4B1C-84EE-101D57675E6A on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8087ADA7-F557-4B1C-84EE-101D57675E6A on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","7e3c7cc40d1e33b691456a87b83efec7a187e648","95305de0f7932ffe68ea6291377338f5c5c9f3d6","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-qenjc9.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DC339748-CC33-490C-8268-8D149E686959
DEBUG winrmshell: [WinRM] creating command_id: DC339748-CC33-490C-8268-8D149E686959 on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DC339748-CC33-490C-8268-8D149E686959 on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIHRoZSBHUE8gdGhhdCBzcGVjaWZpZXMgdGhlIFdFRiBjb2xsZWN0b3IKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEltcG9ydGluZyB0aGUgR1BPIHRvIGVuYWJsZSBQb3dlcnNoZWxsIE1vZHVsZSwgU2NyaXB0QmxvY2sgYW5kIFRyYW5zY3JpcHQgbG9nZ2luZy4uLiIKSW1wb3J0LUdQTyAtQmFja3VwR3BvTmFtZSAnUG93ZXJzaGVsbCBMb2dnaW5nJyAtUGF0aCAiYzpcdmFncmFudFxyZXNvdXJjZXNcR1BPXHBvd2Vyc2hlbGxfbG9nZ2luZyIgLVRhcmdldE5hbWUgJ1Bvd2Vyc2hlbGwgTG9nZ2luZycgLUNyZWF0ZUlmTmVlZGVkCiRPVSA9ICJvdT1Xb3Jrc3RhdGlvbnMsZGM9d2luZG9tYWluLGRjPWxvY2FsIgokZ1BMaW5rcyA9ICRudWxsCiRnUExpbmtzID0gR2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1JZGVudGl0eSAkT1UgLVByb3BlcnRpZXMgbmFtZSxkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKJEdQTyA9IEdldC1HUE8gLU5hbWUgJ1Bvd2Vyc2hlbGwgTG9nZ2luZycKSWYgKCRnUExpbmtzLkxpbmtlZEdyb3VwUG9saWN5T2JqZWN0cyAtbm90Y29udGFpbnMgJGdwby5wYXRoKQp7CiAgICBOZXctR1BMaW5rIC1OYW1lICdQb3dlcnNoZWxsIExvZ2dpbmcnIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBQb3dlcnNoZWxsIExvZ2dpbmcgd2FzIGFscmVhZHkgbGlua2VkIGF0ICRPVS4gTW92aW5nIE9uLiIKfQokT1UgPSAib3U9U2VydmVycyxkYz13aW5kb21haW4sZGM9bG9jYWwiCiRnUExpbmtzID0gJG51bGwKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLUlkZW50aXR5ICRPVSAtUHJvcGVydGllcyBuYW1lLGRpc3Rpbmd1aXNoZWROYW1lLCBnUExpbmssIGdQT3B0aW9ucwokR1BPID0gR2V0LUdQTyAtTmFtZSAnUG93ZXJzaGVsbCBMb2dnaW5nJwpJZiAoJGdQTGlua3MuTGlua2VkR3JvdXBQb2xpY3lPYmplY3RzIC1ub3Rjb250YWlucyAkZ3BvLnBhdGgpCnsKICAgIE5ldy1HUExpbmsgLU5hbWUgJ1Bvd2Vyc2hlbGwgTG9nZ2luZycgLVRhcmdldCAkT1UgLUVuZm9yY2VkIHllcwp9CmVsc2UKewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFBvd2Vyc2hlbGwgTG9nZ2luZyB3YXMgYWxyZWFkeSBsaW5rZWQgYXQgJE9VLiBNb3ZpbmcgT24uIgp9CiRPVSA9ICJvdT1Eb21haW4gQ29udHJvbGxlcnMsZGM9d2luZG9tYWluLGRjPWxvY2FsIgokZ1BMaW5rcyA9ICRudWxsCiRnUExpbmtzID0gR2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1JZGVudGl0eSAkT1UgLVByb3BlcnRpZXMgbmFtZSxkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKSWYgKCRnUExpbmtzLkxpbmtlZEdyb3VwUG9saWN5T2JqZWN0cyAtbm90Y29udGFpbnMgJGdwby5wYXRoKQp7CiAgICBOZXctR1BMaW5rIC1OYW1lICdQb3dlcnNoZWxsIExvZ2dpbmcnIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBQb3dlcnNoZWxsIExvZ2dpbmcgd2FzIGFscmVhZHkgbGlua2VkIGF0ICRPVS4gTW92aW5nIE9uLiIKfQpncHVwZGF0ZSAvZm9yY2UK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C32170CA-B9C4-4EE4-B555-D58B01F5E5F4
DEBUG winrmshell: [WinRM] creating command_id: C32170CA-B9C4-4EE4-B555-D58B01F5E5F4 on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C32170CA-B9C4-4EE4-B555-D58B01F5E5F4 on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: FF58F58E-C2C2-46AC-ACC3-CB9028592989
DEBUG winrmshell: [WinRM] creating command_id: FF58F58E-C2C2-46AC-ACC3-CB9028592989 on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FF58F58E-C2C2-46AC-ACC3-CB9028592989 on shell_id 2770CE57-39B9-4F35-88C8-1A9F4C4D524E
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-qenjc9.ps1 to C:/tmp/vagrant-shell.ps1 (2.244 KB over 1 chunks) in (0m0.21s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.44s) stream_files: (0m0.21s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-powershelllogging.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-powershelllogging.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-powershelllogging.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24197010 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24196070 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23c399d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E6F0CDE0-D848-4688-89FC-7F056FBFF2CB
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 04C2AA57-AC81-4D39-ABA4-482A099B9A28
DEBUG winrmshell: [WinRM] creating command_id: 04C2AA57-AC81-4D39-ABA4-482A099B9A28 on shell_id E6F0CDE0-D848-4688-89FC-7F056FBFF2CB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:47] Importing the GPO to enable Powershell Module, ScriptBlock and Transcript logging...
 INFO interface: detail:     dc: [14:47] Importing the GPO to enable Powershell Module, ScriptBlock and Transcript logging...
    dc: [14:47] Importing the GPO to enable Powershell Module, ScriptBlock and Transcript logging...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName      : Powershell Logging
 INFO interface: detail:     dc: DisplayName      : Powershell Logging
    dc: DisplayName      : Powershell Logging
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail:     dc: Id               : 0c3c7586-537f-49ce-8a14-214378291ec5
    dc: Id               : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:47:52 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:47:52 PM
    dc: CreationTime     : 6/20/2022 2:47:52 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:47:52 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:47:52 PM
    dc: ModificationTime : 6/20/2022 2:47:52 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Powershell Logging
 INFO interface: detail:     dc: DisplayName   : Powershell Logging
    dc: DisplayName   : Powershell Logging
 INFO interface: detail: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail:     dc: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
    dc: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 3
 INFO interface: detail:     dc: Order         : 3
    dc: Order         : 3
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Powershell Logging
 INFO interface: detail:     dc: DisplayName   : Powershell Logging
    dc: DisplayName   : Powershell Logging
 INFO interface: detail: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail:     dc: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
    dc: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 3
 INFO interface: detail:     dc: Order         : 3
    dc: Order         : 3
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Powershell Logging
 INFO interface: detail:     dc: DisplayName   : Powershell Logging
    dc: DisplayName   : Powershell Logging
 INFO interface: detail: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail:     dc: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
    dc: GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 4
 INFO interface: detail:     dc: Order         : 4
    dc: Order         : 4
 INFO interface: detail: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
    dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Updating policy...
 INFO interface: detail:     dc: Updating policy...
    dc: Updating policy...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Computer Policy update has completed successfully.
 INFO interface: detail:     dc: Computer Policy update has completed successfully.
    dc: Computer Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: User Policy update has completed successfully.
 INFO interface: detail:     dc: User Policy update has completed successfully.
    dc: User Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 04C2AA57-AC81-4D39-ABA4-482A099B9A28 on shell_id E6F0CDE0-D848-4688-89FC-7F056FBFF2CB
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23553380 @data=[{:stdout=>"[14:47] Importing the GPO to enable Powershell Module, ScriptBlock and Transcript logging...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName      : Powershell Logging\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : 0c3c7586-537f-49ce-8a14-214378291ec5\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:47:52 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:47:52 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Powershell Logging\r\n"}, {:stdout=>"GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 3\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Powershell Logging\r\n"}, {:stdout=>"GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 3\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Powershell Logging\r\n"}, {:stdout=>"GpoId         : 0c3c7586-537f-49ce-8a14-214378291ec5\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 4\r\n"}, {:stdout=>"Target        : OU=Domain Controllers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Updating policy...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Computer Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"User Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c240c5ba0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c24b142c8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 757EE09D-D559-4C80-B39C-1D48D729FD27
DEBUG winrmshell: [WinRM] Command created for hostname with id: 22F5377F-D54B-4778-BDF1-7DE2C3A5AF37
DEBUG winrmshell: [WinRM] creating command_id: 22F5377F-D54B-4778-BDF1-7DE2C3A5AF37 on shell_id 757EE09D-D559-4C80-B39C-1D48D729FD27
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 22F5377F-D54B-4778-BDF1-7DE2C3A5AF37 on shell_id 757EE09D-D559-4C80-B39C-1D48D729FD27
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c244059f0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F05714AD-01C6-4A57-B54D-F4E4C8C255F8
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8A5C97EE-672B-4C7B-8D55-AADE923FAC7B
DEBUG winrmshell: [WinRM] creating command_id: 8A5C97EE-672B-4C7B-8D55-AADE923FAC7B on shell_id F05714AD-01C6-4A57-B54D-F4E4C8C255F8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8A5C97EE-672B-4C7B-8D55-AADE923FAC7B on shell_id F05714AD-01C6-4A57-B54D-F4E4C8C255F8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c248b6da0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 391144D1-855F-48B9-A91C-7BEA78852C40
DEBUG winrmshell: [WinRM] Command created for hostname with id: 53CDE1C1-B871-439D-99F2-B0C67BD0D4B1
DEBUG winrmshell: [WinRM] creating command_id: 53CDE1C1-B871-439D-99F2-B0C67BD0D4B1 on shell_id 391144D1-855F-48B9-A91C-7BEA78852C40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 53CDE1C1-B871-439D-99F2-B0C67BD0D4B1 on shell_id 391144D1-855F-48B9-A91C-7BEA78852C40
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2290a740 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2408c7d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240862c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c236975c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 588F5FF6-26F9-4724-8A9D-F3819BEB3DB1
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3BB20D04-5E95-4E26-91C0-6AB15EC6DF2C
DEBUG winrmshell: [WinRM] creating command_id: 3BB20D04-5E95-4E26-91C0-6AB15EC6DF2C on shell_id 588F5FF6-26F9-4724-8A9D-F3819BEB3DB1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3BB20D04-5E95-4E26-91C0-6AB15EC6DF2C on shell_id 588F5FF6-26F9-4724-8A9D-F3819BEB3DB1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b36c38 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237daba8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237d3808 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22534198 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6673AEC3-D21E-47AB-B7EA-758644A26991
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DB1F4F61-270A-422A-A8B5-C24793501022
DEBUG winrmshell: [WinRM] creating command_id: DB1F4F61-270A-422A-A8B5-C24793501022 on shell_id 6673AEC3-D21E-47AB-B7EA-758644A26991
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DB1F4F61-270A-422A-A8B5-C24793501022 on shell_id 6673AEC3-D21E-47AB-B7EA-758644A26991
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24a8fa78 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1vy0qze.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b2cbc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b279b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249c6218 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "174a535f7451eb0c640c2660e458ae90eccec75a" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1vy0qze.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2A574858-A857-47D3-92A8-2F00B6EC3848
DEBUG winrmshell: [WinRM] creating command_id: 2A574858-A857-47D3-92A8-2F00B6EC3848 on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2A574858-A857-47D3-92A8-2F00B6EC3848 on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","174a535f7451eb0c640c2660e458ae90eccec75a","7e3c7cc40d1e33b691456a87b83efec7a187e648","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1vy0qze.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9F01CB0C-EC3D-4D81-A01F-FDF46EC0D32A
DEBUG winrmshell: [WinRM] creating command_id: 9F01CB0C-EC3D-4D81-A01F-FDF46EC0D32A on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9F01CB0C-EC3D-4D81-A01F-FDF46EC0D32A on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyB0aGUgR1BPcyBmb3IgdGhlIGN1c3RvbSBXaW5FdmVudExvZyBhdWRpdGluZyBwb2xpY3kuCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDb25maWd1cmluZyBhdWRpdGluZyBwb2xpY3kgR1BPcy4uLiIKJEdQT05hbWUgPSAnRG9tYWluIENvbnRyb2xsZXJzIEVuaGFuY2VkIEF1ZGl0aW5nIFBvbGljeScKJE9VID0gIm91PURvbWFpbiBDb250cm9sbGVycyxkYz13aW5kb21haW4sZGM9bG9jYWwiCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbXBvcnRpbmcgJEdQT05hbWUuLi4iCkltcG9ydC1HUE8gLUJhY2t1cEdwb05hbWUgJEdQT05hbWUgLVBhdGggImM6XHZhZ3JhbnRccmVzb3VyY2VzXEdQT1xEb21haW5fQ29udHJvbGxlcnNfRW5oYW5jZWRfQXVkaXRpbmdfUG9saWN5IiAtVGFyZ2V0TmFtZSAkR1BPTmFtZSAtQ3JlYXRlSWZOZWVkZWQKJGdwTGlua3MgPSAkbnVsbAokZ1BMaW5rcyA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICRHUE9OYW1lCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAkR1BPTmFtZSAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0KZWxzZQp7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgR3BMaW5rICRHUE9OYW1lIGFscmVhZHkgbGlua2VkIG9uICRPVS4gTW92aW5nIE9uLiIKfQokR1BPTmFtZSA9ICdTZXJ2ZXJzIEVuaGFuY2VkIEF1ZGl0aW5nIFBvbGljeScKJE9VID0gIm91PVNlcnZlcnMsZGM9d2luZG9tYWluLGRjPWxvY2FsIgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW1wb3J0aW5nICRHUE9OYW1lLi4uIgpJbXBvcnQtR1BPIC1CYWNrdXBHcG9OYW1lICRHUE9OYW1lIC1QYXRoICJjOlx2YWdyYW50XHJlc291cmNlc1xHUE9cU2VydmVyc19FbmhhbmNlZF9BdWRpdGluZ19Qb2xpY3kiIC1UYXJnZXROYW1lICRHUE9OYW1lIC1DcmVhdGVJZk5lZWRlZAokZ3BMaW5rcyA9ICRudWxsCiRnUExpbmtzID0gR2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1JZGVudGl0eSAkT1UgLVByb3BlcnRpZXMgbmFtZSxkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKJEdQTyA9IEdldC1HUE8gLU5hbWUgJEdQT05hbWUKSWYgKCRnUExpbmtzLkxpbmtlZEdyb3VwUG9saWN5T2JqZWN0cyAtbm90Y29udGFpbnMgJGdwby5wYXRoKQp7CiAgICBOZXctR1BMaW5rIC1OYW1lICRHUE9OYW1lIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBHcExpbmsgJEdQT05hbWUgYWxyZWFkeSBsaW5rZWQgb24gJE9VLiBNb3ZpbmcgT24uIgp9CgokR1BPTmFtZSA9ICdXb3Jrc3RhdGlvbnMgRW5oYW5jZWQgQXVkaXRpbmcgUG9saWN5JwokT1UgPSAib3U9V29ya3N0YXRpb25zLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEltcG9ydGluZyAkR1BPTmFtZS4uLiIKSW1wb3J0LUdQTyAtQmFja3VwR3BvTmFtZSAkR1BPTmFtZSAtUGF0aCAiYzpcdmFncmFudFxyZXNvdXJjZXNcR1BPXFdvcmtzdGF0aW9uc19FbmhhbmNlZF9BdWRpdGluZ19Qb2xpY3kiIC1UYXJnZXROYW1lICRHUE9OYW1lIC1DcmVhdGVJZk5lZWRlZAokZ3BMaW5rcyA9ICRudWxsCiRnUExpbmtzID0gR2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1JZGVudGl0eSAkT1UgLVByb3BlcnRpZXMgbmFtZSxkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKJEdQTyA9IEdldC1HUE8gLU5hbWUgJEdQT05hbWUKSWYgKCRnUExpbmtzLkxpbmtlZEdyb3VwUG9saWN5T2JqZWN0cyAtbm90Y29udGFpbnMgJGdwby5wYXRoKQp7CiAgICBOZXctR1BMaW5rIC1OYW1lICRHUE9OYW1lIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBHcExpbmsgJEdQT05hbWUgYWxyZWFkeSBsaW5rZWQgb24gJE9VLiBNb3ZpbmcgT24uIgp9Cg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DB2DA80C-03B1-4FD7-8DF1-38B5A9AAB135
DEBUG winrmshell: [WinRM] creating command_id: DB2DA80C-03B1-4FD7-8DF1-38B5A9AAB135 on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DB2DA80C-03B1-4FD7-8DF1-38B5A9AAB135 on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6F53DC1A-1122-4821-BFB7-3E299BA07AE4
DEBUG winrmshell: [WinRM] creating command_id: 6F53DC1A-1122-4821-BFB7-3E299BA07AE4 on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6F53DC1A-1122-4821-BFB7-3E299BA07AE4 on shell_id 3EFF4C35-3B50-49A6-8B9E-2D3641BD4A3B
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1vy0qze.ps1 to C:/tmp/vagrant-shell.ps1 (2.952 KB over 1 chunks) in (0m0.21s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.45s) stream_files: (0m0.21s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-AuditingPolicyGPOs.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-AuditingPolicyGPOs.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-AuditingPolicyGPOs.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24aa7cb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24aa69f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24933c88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3291F48B-AAFE-47FC-8182-96CB0A28AEDB
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 283B050A-E617-4D18-B25E-2D7D45A3E9C1
DEBUG winrmshell: [WinRM] creating command_id: 283B050A-E617-4D18-B25E-2D7D45A3E9C1 on shell_id 3291F48B-AAFE-47FC-8182-96CB0A28AEDB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:48] Configuring auditing policy GPOs...
 INFO interface: detail:     dc: [14:48] Configuring auditing policy GPOs...
    dc: [14:48] Configuring auditing policy GPOs...
 INFO interface: detail: [14:48] Importing Domain Controllers Enhanced Auditing Policy...
 INFO interface: detail:     dc: [14:48] Importing Domain Controllers Enhanced Auditing Policy...
    dc: [14:48] Importing Domain Controllers Enhanced Auditing Policy...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName      : Domain Controllers Enhanced Auditing Policy
 INFO interface: detail:     dc: DisplayName      : Domain Controllers Enhanced Auditing Policy
    dc: DisplayName      : Domain Controllers Enhanced Auditing Policy
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : e5068b05-4dba-4fff-b7dd-acec3221e2b7
 INFO interface: detail:     dc: Id               : e5068b05-4dba-4fff-b7dd-acec3221e2b7
    dc: Id               : e5068b05-4dba-4fff-b7dd-acec3221e2b7
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:48:08 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:48:08 PM
    dc: CreationTime     : 6/20/2022 2:48:08 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:48:08 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:48:08 PM
    dc: ModificationTime : 6/20/2022 2:48:08 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Domain Controllers Enhanced Auditing Policy
 INFO interface: detail:     dc: DisplayName   : Domain Controllers Enhanced Auditing Policy
    dc: DisplayName   : Domain Controllers Enhanced Auditing Policy
 INFO interface: detail: GpoId         : e5068b05-4dba-4fff-b7dd-acec3221e2b7
 INFO interface: detail:     dc: GpoId         : e5068b05-4dba-4fff-b7dd-acec3221e2b7
    dc: GpoId         : e5068b05-4dba-4fff-b7dd-acec3221e2b7
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 5
 INFO interface: detail:     dc: Order         : 5
    dc: Order         : 5
 INFO interface: detail: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
    dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:48] Importing Servers Enhanced Auditing Policy...
 INFO interface: detail:     dc: [14:48] Importing Servers Enhanced Auditing Policy...
    dc: [14:48] Importing Servers Enhanced Auditing Policy...
 INFO interface: detail: DisplayName      : Servers Enhanced Auditing Policy
 INFO interface: detail:     dc: DisplayName      : Servers Enhanced Auditing Policy
    dc: DisplayName      : Servers Enhanced Auditing Policy
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd
 INFO interface: detail:     dc: Id               : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd
    dc: Id               : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd
 INFO interface: detail: GpoStatus        : UserSettingsDisabled
 INFO interface: detail:     dc: GpoStatus        : UserSettingsDisabled
    dc: GpoStatus        : UserSettingsDisabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:48:09 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:48:09 PM
    dc: CreationTime     : 6/20/2022 2:48:09 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:48:09 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:48:09 PM
    dc: ModificationTime : 6/20/2022 2:48:09 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Servers Enhanced Auditing Policy
 INFO interface: detail:     dc: DisplayName   : Servers Enhanced Auditing Policy
    dc: DisplayName   : Servers Enhanced Auditing Policy
 INFO interface: detail: GpoId         : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd
 INFO interface: detail:     dc: GpoId         : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd
    dc: GpoId         : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 4
 INFO interface: detail:     dc: Order         : 4
    dc: Order         : 4
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:48] Importing Workstations Enhanced Auditing Policy...
 INFO interface: detail:     dc: [14:48] Importing Workstations Enhanced Auditing Policy...
    dc: [14:48] Importing Workstations Enhanced Auditing Policy...
 INFO interface: detail: DisplayName      : Workstations Enhanced Auditing Policy
 INFO interface: detail:     dc: DisplayName      : Workstations Enhanced Auditing Policy
    dc: DisplayName      : Workstations Enhanced Auditing Policy
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : 318fe429-4ad3-4b69-a0ee-03468ec44944
 INFO interface: detail:     dc: Id               : 318fe429-4ad3-4b69-a0ee-03468ec44944
    dc: Id               : 318fe429-4ad3-4b69-a0ee-03468ec44944
 INFO interface: detail: GpoStatus        : UserSettingsDisabled
 INFO interface: detail:     dc: GpoStatus        : UserSettingsDisabled
    dc: GpoStatus        : UserSettingsDisabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:48:09 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:48:09 PM
    dc: CreationTime     : 6/20/2022 2:48:09 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:48:09 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:48:09 PM
    dc: ModificationTime : 6/20/2022 2:48:09 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Workstations Enhanced Auditing Policy
 INFO interface: detail:     dc: DisplayName   : Workstations Enhanced Auditing Policy
    dc: DisplayName   : Workstations Enhanced Auditing Policy
 INFO interface: detail: GpoId         : 318fe429-4ad3-4b69-a0ee-03468ec44944
 INFO interface: detail:     dc: GpoId         : 318fe429-4ad3-4b69-a0ee-03468ec44944
    dc: GpoId         : 318fe429-4ad3-4b69-a0ee-03468ec44944
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 4
 INFO interface: detail:     dc: Order         : 4
    dc: Order         : 4
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 283B050A-E617-4D18-B25E-2D7D45A3E9C1 on shell_id 3291F48B-AAFE-47FC-8182-96CB0A28AEDB
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2481c200 @data=[{:stdout=>"[14:48] Configuring auditing policy GPOs...\r\n"}, {:stdout=>"[14:48] Importing Domain Controllers Enhanced Auditing Policy...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName      : Domain Controllers Enhanced Auditing Policy\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : e5068b05-4dba-4fff-b7dd-acec3221e2b7\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:48:08 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:48:08 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Domain Controllers Enhanced Auditing Policy\r\n"}, {:stdout=>"GpoId         : e5068b05-4dba-4fff-b7dd-acec3221e2b7\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 5\r\n"}, {:stdout=>"Target        : OU=Domain Controllers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:48] Importing Servers Enhanced Auditing Policy...\r\n"}, {:stdout=>"DisplayName      : Servers Enhanced Auditing Policy\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd\r\n"}, {:stdout=>"GpoStatus        : UserSettingsDisabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:48:09 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:48:09 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Servers Enhanced Auditing Policy\r\n"}, {:stdout=>"GpoId         : d266ba93-5eba-4b22-8a46-b8ca78bc9ccd\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 4\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:48] Importing Workstations Enhanced Auditing Policy...\r\n"}, {:stdout=>"DisplayName      : Workstations Enhanced Auditing Policy\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : 318fe429-4ad3-4b69-a0ee-03468ec44944\r\n"}, {:stdout=>"GpoStatus        : UserSettingsDisabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:48:09 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:48:09 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Workstations Enhanced Auditing Policy\r\n"}, {:stdout=>"GpoId         : 318fe429-4ad3-4b69-a0ee-03468ec44944\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 4\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24b142c8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c24216978 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6FE31AFE-DDCB-48CE-9B56-300BD04D6A16
DEBUG winrmshell: [WinRM] Command created for hostname with id: F05B7893-0269-40F0-9B76-211F20E98DEB
DEBUG winrmshell: [WinRM] creating command_id: F05B7893-0269-40F0-9B76-211F20E98DEB on shell_id 6FE31AFE-DDCB-48CE-9B56-300BD04D6A16
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F05B7893-0269-40F0-9B76-211F20E98DEB on shell_id 6FE31AFE-DDCB-48CE-9B56-300BD04D6A16
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249cce60 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A4BB1B14-DC95-4A2C-AE86-15637EC6F490
DEBUG winrmshell: [WinRM] Command created for hostname with id: 30B70701-CABA-4286-95FC-F7F3C0F6E7D8
DEBUG winrmshell: [WinRM] creating command_id: 30B70701-CABA-4286-95FC-F7F3C0F6E7D8 on shell_id A4BB1B14-DC95-4A2C-AE86-15637EC6F490
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 30B70701-CABA-4286-95FC-F7F3C0F6E7D8 on shell_id A4BB1B14-DC95-4A2C-AE86-15637EC6F490
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23989698 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7B6E2518-FA2C-475E-8E9F-B85232B7FD05
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0E689E6B-03AA-4BD7-8BC9-8C89D370CF1C
DEBUG winrmshell: [WinRM] creating command_id: 0E689E6B-03AA-4BD7-8BC9-8C89D370CF1C on shell_id 7B6E2518-FA2C-475E-8E9F-B85232B7FD05
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0E689E6B-03AA-4BD7-8BC9-8C89D370CF1C on shell_id 7B6E2518-FA2C-475E-8E9F-B85232B7FD05
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242747d0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2441fcd8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2441eae0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242a41d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4657F3C4-7487-4FC0-A510-0905E4251AA0
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2C7B6E09-B117-4149-A6A7-FD875990ACC6
DEBUG winrmshell: [WinRM] creating command_id: 2C7B6E09-B117-4149-A6A7-FD875990ACC6 on shell_id 4657F3C4-7487-4FC0-A510-0905E4251AA0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2C7B6E09-B117-4149-A6A7-FD875990ACC6 on shell_id 4657F3C4-7487-4FC0-A510-0905E4251AA0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241def28 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23a50f90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23a11c78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24245f48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 56A08F3D-DDF3-4350-8D23-FBF82481BE18
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 156FF504-F2F5-4222-BFD1-AB353E20CDBF
DEBUG winrmshell: [WinRM] creating command_id: 156FF504-F2F5-4222-BFD1-AB353E20CDBF on shell_id 56A08F3D-DDF3-4350-8D23-FBF82481BE18
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 156FF504-F2F5-4222-BFD1-AB353E20CDBF on shell_id 56A08F3D-DDF3-4350-8D23-FBF82481BE18
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2453bdb0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-17nb7g3.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2429c488 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24297578 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2420c978 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "88fd6f54ec04ca82ba71cbbb4612ad3b1579aa05" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-17nb7g3.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F1EF741B-7DD7-429D-B5A9-4505FB73C440
DEBUG winrmshell: [WinRM] creating command_id: F1EF741B-7DD7-429D-B5A9-4505FB73C440 on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F1EF741B-7DD7-429D-B5A9-4505FB73C440 on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","88fd6f54ec04ca82ba71cbbb4612ad3b1579aa05","174a535f7451eb0c640c2660e458ae90eccec75a","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-17nb7g3.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 390618CD-3AD9-462F-B44C-F8FFFF7C8E5A
DEBUG winrmshell: [WinRM] creating command_id: 390618CD-3AD9-462F-B44C-F8FFFF7C8E5A on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 390618CD-3AD9-462F-B44C-F8FFFF7C8E5A on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIHRoZSBHUE8gdGhhdCBhbGxvd3Mgd2luZG9tYWluXHZhZ3JhbnQgdG8gUkRQCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbXBvcnRpbmcgdGhlIEdQTyB0byBhbGxvdyB3aW5kb21haW4vdmFncmFudCB0byBSRFAuLi4iCkltcG9ydC1HUE8gLUJhY2t1cEdwb05hbWUgJ0FsbG93IERvbWFpbiBVc2VycyBSRFAnIC1QYXRoICJjOlx2YWdyYW50XHJlc291cmNlc1xHUE9ccmRwX3VzZXJzIiAtTWlncmF0aW9uVGFibGUgImM6XHZhZ3JhbnRccmVzb3VyY2VzXEdQT1xyZHBfdXNlcnNccmRwX3VzZXJzLm1pZ3RhYmxlIiAtVGFyZ2V0TmFtZSAnQWxsb3cgRG9tYWluIFVzZXJzIFJEUCcgLUNyZWF0ZUlmTmVlZGVkCgokT1UgPSAib3U9V29ya3N0YXRpb25zLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSAkbnVsbAokZ1BMaW5rcyA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICdBbGxvdyBEb21haW4gVXNlcnMgUkRQJwpJZiAoJGdQTGlua3MuTGlua2VkR3JvdXBQb2xpY3lPYmplY3RzIC1ub3Rjb250YWlucyAkZ3BvLnBhdGgpCnsKICBOZXctR1BMaW5rIC1OYW1lICdBbGxvdyBEb21haW4gVXNlcnMgUkRQJyAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0KZWxzZQp7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEFsbG93IERvbWFpbiBVc2VycyBSRFAgR1BPIHdhcyBhbHJlYWR5IGxpbmtlZCBhdCAkT1UuIE1vdmluZyBPbi4iCn0KJE9VID0gIm91PVNlcnZlcnMsZGM9d2luZG9tYWluLGRjPWxvY2FsIgokZ1BMaW5rcyA9ICRudWxsCiRnUExpbmtzID0gR2V0LUFET3JnYW5pemF0aW9uYWxVbml0IC1JZGVudGl0eSAkT1UgLVByb3BlcnRpZXMgbmFtZSxkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKJEdQTyA9IEdldC1HUE8gLU5hbWUgJ0FsbG93IERvbWFpbiBVc2VycyBSRFAnCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAnQWxsb3cgRG9tYWluIFVzZXJzIFJEUCcgLVRhcmdldCAkT1UgLUVuZm9yY2VkIHllcwp9CmVsc2UKewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBBbGxvdyBEb21haW4gVXNlcnMgUkRQIEdQTyB3YXMgYWxyZWFkeSBsaW5rZWQgYXQgJE9VLiBNb3ZpbmcgT24uIgp9CmdwdXBkYXRlIC9mb3JjZQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 639522E7-4171-41F8-9785-A6386E10EB53
DEBUG winrmshell: [WinRM] creating command_id: 639522E7-4171-41F8-9785-A6386E10EB53 on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 639522E7-4171-41F8-9785-A6386E10EB53 on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4B520EC1-B6F4-48B9-B87F-0FCB76BB202E
DEBUG winrmshell: [WinRM] creating command_id: 4B520EC1-B6F4-48B9-B87F-0FCB76BB202E on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4B520EC1-B6F4-48B9-B87F-0FCB76BB202E on shell_id 0C17C112-4137-47A5-90A1-6ECFC325323A
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-17nb7g3.ps1 to C:/tmp/vagrant-shell.ps1 (1.776 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.42s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-rdp-user-gpo.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-rdp-user-gpo.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-rdp-user-gpo.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24af1d40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24af0eb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249bca60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AD7B4FF2-A15F-4173-B234-AC1F98E1C10C
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BE44C10A-0A8C-45D6-80A4-D4F821EBB312
DEBUG winrmshell: [WinRM] creating command_id: BE44C10A-0A8C-45D6-80A4-D4F821EBB312 on shell_id AD7B4FF2-A15F-4173-B234-AC1F98E1C10C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:48] Importing the GPO to allow windomain/vagrant to RDP...
 INFO interface: detail:     dc: [14:48] Importing the GPO to allow windomain/vagrant to RDP...
    dc: [14:48] Importing the GPO to allow windomain/vagrant to RDP...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName      : Allow Domain Users RDP
 INFO interface: detail:     dc: DisplayName      : Allow Domain Users RDP
    dc: DisplayName      : Allow Domain Users RDP
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : 69078699-7f2a-4302-a957-1baa1d3abdc7
 INFO interface: detail:     dc: Id               : 69078699-7f2a-4302-a957-1baa1d3abdc7
    dc: Id               : 69078699-7f2a-4302-a957-1baa1d3abdc7
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:48:15 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:48:15 PM
    dc: CreationTime     : 6/20/2022 2:48:15 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:48:15 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:48:15 PM
    dc: ModificationTime : 6/20/2022 2:48:15 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Allow Domain Users RDP
 INFO interface: detail:     dc: DisplayName   : Allow Domain Users RDP
    dc: DisplayName   : Allow Domain Users RDP
 INFO interface: detail: GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7
 INFO interface: detail:     dc: GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7
    dc: GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 5
 INFO interface: detail:     dc: Order         : 5
    dc: Order         : 5
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Allow Domain Users RDP
 INFO interface: detail:     dc: DisplayName   : Allow Domain Users RDP
    dc: DisplayName   : Allow Domain Users RDP
 INFO interface: detail: GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7
 INFO interface: detail:     dc: GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7
    dc: GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 5
 INFO interface: detail:     dc: Order         : 5
    dc: Order         : 5
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Updating policy...
 INFO interface: detail:     dc: Updating policy...
    dc: Updating policy...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Computer Policy update has completed successfully.
 INFO interface: detail:     dc: Computer Policy update has completed successfully.
    dc: Computer Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: User Policy update has completed successfully.
 INFO interface: detail:     dc: User Policy update has completed successfully.
    dc: User Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BE44C10A-0A8C-45D6-80A4-D4F821EBB312 on shell_id AD7B4FF2-A15F-4173-B234-AC1F98E1C10C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c248a7fa8 @data=[{:stdout=>"[14:48] Importing the GPO to allow windomain/vagrant to RDP...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName      : Allow Domain Users RDP\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : 69078699-7f2a-4302-a957-1baa1d3abdc7\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:48:15 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:48:15 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Allow Domain Users RDP\r\n"}, {:stdout=>"GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 5\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Allow Domain Users RDP\r\n"}, {:stdout=>"GpoId         : 69078699-7f2a-4302-a957-1baa1d3abdc7\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 5\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Updating policy...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Computer Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"User Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24216978 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c249cf868 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 49B09D07-946C-484E-A0B7-E2F7DB30D5E2
DEBUG winrmshell: [WinRM] Command created for hostname with id: 7383B6CA-A41C-4891-9EFE-4F4D580B632F
DEBUG winrmshell: [WinRM] creating command_id: 7383B6CA-A41C-4891-9EFE-4F4D580B632F on shell_id 49B09D07-946C-484E-A0B7-E2F7DB30D5E2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7383B6CA-A41C-4891-9EFE-4F4D580B632F on shell_id 49B09D07-946C-484E-A0B7-E2F7DB30D5E2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c243fd5c0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2203, 5985=>55985, 5986=>55986}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3AD763EE-D39D-43FE-A508-3E1EF6547C0E
DEBUG winrmshell: [WinRM] Command created for hostname with id: A447EBCF-0534-43F1-B62F-47BBF06810DC
DEBUG winrmshell: [WinRM] creating command_id: A447EBCF-0534-43F1-B62F-47BBF06810DC on shell_id 3AD763EE-D39D-43FE-A508-3E1EF6547C0E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A447EBCF-0534-43F1-B62F-47BBF06810DC on shell_id 3AD763EE-D39D-43FE-A508-3E1EF6547C0E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24b7a618 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4EF5A0BA-CB33-4068-AEF9-F183B8EAF60F
DEBUG winrmshell: [WinRM] Command created for hostname with id: 6727CF32-60FA-4EF1-9025-2B66D0C56E99
DEBUG winrmshell: [WinRM] creating command_id: 6727CF32-60FA-4EF1-9025-2B66D0C56E99 on shell_id 4EF5A0BA-CB33-4068-AEF9-F183B8EAF60F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6727CF32-60FA-4EF1-9025-2B66D0C56E99 on shell_id 4EF5A0BA-CB33-4068-AEF9-F183B8EAF60F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2429ca28 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c248dca50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c248d6ce0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24777638 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3EBFB9E7-B918-443F-9958-8BDE401182DD
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 70E3D1EC-70D0-443E-8F26-2AA40D0CF1FC
DEBUG winrmshell: [WinRM] creating command_id: 70E3D1EC-70D0-443E-8F26-2AA40D0CF1FC on shell_id 3EBFB9E7-B918-443F-9958-8BDE401182DD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 70E3D1EC-70D0-443E-8F26-2AA40D0CF1FC on shell_id 3EBFB9E7-B918-443F-9958-8BDE401182DD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2457bb40 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c215b0870 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c215712b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24aca100 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8E7595E3-F7A7-40B0-A4AA-1C50BBA68D8C
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C21CA00E-DECD-4968-A520-1B2A2DCDB8DC
DEBUG winrmshell: [WinRM] creating command_id: C21CA00E-DECD-4968-A520-1B2A2DCDB8DC on shell_id 8E7595E3-F7A7-40B0-A4AA-1C50BBA68D8C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C21CA00E-DECD-4968-A520-1B2A2DCDB8DC on shell_id 8E7595E3-F7A7-40B0-A4AA-1C50BBA68D8C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2495ba80 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-i1f2q1.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237db008 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c237d8a38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c22ab38d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "e3e5749df85ade9654d14b2e182021e630867c3b" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-i1f2q1.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 87B82816-07E2-450C-BC52-8987D8379AE5
DEBUG winrmshell: [WinRM] creating command_id: 87B82816-07E2-450C-BC52-8987D8379AE5 on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 87B82816-07E2-450C-BC52-8987D8379AE5 on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","e3e5749df85ade9654d14b2e182021e630867c3b","88fd6f54ec04ca82ba71cbbb4612ad3b1579aa05","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-i1f2q1.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 267CF868-0CC9-424C-9A68-88C80174E558
DEBUG winrmshell: [WinRM] creating command_id: 267CF868-0CC9-424C-9A68-88C80174E558 on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 267CF868-0CC9-424C-9A68-88C80174E558 on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIHRoZSBHUE8gdGhhdCBkaXNhYmxlcyBXaW5kb3dzIERlZmVuZGVyIGFuZCBBTVNJCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbXBvcnRpbmcgdGhlIEdQTyB0byBkaXNhYmxlIFdpbmRvd3MgRGVmZW5kZXIuLi4iCkltcG9ydC1HUE8gLUJhY2t1cEdwb05hbWUgJ0Rpc2FibGUgV2luZG93cyBEZWZlbmRlcicgLVBhdGggImM6XHZhZ3JhbnRccmVzb3VyY2VzXEdQT1xkaXNhYmxlX3dpbmRvd3NfZGVmZW5kZXIiIC1UYXJnZXROYW1lICdEaXNhYmxlIFdpbmRvd3MgRGVmZW5kZXInIC1DcmVhdGVJZk5lZWRlZAoKJE9VID0gIm91PVdvcmtzdGF0aW9ucyxkYz13aW5kb21haW4sZGM9bG9jYWwiCiRnUExpbmtzID0gJG51bGwKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLUlkZW50aXR5ICRPVSAtUHJvcGVydGllcyBuYW1lLGRpc3Rpbmd1aXNoZWROYW1lLCBnUExpbmssIGdQT3B0aW9ucwokR1BPID0gR2V0LUdQTyAtTmFtZSAnRGlzYWJsZSBXaW5kb3dzIERlZmVuZGVyJwpJZiAoJGdQTGlua3MuTGlua2VkR3JvdXBQb2xpY3lPYmplY3RzIC1ub3Rjb250YWlucyAkZ3BvLnBhdGgpCnsKICBOZXctR1BMaW5rIC1OYW1lICdEaXNhYmxlIFdpbmRvd3MgRGVmZW5kZXInIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfQplbHNlCnsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGlzYWJsZSBXaW5kb3dzIERlZmVuZGVyIEdQTyB3YXMgYWxyZWFkeSBsaW5rZWQgYXQgJE9VLiBNb3ZpbmcgT24uIgp9CiRPVSA9ICJvdT1TZXJ2ZXJzLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSAkbnVsbAokZ1BMaW5rcyA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsZGlzdGluZ3Vpc2hlZE5hbWUsIGdQTGluaywgZ1BPcHRpb25zCiRHUE8gPSBHZXQtR1BPIC1OYW1lICdEaXNhYmxlIFdpbmRvd3MgRGVmZW5kZXInCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkKewogICAgTmV3LUdQTGluayAtTmFtZSAnRGlzYWJsZSBXaW5kb3dzIERlZmVuZGVyJyAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0KZWxzZQp7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERpc2FibGUgV2luZG93cyBEZWZlbmRlciBHUE8gd2FzIGFscmVhZHkgbGlua2VkIGF0ICRPVS4gTW92aW5nIE9uLiIKfQpncHVwZGF0ZSAvZm9yY2UK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 35B22CEA-D5E1-4DB1-8630-11CD59D1DA8A
DEBUG winrmshell: [WinRM] creating command_id: 35B22CEA-D5E1-4DB1-8630-11CD59D1DA8A on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 35B22CEA-D5E1-4DB1-8630-11CD59D1DA8A on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1C2DD938-A3C3-4B6D-A3A0-E49B5DB8703B
DEBUG winrmshell: [WinRM] creating command_id: 1C2DD938-A3C3-4B6D-A3A0-E49B5DB8703B on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1C2DD938-A3C3-4B6D-A3A0-E49B5DB8703B on shell_id 31713E04-0C63-4D42-A902-7543F1EB7E58
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-i1f2q1.ps1 to C:/tmp/vagrant-shell.ps1 (1.72 KB over 1 chunks) in (0m0.17s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.41s) stream_files: (0m0.17s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-disable-windows-defender-gpo.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-disable-windows-defender-gpo.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-disable-windows-defender-gpo.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24538868 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24533868 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24415148 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32309A28-E0BF-4097-9466-45670D66CD28
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 609CA287-4173-44A8-B5FD-9E4EF6FE77B8
DEBUG winrmshell: [WinRM] creating command_id: 609CA287-4173-44A8-B5FD-9E4EF6FE77B8 on shell_id 32309A28-E0BF-4097-9466-45670D66CD28
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:48] Importing the GPO to disable Windows Defender...
 INFO interface: detail:     dc: [14:48] Importing the GPO to disable Windows Defender...
    dc: [14:48] Importing the GPO to disable Windows Defender...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName      : Disable Windows Defender
 INFO interface: detail:     dc: DisplayName      : Disable Windows Defender
    dc: DisplayName      : Disable Windows Defender
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
 INFO interface: detail:     dc: Id               : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
    dc: Id               : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:48:33 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:48:33 PM
    dc: CreationTime     : 6/20/2022 2:48:33 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:48:33 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:48:33 PM
    dc: ModificationTime : 6/20/2022 2:48:33 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Disable Windows Defender
 INFO interface: detail:     dc: DisplayName   : Disable Windows Defender
    dc: DisplayName   : Disable Windows Defender
 INFO interface: detail: GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
 INFO interface: detail:     dc: GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
    dc: GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 6
 INFO interface: detail:     dc: Order         : 6
    dc: Order         : 6
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Disable Windows Defender
 INFO interface: detail:     dc: DisplayName   : Disable Windows Defender
    dc: DisplayName   : Disable Windows Defender
 INFO interface: detail: GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
 INFO interface: detail:     dc: GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
    dc: GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 6
 INFO interface: detail:     dc: Order         : 6
    dc: Order         : 6
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Updating policy...
 INFO interface: detail:     dc: Updating policy...
    dc: Updating policy...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Computer Policy update has completed successfully.
 INFO interface: detail:     dc: Computer Policy update has completed successfully.
    dc: Computer Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: User Policy update has completed successfully.
 INFO interface: detail:     dc: User Policy update has completed successfully.
    dc: User Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 609CA287-4173-44A8-B5FD-9E4EF6FE77B8 on shell_id 32309A28-E0BF-4097-9466-45670D66CD28
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242d4950 @data=[{:stdout=>"[14:48] Importing the GPO to disable Windows Defender...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName      : Disable Windows Defender\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:48:33 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:48:33 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Disable Windows Defender\r\n"}, {:stdout=>"GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 6\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Disable Windows Defender\r\n"}, {:stdout=>"GpoId         : 2f7ce3b6-58c2-4aa8-b600-216c239b49b2\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 6\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Updating policy...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Computer Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"User Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c249cf868 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c245520b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BD1812F7-64DF-4D06-BF46-BE1C79061EE9
DEBUG winrmshell: [WinRM] Command created for hostname with id: 19245053-3974-423F-9C78-A6DC55C9B994
DEBUG winrmshell: [WinRM] creating command_id: 19245053-3974-423F-9C78-A6DC55C9B994 on shell_id BD1812F7-64DF-4D06-BF46-BE1C79061EE9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 19245053-3974-423F-9C78-A6DC55C9B994 on shell_id BD1812F7-64DF-4D06-BF46-BE1C79061EE9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24146e80 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 677B9582-013B-41A4-AC83-3920C8244F6D
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1B173AAA-9631-4BE8-A172-BC99ACE844D1
DEBUG winrmshell: [WinRM] creating command_id: 1B173AAA-9631-4BE8-A172-BC99ACE844D1 on shell_id 677B9582-013B-41A4-AC83-3920C8244F6D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1B173AAA-9631-4BE8-A172-BC99ACE844D1 on shell_id 677B9582-013B-41A4-AC83-3920C8244F6D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c247a4f20 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B723CD91-59BA-4F04-B27B-3E28944CB156
DEBUG winrmshell: [WinRM] Command created for hostname with id: 856F7EAB-8015-4427-B214-1B962795042D
DEBUG winrmshell: [WinRM] creating command_id: 856F7EAB-8015-4427-B214-1B962795042D on shell_id B723CD91-59BA-4F04-B27B-3E28944CB156
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 856F7EAB-8015-4427-B214-1B962795042D on shell_id B723CD91-59BA-4F04-B27B-3E28944CB156
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c239e1e38 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243adc00 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243acd78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242aff38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 57BDC9C6-D281-423A-9A9D-6C993A08CB0B
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CDA25236-9DFA-41AC-B2E7-67BB8843457C
DEBUG winrmshell: [WinRM] creating command_id: CDA25236-9DFA-41AC-B2E7-67BB8843457C on shell_id 57BDC9C6-D281-423A-9A9D-6C993A08CB0B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CDA25236-9DFA-41AC-B2E7-67BB8843457C on shell_id 57BDC9C6-D281-423A-9A9D-6C993A08CB0B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2421c4b8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c247a45e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2479f700 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245a2510 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1AAD940E-775B-4ED4-BAD1-5C1B3E8A169D
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DB0E59B1-2FC6-4D46-AAC0-6E79DF796139
DEBUG winrmshell: [WinRM] creating command_id: DB0E59B1-2FC6-4D46-AAC0-6E79DF796139 on shell_id 1AAD940E-775B-4ED4-BAD1-5C1B3E8A169D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DB0E59B1-2FC6-4D46-AAC0-6E79DF796139 on shell_id 1AAD940E-775B-4ED4-BAD1-5C1B3E8A169D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24496860 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-19qba1o.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2497dab8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2497cc30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2488b8f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "d8af8aeffead267ef9aa45077125ae95ddd9a237" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-19qba1o.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4D4A0D54-A376-475B-9134-BB8D4ACCE8CA
DEBUG winrmshell: [WinRM] creating command_id: 4D4A0D54-A376-475B-9134-BB8D4ACCE8CA on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4D4A0D54-A376-475B-9134-BB8D4ACCE8CA on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","d8af8aeffead267ef9aa45077125ae95ddd9a237","e3e5749df85ade9654d14b2e182021e630867c3b","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-19qba1o.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0973CBDF-16A3-4D49-B6CE-94B6E363B39A
DEBUG winrmshell: [WinRM] creating command_id: 0973CBDF-16A3-4D49-B6CE-94B6E363B39A on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0973CBDF-16A3-4D49-B6CE-94B6E363B39A on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIHRoZSBHUE8gdGhhdCBkaXNhYmxlcyBXaW5kb3dzIERlZmVuZGVyIGFuZCBBTVNJCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbXBvcnRpbmcgdGhlIEdQTyB0byBzZXQgdGhlIFRhc2tiYXIgbGF5b3V0Li4uIgpJbXBvcnQtR1BPIC1CYWNrdXBHcG9OYW1lICdUYXNrYmFyIExheW91dCcgLVBhdGggImM6XHZhZ3JhbnRccmVzb3VyY2VzXEdQT1x0YXNrYmFyX2xheW91dCIgLVRhcmdldE5hbWUgJ1Rhc2tiYXIgTGF5b3V0JyAtQ3JlYXRlSWZOZWVkZWQKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDb3B5aW5nIGxheW91dCBmaWxlIHRvIFNZU1ZPTC4uLiIKQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1xHUE9cdGFza2Jhcl9sYXlvdXRcRGV0ZWN0aW9uTGFiTGF5b3V0LnhtbCIgImM6XFdpbmRvd3NcU1lTVk9MXGRvbWFpblxzY3JpcHRzXERldGVjdGlvbkxhYkxheW91dC54bWwiCgokT1UgPSAib3U9RG9tYWluIENvbnRyb2xsZXJzLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSAkbnVsbAokZ1BMaW5rcyA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsIGRpc3Rpbmd1aXNoZWROYW1lLCBnUExpbmssIGdQT3B0aW9ucwokR1BPID0gR2V0LUdQTyAtTmFtZSAnVGFza2JhciBMYXlvdXQnCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkgewogICAgTmV3LUdQTGluayAtTmFtZSAnVGFza2JhciBMYXlvdXQnIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfSBFbHNlIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBUYXNrYmFyIExheW91dCBHUE8gd2FzIGFscmVhZHkgbGlua2VkIGF0ICRPVS4gTW92aW5nIE9uLiIKfQoKJE9VID0gIm91PVdvcmtzdGF0aW9ucyxkYz13aW5kb21haW4sZGM9bG9jYWwiCiRnUExpbmtzID0gJG51bGwKJGdQTGlua3MgPSBHZXQtQURPcmdhbml6YXRpb25hbFVuaXQgLUlkZW50aXR5ICRPVSAtUHJvcGVydGllcyBuYW1lLCBkaXN0aW5ndWlzaGVkTmFtZSwgZ1BMaW5rLCBnUE9wdGlvbnMKJEdQTyA9IEdldC1HUE8gLU5hbWUgJ1Rhc2tiYXIgTGF5b3V0JwpJZiAoJGdQTGlua3MuTGlua2VkR3JvdXBQb2xpY3lPYmplY3RzIC1ub3Rjb250YWlucyAkZ3BvLnBhdGgpIHsKICAgIE5ldy1HUExpbmsgLU5hbWUgJ1Rhc2tiYXIgTGF5b3V0JyAtVGFyZ2V0ICRPVSAtRW5mb3JjZWQgeWVzCn0gRWxzZSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVGFza2JhciBMYXlvdXQgR1BPIHdhcyBhbHJlYWR5IGxpbmtlZCBhdCAkT1UuIE1vdmluZyBPbi4iCn0KCiRPVSA9ICJvdT1TZXJ2ZXJzLGRjPXdpbmRvbWFpbixkYz1sb2NhbCIKJGdQTGlua3MgPSAkbnVsbAokZ1BMaW5rcyA9IEdldC1BRE9yZ2FuaXphdGlvbmFsVW5pdCAtSWRlbnRpdHkgJE9VIC1Qcm9wZXJ0aWVzIG5hbWUsIGRpc3Rpbmd1aXNoZWROYW1lLCBnUExpbmssIGdQT3B0aW9ucwokR1BPID0gR2V0LUdQTyAtTmFtZSAnVGFza2JhciBMYXlvdXQnCklmICgkZ1BMaW5rcy5MaW5rZWRHcm91cFBvbGljeU9iamVjdHMgLW5vdGNvbnRhaW5zICRncG8ucGF0aCkgewogICAgTmV3LUdQTGluayAtTmFtZSAnVGFza2JhciBMYXlvdXQnIC1UYXJnZXQgJE9VIC1FbmZvcmNlZCB5ZXMKfSBFbHNlIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBUYXNrYmFyIExheW91dCBHUE8gd2FzIGFscmVhZHkgbGlua2VkIGF0ICRPVS4gTW92aW5nIE9uLiIKfQpncHVwZGF0ZSAvZm9yY2UK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 84E466AA-A8B2-4F4F-A9EB-EA7CAB4BF319
DEBUG winrmshell: [WinRM] creating command_id: 84E466AA-A8B2-4F4F-A9EB-EA7CAB4BF319 on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 84E466AA-A8B2-4F4F-A9EB-EA7CAB4BF319 on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7DFC5503-9F02-4DBC-AE24-5A5B3552C01C
DEBUG winrmshell: [WinRM] creating command_id: 7DFC5503-9F02-4DBC-AE24-5A5B3552C01C on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7DFC5503-9F02-4DBC-AE24-5A5B3552C01C on shell_id 6BCD43BF-0C3D-46FF-B067-D002100D7ECE
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-19qba1o.ps1 to C:/tmp/vagrant-shell.ps1 (2.5 KB over 1 chunks) in (0m0.20s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.43s) stream_files: (0m0.20s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-taskbar-layout-gpo.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/configure-taskbar-layout-gpo.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/configure-taskbar-layout-gpo.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241acaa0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241a7bb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240c7590 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1B9B3AA1-4E7C-41FC-86D3-E015F1A11548
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 89E5925B-EF39-4EB0-B201-610D205893D6
DEBUG winrmshell: [WinRM] creating command_id: 89E5925B-EF39-4EB0-B201-610D205893D6 on shell_id 1B9B3AA1-4E7C-41FC-86D3-E015F1A11548
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:48] Importing the GPO to set the Taskbar layout...
 INFO interface: detail:     dc: [14:48] Importing the GPO to set the Taskbar layout...
    dc: [14:48] Importing the GPO to set the Taskbar layout...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName      : Taskbar Layout
 INFO interface: detail:     dc: DisplayName      : Taskbar Layout
    dc: DisplayName      : Taskbar Layout
 INFO interface: detail: DomainName       : windomain.local
 INFO interface: detail:     dc: DomainName       : windomain.local
    dc: DomainName       : windomain.local
 INFO interface: detail: Owner            : WINDOMAIN\vagrant
 INFO interface: detail:     dc: Owner            : WINDOMAIN\vagrant
    dc: Owner            : WINDOMAIN\vagrant
 INFO interface: detail: Id               : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail:     dc: Id               : b0943197-d4f4-4821-9a33-1b615aad22aa
    dc: Id               : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail: GpoStatus        : AllSettingsEnabled
 INFO interface: detail:     dc: GpoStatus        : AllSettingsEnabled
    dc: GpoStatus        : AllSettingsEnabled
 INFO interface: detail: Description      :
 INFO interface: detail:     dc: Description      :
    dc: Description      :
 INFO interface: detail: CreationTime     : 6/20/2022 2:48:50 PM
 INFO interface: detail:     dc: CreationTime     : 6/20/2022 2:48:50 PM
    dc: CreationTime     : 6/20/2022 2:48:50 PM
 INFO interface: detail: ModificationTime : 6/20/2022 2:48:51 PM
 INFO interface: detail:     dc: ModificationTime : 6/20/2022 2:48:51 PM
    dc: ModificationTime : 6/20/2022 2:48:51 PM
 INFO interface: detail: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: UserVersion      : AD Version: 1, SysVol Version: 1
    dc: UserVersion      : AD Version: 1, SysVol Version: 1
 INFO interface: detail: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail:     dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
    dc: ComputerVersion  : AD Version: 1, SysVol Version: 1
 INFO interface: detail: WmiFilter        :
 INFO interface: detail:     dc: WmiFilter        :
    dc: WmiFilter        :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:48] Copying layout file to SYSVOL...
 INFO interface: detail:     dc: [14:48] Copying layout file to SYSVOL...
    dc: [14:48] Copying layout file to SYSVOL...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Taskbar Layout
 INFO interface: detail:     dc: DisplayName   : Taskbar Layout
    dc: DisplayName   : Taskbar Layout
 INFO interface: detail: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail:     dc: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
    dc: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 6
 INFO interface: detail:     dc: Order         : 6
    dc: Order         : 6
 INFO interface: detail: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
    dc: Target        : OU=Domain Controllers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Taskbar Layout
 INFO interface: detail:     dc: DisplayName   : Taskbar Layout
    dc: DisplayName   : Taskbar Layout
 INFO interface: detail: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail:     dc: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
    dc: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 7
 INFO interface: detail:     dc: Order         : 7
    dc: Order         : 7
 INFO interface: detail: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Workstations,DC=windomain,DC=local
    dc: Target        : OU=Workstations,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: DisplayName   : Taskbar Layout
 INFO interface: detail:     dc: DisplayName   : Taskbar Layout
    dc: DisplayName   : Taskbar Layout
 INFO interface: detail: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail:     dc: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
    dc: GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa
 INFO interface: detail: Enabled       : True
 INFO interface: detail:     dc: Enabled       : True
    dc: Enabled       : True
 INFO interface: detail: Enforced      : True
 INFO interface: detail:     dc: Enforced      : True
    dc: Enforced      : True
 INFO interface: detail: Order         : 7
 INFO interface: detail:     dc: Order         : 7
    dc: Order         : 7
 INFO interface: detail: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail:     dc: Target        : OU=Servers,DC=windomain,DC=local
    dc: Target        : OU=Servers,DC=windomain,DC=local
 INFO interface: detail: GpoDomainName : windomain.local
 INFO interface: detail:     dc: GpoDomainName : windomain.local
    dc: GpoDomainName : windomain.local
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Updating policy...
 INFO interface: detail:     dc: Updating policy...
    dc: Updating policy...
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Computer Policy update has completed successfully.
 INFO interface: detail:     dc: Computer Policy update has completed successfully.
    dc: Computer Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: User Policy update has completed successfully.
 INFO interface: detail:     dc: User Policy update has completed successfully.
    dc: User Policy update has completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 89E5925B-EF39-4EB0-B201-610D205893D6 on shell_id 1B9B3AA1-4E7C-41FC-86D3-E015F1A11548
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23999070 @data=[{:stdout=>"[14:48] Importing the GPO to set the Taskbar layout...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName      : Taskbar Layout\r\n"}, {:stdout=>"DomainName       : windomain.local\r\n"}, {:stdout=>"Owner            : WINDOMAIN\\vagrant\r\n"}, {:stdout=>"Id               : b0943197-d4f4-4821-9a33-1b615aad22aa\r\n"}, {:stdout=>"GpoStatus        : AllSettingsEnabled\r\n"}, {:stdout=>"Description      : \r\n"}, {:stdout=>"CreationTime     : 6/20/2022 2:48:50 PM\r\n"}, {:stdout=>"ModificationTime : 6/20/2022 2:48:51 PM\r\n"}, {:stdout=>"UserVersion      : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"ComputerVersion  : AD Version: 1, SysVol Version: 1\r\n"}, {:stdout=>"WmiFilter        : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:48] Copying layout file to SYSVOL...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Taskbar Layout\r\n"}, {:stdout=>"GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 6\r\n"}, {:stdout=>"Target        : OU=Domain Controllers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Taskbar Layout\r\n"}, {:stdout=>"GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 7\r\n"}, {:stdout=>"Target        : OU=Workstations,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"DisplayName   : Taskbar Layout\r\n"}, {:stdout=>"GpoId         : b0943197-d4f4-4821-9a33-1b615aad22aa\r\n"}, {:stdout=>"Enabled       : True\r\n"}, {:stdout=>"Enforced      : True\r\n"}, {:stdout=>"Order         : 7\r\n"}, {:stdout=>"Target        : OU=Servers,DC=windomain,DC=local\r\n"}, {:stdout=>"GpoDomainName : windomain.local\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Updating policy...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Computer Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"User Policy update has completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c245520b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c240a65e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6AC2CEE0-6C68-44D9-8297-915A550FF765
DEBUG winrmshell: [WinRM] Command created for hostname with id: 5AEF4F57-BAAF-4B10-A61C-F0EC5AE8F7EA
DEBUG winrmshell: [WinRM] creating command_id: 5AEF4F57-BAAF-4B10-A61C-F0EC5AE8F7EA on shell_id 6AC2CEE0-6C68-44D9-8297-915A550FF765
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5AEF4F57-BAAF-4B10-A61C-F0EC5AE8F7EA on shell_id 6AC2CEE0-6C68-44D9-8297-915A550FF765
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c249bed38 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 63643F93-4133-4AB3-8AB3-ED80320BA7F2
DEBUG winrmshell: [WinRM] Command created for hostname with id: AA4273DD-72F4-4A42-A252-CE3F6EEEE1C2
DEBUG winrmshell: [WinRM] creating command_id: AA4273DD-72F4-4A42-A252-CE3F6EEEE1C2 on shell_id 63643F93-4133-4AB3-8AB3-ED80320BA7F2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AA4273DD-72F4-4A42-A252-CE3F6EEEE1C2 on shell_id 63643F93-4133-4AB3-8AB3-ED80320BA7F2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2419e1a8 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 75332886-1644-44AA-B1EE-2F118966ED48
DEBUG winrmshell: [WinRM] Command created for hostname with id: 97F50669-8477-4DD5-93FD-AFFB41FFB514
DEBUG winrmshell: [WinRM] creating command_id: 97F50669-8477-4DD5-93FD-AFFB41FFB514 on shell_id 75332886-1644-44AA-B1EE-2F118966ED48
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 97F50669-8477-4DD5-93FD-AFFB41FFB514 on shell_id 75332886-1644-44AA-B1EE-2F118966ED48
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24825760 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c236c6a50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c236be6e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2261c830 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CA08250A-DD1E-4261-9035-7C6037AD0A4F
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8CA3B768-6669-41FB-9D48-7A265E60FF6E
DEBUG winrmshell: [WinRM] creating command_id: 8CA3B768-6669-41FB-9D48-7A265E60FF6E on shell_id CA08250A-DD1E-4261-9035-7C6037AD0A4F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8CA3B768-6669-41FB-9D48-7A265E60FF6E on shell_id CA08250A-DD1E-4261-9035-7C6037AD0A4F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24af0530 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24154f58 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2414f378 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24084560 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B25FF4A1-91D6-482B-BE40-35116904656B
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A7F45718-45C4-4C4F-9438-435958CE9E59
DEBUG winrmshell: [WinRM] creating command_id: A7F45718-45C4-4C4F-9438-435958CE9E59 on shell_id B25FF4A1-91D6-482B-BE40-35116904656B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A7F45718-45C4-4C4F-9438-435958CE9E59 on shell_id B25FF4A1-91D6-482B-BE40-35116904656B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c237af458 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1nyv73z.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242672d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24266130 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241d5f40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "04b00952985c8555d76eb259f2adab5966222b80" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1nyv73z.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 993DD383-614E-434D-A0A8-DB12BC47241B
DEBUG winrmshell: [WinRM] creating command_id: 993DD383-614E-434D-A0A8-DB12BC47241B on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 993DD383-614E-434D-A0A8-DB12BC47241B on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","04b00952985c8555d76eb259f2adab5966222b80","d8af8aeffead267ef9aa45077125ae95ddd9a237","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1nyv73z.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B24CFF2B-7164-49CA-AFCA-DC811E2E6153
DEBUG winrmshell: [WinRM] creating command_id: B24CFF2B-7164-49CA-AFCA-DC811E2E6153 on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B24CFF2B-7164-49CA-AFCA-DC811E2E6153 on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBBdXRvcnVuc1RvV2luRXZlbnRMb2cgZnJvbSB0aGUgUGFsYW50aXIgV0VGIHJlcG86IChodHRwczovL2dpdGh1Yi5jb20vcGFsYW50aXIvd2luZG93cy1ldmVudC1mb3J3YXJkaW5nL3RyZWUvbWFzdGVyL0F1dG9ydW5zVG9XaW5FdmVudExvZykKIyBUTDtEUiAtIExvZ3MgYWxsIGVudHJpZXMgZnJvbSBBdXRvcnVucyB0byB0aGUgV2luZG93cyBldmVudCBsb2cgdG8gYmUgaW5kZXhlZCBieSBTcGx1bmsKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQXV0b3J1bnNUb1dpbkV2ZW50TG9nLi4uIgpJZiAoKEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIiAtZWEgc2lsZW50KSAtZXEgJG51bGwpCnsKICAgICMgTW9kaWZ5IHRoZSBpbnN0YWxsZXIgdG8gYWRkIGFuIEhUVFAgZmFsbGJhY2sgdW50aWwgdGhpcyBnZXRzIGZpeGVkIHVwc3RyZWFtIGluIHRoZSB3aW5kb3dzLWV2ZW50LWZvd2FyZGluZyByZXBvCiAgICAjIFNlZSBodHRwczovL2dpdGh1Yi5jb20vY2xvbmcvRGV0ZWN0aW9uTGFiL2lzc3Vlcy81OTcKICAgIChHZXQtQ29udGVudCBjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3aW5kb3dzLWV2ZW50LWZvcndhcmRpbmctbWFzdGVyXEF1dG9ydW5zVG9XaW5FdmVudExvZ1xJbnN0YWxsLnBzMSAtUmF3KSAtcmVwbGFjZSAnSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vYXV0b3J1bnNjNjQuZXhlIiAtT3V0RmlsZSAiXCRhdXRvcnVuc1BhdGgiJywgJ1RyeSB7CiAgICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCcnaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vQXV0b3J1bnM2NC5leGUnJywgJGF1dG9ydW5zUGF0aCkKICB9IENhdGNoIHsKICAgIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAgIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJydodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL0F1dG9ydW5zNjQuZXhlJycsICRhdXRvcnVuc1BhdGgpCiAgfScgfCBTZXQtQ29udGVudCAtUGF0aCAiYzpcVXNlcnNcdmFncmFudFxBcHBEYXRhXExvY2FsXFRlbXBcd2luZG93cy1ldmVudC1mb3J3YXJkaW5nLW1hc3RlclxBdXRvcnVuc1RvV2luRXZlbnRMb2dcSW5zdGFsbC5wczEiCiAgICAuIGM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHdpbmRvd3MtZXZlbnQtZm9yd2FyZGluZy1tYXN0ZXJcQXV0b3J1bnNUb1dpbkV2ZW50TG9nXEluc3RhbGwucHMxCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQXV0b3J1bnNUb1dpbkV2ZW50TG9nIGluc3RhbGxlZC4gU3RhcnRpbmcgdGhlIHNjaGVkdWxlZCB0YXNrLiBGdXR1cmUgcnVucyB3aWxsIGJlZ2luIGF0IDExYW0iCiAgICBTdGFydC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIgogICAgIyBodHRwczovL21jcG1hZy5jb20vYXJ0aWNsZXMvMjAxOC8wMy8xNi93YWl0LWFjdGlvbi1mdW5jdGlvbi1wb3dlcnNoZWxsLmFzcHgKICAgICMgV2FpdCAzMCBzZWNvbmRzIGZvciB0aGUgc2NoZWR1bGVkIHRhc2sgdG8gZW50ZXIgdGhlICJSdW5uaW5nIiBzdGF0ZQogICAgJFRpbWVvdXQgPSAzMAogICAgJHRpbWVyID0gW0RpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkKICAgIHdoaWxlICgoJHRpbWVyLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1sdCAkVGltZW91dCkgLWFuZCAoKEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIikuU3RhdGUgLW5lICJSdW5uaW5nIikpIHsKICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAzCiAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFN0aWxsIHdhaXRpbmcgZm9yIHNjaGVkdWxlZCB0YXNrIHRvIHN0YXJ0IGFmdGVyICIkdGltZXIuRWxhcHNlZC5TZWNvbmRzIiBzZWNvbmRzLi4uIgogICAgfQogICAgJHRpbWVyLlN0b3AoKQogICAgJFRzayA9IEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIgogICAgaWYgKCRUc2suU3RhdGUgLW5lICJSdW5uaW5nIikKICAgIHsKICAgICAgICB0aHJvdyAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIHNjaGVkdWxlZCB0YXNrcyB3YXNuJ3QgcnVubmluZyBhZnRlciBzdGFydGluZyBpdCIKICAgIH0KfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBBdXRvcnVuc1RvV2luRXZlbnRMb2cgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2EBBAB4B-CF5A-4D67-AD68-C67F51015960
DEBUG winrmshell: [WinRM] creating command_id: 2EBBAB4B-CF5A-4D67-AD68-C67F51015960 on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2EBBAB4B-CF5A-4D67-AD68-C67F51015960 on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9DF6710A-43A9-4CD1-AFEE-7F4F5983F979
DEBUG winrmshell: [WinRM] creating command_id: 9DF6710A-43A9-4CD1-AFEE-7F4F5983F979 on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9DF6710A-43A9-4CD1-AFEE-7F4F5983F979 on shell_id 943718A1-3BD7-4234-8727-AC3813794537
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1nyv73z.ps1 to C:/tmp/vagrant-shell.ps1 (3.24 KB over 1 chunks) in (0m0.25s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.68s) stream_files: (0m0.25s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     dc: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
    dc: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249bc880 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249b79c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c248be848 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4847DD8A-D640-4A89-B7A4-F7D6B142DFC2
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7CF4FCB8-B35A-4B7B-862F-4A9109F4321E
DEBUG winrmshell: [WinRM] creating command_id: 7CF4FCB8-B35A-4B7B-862F-4A9109F4321E on shell_id 4847DD8A-D640-4A89-B7A4-F7D6B142DFC2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [14:49] Installing AutorunsToWinEventLog...
 INFO interface: detail:     dc: [14:49] Installing AutorunsToWinEventLog...
    dc: [14:49] Installing AutorunsToWinEventLog...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail:     Directory: C:\Program Files
 INFO interface: detail:     dc:     Directory: C:\Program Files
    dc:     Directory: C:\Program Files
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     dc: Mode                LastWriteTime         Length Name
    dc: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     dc: ----                -------------         ------ ----
    dc: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/20/2022   2:49 PM                AutorunsToWinEventLog
 INFO interface: detail:     dc: d-----        6/20/2022   2:49 PM                AutorunsToWinEventLog
    dc: d-----        6/20/2022   2:49 PM                AutorunsToWinEventLog
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail:     dc: Actions            : {MSFT_TaskExecAction}
    dc: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail: Author             :
 INFO interface: detail:     dc: Author             :
    dc: Author             :
 INFO interface: detail: Date               :
 INFO interface: detail:     dc: Date               :
    dc: Date               :
 INFO interface: detail: Description        :
 INFO interface: detail:     dc: Description        :
    dc: Description        :
 INFO interface: detail: Documentation      :
 INFO interface: detail:     dc: Documentation      :
    dc: Documentation      :
 INFO interface: detail: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail:     dc: Principal          : MSFT_TaskPrincipal2
    dc: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail: SecurityDescriptor :
 INFO interface: detail:     dc: SecurityDescriptor :
    dc: SecurityDescriptor :
 INFO interface: detail: Settings           : MSFT_TaskSettings3
 INFO interface: detail:     dc: Settings           : MSFT_TaskSettings3
    dc: Settings           : MSFT_TaskSettings3
 INFO interface: detail: Source             :
 INFO interface: detail:     dc: Source             :
    dc: Source             :
 INFO interface: detail: State              : Ready
 INFO interface: detail:     dc: State              : Ready
    dc: State              : Ready
 INFO interface: detail: TaskName           : AutorunsToWinEventLog
 INFO interface: detail:     dc: TaskName           : AutorunsToWinEventLog
    dc: TaskName           : AutorunsToWinEventLog
 INFO interface: detail: TaskPath           : \
 INFO interface: detail:     dc: TaskPath           : \
    dc: TaskPath           : \
 INFO interface: detail: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail:     dc: Triggers           : {MSFT_TaskDailyTrigger}
    dc: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail: URI                : \AutorunsToWinEventLog
 INFO interface: detail:     dc: URI                : \AutorunsToWinEventLog
    dc: URI                : \AutorunsToWinEventLog
 INFO interface: detail: Version            :
 INFO interface: detail:     dc: Version            :
    dc: Version            :
 INFO interface: detail: PSComputerName     :
 INFO interface: detail:     dc: PSComputerName     :
    dc: PSComputerName     :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail:     dc: Actions            : {MSFT_TaskExecAction}
    dc: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail: Author             :
 INFO interface: detail:     dc: Author             :
    dc: Author             :
 INFO interface: detail: Date               :
 INFO interface: detail:     dc: Date               :
    dc: Date               :
 INFO interface: detail: Description        :
 INFO interface: detail:     dc: Description        :
    dc: Description        :
 INFO interface: detail: Documentation      :
 INFO interface: detail:     dc: Documentation      :
    dc: Documentation      :
 INFO interface: detail: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail:     dc: Principal          : MSFT_TaskPrincipal2
    dc: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail: SecurityDescriptor :
 INFO interface: detail:     dc: SecurityDescriptor :
    dc: SecurityDescriptor :
 INFO interface: detail: Settings           : MSFT_TaskSettings3
 INFO interface: detail:     dc: Settings           : MSFT_TaskSettings3
    dc: Settings           : MSFT_TaskSettings3
 INFO interface: detail: Source             :
 INFO interface: detail:     dc: Source             :
    dc: Source             :
 INFO interface: detail: State              : Ready
 INFO interface: detail:     dc: State              : Ready
    dc: State              : Ready
 INFO interface: detail: TaskName           : AutorunsToWinEventLog
 INFO interface: detail:     dc: TaskName           : AutorunsToWinEventLog
    dc: TaskName           : AutorunsToWinEventLog
 INFO interface: detail: TaskPath           : \
 INFO interface: detail:     dc: TaskPath           : \
    dc: TaskPath           : \
 INFO interface: detail: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail:     dc: Triggers           : {MSFT_TaskDailyTrigger}
    dc: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail: URI                : \AutorunsToWinEventLog
 INFO interface: detail:     dc: URI                : \AutorunsToWinEventLog
    dc: URI                : \AutorunsToWinEventLog
 INFO interface: detail: Version            :
 INFO interface: detail:     dc: Version            :
    dc: Version            :
 INFO interface: detail: PSComputerName     :
 INFO interface: detail:     dc: PSComputerName     :
    dc: PSComputerName     :
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: [14:49] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
 INFO interface: detail:     dc: [14:49] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
    dc: [14:49] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
 INFO interface: detail: 
 INFO interface: detail:     dc: 
    dc: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7CF4FCB8-B35A-4B7B-862F-4A9109F4321E on shell_id 4847DD8A-D640-4A89-B7A4-F7D6B142DFC2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2474d2c0 @data=[{:stdout=>"[14:49] Installing AutorunsToWinEventLog...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Program Files\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/20/2022   2:49 PM                AutorunsToWinEventLog                            \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Actions            : {MSFT_TaskExecAction}\r\n"}, {:stdout=>"Author             : \r\n"}, {:stdout=>"Date               : \r\n"}, {:stdout=>"Description        : \r\n"}, {:stdout=>"Documentation      : \r\n"}, {:stdout=>"Principal          : MSFT_TaskPrincipal2\r\n"}, {:stdout=>"SecurityDescriptor : \r\n"}, {:stdout=>"Settings           : MSFT_TaskSettings3\r\n"}, {:stdout=>"Source             : \r\n"}, {:stdout=>"State              : Ready\r\n"}, {:stdout=>"TaskName           : AutorunsToWinEventLog\r\n"}, {:stdout=>"TaskPath           : \\\r\n"}, {:stdout=>"Triggers           : {MSFT_TaskDailyTrigger}\r\n"}, {:stdout=>"URI                : \\AutorunsToWinEventLog\r\n"}, {:stdout=>"Version            : \r\n"}, {:stdout=>"PSComputerName     : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Actions            : {MSFT_TaskExecAction}\r\n"}, {:stdout=>"Author             : \r\n"}, {:stdout=>"Date               : \r\n"}, {:stdout=>"Description        : \r\n"}, {:stdout=>"Documentation      : \r\n"}, {:stdout=>"Principal          : MSFT_TaskPrincipal2\r\n"}, {:stdout=>"SecurityDescriptor : \r\n"}, {:stdout=>"Settings           : MSFT_TaskSettings3\r\n"}, {:stdout=>"Source             : \r\n"}, {:stdout=>"State              : Ready\r\n"}, {:stdout=>"TaskName           : AutorunsToWinEventLog\r\n"}, {:stdout=>"TaskPath           : \\\r\n"}, {:stdout=>"Triggers           : {MSFT_TaskDailyTrigger}\r\n"}, {:stdout=>"URI                : \\AutorunsToWinEventLog\r\n"}, {:stdout=>"Version            : \r\n"}, {:stdout=>"PSComputerName     : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[14:49] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c240a65e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c245bb588 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32ABF53C-1250-49C5-B330-DA9DF5BC1AB7
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4A063C86-15AC-4208-8433-7A4F5B7BC6FE
DEBUG winrmshell: [WinRM] creating command_id: 4A063C86-15AC-4208-8433-7A4F5B7BC6FE on shell_id 32ABF53C-1250-49C5-B330-DA9DF5BC1AB7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4A063C86-15AC-4208-8433-7A4F5B7BC6FE on shell_id 32ABF53C-1250-49C5-B330-DA9DF5BC1AB7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241a42b0 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32971B50-3C47-476A-942D-87B4F430B38A
DEBUG winrmshell: [WinRM] Command created for hostname with id: D338242A-BA97-4755-B177-17FFD82090CD
DEBUG winrmshell: [WinRM] creating command_id: D338242A-BA97-4755-B177-17FFD82090CD on shell_id 32971B50-3C47-476A-942D-87B4F430B38A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D338242A-BA97-4755-B177-17FFD82090CD on shell_id 32971B50-3C47-476A-942D-87B4F430B38A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2481d510 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7385775F-C950-4612-A9E0-6D625A9010D2
DEBUG winrmshell: [WinRM] Command created for hostname with id: A846AE4C-5FF9-4A19-B595-F5ED42C0067E
DEBUG winrmshell: [WinRM] creating command_id: A846AE4C-5FF9-4A19-B595-F5ED42C0067E on shell_id 7385775F-C950-4612-A9E0-6D625A9010D2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A846AE4C-5FF9-4A19-B595-F5ED42C0067E on shell_id 7385775F-C950-4612-A9E0-6D625A9010D2
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c23a33120 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243a5cf8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c243a4ad8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242a5c68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 743C8ABF-C14E-499E-8C95-0DB22453A485
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 495FE816-BEF5-4A4C-A14A-3F1BA73401DB
DEBUG winrmshell: [WinRM] creating command_id: 495FE816-BEF5-4A4C-A14A-3F1BA73401DB on shell_id 743C8ABF-C14E-499E-8C95-0DB22453A485
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 495FE816-BEF5-4A4C-A14A-3F1BA73401DB on shell_id 743C8ABF-C14E-499E-8C95-0DB22453A485
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24207478 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24746c18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c247448f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c245511d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 65AB84CF-0DD0-41B9-BE91-564624FC3D15
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7862A754-04A7-43CE-815D-F35847A63E73
DEBUG winrmshell: [WinRM] creating command_id: 7862A754-04A7-43CE-815D-F35847A63E73 on shell_id 65AB84CF-0DD0-41B9-BE91-564624FC3D15
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7862A754-04A7-43CE-815D-F35847A63E73 on shell_id 65AB84CF-0DD0-41B9-BE91-564624FC3D15
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2441f0a8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-ap6nhz to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2491a990 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24919ab8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2481c8e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "af4aaea595b5271e1593adca5253b0b12d4b3df3" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-ap6nhz";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 13B0D79C-7A8B-4655-9F41-E11C20C53929
DEBUG winrmshell: [WinRM] creating command_id: 13B0D79C-7A8B-4655-9F41-E11C20C53929 on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 13B0D79C-7A8B-4655-9F41-E11C20C53929 on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","af4aaea595b5271e1593adca5253b0b12d4b3df3","04b00952985c8555d76eb259f2adab5966222b80","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-ap6nhz to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7E732F8B-8E08-4928-B184-DB5A70483075
DEBUG winrmshell: [WinRM] creating command_id: 7E732F8B-8E08-4928-B184-DB5A70483075 on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7E732F8B-8E08-4928-B184-DB5A70483075 on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('d2V2dHV0aWwgZWwgfCBTZWxlY3QtU3RyaW5nIC1ub3RtYXRjaCAiTWljcm9zb2Z0LVdpbmRvd3MtTGl2ZUlkIiB8IEZvcmVhY2gtT2JqZWN0IHt3ZXZ0dXRpbCBjbCAiJF8ifQ==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4F22EF88-3B36-4885-97C9-FE81EC37796E
DEBUG winrmshell: [WinRM] creating command_id: 4F22EF88-3B36-4885-97C9-FE81EC37796E on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4F22EF88-3B36-4885-97C9-FE81EC37796E on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D746ADBB-6DA7-45CB-B621-6051B956BF75
DEBUG winrmshell: [WinRM] creating command_id: D746ADBB-6DA7-45CB-B621-6051B956BF75 on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D746ADBB-6DA7-45CB-B621-6051B956BF75 on shell_id 6C8499F6-DE2C-4E35-AF95-208ED014EDDE
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-ap6nhz to C:/tmp/vagrant-shell.ps1 (0.132 KB over 1 chunks) in (0m0.21s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.43s) stream_files: (0m0.21s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     dc: Running: inline PowerShell script
    dc: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240f4ab8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c240eed48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c23a8bcf8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 0D682E82-F15C-4FD6-A656-62E392871E0F
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2D76B79B-C681-490D-961D-627F9BC4F728
DEBUG winrmshell: [WinRM] creating command_id: 2D76B79B-C681-490D-961D-627F9BC4F728 on shell_id 0D682E82-F15C-4FD6-A656-62E392871E0F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2D76B79B-C681-490D-961D-627F9BC4F728 on shell_id 0D682E82-F15C-4FD6-A656-62E392871E0F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2370d2e8 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c245bb588 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c2496d370 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AAEB76F2-D739-4503-98A8-52867052856B
DEBUG winrmshell: [WinRM] Command created for hostname with id: 195A3B99-D56E-436C-85A6-D8C622559F11
DEBUG winrmshell: [WinRM] creating command_id: 195A3B99-D56E-436C-85A6-D8C622559F11 on shell_id AAEB76F2-D739-4503-98A8-52867052856B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 195A3B99-D56E-436C-85A6-D8C622559F11 on shell_id AAEB76F2-D739-4503-98A8-52867052856B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2433d518 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5986=>2202, 22=>2203, 5985=>55985}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D0AF3133-CF1A-49D9-99BD-8C043406D5D9
DEBUG winrmshell: [WinRM] Command created for hostname with id: 986257DF-0D5D-4876-A231-52A7E471A6BA
DEBUG winrmshell: [WinRM] creating command_id: 986257DF-0D5D-4876-A231-52A7E471A6BA on shell_id D0AF3133-CF1A-49D9-99BD-8C043406D5D9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 986257DF-0D5D-4876-A231-52A7E471A6BA on shell_id D0AF3133-CF1A-49D9-99BD-8C043406D5D9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24ad9010 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>55985, 5986=>55986, 22=>2200}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8559AD27-086A-4D82-9BB7-9150C24B1FCF
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4C47972C-17A9-426F-B10C-B4F0D3BC0D57
DEBUG winrmshell: [WinRM] creating command_id: 4C47972C-17A9-426F-B10C-B4F0D3BC0D57 on shell_id 8559AD27-086A-4D82-9BB7-9150C24B1FCF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4C47972C-17A9-426F-B10C-B4F0D3BC0D57 on shell_id 8559AD27-086A-4D82-9BB7-9150C24B1FCF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24207540 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2471f4b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2471d7a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24540b58 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DCF943F6-F68D-4EB2-AF5C-CED757CC204E
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8EBA2D36-3D5E-4DD3-9F35-C5C21DED6B29
DEBUG winrmshell: [WinRM] creating command_id: 8EBA2D36-3D5E-4DD3-9F35-C5C21DED6B29 on shell_id DCF943F6-F68D-4EB2-AF5C-CED757CC204E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8EBA2D36-3D5E-4DD3-9F35-C5C21DED6B29 on shell_id DCF943F6-F68D-4EB2-AF5C-CED757CC204E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2440d7e0 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249c4f08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249c4080 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c248cdb90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 660DC3F7-8383-45F7-9727-1B817E2BFAFC
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: EAB870BD-DF16-495D-A8A4-1DB0F9AFF9D5
DEBUG winrmshell: [WinRM] creating command_id: EAB870BD-DF16-495D-A8A4-1DB0F9AFF9D5 on shell_id 660DC3F7-8383-45F7-9727-1B817E2BFAFC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EAB870BD-DF16-495D-A8A4-1DB0F9AFF9D5 on shell_id 660DC3F7-8383-45F7-9727-1B817E2BFAFC
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c2475c090 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1jenjh to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b4c2b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b473f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24a0f030 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "f8e57c707a5489b2bd0a0b1e5c2beddb083153ed" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-1jenjh";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0E58976B-2AC8-4995-B8C3-9117B319B079
DEBUG winrmshell: [WinRM] creating command_id: 0E58976B-2AC8-4995-B8C3-9117B319B079 on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0E58976B-2AC8-4995-B8C3-9117B319B079 on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","f8e57c707a5489b2bd0a0b1e5c2beddb083153ed","af4aaea595b5271e1593adca5253b0b12d4b3df3","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1jenjh to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BC28A738-C833-43B6-8A6C-EBDBEC735854
DEBUG winrmshell: [WinRM] creating command_id: BC28A738-C833-43B6-8A6C-EBDBEC735854 on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BC28A738-C833-43B6-8A6C-EBDBEC735854 on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('U2V0LVNtYlNlcnZlckNvbmZpZ3VyYXRpb24gLUF1ZGl0U21iMUFjY2VzcyAkdHJ1ZSAtRm9yY2U=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 01E50B8E-6AE6-4171-802E-47A7F7DE3381
DEBUG winrmshell: [WinRM] creating command_id: 01E50B8E-6AE6-4171-802E-47A7F7DE3381 on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 01E50B8E-6AE6-4171-802E-47A7F7DE3381 on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 57AB913F-9E38-4C09-913C-30DB1949159D
DEBUG winrmshell: [WinRM] creating command_id: 57AB913F-9E38-4C09-913C-30DB1949159D on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 57AB913F-9E38-4C09-913C-30DB1949159D on shell_id 13CE45D2-0375-419F-9B32-935D4787770C
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-1jenjh to C:/tmp/vagrant-shell.ps1 (0.072 KB over 1 chunks) in (0m0.18s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.42s) stream_files: (0m0.18s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     dc: Running: inline PowerShell script
    dc: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242457c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242448c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c241af160 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F9135B6E-EE9C-477C-B2D7-437E4F5D0B1C
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C758E1E6-8195-4D74-BCD3-A35499FA7AFB
DEBUG winrmshell: [WinRM] creating command_id: C758E1E6-8195-4D74-BCD3-A35499FA7AFB on shell_id F9135B6E-EE9C-477C-B2D7-437E4F5D0B1C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C758E1E6-8195-4D74-BCD3-A35499FA7AFB on shell_id F9135B6E-EE9C-477C-B2D7-437E4F5D0B1C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c240bf5c0 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2496d370 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> dc: Running provisioner: shell...
==> dc: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000027c24b54800 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F1AEE798-22C7-4466-9C86-47E0C04355A4
DEBUG winrmshell: [WinRM] Command created for hostname with id: FA9D6240-03A4-48E0-B8FA-7DC770F44F53
DEBUG winrmshell: [WinRM] creating command_id: FA9D6240-03A4-48E0-B8FA-7DC770F44F53 on shell_id F1AEE798-22C7-4466-9C86-47E0C04355A4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FA9D6240-03A4-48E0-B8FA-7DC770F44F53 on shell_id F1AEE798-22C7-4466-9C86-47E0C04355A4
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24540950 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{22=>2200, 5985=>2201, 5986=>2202}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9615460D-A862-403B-8940-C8E57ABF95ED
DEBUG winrmshell: [WinRM] Command created for hostname with id: 16090386-93CF-4F89-AF2D-6C2E9CDB6E4E
DEBUG winrmshell: [WinRM] creating command_id: 16090386-93CF-4F89-AF2D-6C2E9CDB6E4E on shell_id 9615460D-A862-403B-8940-C8E57ABF95ED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 16090386-93CF-4F89-AF2D-6C2E9CDB6E4E on shell_id 9615460D-A862-403B-8940-C8E57ABF95ED
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c22a39f08 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = dc.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 3072
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 6b b8 79 c2 d0
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - uuid.location = 56 4d ea 7b b8 79 c2 d1-c1 b3 6d 19 4a a1 2f 14
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = 6286996480328961601
DEBUG vmware_driver:   - vm.genidx = 3171757620272964659
DEBUG vmware_driver:   - vmci0.id = 1861462628
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:a1:2f:14
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:a1:2f:1e
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:a1:2f:14
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:a1:2f:14' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:a1:2f:14 RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.129: {:tcp=>{5985=>2201, 5986=>2202, 22=>2203}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: dc (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2201
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: plaintext
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7AC3CD55-FFF9-416D-B89D-102ABB97681E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 16BA893E-1101-40AF-AC83-CCD70132754A
DEBUG winrmshell: [WinRM] creating command_id: 16BA893E-1101-40AF-AC83-CCD70132754A on shell_id 7AC3CD55-FFF9-416D-B89D-102ABB97681E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 16BA893E-1101-40AF-AC83-CCD70132754A on shell_id 7AC3CD55-FFF9-416D-B89D-102ABB97681E
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c242f5790 @data=[{:stdout=>"dc"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24911458 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c249105d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c247e2190 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8242AB5B-38B5-48A2-AFFD-BD5165D504A0
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: FBF1273D-8B43-4B63-BA0A-4D48EA8AEE91
DEBUG winrmshell: [WinRM] creating command_id: FBF1273D-8B43-4B63-BA0A-4D48EA8AEE91 on shell_id 8242AB5B-38B5-48A2-AFFD-BD5165D504A0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FBF1273D-8B43-4B63-BA0A-4D48EA8AEE91 on shell_id 8242AB5B-38B5-48A2-AFFD-BD5165D504A0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c245a3b18 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b4f3a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24b4e518 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c24a858c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 07F240E4-6474-43E9-9A6B-6710D10CF0A6
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 24732CF4-3BEF-4118-AD76-9854DB726C5B
DEBUG winrmshell: [WinRM] creating command_id: 24732CF4-3BEF-4118-AD76-9854DB726C5B on shell_id 07F240E4-6474-43E9-9A6B-6710D10CF0A6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 24732CF4-3BEF-4118-AD76-9854DB726C5B on shell_id 07F240E4-6474-43E9-9A6B-6710D10CF0A6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c24919f68 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-137k4b6 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2363dfe8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2363c2d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c2149ae90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "7965a97dba84ae35513ec6983a7d5dec9fcbe56e" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220620-572-137k4b6";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0DADA847-2A03-4DF1-A313-C40EACD4BA8F
DEBUG winrmshell: [WinRM] creating command_id: 0DADA847-2A03-4DF1-A313-C40EACD4BA8F on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0DADA847-2A03-4DF1-A313-C40EACD4BA8F on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","7965a97dba84ae35513ec6983a7d5dec9fcbe56e","f8e57c707a5489b2bd0a0b1e5c2beddb083153ed","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-137k4b6 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8449512D-C9C0-43DC-B766-1E856D1FFFB0
DEBUG winrmshell: [WinRM] creating command_id: 8449512D-C9C0-43DC-B766-1E856D1FFFB0 on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8449512D-C9C0-43DC-B766-1E856D1FFFB0 on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('V3JpdGUtSG9zdCAnREMgUHJvdmlzaW9uaW5nIENvbXBsZXRlISc=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6AE45970-49B9-461A-98A1-96EAC74E54E6
DEBUG winrmshell: [WinRM] creating command_id: 6AE45970-49B9-461A-98A1-96EAC74E54E6 on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6AE45970-49B9-461A-98A1-96EAC74E54E6 on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5E3D6B05-83E0-4C27-9289-A3AEC4C647A0
DEBUG winrmshell: [WinRM] creating command_id: 5E3D6B05-83E0-4C27-9289-A3AEC4C647A0 on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5E3D6B05-83E0-4C27-9289-A3AEC4C647A0 on shell_id F2AC3D4F-8FC9-47CB-AE65-40B3A47C4BB6
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220620-572-137k4b6 to C:/tmp/vagrant-shell.ps1 (0.048 KB over 1 chunks) in (0m0.18s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.42s) stream_files: (0m0.18s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     dc: Running: inline PowerShell script
    dc: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2201/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242f60f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242f42f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000027c242641f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B030E809-F538-4D55-ADC1-2A67CC70CE25
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B481776D-7357-4A13-BE1C-1F3E9963D58A
DEBUG winrmshell: [WinRM] creating command_id: B481776D-7357-4A13-BE1C-1F3E9963D58A on shell_id B030E809-F538-4D55-ADC1-2A67CC70CE25
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: DC Provisioning Complete!
 INFO interface: detail:     dc: DC Provisioning Complete!
    dc: DC Provisioning Complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B481776D-7357-4A13-BE1C-1F3E9963D58A on shell_id B030E809-F538-4D55-ADC1-2A67CC70CE25
DEBUG winrmshell: Output: #<WinRM::Output:0x0000027c241c5050 @data=[{:stdout=>"DC Provisioning Complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c24b54800 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Provision:0x0000027c23960cc0>
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c23b615b0>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c23b615b0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c23b616f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c23a223e8>
 INFO warden: Calling OUT action: VMware Middleware: PruneForwardedPorts
 INFO warden: Calling OUT action: VMware Middleware: CheckExistingNetwork
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2381e560>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c2381e560>
 INFO warden: Calling OUT action: #<Proc:0x0000027c2381e5b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c23ba19f8>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000027c21eabfb0>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: VMware Middleware: SetDisplayName
 INFO warden: Calling OUT action: VMware Middleware: Import
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::PrepareClone:0x0000027c23b10688>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleBox:0x0000027c23afb210>
 INFO warden: Calling IN action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c215413d0>
DEBUG storeboxmetadata: Writing box metadata file to D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/dc/vmware_desktop/box_meta
 INFO warden: Calling OUT action: #<VagrantPlugins::CommandUp::StoreBoxMetadata:0x0000027c215413d0>
 INFO warden: Calling OUT action: #<Proc:0x0000027c21541448 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000027c21c847f0>
 INFO warden: Calling OUT action: VMware Middleware: CheckVMware
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000027c225b40f0>
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO interface: Machine: action ["up", "end", {:target=>:dc}]
 INFO environment: Released process lock: machine-action-72e3d0cc61eeeff22d74ebfe7711adc4
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Running hook: environment_unload
 INFO runner: Running action: environment_unload #<Vagrant::Action::Builder:0x0000027c225acaa8>
