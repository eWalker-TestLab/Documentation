 INFO global: Vagrant version: 2.2.19
 INFO global: Ruby version: 2.7.4
 INFO global: RubyGems version: 3.1.6
 INFO global: VAGRANT_EXECUTABLE="C:\\Program_Files\\HashiCorp\\Vagrant\\embedded\\gems\\2.2.19\\gems\\vagrant-2.2.19\\bin\\vagrant"
 INFO global: VAGRANT_INSTALLER_EMBEDDED_DIR="C:\\Program_Files\\HashiCorp\\Vagrant\\embedded"
 INFO global: VAGRANT_INSTALLER_ENV="1"
 INFO global: VAGRANT_INSTALLER_VERSION="2"
 INFO global: VAGRANT_LOG="debug"
 WARN global: resolv replacement has not been enabled!
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/autocomplete/plugin.rb
 INFO manager: Registered plugin: autocomplete command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/box/plugin.rb
 INFO manager: Registered plugin: box command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/cap/plugin.rb
 INFO manager: Registered plugin: cap command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/cloud/plugin.rb
 INFO manager: Registered plugin: vagrant-cloud
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/destroy/plugin.rb
 INFO manager: Registered plugin: destroy command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/global-status/plugin.rb
 INFO manager: Registered plugin: global-status command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/halt/plugin.rb
 INFO manager: Registered plugin: halt command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/help/plugin.rb
 INFO manager: Registered plugin: help command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/init/plugin.rb
 INFO manager: Registered plugin: init command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/list-commands/plugin.rb
 INFO manager: Registered plugin: list-commands command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/login/plugin.rb
 INFO manager: Registered plugin: vagrant-login
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/package/plugin.rb
 INFO manager: Registered plugin: package command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/plugin/plugin.rb
 INFO manager: Registered plugin: plugin command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/port/plugin.rb
 INFO manager: Registered plugin: port command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/powershell/plugin.rb
 INFO manager: Registered plugin: powershell command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/provider/plugin.rb
 INFO manager: Registered plugin: provider command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/provision/plugin.rb
 INFO manager: Registered plugin: provision command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/push/plugin.rb
 INFO manager: Registered plugin: push command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/rdp/plugin.rb
 INFO manager: Registered plugin: rdp command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/reload/plugin.rb
 INFO manager: Registered plugin: reload command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/resume/plugin.rb
 INFO manager: Registered plugin: resume command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/snapshot/plugin.rb
 INFO manager: Registered plugin: snapshot command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/ssh/plugin.rb
 INFO manager: Registered plugin: ssh command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/ssh_config/plugin.rb
 INFO manager: Registered plugin: ssh-config command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/status/plugin.rb
 INFO manager: Registered plugin: status command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/suspend/plugin.rb
 INFO manager: Registered plugin: suspend command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/up/plugin.rb
 INFO manager: Registered plugin: up command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/upload/plugin.rb
 INFO manager: Registered plugin: upload command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/validate/plugin.rb
 INFO manager: Registered plugin: validate command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/version/plugin.rb
 INFO manager: Registered plugin: version command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/winrm/plugin.rb
 INFO manager: Registered plugin: winrm command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/commands/winrm_config/plugin.rb
 INFO manager: Registered plugin: winrm-config command
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/ssh/plugin.rb
 INFO manager: Registered plugin: ssh communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/winrm/plugin.rb
 INFO manager: Registered plugin: winrm communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/communicators/winssh/plugin.rb
 INFO manager: Registered plugin: windows ssh communicator
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/alpine/plugin.rb
 INFO manager: Registered plugin: Alpine guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/alt/plugin.rb
 INFO manager: Registered plugin: ALT Platform guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/amazon/plugin.rb
 INFO manager: Registered plugin: Amazon Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/arch/plugin.rb
 INFO manager: Registered plugin: Arch guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/atomic/plugin.rb
 INFO manager: Registered plugin: Atomic Host guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/bsd/plugin.rb
 INFO manager: Registered plugin: BSD-based guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/centos/plugin.rb
 INFO manager: Registered plugin: CentOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/coreos/plugin.rb
 INFO manager: Registered plugin: CoreOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/darwin/plugin.rb
 INFO manager: Registered plugin: Darwin guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/debian/plugin.rb
 INFO manager: Registered plugin: Debian guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/dragonflybsd/plugin.rb
 INFO manager: Registered plugin: DragonFly BSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/elementary/plugin.rb
 INFO manager: Registered plugin: Elementary guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/esxi/plugin.rb
 INFO manager: Registered plugin: ESXi guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/fedora/plugin.rb
 INFO manager: Registered plugin: Fedora guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/freebsd/plugin.rb
 INFO manager: Registered plugin: FreeBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/funtoo/plugin.rb
 INFO manager: Registered plugin: Funtoo guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/gentoo/plugin.rb
 INFO manager: Registered plugin: Gentoo guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/haiku/plugin.rb
 INFO manager: Registered plugin: Haiku guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/kali/plugin.rb
 INFO manager: Registered plugin: Kali guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/linux/plugin.rb
 INFO manager: Registered plugin: Linux guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/mint/plugin.rb
 INFO manager: Registered plugin: Mint guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/netbsd/plugin.rb
 INFO manager: Registered plugin: NetBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/nixos/plugin.rb
 INFO manager: Registered plugin: NixOS guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/omnios/plugin.rb
 INFO manager: Registered plugin: OmniOS guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/openbsd/plugin.rb
 INFO manager: Registered plugin: OpenBSD guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/openwrt/plugin.rb
 INFO manager: Registered plugin: OpenWrt guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/photon/plugin.rb
 INFO manager: Registered plugin: VMware Photon guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/pld/plugin.rb
 INFO manager: Registered plugin: PLD Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/redhat/plugin.rb
 INFO manager: Registered plugin: Red Hat Enterprise Linux guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/rocky/plugin.rb
 INFO manager: Registered plugin: Rocky guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/slackware/plugin.rb
 INFO manager: Registered plugin: Slackware guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/smartos/plugin.rb
 INFO manager: Registered plugin: SmartOS guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/solaris/plugin.rb
 INFO manager: Registered plugin: Solaris guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/solaris11/plugin.rb
 INFO manager: Registered plugin: Solaris 11 guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/suse/plugin.rb
 INFO manager: Registered plugin: SUSE guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/tinycore/plugin.rb
 INFO manager: Registered plugin: TinyCore Linux guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/trisquel/plugin.rb
 INFO manager: Registered plugin: Trisquel guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/ubuntu/plugin.rb
 INFO manager: Registered plugin: Ubuntu guest
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/guests/windows/plugin.rb
 INFO manager: Registered plugin: Windows guest.
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/alt/plugin.rb
 INFO manager: Registered plugin: ALT Platform host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/arch/plugin.rb
 INFO manager: Registered plugin: Arch host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/bsd/plugin.rb
 INFO manager: Registered plugin: BSD host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/darwin/plugin.rb
 INFO manager: Registered plugin: Mac OS X host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/freebsd/plugin.rb
 INFO manager: Registered plugin: FreeBSD host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/gentoo/plugin.rb
 INFO manager: Registered plugin: Gentoo host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/linux/plugin.rb
 INFO manager: Registered plugin: Linux host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/null/plugin.rb
 INFO manager: Registered plugin: null host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/redhat/plugin.rb
 INFO manager: Registered plugin: Red Hat Enterprise Linux host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/slackware/plugin.rb
 INFO manager: Registered plugin: Slackware host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/suse/plugin.rb
 INFO manager: Registered plugin: SUSE host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/void/plugin.rb
 INFO manager: Registered plugin: Void host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/hosts/windows/plugin.rb
 INFO manager: Registered plugin: Windows host
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/kernel_v1/plugin.rb
 INFO manager: Registered plugin: kernel
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/kernel_v2/plugin.rb
 INFO manager: Registered plugin: kernel
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb
 INFO manager: Registered plugin: docker-provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb
 INFO manager: Registered plugin: Hyper-V provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb
 INFO manager: Registered plugin: VirtualBox provider
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/ansible/plugin.rb
 INFO manager: Registered plugin: ansible
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/cfengine/plugin.rb
 INFO manager: Registered plugin: CFEngine Provisioner
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/chef/plugin.rb
 INFO manager: Registered plugin: chef
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/container/plugin.rb
 INFO manager: Registered plugin: container
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/docker/plugin.rb
 INFO manager: Registered plugin: docker
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/file/plugin.rb
 INFO manager: Registered plugin: file
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/podman/plugin.rb
 INFO manager: Registered plugin: podman
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/puppet/plugin.rb
 INFO manager: Registered plugin: puppet
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/salt/plugin.rb
 INFO manager: Registered plugin: salt
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/provisioners/shell/plugin.rb
 INFO manager: Registered plugin: shell
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/atlas/plugin.rb
 INFO manager: Registered plugin: atlas
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/ftp/plugin.rb
 INFO manager: Registered plugin: ftp
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/heroku/plugin.rb
 INFO manager: Registered plugin: heroku
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/local-exec/plugin.rb
 INFO manager: Registered plugin: local-exec
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/pushes/noop/plugin.rb
 INFO manager: Registered plugin: noop
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/nfs/plugin.rb
 INFO manager: Registered plugin: NFS synced folders
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/rsync/plugin.rb
 INFO manager: Registered plugin: RSync synced folders
DEBUG global: Loading core plugin: C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb
 INFO manager: Registered plugin: SMB synced folders
 INFO vagrant: `vagrant` invoked: ["reload", "wef", "--debug"]
DEBUG vagrant: Creating Vagrant environment
 INFO environment: Environment initialized (#<Vagrant::Environment:0x0000024350624ec8>)
 INFO environment:   - cwd: D:/workspace/eWalker/DetectionLab/Vagrant
 INFO environment: Home path: D:/yzhao/.vagrant.d
DEBUG environment: Effective local data path: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
 INFO environment: Local data path: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
DEBUG environment: Creating: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant
DEBUG manager: Enabling localized plugins
 INFO manager: Plugins:
DEBUG solution_file: new solution file instance plugin_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json solution_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol
DEBUG solution_file: missing file so skipping loading
DEBUG bundler: solution file in use for init: <Vagrant::Bundler::SolutionFile:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol:invalid>
DEBUG bundler: Generating new builtin set instance.
DEBUG bundler: Generating new plugin set instance. Skip gems - []
DEBUG bundler: generating solution set for configured plugins
DEBUG bundler: Current generated plugin dependency list: []
DEBUG bundler: resolving solution from available specification set
DEBUG bundler: solution set for configured plugins has been resolved
DEBUG bundler: activating solution set
DEBUG bundler: Activating solution set: []
DEBUG solution_file: plugin file does not exist, not storing solution
DEBUG bundler: solution set stored to - <Vagrant::Bundler::SolutionFile:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/local.sol:invalid>
 INFO manager: Loading plugins...
DEBUG manager: Enabling globalized plugins
 INFO manager: Plugins:
 INFO manager:   - vagrant-reload = [installed: 0.0.1 constraint: > 0]
 INFO manager:   - vagrant-vmware-desktop = [installed: 3.0.1 constraint: > 0]
DEBUG solution_file: new solution file instance plugin_file=D:/yzhao/.vagrant.d/plugins.json solution_file=D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol
DEBUG solution_file: reading solution file - D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol
DEBUG solution_file: solution validation check CHECKSUM 9fcfcffe612e5ad699ff689b31abbda7e7dbd14525fe86e49533ab494f410560 <-> 9fcfcffe612e5ad699ff689b31abbda7e7dbd14525fe86e49533ab494f410560 VERSION 2.2.19 <-> 2.2.19
DEBUG solution_file: loading solution dependency list
DEBUG solution_file: solution dependency list: [#<Gem::Resolver::DependencyRequest:0x000002435099d7d0 @dependency=<Gem::Dependency type=:runtime name="vagrant-reload" requirements="= 0.0.1">, @requester=nil>, #<Gem::Resolver::DependencyRequest:0x000002435099d528 @dependency=<Gem::Dependency type=:runtime name="vagrant-vmware-desktop" requirements="= 3.0.1">, @requester=nil>]
DEBUG bundler: solution file in use for init: <Vagrant::Bundler::SolutionFile:D:/yzhao/.vagrant.d/plugins.json:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/bundler/global.sol:valid>
DEBUG bundler: Generating new builtin set instance.
DEBUG bundler: Generating new plugin set instance. Skip gems - []
DEBUG bundler: loading cached solution set
DEBUG bundler: activating solution set
DEBUG bundler: Activating solution set: ["vagrant-reload-0.0.1", "vagrant-vmware-desktop-3.0.1"]
DEBUG bundler: Activating gem vagrant-reload-0.0.1
DEBUG bundler: Activating gem vagrant-vmware-desktop-3.0.1
 INFO manager: Loading plugins...
 INFO manager: Loading plugin `vagrant-reload` with default require: `vagrant-reload`
 INFO manager: Registered plugin: Reload
DEBUG manager: Successfully loaded plugin `vagrant-reload`.
 INFO manager: Loading plugin `vagrant-vmware-desktop` with default require: `vagrant-vmware-desktop`
 INFO manager: Registered plugin: VMware Workstation Provider
DEBUG manager: Successfully loaded plugin `vagrant-vmware-desktop`.
 INFO loader: Set :root = ["#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile
 INFO loader: Loading configuration in order: [:home, :root]
DEBUG loader: Loading from: root (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO subprocess: Starting process: ["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\/powershell.EXE", "-NoLogo", "-NoProfile", "-NonInteractive", "-ExecutionPolicy", "Bypass", "-Command", "Write-Output $PSVersionTable.PSVersion.Major"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 5
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 30
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\/powershell.EXE", "-NoLogo", "-NoProfile", "-NonInteractive", "-ExecutionPolicy", "Bypass", "-Command", "(new-object System.Security.Principal.WindowsPrincipal([System.Security.Principal.WindowsIdentity]::GetCurrent())).IsInRole([System.Security.Principal.WindowsBuiltInRole]::Administrator)"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: True
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_logger" = ["[\"2\", #<Proc:0x00000243506fe038 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:3>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x00000243506fe038 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:3>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_logger"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: bento/ubuntu-20.04 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO host: Autodetecting host type for [#<Vagrant::Environment: D:/workspace/eWalker/DetectionLab/Vagrant>]
DEBUG host: Trying: alt
DEBUG host: Trying: arch
DEBUG host: Trying: darwin
DEBUG host: Trying: freebsd
DEBUG host: Trying: gentoo
DEBUG host: Trying: redhat
DEBUG host: Trying: slackware
DEBUG host: Trying: suse
DEBUG host: Trying: void
DEBUG host: Trying: bsd
DEBUG host: Trying: linux
DEBUG host: Trying: null
DEBUG host: Trying: windows
 INFO host: Detected: windows!
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x000002434fdf72f0>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000024350603bd8>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000024350603bd8>
 INFO loader: Set :"3060_bento/ubuntu-20.04_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/bento-VAGRANTSLASH-ubuntu-20.04/202112.19.0/vmware_desktop/Vagrantfile
 INFO loader: Loading configuration in order: [:"3060_bento/ubuntu-20.04_vmware_desktop", :home, :root, "2860_machine_logger"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop" = ["[\"2\", #<Proc:0x0000024350715030>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000024350715030>]
 INFO loader: Loading configuration in order: [:"3060_bento/ubuntu-20.04_vmware_desktop", :home, :root, "2860_machine_logger", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_logger (cache)
DEBUG loader: Loading from: 2860_vm_logger_bento/ubuntu-20.04_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_dc" = ["[\"2\", #<Proc:0x00000243506fde30 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x00000243506fde30 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:50>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x00000243512ab2a0>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000024351230668>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x0000024351230668>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
DEBUG loader: Populating proc cache for #<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>
DEBUG loader: Load procs for pathname: D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile
 INFO root: Version requirements from Vagrantfile: [">= 1.6.2"]
 INFO root:   - Version requirements satisfied!
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_dc_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x00000243513bab00>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x00000243513bab00>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_dc (cache)
DEBUG loader: Loading from: 2860_vm_dc_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_wef" = ["[\"2\", #<Proc:0x00000243506fdbd8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x00000243506fdbd8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x0000024351364d68>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x00000243512fd6e0>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x00000243512fd6e0>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO loader: Set :"2860_vm_wef_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x000002435064da58>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x000002435064da58>]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Loading from: 2860_vm_wef_detectionlab/win2016_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG base: Windows, checking for VBoxManage on PATH first
 INFO base: VBoxManage path: VBoxManage
DEBUG environment: Initial usable provider list: [[4, :hyperv], [10, :vmware_desktop], [10, :vmware_workstation]]
DEBUG environment: Priority sorted usable provider list: [:vmware_desktop, :vmware_workstation, :hyperv]
DEBUG environment: Preferred provider list: []
DEBUG environment: Using provider `vmware_desktop` as it is the highest priority in the usable list.
 INFO loader: Set "2860_machine_win10" = ["[\"2\", #<Proc:0x00000243506fd9d0 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x00000243506fd9d0 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:181>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (evaluating)
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
 INFO provisioner: Provisioner config for 'reload' not found. Ignoring config.
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG provisioner: Provisioner defined: 
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box not found: detectionlab/win10 (vmware_desktop)
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x0000024350e7f118>]"]
DEBUG loader: Populating proc cache for ["2", #<Proc:0x0000024350e7f118>]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (evaluating)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 WARN vagrantfile: Failed to locate detectionlab/win10 with version 
 WARN vagrantfile: Performing lookup with initial values detectionlab/win10 with version 
 INFO box_collection: Box not found: detectionlab/win10 (vmware_desktop)
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x0000024350e7f118>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box not found: detectionlab/win10 (vmware_desktop)
 INFO loader: Set :"2860_vm_win10_detectionlab/win10_vmware_desktop" = ["[\"2\", #<Proc:0x0000024350e7f118>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_win10 (cache)
DEBUG loader: Loading from: 2860_vm_win10_detectionlab/win10_vmware_desktop (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO environment: Running hook: environment_plugins_loaded
 INFO runner: Running action: environment_plugins_loaded #<Vagrant::Action::Builder:0x00000243504633a0>
 INFO environment: Running hook: environment_load
 INFO runner: Running action: environment_load #<Vagrant::Action::Builder:0x00000243513d2cc8>
 INFO warden: Calling IN action: #<HashiCorp::VagrantVMwareDesktop::SetupPlugin:0x000002435134c808>
DEBUG checkpoint_client: starting plugin check
DEBUG checkpoint_client: starting utility check
 INFO warden: Calling OUT action: #<HashiCorp::VagrantVMwareDesktop::SetupPlugin:0x000002435134c808>
DEBUG checkpoint_client: plugin check complete
DEBUG checkpoint_client: starting plugin check
 INFO cli: CLI: [] "reload" ["wef"]
DEBUG checkpoint_client: plugin check complete
DEBUG cli: Invoking command class: VagrantPlugins::CommandReload::Command ["wef"]
DEBUG checkpoint_client: no information received from checkpoint
DEBUG command: 'reload' each target VM...
DEBUG command: Getting target VMs for command. Arguments:
DEBUG command:  -- names: ["wef"]
DEBUG command:  -- options: nil
 INFO vmware_driver: VMX file: 
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG command: Finding machine that match name: wef
 INFO command: Active machine found with name wef. Using provider: vmware_desktop
 INFO environment: Getting machine: wef (vmware_desktop)
 INFO environment: Uncached load of machine.
 INFO loader: Set "2860_machine_wef" = ["[\"2\", #<Proc:0x00000243506fdbd8 D:/workspace/eWalker/DetectionLab/Vagrant/Vagrantfile:118>]"]
 INFO loader: Loading configuration in order: [:home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"3060_detectionlab/win2016_vmware_desktop", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
 INFO box_collection: Box found: detectionlab/win2016 (vmware_desktop)
 INFO environment: Running hook: authenticate_box_url
 INFO runner: Running action: authenticate_box_url #<Vagrant::Action::Builder:0x00000243511162c8>
 INFO warden: Calling IN action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000002435103f5c0>
 WARN authenticate-box-url: Authentication token not found as GET parameter.
 INFO warden: Calling OUT action: #<VagrantPlugins::CloudCommand::AddAuthentication:0x000002435103f5c0>
 INFO loader: Set :"3060_detectionlab/win2016_vmware_desktop" = ["#<Pathname:D:/yzhao/.vagrant.d/boxes/detectionlab-VAGRANTSLASH-win2016/1.9/vmware_desktop/Vagrantfile>"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", :"2860_vm_wef_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
 INFO loader: Set :"2860_vm_wef_detectionlab/win2016_vmware_desktop" = ["[\"2\", #<Proc:0x000002435064da58>]"]
 INFO loader: Loading configuration in order: [:"3060_detectionlab/win2016_vmware_desktop", :home, :root, "2860_machine_wef", :"2860_vm_wef_detectionlab/win2016_vmware_desktop"]
ERROR loader: Unknown config sources: ["2860_machine_logger", :"3060_bento/ubuntu-20.04_vmware_desktop", :"2860_vm_logger_bento/ubuntu-20.04_vmware_desktop", "2860_machine_dc", :"2860_vm_dc_detectionlab/win2016_vmware_desktop", "2860_machine_win10", :"2860_vm_win10_detectionlab/win10_vmware_desktop"]
DEBUG loader: Loading from: 3060_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Loading from: root (cache)
DEBUG loader: Loading from: 2860_machine_wef (cache)
DEBUG loader: Loading from: 2860_vm_wef_detectionlab/win2016_vmware_desktop (cache)
DEBUG loader: Configuration loaded successfully, finalizing and returning
DEBUG push: finalizing
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
 INFO machine: Initializing machine: wef
 INFO machine:   - Provider: HashiCorp::VagrantVMwareDesktop::Provider
 INFO machine:   - Box: #<Vagrant::Box:0x0000024350fc7750>
 INFO machine:   - Data dir: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/wef/vmware_desktop
DEBUG vmware: Re-initializing driver for new ID: "D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/wef/vmware_desktop/b422f57c-7c53-492b-8be2-3da74bf5d4c0/WindowsServer2016.vmx"
 INFO vmware_driver: VMX file: D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/wef/vmware_desktop/b422f57c-7c53-492b-8be2-3da74bf5d4c0/WindowsServer2016.vmx
DEBUG vagrant_utility: initialize HOST=127.0.0.1 PORT=9922
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/info RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/vmware/paths RESPONSE=200 
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG vmware_driver: vagrant vmware utility version detected: 1.0.21
DEBUG vmware_driver: vmware product detected: Workstation
DEBUG vmware_driver: vmware license in use: workstation
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
DEBUG vmware_driver: discovered vmware NAT device: vmnet8
DEBUG checkpoint_client: getting utility version
DEBUG vmware_driver: Getting version from vagrant-vmware-utility
DEBUG vagrant_utility: request METHOD=GET PATH=/version RESPONSE=200 
DEBUG checkpoint_client: got utility version: "1.0.21"
DEBUG checkpoint_client: running utility checkpoint check
DEBUG checkpoint_client: utility check complete
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
DEBUG vmware_driver: discovered vmware NAT device: vmnet8
DEBUG machine: Eager loading WinRM communicator to avoid GH-3390
 INFO winrm: Initializing WinRMCommunicator
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO interface: Machine: metadata ["provider", :vmware_desktop, {:target=>:wef}]
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO command: With machine: wef (#<HashiCorp::VagrantVMwareDesktop::Provider:0x00000243508627a8 @logger=#<Log4r::Logger:0x00000243508624b0 @fullname="hashicorp::vagrant::vmware", @outputters=[], @additive=true, @name="vmware", @path="hashicorp::vagrant", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @machine=#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, @driver=#<HashiCorp::VagrantVMwareDesktop::Driver::Base:0x00000243507d0b00 @config=#<HashiCorp::VagrantVMwareDesktop::Config:0x0000024351036f60 @allowlist_verified=false, @base_address=nil, @base_mac=nil, @clone_directory=nil, @functional_hgfs=true, @unmount_default_hgfs=true, @enable_vmrun_ip_lookup=true, @gui=true, @force_vmware_license=nil, @linked_clone=true, @nat_device="vmnet8", @network_adapters={0=>[:nat, {:auto_config=>false}]}, @shared_folder_special_char="-", @verify_vmnet=true, @vmx={"displayname"=>"wef.windomain.local", "memsize"=>"2048", "numvcpus"=>"2"}, @port_forward_network_pause=0, @ssh_info_public=false, @utility_host="127.0.0.1", @utility_port=9922, @utility_certificate_path="C:/ProgramData/HashiCorp/vagrant-vmware-desktop/certificates", @logger=#<Log4r::Logger:0x0000024351097388 @fullname="hashicorp::provider::vmware::config", @outputters=[], @additive=true, @name="config", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @__invalid_methods=#<Set: {}>>, @logger=#<Log4r::Logger:0x00000243507d0ab0 @fullname="hashicorp::provider::vmware_driver", @outputters=[], @additive=true, @name="vmware_driver", @path="hashicorp::provider", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @vmx_path=#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/wef/vmware_desktop/b422f57c-7c53-492b-8be2-3da74bf5d4c0/WindowsServer2016.vmx>, @vm_dir=#<Pathname:D:/workspace/eWalker/DetectionLab/Vagrant/.vagrant/machines/wef/vmware_desktop/b422f57c-7c53-492b-8be2-3da74bf5d4c0>, @vagrant_utility=#<HashiCorp::VagrantVMwareDesktop::Helper::VagrantUtility:0x00000243506ec518 @logger=#<Log4r::Logger:0x00000243506ec4a0 @fullname="hashicorp::provider::vmware::vagrant_utility", @outputters=[], @additive=true, @name="vagrant_utility", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @connection=#<Net::HTTP 127.0.0.1:9922 open=false>, @headers={"Content-Type"=>"application/vnd.hashicorp.vagrant.vmware.rest-v1+json", "Origin"=>"https://127.0.0.1:9922", "User-Agent"=>"Vagrant/2.2.19 (+https://www.vagrantup.com; ruby2.7.4)  - VagrantVMWareDesktop/STUB", "X-Requested-With"=>"Vagrant"}>, @license="workstation", @pro_license=true, @version="16.2.3", @product_name="Workstation", @vmrun_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", @vmware_vmx_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\x64\\vmware-vmx.exe", @vmware_vdiskmanager_path="C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmware-vdiskmanager.exe", @utility_version=#<Gem::Version "1.0.21">>, @cap_logger=#<Log4r::Logger:0x00000243504403c8 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::provider", @outputters=[], @additive=true, @name="provider", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x000002434ff30f40 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware_desktop, #<#<Class:0x0000024350443398>:0x000002434fe4c7c8>]], @cap_args=[#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:docker=>#<Vagrant::Registry:0x00000243504418b8 @items={:public_address=>#<Proc:0x0000024350440878 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:60>, :proxy_machine=>#<Proc:0x0000024350440788 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:65>, :has_communicator=>#<Proc:0x0000024350440698 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/docker/plugin.rb:70>}, @results_cache={}>, :hyperv=>#<Vagrant::Registry:0x0000024350441728 @items={:public_address=>#<Proc:0x00000243509313f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:25>, :snapshot_list=>#<Proc:0x0000024350931378 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:30>, :configure_disks=>#<Proc:0x0000024350931350 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:35>, :cleanup_disks=>#<Proc:0x0000024350931328 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:40>, :validate_disk_ext=>#<Proc:0x0000024350931300 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:45>, :default_disk_exts=>#<Proc:0x00000243509312d8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:50>, :set_default_disk_ext=>#<Proc:0x00000243509312b0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/hyperv/plugin.rb:55>}, @results_cache={}>, :virtualbox=>#<Vagrant::Registry:0x0000024350440d28 @items={:forwarded_ports=>#<Proc:0x0000024350450d68 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:27>, :nic_mac_addresses=>#<Proc:0x0000024350450d40 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:32>, :public_address=>#<Proc:0x0000024350450d18 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:37>, :configure_disks=>#<Proc:0x0000024350450cf0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:42>, :cleanup_disks=>#<Proc:0x0000024350450cc8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:47>, :validate_disk_ext=>#<Proc:0x0000024350450ca0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:52>, :default_disk_exts=>#<Proc:0x0000024350450c78 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:57>, :set_default_disk_ext=>#<Proc:0x0000024350450c50 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:62>, :snapshot_list=>#<Proc:0x0000024350450c28 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:67>}, @results_cache={}>, :vmware_desktop=>#<Vagrant::Registry:0x00000243504408f0 @items={:snapshot_list=>#<Proc:0x000002434fe54e50 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x000002434fe54e28 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x000002434fe54e00 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x000002434fe54ab8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x000002434fe54a40 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x000002434fe54950 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x000002434fe54928 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>, :vmware_workstation=>#<Vagrant::Registry:0x0000024350440760 @items={:snapshot_list=>#<Proc:0x000002434fe545b8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:59>, :delete_all_snapshots=>#<Proc:0x000002434fe54590 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:64>, :delete_snapshot=>#<Proc:0x000002434fe54518 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:69>, :forwarded_ports=>#<Proc:0x000002434fe541f8 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:79>, :public_address=>#<Proc:0x000002434fe54568 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:84>, :nic_mac_addresses=>#<Proc:0x000002434fe4ff40 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:89>, :scrub_forwarded_ports=>#<Proc:0x000002434fe4fef0 D:/yzhao/.vagrant.d/gems/2.7.4/gems/vagrant-vmware-desktop-3.0.1/lib/vagrant-vmware-desktop/plugin.rb:94>}, @results_cache={}>}>)
 INFO machine: Calling action: reload on provider VMware Workstation
DEBUG environment: Attempting to acquire process-lock: machine-action-c4cb9d292a6574e05a72b156332ab119
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: machine-action-c4cb9d292a6574e05a72b156332ab119
 INFO interface: Machine: action ["reload", "start", {:target=>:wef}]
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000024350478598>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024350f31750>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000024350e0ff70>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243522315d0>
 INFO warden: Calling IN action: #<Proc:0x0000024350f11f68 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000024352231508>
DEBUG syncedfolder: Searching for cap: default_fstab_modification
DEBUG syncedfolder: Checking in: vmware
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: VMware Middleware: CheckVMware
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024352248410>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x00000243524ae268>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243524c50d0>
 INFO warden: Calling IN action: #<Proc:0x00000243523d3528 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: DiscardSuspendedState
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:d6:5e:fd"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:d6:5e:07"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x00000243524a5460>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x00000243522792b8>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243520b38c0>
 INFO warden: Calling IN action: #<Proc:0x0000024351eb3a70 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x00000243520b37f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x00000243524a53e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
DEBUG checkpoint: checkpoint data processing complete
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000024352278020>
 INFO interface: output: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO interface: output: ==> wef: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
==> wef: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO box: box update check is under the interval threshold
 INFO box: Skipping box update check
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024352291278>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x00000243511ab0d0>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243524dfd18>
 INFO warden: Calling IN action: #<Proc:0x00000243523b24b8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: CheckExistingNetwork
 INFO check_existing_network: Checking if the vmnet devices are healthy...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Verifying vmnet devices are healthy...
 INFO interface: info: ==> wef: Verifying vmnet devices are healthy...
==> wef: Verifying vmnet devices are healthy...
DEBUG vagrant_utility: request METHOD=POST PATH=/vmnet/verify RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: PruneForwardedPorts
 INFO prune_forwarded_ports: Pruning forwarded ports...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
DEBUG vmware_driver: requesting prune of unused port forwards
DEBUG vagrant_utility: request METHOD=DELETE PATH=/portforwards RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000002435249f088>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000024352332560>
 INFO warden: Calling IN action: VMware Middleware: Suspended
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
DEBUG suspended: result: false
 INFO warden: Calling OUT action: VMware Middleware: Suspended
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000024351261808>
 INFO warden: Calling IN action: #<Proc:0x000002435222a5c8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Provision:0x00000243512612b8>
 INFO provision: Checking provisioner sentinel file...
 INFO warden: Calling IN action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x0000024350f4b150>
DEBUG host: Searching for cap: nfs_prune
DEBUG host: Checking in: windows
 INFO nfs: Host doesn't support pruning NFS. Skipping.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x0000024350e55750>
 INFO synced_folder_cleanup: Invoking synced folder cleanup for: vmware
 INFO synced_folder: Clearing shared folders
 INFO vmware_driver: Clearing shared folders...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:d6:5e:fd"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:d6:5e:07"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Delayed:0x0000024350859838>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolders:0x0000024350859798>
 INFO synced_folders: SyncedFolders loading from cache: false
 INFO synced_folders: Synced Folder Implementation: vmware
 INFO synced_folders:   - /vagrant: . => /vagrant
 INFO synced_folders: Invoking synced folder prepare for: vmware
 INFO warden: Calling IN action: VMware Middleware: PrepareNFSSettings
 INFO warden: Calling IN action: VMware Middleware: Network
DEBUG network: Available slots for high-level adapters: #<Set: {1, 2, 3, 4, 5, 6, 7, 8}>
 INFO network: Determining network adapters required for high-level configuration...
 INFO network:  -- Slot 1: hostonly
 INFO network: Determining adapters and compiling network configuration...
 INFO network: Slot 0. Type: nat
DEBUG network: Normalized configuration: {:auto_config=>false, :type=>:dhcp}
DEBUG network: Adapter configuration: {:type=>:nat, :slot=>0}
DEBUG network: Network configuration: {:type=>:dhcp, :auto_config=>false}
 INFO network: Slot 1. Type: hostonly
DEBUG network: Normalized configuration: {:auto_config=>true, :netmask=>"255.255.255.0", :type=>:static, :ip=>"192.168.56.103", :gateway=>"192.168.56.1", :dns=>"192.168.56.102", :protocol=>"tcp", :id=>"b6a5947e-de6d-40a0-abd4-abdb2e456bc0", :subnet_ip=>"192.168.56.0", :adapter_ip=>"192.168.56.1"}
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
 INFO network: Found matching vmnet device: vmnet2
 INFO network: Checking for hostonly network collisions...
 INFO subprocess: Starting process: ["C:\\WINDOWS\\system32/netsh.exe", "interface", "ip", "show", "route"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 

Publish  Type      Met  Prefix                    Idx  Gateway/Interface Name

-------  --------  ---  ------------------------  ---  ------------------------

No       Manual    100  0.0.0.0/0                  19  192.168.70.254

No       System    256  127.0.0.0/8                 1  Loopback Pseudo-Interface 1

No       System    256  127.0.0.1/32                1  Loopback Pseudo-Interface 1

No       System    256  127.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  169.254.0.0/16             34  VMware Network Adapter VMnet2

No       System    256  169.254.140.76/32          34  VMware Network Adapter VMnet2

No       System    256  169.254.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  172.22.112.0/20            97  vEthernet (Wi-Fi)

No       System    256  172.22.112.1/32            97  vEthernet (Wi-Fi)

No       System    256  172.22.127.255/32          97  vEthernet (Wi-Fi)

No       System    256  172.23.48.0/20             79  vEthernet (VMware Network )

No       System    256  172.23.48.1/32             79  vEthernet (VMware Network )

No       System    256  172.23.63.255/32           79  vEthernet (VMware Network )

No       System    256  172.23.128.0/20            28  vEthernet (Default Switch)

No       System    256  172.23.128.1/32            28  vEthernet (Default Switch)

No       System    256  172.23.143.255/32          28  vEthernet (Default Switch)

No       System    256  172.24.224.0/20            91  vEthernet (VMware Network ) 3

No       System    256  172.24.224.1/32            91  vEthernet (VMware Network ) 3

No       System    256  172.24.239.255/32          91  vEthernet (VMware Network ) 3

No       System    256  172.25.64.0/20             51  vEthernet (Ethernet)

No       System    256  172.25.64.1/32             51  vEthernet (Ethernet)

No       System    256  172.25.79.255/32           51  vEthernet (Ethernet)

No       System    256  172.28.64.0/20             85  vEthernet (VMware Network ) 2

No       System    256  172.28.64.1/32             85  vEthernet (VMware Network ) 2

No       System    256  172.28.79.255/32           85  vEthernet (VMware Network ) 2

No       System    256  172.30.80.0/20             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.80.1/32             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.95.255/32           73  vEthernet (vEthernet (NAT )

No       System    256  192.168.44.0/24            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.1/32            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.255/32          21  VMware Network Adapter VMnet1

No       System    256  192.168.70.0/24            19  Wi-Fi

No       System    256  192.168.70.245/32          19  Wi-Fi

No       System    256  192.168.70.255/32          19  Wi-Fi

No       System    256  192.168.222.0/24           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.1/32           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.255/32         33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 1  Loopback Pseudo-Interface 1

No       System    256  224.0.0.0/4                11  OpenVPN Wintun

No       System    256  224.0.0.0/4                34  VMware Network Adapter VMnet2

No       System    256  224.0.0.0/4                21  VMware Network Adapter VMnet1

No       System    256  224.0.0.0/4                33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 4  Ethernet

No       System    256  224.0.0.0/4                24  vEthernet (NAT vSwitch)

No       System    256  224.0.0.0/4                19  Wi-Fi

No       System    256  224.0.0.0/4                51  vEthernet (Ethernet)

No       System    256  224.0.0.0/4                28  vEthernet (Default Switch)

No       System    256  224.0.0.0/4                73  vEthernet (vEthernet (NAT )

No       System    256  224.0.0.0/4                79  vEthernet (VMware Network )

No       System    256  224.0.0.0/4                85  vEthernet (VMware Network ) 2

No       System    256  224.0.0.0/4                91  vEthernet (VMware Network ) 3

No       System    256  224.0.0.0/4                97  vEthernet (Wi-Fi)

No       System    256  224.0.0.0/4                32  Local Area Connection* 2

No       System    256  255.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  255.255.255.255/32         11  OpenVPN Wintun

No       System    256  255.255.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  255.255.255.255/32         21  VMware Network Adapter VMnet1

No       System    256  255.255.255.255/32         33  VMware Network Adapter VMnet8

No       System    256  255.255.255.255/32          4  Ethernet

No       System    256  255.255.255.255/32         24  vEthernet (NAT vSwitch)

No       System    256  255.255.255.255/32         19  Wi-Fi

No       System    256  255.255.255.255/32         51  vEthernet (Ethernet)

No       System    256  255.255.255.255/32         28  vEthernet (Default Switch)

No       System    256  255.255.255.255/32         73  vEthernet (vEthernet (NAT )

No       System    256  255.255.255.255/32         79  vEthernet (VMware Network )

No       System    256  255.255.255.255/32         85  vEthernet (VMware Network ) 2

No       System    256  255.255.255.255/32         91  vEthernet (VMware Network ) 3

No       System    256  255.255.255.255/32         97  vEthernet (Wi-Fi)

No       System    256  255.255.255.255/32         32  Local Area Connection* 2


DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG network: Adapter configuration: {:type=>:custom, :mac_address=>nil, :vnet=>"vmnet2", :slot=>1}
DEBUG network: Network configuration: {:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.103", :netmask=>"255.255.255.0", :auto_config=>true}
 INFO network: Enabling 2 adapters...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Preparing network adapters...
 INFO interface: info: ==> wef: Preparing network adapters...
==> wef: Preparing network adapters...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet0.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddressoffset
WARNING: The VMX file for this box contains a setting that is automatically overwritten by Vagrant
WARNING: when started. Vagrant will stop overwriting this setting in an upcoming release which may
WARNING: prevent proper networking setup. Below is the detected VMX setting:
WARNING: 
WARNING:   ethernet1.pcislotnumber = "33"
WARNING: 
WARNING: If networking fails to properly configure, it may require this VMX setting. It can be manually
WARNING: applied via the Vagrantfile:
WARNING: 
WARNING:   Vagrant.configure(2) do |config|
WARNING:     config.vm.provider :vmware_desktop do |vmware|
WARNING:       vmware.vmx["ethernet1.pcislotnumber"] = "33"
WARNING:     end
WARNING:   end
WARNING: 
WARNING: For more information: https://www.vagrantup.com/docs/vmware/boxes.html#vmx-allowlisting
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet1.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.vnet
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: BaseMacToIp
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SetHostname:0x0000024352340430>
 INFO warden: Calling IN action: VMware Middleware: VMXModify
 INFO vmx_modify: Modifying VMX file according to user config...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmx_modify:   - Set: displayname = 'wef.windomain.local'
 INFO vmx_modify:   - Set: memsize = '2048'
 INFO vmx_modify:   - Set: numvcpus = '2'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "21009"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "2"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: PrepareForwardedPortCollisionParams
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}]
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x00000243513bbd70>
DEBUG environment: Attempting to acquire process-lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: fpcollision
 INFO handle_port_collisions: Detecting any forwarded port collisions...
DEBUG handle_port_collisions: Extra in use: {2201=>#<Set: {"*"}>, 2202=>#<Set: {"*"}>, 55985=>#<Set: {"*"}>, 55986=>#<Set: {"*"}>, 2200=>#<Set: {"*"}>, 2203=>#<Set: {"*"}>, 2204=>#<Set: {"*"}>, 2205=>#<Set: {"*"}>, 2206=>#<Set: {"*"}>, 2222=>#<Set: {"*"}>}
DEBUG handle_port_collisions: Remap: {}
DEBUG handle_port_collisions: Repair: true
 INFO handle_port_collisions: Attempting to repair FP collision: 55985
 INFO handle_port_collisions: Repaired FP collision: 55985 to 2207
 INFO interface: info: Fixed port collision for 5985 => 55985. Now on port 2207.
 INFO interface: info: ==> wef: Fixed port collision for 5985 => 55985. Now on port 2207.
==> wef: Fixed port collision for 5985 => 55985. Now on port 2207.
 INFO handle_port_collisions: Attempting to repair FP collision: 55986
 INFO handle_port_collisions: Repaired FP collision: 55986 to 2208
 INFO interface: info: Fixed port collision for 5986 => 55986. Now on port 2208.
 INFO interface: info: ==> wef: Fixed port collision for 5986 => 55986. Now on port 2208.
==> wef: Fixed port collision for 5986 => 55986. Now on port 2208.
 INFO handle_port_collisions: Attempting to repair FP collision: 2222
 INFO handle_port_collisions: Repaired FP collision: 2222 to 2209
 INFO interface: info: Fixed port collision for 22 => 2222. Now on port 2209.
 INFO interface: info: ==> wef: Fixed port collision for 22 => 2222. Now on port 2209.
==> wef: Fixed port collision for 22 => 2222. Now on port 2209.
 INFO environment: Released process lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: Boot
 INFO interface: info: Starting the VMware VM...
 INFO interface: info: ==> wef: Starting the VMware VM...
==> wef: Starting the VMware VM...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "start", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx", "gui"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 44
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: VMware Middleware: WaitForAddress
 INFO interface: info: Waiting for the VM to receive an address...
 INFO interface: info: ==> wef: Waiting for the VM to receive an address...
==> wef: Waiting for the VM to receive an address...
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
 INFO warden: Calling IN action: VMware Middleware: ForwardPorts
DEBUG forward_ports: Building up ports to forward...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}]
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
 INFO interface: info: Forwarding ports...
 INFO interface: info: ==> wef: Forwarding ports...
==> wef: Forwarding ports...
 INFO interface: detail: -- 5985 => 2207
 INFO interface: detail:     wef: -- 5985 => 2207
    wef: -- 5985 => 2207
 INFO interface: detail: -- 5986 => 2208
 INFO interface: detail:     wef: -- 5986 => 2208
    wef: -- 5986 => 2208
 INFO interface: detail: -- 22 => 2209
 INFO interface: detail:     wef: -- 22 => 2209
    wef: -- 22 => 2209
DEBUG vmware_driver: requesting ports to be forwarded: [{:device=>"vmnet8", :guest_port=>5985, :host_port=>2207, :protocol=>"tcp", :guest_ip=>"192.168.222.131"}, {:device=>"vmnet8", :guest_port=>5986, :host_port=>2208, :protocol=>"tcp", :guest_ip=>"192.168.222.131"}, {:device=>"vmnet8", :guest_port=>22, :host_port=>2209, :protocol=>"tcp", :guest_ip=>"192.168.222.131"}]
DEBUG vmware_driver: forwarding ports via collection method
DEBUG vagrant_utility: request METHOD=PUT PATH=/vmnet/vmnet8/portforward RESPONSE=200 
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x00000243508bbd08>
 INFO interface: output: Waiting for machine to boot. This may take a few minutes...
 INFO interface: output: ==> wef: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
==> wef: Waiting for machine to boot. This may take a few minutes...
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2205, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5986=>2205, 5985=>2204}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO interface: detail: WinRM address: 127.0.0.1:2207
 INFO interface: detail:     wef: WinRM address: 127.0.0.1:2207
    wef: WinRM address: 127.0.0.1:2207
 INFO interface: detail: WinRM username: vagrant
 INFO interface: detail:     wef: WinRM username: vagrant
    wef: WinRM username: vagrant
 INFO interface: detail: WinRM execution_time_limit: PT2H
 INFO interface: detail:     wef: WinRM execution_time_limit: PT2H
    wef: WinRM execution_time_limit: PT2H
 INFO interface: detail: WinRM transport: negotiate
 INFO interface: detail:     wef: WinRM transport: negotiate
    wef: WinRM transport: negotiate
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2209, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9559ED7B-2FFA-446F-B293-3CEFA3F0C89A
DEBUG winrmshell: [WinRM] Command created for hostname with id: 72253493-F453-4FB8-9A29-B8DEAAE3A6C2
DEBUG winrmshell: [WinRM] creating command_id: 72253493-F453-4FB8-9A29-B8DEAAE3A6C2 on shell_id 9559ED7B-2FFA-446F-B293-3CEFA3F0C89A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 72253493-F453-4FB8-9A29-B8DEAAE3A6C2 on shell_id 9559ED7B-2FFA-446F-B293-3CEFA3F0C89A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352befae0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO interface: output: Machine booted and ready!
 INFO interface: output: ==> wef: Machine booted and ready!
==> wef: Machine booted and ready!
 INFO warden: Calling IN action: #<Proc:0x00000243508bbcb8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x000002435249f010 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<Proc:0x00000243522c9588 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x00000243522c9588 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x000002435249f010 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x00000243508bbcb8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x00000243508bbd08>
 INFO warden: Calling OUT action: VMware Middleware: ForwardPorts
 INFO warden: Calling OUT action: VMware Middleware: WaitForAddress
 INFO warden: Calling OUT action: VMware Middleware: Boot
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x00000243513bbd70>
 INFO warden: Calling OUT action: VMware Middleware: PrepareForwardedPortCollisionParams
 INFO warden: Calling OUT action: VMware Middleware: VMXModify
 INFO interface: info: Setting hostname...
 INFO interface: info: ==> wef: Setting hostname...
==> wef: Setting hostname...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5986=>2205, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: ADC5C774-C3ED-4300-8394-AC605A5FD4EF
DEBUG winrmshell: [WinRM] Command created for hostname with id: 37BA72EF-83A1-4D6B-87F7-0B8C5013234A
DEBUG winrmshell: [WinRM] creating command_id: 37BA72EF-83A1-4D6B-87F7-0B8C5013234A on shell_id ADC5C774-C3ED-4300-8394-AC605A5FD4EF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 37BA72EF-83A1-4D6B-87F7-0B8C5013234A on shell_id ADC5C774-C3ED-4300-8394-AC605A5FD4EF
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243508b8c70 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: change_host_name
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: change_host_name in windows
 INFO guest: Execute capability: change_host_name [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, "wef"] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b8fd98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b8ed80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ae1a68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8CBE8374-DC0E-44F7-A1EE-73C69F575737
DEBUG winrmshell: [WinRM] Command created for if ([System.Net.Dns]::GetHostName() -eq 'wef') { exit 0 } exit 1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 32B578B9-22E6-4D5E-8A27-DA9B45AAA4B0
DEBUG winrmshell: [WinRM] creating command_id: 32B578B9-22E6-4D5E-8A27-DA9B45AAA4B0 on shell_id 8CBE8374-DC0E-44F7-A1EE-73C69F575737
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 32B578B9-22E6-4D5E-8A27-DA9B45AAA4B0 on shell_id 8CBE8374-DC0E-44F7-A1EE-73C69F575737
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a498a8 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SetHostname:0x0000024352340430>
 INFO warden: Calling OUT action: VMware Middleware: BaseMacToIp
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
 INFO interface: info: Configuring network adapters within the VM...
 INFO interface: info: ==> wef: Configuring network adapters within the VM...
==> wef: Configuring network adapters within the VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 22=>2209, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 583D37AF-1785-4A7C-963C-55421A138F29
DEBUG winrmshell: [WinRM] Command created for hostname with id: FCC3924B-96A8-4CF8-BE7A-682B9EAE67A2
DEBUG winrmshell: [WinRM] creating command_id: FCC3924B-96A8-4CF8-BE7A-682B9EAE67A2 on shell_id 583D37AF-1785-4A7C-963C-55421A138F29
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FCC3924B-96A8-4CF8-BE7A-682B9EAE67A2 on shell_id 583D37AF-1785-4A7C-963C-55421A138F29
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f58d80 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: configure_networks
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: configure_networks in windows
 INFO guest: Execute capability: configure_networks [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.103", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]] (windows)
DEBUG configure_networks: Networks: [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.103", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]
 INFO interface: warn: Configuring secondary network adapters through VMware 
 INFO interface: warn: ==> wef: Configuring secondary network adapters through VMware 
==> wef: Configuring secondary network adapters through VMware 
 INFO interface: warn: on Windows is not yet supported. You will need to manually
 INFO interface: warn: ==> wef: on Windows is not yet supported. You will need to manually
==> wef: on Windows is not yet supported. You will need to manually
 INFO interface: warn: configure the network adapter.
 INFO interface: warn: ==> wef: configure the network adapter.
==> wef: configure the network adapter.
 INFO warden: Calling OUT action: VMware Middleware: Network
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
 INFO warden: Calling OUT action: VMware Middleware: PrepareNFSSettings
 INFO synced_folders: Invoking synced folder enable: vmware
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2204, 5986=>2208, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 226F7609-89C3-449E-BC61-797D735124FC
DEBUG winrmshell: [WinRM] Command created for hostname with id: AF7944BA-DAD7-46FF-9BFD-342D7EC6D510
DEBUG winrmshell: [WinRM] creating command_id: AF7944BA-DAD7-46FF-9BFD-342D7EC6D510 on shell_id 226F7609-89C3-449E-BC61-797D735124FC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AF7944BA-DAD7-46FF-9BFD-342D7EC6D510 on shell_id 226F7609-89C3-449E-BC61-797D735124FC
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243524ac9e0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: verify_vmware_hgfs
DEBUG guest: Checking in: windows
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 21009
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 2
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2205, 22=>2209}, :udp=>{}}
 INFO synced_folder: Preparing shared folders with VMX...
 INFO interface: info: Enabling and configuring shared folders...
 INFO interface: info: ==> wef: Enabling and configuring shared folders...
==> wef: Enabling and configuring shared folders...
 INFO vmware_driver: Enabling shared folders...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "enableSharedFolders", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31855
DEBUG subprocess: Exit status: 0
 INFO interface: detail: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO interface: detail:     wef: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
    wef: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO vmware_driver: Adding a shared folder '-vagrant': D:/workspace/eWalker/DetectionLab/Vagrant
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "addSharedFolder", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "setSharedFolderState", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant", "writable"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2205, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 79E863D5-46EE-4CE6-BD9F-0A25588A8853
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4D7E42EE-CBE2-4C36-8C3A-A3D6C865BAF0
DEBUG winrmshell: [WinRM] creating command_id: 4D7E42EE-CBE2-4C36-8C3A-A3D6C865BAF0 on shell_id 79E863D5-46EE-4CE6-BD9F-0A25588A8853
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4D7E42EE-CBE2-4C36-8C3A-A3D6C865BAF0 on shell_id 79E863D5-46EE-4CE6-BD9F-0A25588A8853
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024353021898 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: mount_vmware_shared_folder
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: mount_vmware_shared_folder in windows
 INFO guest: Execute capability: mount_vmware_shared_folder [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, "-vagrant", "/vagrant", {:guestpath=>"/vagrant", :hostpath=>"D:/workspace/eWalker/DetectionLab/Vagrant", :disabled=>false, :__vagrantfile=>true, :plugin=>#<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000024352a98b88 @logger=#<Log4r::Logger:0x0000024352a98b10 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_logger=#<Log4r::Logger:0x0000024352ab9680 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::syncedfolder", @outputters=[], @additive=true, @name="syncedfolder", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x000002434ff30f40 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware, #<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000024352ad01a0 @logger=#<Log4r::Logger:0x0000024352ad0128 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>>]], @cap_args=[#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:virtualbox=>#<Vagrant::Registry:0x0000024352ab9888 @items={:mount_options=>#<Proc:0x0000024350450ae8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:72>, :mount_type=>#<Proc:0x0000024350450a20 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:77>, :mount_name=>#<Proc:0x0000024350450958 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:82>}, @results_cache={}>, :smb=>#<Vagrant::Registry:0x0000024352ab97e8 @items={:default_fstab_modification=>#<Proc:0x000002435052d100 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:26>, :mount_options=>#<Proc:0x000002435052d088 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:31>, :mount_name=>#<Proc:0x000002435052d010 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:36>, :mount_type=>#<Proc:0x000002435052cf98 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:41>}, @results_cache={}>}>, :owner=>"vagrant", :group=>"vagrant"}] (windows)
DEBUG winrm: powershell executing:
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a1be58 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a1afa8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352991528 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 844E054A-E777-488C-961D-C36C380A67A0
DEBUG winrmshell: [WinRM] Command created for function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B7327A4F-10A1-4484-A213-7B62C42EB8D3
DEBUG winrmshell: [WinRM] creating command_id: B7327A4F-10A1-4484-A213-7B62C42EB8D3 on shell_id 844E054A-E777-488C-961D-C36C380A67A0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B7327A4F-10A1-4484-A213-7B62C42EB8D3 on shell_id 844E054A-E777-488C-961D-C36C380A67A0
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243523b0528 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2208, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A9846BC8-E629-4EA2-AE88-C041BE48175B
DEBUG winrmshell: [WinRM] Command created for hostname with id: 13A3A133-87F9-414D-B7D8-073F8F733EDA
DEBUG winrmshell: [WinRM] creating command_id: 13A3A133-87F9-414D-B7D8-073F8F733EDA on shell_id A9846BC8-E629-4EA2-AE88-C041BE48175B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 13A3A133-87F9-414D-B7D8-073F8F733EDA on shell_id A9846BC8-E629-4EA2-AE88-C041BE48175B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352e6d510 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: persist_mount_shared_folder
DEBUG guest: Checking in: windows
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolders:0x0000024350859798>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Delayed:0x0000024350859838>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x0000024350e55750>
 INFO warden: Calling OUT action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x0000024350f4b150>
 INFO warden: Calling OUT action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO provision: Writing provisioning sentinel so we don't provision again
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352b3e308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2208, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2246AF04-C6BD-423F-BECC-057196D72049
DEBUG winrmshell: [WinRM] Command created for hostname with id: 6A86F4D6-4ECC-4E3C-AE80-D819A7EB70A3
DEBUG winrmshell: [WinRM] creating command_id: 6A86F4D6-4ECC-4E3C-AE80-D819A7EB70A3 on shell_id 2246AF04-C6BD-423F-BECC-057196D72049
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6A86F4D6-4ECC-4E3C-AE80-D819A7EB70A3 on shell_id 2246AF04-C6BD-423F-BECC-057196D72049
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352289c58 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5985=>2204, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 55295A7A-FD02-45D8-B66B-B6B054FD73A3
DEBUG winrmshell: [WinRM] Command created for hostname with id: ECC2FB4E-CDC9-46E4-A8A0-F230E819CAD8
DEBUG winrmshell: [WinRM] creating command_id: ECC2FB4E-CDC9-46E4-A8A0-F230E819CAD8 on shell_id 55295A7A-FD02-45D8-B66B-B6B054FD73A3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ECC2FB4E-CDC9-46E4-A8A0-F230E819CAD8 on shell_id 55295A7A-FD02-45D8-B66B-B6B054FD73A3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352e11af8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2209, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EC881603-DA74-4983-A407-AB23699D55C5
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8974E415-32E4-4DC6-8953-B7A7FFBE7E2B
DEBUG winrmshell: [WinRM] creating command_id: 8974E415-32E4-4DC6-8953-B7A7FFBE7E2B on shell_id EC881603-DA74-4983-A407-AB23699D55C5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8974E415-32E4-4DC6-8953-B7A7FFBE7E2B on shell_id EC881603-DA74-4983-A407-AB23699D55C5
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243523786a0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d71968 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d70ae0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c7ceb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: EA6D6DB5-8AEA-40A3-A982-02BAFBD5523B
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 89E406A6-BB9F-432A-A812-B131DC4F43C8
DEBUG winrmshell: [WinRM] creating command_id: 89E406A6-BB9F-432A-A812-B131DC4F43C8 on shell_id EA6D6DB5-8AEA-40A3-A982-02BAFBD5523B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 89E406A6-BB9F-432A-A812-B131DC4F43C8 on shell_id EA6D6DB5-8AEA-40A3-A982-02BAFBD5523B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352bdd9a8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353249d78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353248ef0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435311ea70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5954C0F5-5BA4-4F3F-8AE9-C5FD312F3CDC
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 75F909EA-4735-426D-A62D-618A903E4D37
DEBUG winrmshell: [WinRM] creating command_id: 75F909EA-4735-426D-A62D-618A903E4D37 on shell_id 5954C0F5-5BA4-4F3F-8AE9-C5FD312F3CDC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 75F909EA-4735-426D-A62D-618A903E4D37 on shell_id 5954C0F5-5BA4-4F3F-8AE9-C5FD312F3CDC
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352fe2fd0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1c2jdz5.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352388bb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352382358 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243520d12f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "df3bb7a140e7cb3fdabbde32ca410ed38003dcb4" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-1c2jdz5.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 40047A2F-C8EA-466F-AC9A-6DB02409E0AF
DEBUG winrmshell: [WinRM] creating command_id: 40047A2F-C8EA-466F-AC9A-6DB02409E0AF on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 40047A2F-C8EA-466F-AC9A-6DB02409E0AF on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"False","df3bb7a140e7cb3fdabbde32ca410ed38003dcb4",,"True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1c2jdz5.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: EB1BC4BF-57B3-4EA7-A386-071DAF4CC214
DEBUG winrmshell: [WinRM] creating command_id: EB1BC4BF-57B3-4EA7-A386-071DAF4CC214 on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EB1BC4BF-57B3-4EA7-A386-071DAF4CC214 on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBTb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9TdGVmYW5TY2hlcmVyL2FkZnMyCnBhcmFtIChbU3RyaW5nXSAkaXAsIFtTdHJpbmddICRkbnMsIFtTdHJpbmddICRnYXRld2F5KQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFJ1bm5pbmcgZml4LXNlY29uZC1uZXR3b3JrLnBzMS4uLiIKCmlmICggKEdldC1OZXRBZGFwdGVyIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgMSB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IEludGVyZmFjZURlc2NyaXB0aW9uKS5Db250YWlucygnUmVkIEhhdCBWaXJ0SU8nKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIE5ldHdvcmsgQ29uZmlndXJhdGlvbiBmb3IgTGliVmlydCBpbnRlcmZhY2UiCiAgJHN1Ym5ldCA9ICRpcCAtcmVwbGFjZSAiXC5cZCskIiwgIiIKICAkbmFtZSA9IChHZXQtTmV0SVBBZGRyZXNzIC1BZGRyZXNzRmFtaWx5IElQdjQgYAogICAgIHwgV2hlcmUtT2JqZWN0IC1GaWx0ZXJTY3JpcHQgeyAoJF8uSVBBZGRyZXNzKS5TdGFydHNXaXRoKCIkc3VibmV0IikgfSBgCiAgICAgKS5JbnRlcmZhY2VBbGlhcwogIGlmICgkbmFtZSkgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldCBJUCBhZGRyZXNzIHRvICRpcCBvZiBpbnRlcmZhY2UgJG5hbWUiCiAgICAmIG5ldHNoLmV4ZSBpbnQgaXAgc2V0IGFkZHJlc3MgIiRuYW1lIiBzdGF0aWMgJGlwIDI1NS4yNTUuMjU1LjAgIiRnYXRld2F5IgogICAgaWYgKCRkbnMpIHsKICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldCBETlMgc2VydmVyIGFkZHJlc3MgdG8gJGRucyBvZiBpbnRlcmZhY2UgJG5hbWUiCiAgICAgICYgbmV0c2guZXhlIGludGVyZmFjZSBpcHY0IGFkZCBkbnNzZXJ2ZXIgIiRuYW1lIiBhZGRyZXNzPSRkbnMgaW5kZXg9MQogICAgfQogIH0gZWxzZSB7CiAgICBXcml0ZS1FcnJvciAiQ291bGQgbm90IGZpbmQgYSBpbnRlcmZhY2Ugd2l0aCBzdWJuZXQgJHN1Ym5ldC54eCIKICB9CiAgZXhpdCAwCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE5vIFZpcnRJTyBhZGFwdGVycywgbW92aW5nIG9uLi4uIgp9CgppZiAoISAoVGVzdC1QYXRoICdDOlxQcm9ncmFtIEZpbGVzXFZNd2FyZVxWTXdhcmUgVG9vbHMnKSApIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVk13YXJlIFRvb2xzIG5vdCBmb3VuZCwgbm8gbmVlZCB0byBjb250aW51ZS4gRXhpdGluZy4iCiAgZXhpdCAwCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSIKV3JpdGUtSG9zdCAiU2V0dGluZyBJUCBhZGRyZXNzIGFuZCBETlMgaW5mb3JtYXRpb24gZm9yIHRoZSBFdGhlcm5ldDEgaW50ZXJmYWNlIgpXcml0ZS1Ib3N0ICJJZiB0aGlzIHN0ZXAgdGltZXMgb3V0LCBpdCdzIGJlY2F1c2UgdmFncmFudCBpcyBjb25uZWN0aW5nIHRvIHRoZSBWTSBvbiB0aGUgd3JvbmcgaW50ZXJmYWNlIgpXcml0ZS1Ib3N0ICJTZWUgaHR0cHM6Ly9naXRodWIuY29tL2Nsb25nL0RldGVjdGlvbkxhYi9pc3N1ZXMvMTE0IGZvciBtb3JlIGluZm9ybWF0aW9uIgoKJHN1Ym5ldCA9ICRpcCAtcmVwbGFjZSAiXC5cZCskIiwgIiIKJG5hbWUgPSAoR2V0LU5ldElQQWRkcmVzcyAtQWRkcmVzc0ZhbWlseSBJUHY0IGAKICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7ICgkXy5JUEFkZHJlc3MpLlN0YXJ0c1dpdGgoJHN1Ym5ldCkgfSBgCiAgICkuSW50ZXJmYWNlQWxpYXMKaWYgKCEkbmFtZSkgewogICRuYW1lID0gKEdldC1OZXRJUEFkZHJlc3MgLUFkZHJlc3NGYW1pbHkgSVB2NCBgCiAgICAgfCBXaGVyZS1PYmplY3QgLUZpbHRlclNjcmlwdCB7ICgkXy5JUEFkZHJlc3MpLlN0YXJ0c1dpdGgoIjE2OS4yNTQuIikgfSBgCiAgICAgKS5JbnRlcmZhY2VBbGlhcwp9CmlmICgkbmFtZSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXQgSVAgYWRkcmVzcyB0byAkaXAgb2YgaW50ZXJmYWNlICRuYW1lIgogICYgbmV0c2guZXhlIGludCBpcCBzZXQgYWRkcmVzcyAiJG5hbWUiIHN0YXRpYyAkaXAgMjU1LjI1NS4yNTUuMCAiJHN1Ym5ldC4xIgogIGlmICgkZG5zKSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU2V0IEROUyBzZXJ2ZXIgYWRkcmVzcyB0byAkZG5zIG9mIGludGVyZmFjZSAkbmFtZSIKICAgICYgbmV0c2guZXhlIGludGVyZmFjZSBpcHY0IGFkZCBkbnNzZXJ2ZXIgIiRuYW1lIiBhZGRyZXNzPSRkbnMgaW5kZXg9MQogIH0KfSBlbHNlIHsKICBXcml0ZS1FcnJvciAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIENvdWxkIG5vdCBmaW5kIGEgaW50ZXJmYWNlIHdpdGggc3VibmV0ICRzdWJuZXQueHgiCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 287C2646-3BAE-4F71-B9D4-D258446D7758
DEBUG winrmshell: [WinRM] creating command_id: 287C2646-3BAE-4F71-B9D4-D258446D7758 on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 287C2646-3BAE-4F71-B9D4-D258446D7758 on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B4A8F495-63CD-43AD-9C94-C31DAD75E890
DEBUG winrmshell: [WinRM] creating command_id: B4A8F495-63CD-43AD-9C94-C31DAD75E890 on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B4A8F495-63CD-43AD-9C94-C31DAD75E890 on shell_id E9FEE63C-3447-4688-835A-6A095DD4272A
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1c2jdz5.ps1 to C:/tmp/vagrant-shell.ps1 (3.296 KB over 1 chunks) in (0m0.45s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.52s) stream_files: (0m0.45s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/fix-second-network.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: elevated executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1" -ip 192.168.56.103 -dns 8.8.8.8 -gateway 192.168.56.1
DEBUG winrmshell: creating hash for file c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243530d74b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243530d6518 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fd3788 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "44e3cd1f991c628a9ae726a40b99b80120e6309f" = @{
    "target" = "c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1";
    "src_basename" = "c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1";
    "dst" = "c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 15EC3636-0399-491A-8311-BF911BCF30F5
DEBUG winrmshell: [WinRM] creating command_id: 15EC3636-0399-491A-8311-BF911BCF30F5 on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 15EC3636-0399-491A-8311-BF911BCF30F5 on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"False","44e3cd1f991c628a9ae726a40b99b80120e6309f",,"True","False","False"


DEBUG winrmshell: Uploading #<StringIO:0x000002435249eca0> to c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DA52E862-625B-4C42-8734-6AC41C1444A0
DEBUG winrmshell: [WinRM] creating command_id: DA52E862-625B-4C42-8734-6AC41C1444A0 on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DA52E862-625B-4C42-8734-6AC41C1444A0 on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('77u/cG93ZXJzaGVsbCAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtT3V0cHV0Rm9ybWF0IFRleHQgLWZpbGUgIkM6XHRtcFx2YWdyYW50LXNoZWxsLnBzMSIgLWlwIDE5Mi4xNjguNTYuMTAzIC1kbnMgOC44LjguOCAtZ2F0ZXdheSAxOTIuMTY4LjU2LjENCiRIb3N0LlNldFNob3VsZEV4aXQoJExBU1RFWElUQ09ERSk=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2D3CFD1E-D21A-4821-9D72-0F29F41525EB
DEBUG winrmshell: [WinRM] creating command_id: 2D3CFD1E-D21A-4821-9D72-0F29F41525EB on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2D3CFD1E-D21A-4821-9D72-0F29F41525EB on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7EE091B1-445A-40EE-ACB1-8667547D336F
DEBUG winrmshell: [WinRM] creating command_id: 7EE091B1-445A-40EE-ACB1-8667547D336F on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7EE091B1-445A-40EE-ACB1-8667547D336F on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: Finished uploading #<StringIO:0x000002435249eca0> to c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1 (0.236 KB over 1 chunks) in (0m0.20s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.45s) stream_files: (0m0.20s) extract: (0m0.00s) 
DEBUG winrmshell: [WinRM] Command created for $username = 'vagrant'
$password = 'vagrant'
$script_file = 'c:/windows/temp/winrm-elevated-shell-91014e02-1483-4785-bac8-39b197fd1623.ps1'

$interactive = 'false'
$pass_to_use = $password
$logon_type = 1
$logon_type_xml = "<LogonType>Password</LogonType>"
if($pass_to_use.length -eq 0) {
  $pass_to_use = $null
  $logon_type = 5
  $logon_type_xml = ""
}
if($interactive -eq 'true') {
  $logon_type = 3
  $logon_type_xml = "<LogonType>InteractiveTokenOrPassword</LogonType>"
}

$task_name = "WinRM_Elevated_Shell_" + [guid]::NewGuid()
$out_file = [System.IO.Path]::GetTempFileName()
$err_file = [System.IO.Path]::GetTempFileName()

$task_xml = @'
<?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <Principals>
    <Principal id="Author">
      <UserId>{username}</UserId>
      {logon_type}
      <RunLevel>HighestAvailable</RunLevel>
    </Principal>
  </Principals>
  <Settings>
    <MultipleInstancesPolicy>IgnoreNew</MultipleInstancesPolicy>
    <DisallowStartIfOnBatteries>false</DisallowStartIfOnBatteries>
    <StopIfGoingOnBatteries>false</StopIfGoingOnBatteries>
    <AllowHardTerminate>true</AllowHardTerminate>
    <StartWhenAvailable>false</StartWhenAvailable>
    <RunOnlyIfNetworkAvailable>false</RunOnlyIfNetworkAvailable>
    <IdleSettings>
      <StopOnIdleEnd>false</StopOnIdleEnd>
      <RestartOnIdle>false</RestartOnIdle>
    </IdleSettings>
    <AllowStartOnDemand>true</AllowStartOnDemand>
    <Enabled>true</Enabled>
    <Hidden>false</Hidden>
    <RunOnlyIfIdle>false</RunOnlyIfIdle>
    <WakeToRun>false</WakeToRun>
    <ExecutionTimeLimit>PT24H</ExecutionTimeLimit>
    <Priority>4</Priority>
  </Settings>
  <Actions Context="Author">
    <Exec>
      <Command>cmd</Command>
      <Arguments>{arguments}</Arguments>
    </Exec>
  </Actions>
</Task>
'@

$arguments = "/c powershell.exe -executionpolicy bypass -NoProfile -File $script_file &gt; $out_file 2&gt;$err_file"

$task_xml = $task_xml.Replace("{arguments}", $arguments)
$task_xml = $task_xml.Replace("{username}", $username)
$task_xml = $task_xml.Replace("{logon_type}", $logon_type_xml)

try {
    $schedule = New-Object -ComObject "Schedule.Service"
    $schedule.Connect()
    $task = $schedule.NewTask($null)
    $task.XmlText = $task_xml
    $folder = $schedule.GetFolder("\")
    $folder.RegisterTaskDefinition($task_name, $task, 6, $username, $pass_to_use, $logon_type, $null) | Out-Null

    $registered_task = $folder.GetTask("\$task_name")
    $registered_task.Run($null) | Out-Null

    $timeout = 10
    $sec = 0
    while ( (!($registered_task.state -eq 4)) -and ($sec -lt $timeout) ) {
        Start-Sleep -s 1
        $sec++
    }
} catch {
    Write-Error -ErrorRecord $PSItem
    exit $PSItem.Exception.HResult
}

function SlurpOutput($file, $cur_line, $out_type) {
  if (Test-Path $file) {
    $fs = New-Object -TypeName System.IO.FileStream -ArgumentList @(
      $file,
      [system.io.filemode]::Open,
      [System.io.FileAccess]::Read,
      [System.IO.FileShare]::ReadWrite
    )
    try {
      $enc = [System.Text.Encoding]::GetEncoding($Host.CurrentCulture.TextInfo.OEMCodePage)
      $bytes = [System.Byte[]]::CreateInstance([System.Byte], $fs.Length)
      if ($fs.Read($bytes, 0, $fs.Length) -gt 0) {
        $text = $enc.GetString($bytes)
        $text.TrimEnd("`n").TrimEnd("`r").Split(@("`r`n", "`n"), [StringSplitOptions]::None) | Select-Object -skip $cur_line | ForEach-Object {
          $cur_line += 1
          if ($out_type -eq 'err') {
            $host.ui.WriteErrorLine("$_")
          } else {
            $host.ui.WriteLine("$_")
          }
        }
      }
    }
    finally { $fs.Close() }
  }
  return $cur_line
}

$err_cur_line = 0
$out_cur_line = 0
$timeout = 86400
$startDate = Get-Date
do {
  Start-Sleep -m 100
  $out_cur_line = SlurpOutput $out_file $out_cur_line 'out'
  $err_cur_line = SlurpOutput $err_file $err_cur_line 'err'
} while( (!($registered_task.state -eq 3)) -and ($startDate.AddSeconds($timeout) -gt (Get-Date)) )

# We'll make a best effort to clean these files
# But a reboot could possibly end the task while the process
# still runs and locks the file. If we can't delete we don't want to fail
try { Remove-Item $out_file -ErrorAction Stop } catch {}
try { Remove-Item $err_file -ErrorAction Stop } catch {}
try { Remove-Item $script_file -ErrorAction Stop } catch {}

$exit_code = $registered_task.LastTaskResult

try {
  # Clean current task
  $folder.DeleteTask($task_name, 0)
  # Clean old tasks if required
  $old_tasks_filter_date = [datetime]::Now.AddSeconds(-86400)
  $old_tasks_to_kill = $folder.GetTasks(0) | Select Name,LastRunTime | Where-Object {
    ($_.Name -like "WinRM_Elevated_Shell*") -and ($_.LastRunTime -le $old_tasks_filter_date) -and ($_.Name -ne $task_name)
  }
  $old_tasks_to_kill | ForEach-Object { try { $folder.DeleteTask($_.Name, 0) } catch {} }
}
catch {}

[System.Runtime.Interopservices.Marshal]::ReleaseComObject($schedule) | Out-Null

exit $exit_code


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 58C96BD2-5E69-45F5-B8C1-782C4CDCE59B
DEBUG winrmshell: [WinRM] creating command_id: 58C96BD2-5E69-45F5-B8C1-782C4CDCE59B on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [19:48] Running fix-second-network.ps1...
 INFO interface: detail:     wef: [19:48] Running fix-second-network.ps1...
    wef: [19:48] Running fix-second-network.ps1...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [19:48] No VirtIO adapters, moving on...
 INFO interface: detail:     wef: [19:48] No VirtIO adapters, moving on...
    wef: [19:48] No VirtIO adapters, moving on...
 INFO interface: detail: [19:48]
 INFO interface: detail:     wef: [19:48]
    wef: [19:48]
 INFO interface: detail: Setting IP address and DNS information for the Ethernet1 interface
 INFO interface: detail:     wef: Setting IP address and DNS information for the Ethernet1 interface
    wef: Setting IP address and DNS information for the Ethernet1 interface
 INFO interface: detail: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
 INFO interface: detail:     wef: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
    wef: If this step times out, it's because vagrant is connecting to the VM on the wrong interface
 INFO interface: detail: See https://github.com/clong/DetectionLab/issues/114 for more information
 INFO interface: detail:     wef: See https://github.com/clong/DetectionLab/issues/114 for more information
    wef: See https://github.com/clong/DetectionLab/issues/114 for more information
 INFO interface: detail: [19:48] Set IP address to 192.168.56.103 of interface Ethernet1
 INFO interface: detail:     wef: [19:48] Set IP address to 192.168.56.103 of interface Ethernet1
    wef: [19:48] Set IP address to 192.168.56.103 of interface Ethernet1
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [19:48] Set DNS server address to 8.8.8.8 of interface Ethernet1
 INFO interface: detail:     wef: [19:48] Set DNS server address to 8.8.8.8 of interface Ethernet1
    wef: [19:48] Set DNS server address to 8.8.8.8 of interface Ethernet1
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 58C96BD2-5E69-45F5-B8C1-782C4CDCE59B on shell_id 627C82EC-8D80-487A-BEF9-4CF503B21F40
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243530212a8 @data=[{:stdout=>"[19:48] Running fix-second-network.ps1...\r\n"}, {:stdout=>"[19:48] No VirtIO adapters, moving on...\r\n"}, {:stdout=>"[19:48]\r\n"}, {:stdout=>"Setting IP address and DNS information for the Ethernet1 interface\r\n"}, {:stdout=>"If this step times out, it's because vagrant is connecting to the VM on the wrong interface\r\n"}, {:stdout=>"See https://github.com/clong/DetectionLab/issues/114 for more information\r\n"}, {:stdout=>"[19:48] Set IP address to 192.168.56.103 of interface Ethernet1\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[19:48] Set DNS server address to 8.8.8.8 of interface Ethernet1\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352b3e308 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352a48110 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 5985=>2204, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D3E14DC6-5D72-47C3-A0EE-8E52C803247C
DEBUG winrmshell: [WinRM] Command created for hostname with id: E4EB381E-2906-41DD-AE48-504CD06D03A1
DEBUG winrmshell: [WinRM] creating command_id: E4EB381E-2906-41DD-AE48-504CD06D03A1 on shell_id D3E14DC6-5D72-47C3-A0EE-8E52C803247C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E4EB381E-2906-41DD-AE48-504CD06D03A1 on shell_id D3E14DC6-5D72-47C3-A0EE-8E52C803247C
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243507f31c8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2208, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8BA82C9D-3579-400B-8992-A6ACBD3CFA02
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8DB7F6B0-4DFE-4040-9C92-579749F3FA15
DEBUG winrmshell: [WinRM] creating command_id: 8DB7F6B0-4DFE-4040-9C92-579749F3FA15 on shell_id 8BA82C9D-3579-400B-8992-A6ACBD3CFA02
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8DB7F6B0-4DFE-4040-9C92-579749F3FA15 on shell_id 8BA82C9D-3579-400B-8992-A6ACBD3CFA02
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c6cbd0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2209, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 08CF26F2-577B-4D35-850C-5FB90CE1D4E6
DEBUG winrmshell: [WinRM] Command created for hostname with id: 76570DA2-B2CD-49F7-B9B1-C22B6941D994
DEBUG winrmshell: [WinRM] creating command_id: 76570DA2-B2CD-49F7-B9B1-C22B6941D994 on shell_id 08CF26F2-577B-4D35-850C-5FB90CE1D4E6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 76570DA2-B2CD-49F7-B9B1-C22B6941D994 on shell_id 08CF26F2-577B-4D35-850C-5FB90CE1D4E6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024350e9cc40 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bf5bc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bf4d38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b1b448 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 75B7547E-5A4B-4C7F-875D-26CAAF29852A
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5DAE021D-49AF-4F27-8FB5-BF76FAC9915F
DEBUG winrmshell: [WinRM] creating command_id: 5DAE021D-49AF-4F27-8FB5-BF76FAC9915F on shell_id 75B7547E-5A4B-4C7F-875D-26CAAF29852A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5DAE021D-49AF-4F27-8FB5-BF76FAC9915F on shell_id 75B7547E-5A4B-4C7F-875D-26CAAF29852A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a81e10 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fe9ee8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fe9038 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f25778 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4CC75D24-A4B0-43A8-825B-98CC43D8BDA3
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DEEEF8A6-0DD6-418A-BB28-25EE0431D9CA
DEBUG winrmshell: [WinRM] creating command_id: DEEEF8A6-0DD6-418A-BB28-25EE0431D9CA on shell_id 4CC75D24-A4B0-43A8-825B-98CC43D8BDA3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DEEEF8A6-0DD6-418A-BB28-25EE0431D9CA on shell_id 4CC75D24-A4B0-43A8-825B-98CC43D8BDA3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352e13948 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-mo7910.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243508b3018 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243508aa5f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243532f4e30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "91103d0ccbde4757bd913a8feb78e434a7d2d5dc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-mo7910.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 42637EF2-5001-4BE3-BD46-F994973565E2
DEBUG winrmshell: [WinRM] creating command_id: 42637EF2-5001-4BE3-BD46-F994973565E2 on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 42637EF2-5001-4BE3-BD46-F994973565E2 on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","df3bb7a140e7cb3fdabbde32ca410ed38003dcb4","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-mo7910.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: ADB3D46F-C8A0-4A15-9559-BE93880FF73A
DEBUG winrmshell: [WinRM] creating command_id: ADB3D46F-C8A0-4A15-9559-BE93880FF73A on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ADB3D46F-C8A0-4A15-9559-BE93880FF73A on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBTZXRzIHRpbWV6b25lIHRvIFVUQywgc2V0cyBob3N0bmFtZSwgY3JlYXRlcy9qb2lucyBkb21haW4uCiMgU291cmNlOiBodHRwczovL2dpdGh1Yi5jb20vU3RlZmFuU2NoZXJlci9hZGZzMgoKJFByb2ZpbGVQYXRoID0gIkM6XFdpbmRvd3NcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxwcm9maWxlLnBzMSIKJGJveCA9IEdldC1JdGVtUHJvcGVydHkgLVBhdGggSEtMTTpTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcQ29udHJvbFxDb21wdXRlck5hbWVcQ29tcHV0ZXJOYW1lIC1OYW1lICJDb21wdXRlck5hbWUiCiRib3ggPSAkYm94LkNvbXB1dGVyTmFtZS5Ub1N0cmluZygpLlRvTG93ZXIoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNldHRpbmcgdGltZXpvbmUgdG8gVVRDLi4uIgpjOlx3aW5kb3dzXHN5c3RlbTMyXHR6dXRpbC5leGUgL3MgIlVUQyIKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDaGVja2luZyBpZiBXaW5kb3dzIGV2YWx1YXRpb24gaXMgZXhwaXJpbmcgc29vbiBvciBleHBpcmVkLi4uIgouIGM6XHZhZ3JhbnRcc2NyaXB0c1xmaXgtd2luZG93cy1leHBpcmF0aW9uLnBzMQoKSWYgKCEoVGVzdC1QYXRoICRQcm9maWxlUGF0aCkpIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGlzYWJsaW5nIHRoZSBJbnZva2UtV2ViUmVxdWVzdCBkb3dubG9hZCBwcm9ncmVzcyBiYXIgZ2xvYmFsbHkgZm9yIHNwZWVkIGltcHJvdmVtZW50cy4iIAogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZWUgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOCBmb3IgbW9yZSBpbmZvIgogIE5ldy1JdGVtIC1QYXRoICRQcm9maWxlUGF0aCB8IE91dC1OdWxsCiAgSWYgKCEoR2V0LUNvbnRlbnQgJFByb2ZpbGVwYXRofCAlIHsgJF8gLW1hdGNoICJTaWxlbnRseUNvbnRpbnVlIiB9ICkpIHsKICAgIEFkZC1Db250ZW50IC1QYXRoICRQcm9maWxlUGF0aCAtVmFsdWUgIiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZSciCiAgfQp9CgojIFBpbmcgRGV0ZWN0aW9uTGFiIHNlcnZlciBmb3IgdXNhZ2Ugc3RhdGlzdGljcwpUcnkgewogIGN1cmwgLXVzZXJBZ2VudCAiRGV0ZWN0aW9uTGFiLSRib3giICJodHRwczovL3BpbmcuZGV0ZWN0aW9ubGFiLm5ldHdvcmsvJGJveCIgLVVzZUJhc2ljUGFyc2luZyB8IG91dC1udWxsCn0gQ2F0Y2ggewogIFdyaXRlLUhvc3QgIlVuYWJsZSB0byBjb25uZWN0IHRvIHBpbmcuZGV0ZWN0aW9ubGFiLm5ldHdvcmsiCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEaXNhYmxpbmcgSVB2NiBvbiBhbGwgbmV0d29yayBhZGF0cGVycy4uLiIKR2V0LU5ldEFkYXB0ZXJCaW5kaW5nIC1Db21wb25lbnRJRCBtc190Y3BpcDYgfCBGb3JFYWNoLU9iamVjdCB7RGlzYWJsZS1OZXRBZGFwdGVyQmluZGluZyAtTmFtZSAkXy5OYW1lIC1Db21wb25lbnRJRCBtc190Y3BpcDZ9CkdldC1OZXRBZGFwdGVyQmluZGluZyAtQ29tcG9uZW50SUQgbXNfdGNwaXA2IAojIGh0dHBzOi8vc3VwcG9ydC5taWNyb3NvZnQuY29tL2VuLWdiL2hlbHAvOTI5ODUyL2d1aWRhbmNlLWZvci1jb25maWd1cmluZy1pcHY2LWluLXdpbmRvd3MtZm9yLWFkdmFuY2VkLXVzZXJzCnJlZyBhZGQgIkhLRVlfTE9DQUxfTUFDSElORVxTWVNURU1cQ3VycmVudENvbnRyb2xTZXRcU2VydmljZXNcVGNwaXA2XFBhcmFtZXRlcnMiIC92IERpc2FibGVkQ29tcG9uZW50cyAvdCBSRUdfRFdPUkQgL2QgMjU1IC9mCgppZiAoJGVudjpDT01QVVRFUk5BTUUgLWltYXRjaCAndmFncmFudCcpIHsKCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEhvc3RuYW1lIGlzIHN0aWxsIHRoZSBvcmlnaW5hbCBvbmUsIHNraXAgcHJvdmlzaW9uaW5nIGZvciByZWJvb3QuLi4iCgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIGJnaW5mby4uLiIKICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xpbnN0YWxsLWJnaW5mby5wczEKCn0gZWxzZWlmICgoZ3dtaSB3aW4zMl9jb21wdXRlcnN5c3RlbSkucGFydG9mZG9tYWluIC1lcSAkZmFsc2UpIHsKCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEN1cnJlbnQgZG9tYWluIGlzIHNldCB0byAnd29ya2dyb3VwJy4gVGltZSB0byBqb2luIHRoZSBkb21haW4hIgoKICBpZiAoIShUZXN0LVBhdGggJ2M6XFByb2dyYW0gRmlsZXNcc3lzaW50ZXJuYWxzXGJnaW5mby5leGUnKSkgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgYmdpbmZvLi4uIgogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcaW5zdGFsbC1iZ2luZm8ucHMxCiAgICAjIFNldCBiYWNrZ3JvdW5kIHRvIGJlICJmaXR0ZWQiIGluc3RlYWQgb2YgInRpbGVkIgogICAgU2V0LUl0ZW1Qcm9wZXJ0eSAnSEtDVTpcQ29udHJvbCBQYW5lbFxEZXNrdG9wJyAtTmFtZSBUaWxlV2FsbHBhcGVyIC1WYWx1ZSAnMCcKICAgIFNldC1JdGVtUHJvcGVydHkgJ0hLQ1U6XENvbnRyb2wgUGFuZWxcRGVza3RvcCcgLU5hbWUgV2FsbHBhcGVyU3R5bGUgLVZhbHVlICc2JwogICAgIyBTZXQgVGFzayBNYW5hZ2VyIHByZWZzCiAgICByZWcgaW1wb3J0ICJjOlx2YWdyYW50XHJlc291cmNlc1x3aW5kb3dzXFRhc2tNYW5hZ2VyLnJlZyIgMj4mMSB8IG91dC1udWxsCiAgfQoKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgTXkgaG9zdG5hbWUgaXMgJGVudjpDT01QVVRFUk5BTUUiCiAgaWYgKCRlbnY6Q09NUFVURVJOQU1FIC1pbWF0Y2ggJ2RjJykgewogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcY3JlYXRlLWRvbWFpbi5wczEgMTkyLjE2OC41Ni4xMDIKICB9IGVsc2UgewogICAgLiBjOlx2YWdyYW50XHNjcmlwdHNcam9pbi1kb21haW4ucHMxCiAgfQp9IGVsc2UgewogIFdyaXRlLUhvc3QgLWZvcmUgZ3JlZW4gIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJIGFtIGRvbWFpbiBqb2luZWQhIgogIGlmICghKFRlc3QtUGF0aCAnYzpcUHJvZ3JhbSBGaWxlc1xzeXNpbnRlcm5hbHNcYmdpbmZvLmV4ZScpKSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW5zdGFsbGluZyBiZ2luZm8uLi4iCiAgICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xpbnN0YWxsLWJnaW5mby5wczEKICB9CgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIHRoZSByZWdpc3RyeSBmb3IgYXV0by1sb2dpbi4uLiIKICBTZXQtSXRlbVByb3BlcnR5ICJIS0xNOlxTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93cyBOVFxDdXJyZW50VmVyc2lvblxXaW5sb2dvbiIgLU5hbWUgQXV0b0FkbWluTG9nb24gLVZhbHVlIDEgLVR5cGUgU3RyaW5nCiAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC1OYW1lIERlZmF1bHRVc2VyTmFtZSAtVmFsdWUgInZhZ3JhbnQiCiAgU2V0LUl0ZW1Qcm9wZXJ0eSAiSEtMTTpcU09GVFdBUkVcTWljcm9zb2Z0XFdpbmRvd3MgTlRcQ3VycmVudFZlcnNpb25cV2lubG9nb24iIC1OYW1lIERlZmF1bHRQYXNzd29yZCAtVmFsdWUgInZhZ3JhbnQiCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFByb3Zpc2lvbmluZyBhZnRlciBqb2luaW5nIGRvbWFpbi4uLiIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C6FC0824-A33A-400D-A8B4-34E31A71F361
DEBUG winrmshell: [WinRM] creating command_id: C6FC0824-A33A-400D-A8B4-34E31A71F361 on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C6FC0824-A33A-400D-A8B4-34E31A71F361 on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4C075F70-055B-40E3-9154-FAEEFC30B042
DEBUG winrmshell: [WinRM] creating command_id: 4C075F70-055B-40E3-9154-FAEEFC30B042 on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4C075F70-055B-40E3-9154-FAEEFC30B042 on shell_id 4C1EAE0B-40CB-4707-A2BB-5E99D473B0CF
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-mo7910.ps1 to C:/tmp/vagrant-shell.ps1 (5.112 KB over 1 chunks) in (0m0.14s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.36s) stream_files: (0m0.14s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352eb7318 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352eb6490 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dd84d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 766E028C-5EA2-42BC-B244-73D5F542AD51
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B9430845-869D-4902-AA69-569F3C2B5209
DEBUG winrmshell: [WinRM] creating command_id: B9430845-869D-4902-AA69-569F3C2B5209 on shell_id 766E028C-5EA2-42BC-B244-73D5F542AD51
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [19:48] Setting timezone to UTC...
 INFO interface: detail:     wef: [19:48] Setting timezone to UTC...
    wef: [19:48] Setting timezone to UTC...
 INFO interface: detail: [19:48] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail:     wef: [19:48] Checking if Windows evaluation is expiring soon or expired...
    wef: [19:48] Checking if Windows evaluation is expiring soon or expired...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [19:48] 180 days left until expiration, no need to rearm.
 INFO interface: detail:     wef: [19:48] 180 days left until expiration, no need to rearm.
    wef: [19:48] 180 days left until expiration, no need to rearm.
 INFO interface: detail: [19:48] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
 INFO interface: detail:     wef: [19:48] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
    wef: [19:48] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.
 INFO interface: detail: [19:48] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
 INFO interface: detail:     wef: [19:48] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
    wef: [19:48] See https://github.com/PowerShell/PowerShell/issues/2138 for more info
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Unable to connect to ping.detectionlab.network
 INFO interface: detail:     wef: Unable to connect to ping.detectionlab.network
    wef: Unable to connect to ping.detectionlab.network
 INFO interface: detail: [19:48] Disabling IPv6 on all network adatpers...
 INFO interface: detail:     wef: [19:48] Disabling IPv6 on all network adatpers...
    wef: [19:48] Disabling IPv6 on all network adatpers...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Name                           DisplayName                                        ComponentID
 INFO interface: detail:     wef: Name                           DisplayName                                        ComponentID
    wef: Name                           DisplayName                                        ComponentID
 INFO interface: detail: ----                           -----------                                        -----------
 INFO interface: detail:     wef: ----                           -----------                                        -----------
    wef: ----                           -----------                                        -----------
 INFO interface: detail: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     wef: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    wef: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     wef: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    wef: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: The operation completed successfully.
 INFO interface: detail:     wef: The operation completed successfully.
    wef: The operation completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [19:48] Current domain is set to 'workgroup'. Time to join the domain!
 INFO interface: detail:     wef: [19:48] Current domain is set to 'workgroup'. Time to join the domain!
    wef: [19:48] Current domain is set to 'workgroup'. Time to join the domain!
 INFO interface: detail: [19:48] Installing bginfo...
 INFO interface: detail:     wef: [19:48] Installing bginfo...
    wef: [19:48] Installing bginfo...
 INFO interface: detail: [19:48] Installing BGInfo...
 INFO interface: detail:     wef: [19:48] Installing BGInfo...
    wef: [19:48] Installing BGInfo...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
 INFO interface: detail:     wef: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
    wef: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Program Files\sysinternals
 INFO interface: detail: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
 INFO interface: detail:     wef: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
    wef: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Program Files
 INFO interface: detail: PSChildName       : sysinternals
 INFO interface: detail:     wef: PSChildName       : sysinternals
    wef: PSChildName       : sysinternals
 INFO interface: detail: PSDrive           : C
 INFO interface: detail:     wef: PSDrive           : C
    wef: PSDrive           : C
 INFO interface: detail: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail:     wef: PSProvider        : Microsoft.PowerShell.Core\FileSystem
    wef: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail: PSIsContainer     : True
 INFO interface: detail:     wef: PSIsContainer     : True
    wef: PSIsContainer     : True
 INFO interface: detail: Name              : sysinternals
 INFO interface: detail:     wef: Name              : sysinternals
    wef: Name              : sysinternals
 INFO interface: detail: FullName          : C:\Program Files\sysinternals
 INFO interface: detail:     wef: FullName          : C:\Program Files\sysinternals
    wef: FullName          : C:\Program Files\sysinternals
 INFO interface: detail: Parent            : Program Files
 INFO interface: detail:     wef: Parent            : Program Files
    wef: Parent            : Program Files
 INFO interface: detail: Exists            : True
 INFO interface: detail:     wef: Exists            : True
    wef: Exists            : True
 INFO interface: detail: Root              : C:\
 INFO interface: detail:     wef: Root              : C:\
    wef: Root              : C:\
 INFO interface: detail: Extension         :
 INFO interface: detail:     wef: Extension         :
    wef: Extension         :
 INFO interface: detail: CreationTime      : 6/20/2022 7:48:37 PM
 INFO interface: detail:     wef: CreationTime      : 6/20/2022 7:48:37 PM
    wef: CreationTime      : 6/20/2022 7:48:37 PM
 INFO interface: detail: CreationTimeUtc   : 6/21/2022 2:48:37 AM
 INFO interface: detail:     wef: CreationTimeUtc   : 6/21/2022 2:48:37 AM
    wef: CreationTimeUtc   : 6/21/2022 2:48:37 AM
 INFO interface: detail: LastAccessTime    : 6/20/2022 7:48:37 PM
 INFO interface: detail:     wef: LastAccessTime    : 6/20/2022 7:48:37 PM
    wef: LastAccessTime    : 6/20/2022 7:48:37 PM
 INFO interface: detail: LastAccessTimeUtc : 6/21/2022 2:48:37 AM
 INFO interface: detail:     wef: LastAccessTimeUtc : 6/21/2022 2:48:37 AM
    wef: LastAccessTimeUtc : 6/21/2022 2:48:37 AM
 INFO interface: detail: LastWriteTime     : 6/20/2022 7:48:37 PM
 INFO interface: detail:     wef: LastWriteTime     : 6/20/2022 7:48:37 PM
    wef: LastWriteTime     : 6/20/2022 7:48:37 PM
 INFO interface: detail: LastWriteTimeUtc  : 6/21/2022 2:48:37 AM
 INFO interface: detail:     wef: LastWriteTimeUtc  : 6/21/2022 2:48:37 AM
    wef: LastWriteTimeUtc  : 6/21/2022 2:48:37 AM
 INFO interface: detail: Attributes        : Directory
 INFO interface: detail:     wef: Attributes        : Directory
    wef: Attributes        : Directory
 INFO interface: detail: Mode              : d-----
 INFO interface: detail:     wef: Mode              : d-----
    wef: Mode              : d-----
 INFO interface: detail: BaseName          : sysinternals
 INFO interface: detail:     wef: BaseName          : sysinternals
    wef: BaseName          : sysinternals
 INFO interface: detail: Target            : {}
 INFO interface: detail:     wef: Target            : {}
    wef: Target            : {}
 INFO interface: detail: LinkType          :
 INFO interface: detail:     wef: LinkType          :
    wef: LinkType          :
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [19:48] My hostname is WEF
 INFO interface: detail:     wef: [19:48] My hostname is WEF
    wef: [19:48] My hostname is WEF
 INFO interface: detail: [19:48] Joining the domain...
 INFO interface: detail:     wef: [19:48] Joining the domain...
    wef: [19:48] Joining the domain...
 INFO interface: detail: [19:48] First, set DNS to DC to join the domain...
 INFO interface: detail:     wef: [19:48] First, set DNS to DC to join the domain...
    wef: [19:48] First, set DNS to DC to join the domain...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: __GENUS          : 2
 INFO interface: detail:     wef: __GENUS          : 2
    wef: __GENUS          : 2
 INFO interface: detail: __CLASS          : __PARAMETERS
 INFO interface: detail:     wef: __CLASS          : __PARAMETERS
    wef: __CLASS          : __PARAMETERS
 INFO interface: detail: __SUPERCLASS     :
 INFO interface: detail:     wef: __SUPERCLASS     :
    wef: __SUPERCLASS     :
 INFO interface: detail: __DYNASTY        : __PARAMETERS
 INFO interface: detail:     wef: __DYNASTY        : __PARAMETERS
    wef: __DYNASTY        : __PARAMETERS
 INFO interface: detail: __RELPATH        :
 INFO interface: detail:     wef: __RELPATH        :
    wef: __RELPATH        :
 INFO interface: detail: __PROPERTY_COUNT : 1
 INFO interface: detail:     wef: __PROPERTY_COUNT : 1
    wef: __PROPERTY_COUNT : 1
 INFO interface: detail: __DERIVATION     : {}
 INFO interface: detail:     wef: __DERIVATION     : {}
    wef: __DERIVATION     : {}
 INFO interface: detail: __SERVER         :
 INFO interface: detail:     wef: __SERVER         :
    wef: __SERVER         :
 INFO interface: detail: __NAMESPACE      :
 INFO interface: detail:     wef: __NAMESPACE      :
    wef: __NAMESPACE      :
 INFO interface: detail: __PATH           :
 INFO interface: detail:     wef: __PATH           :
    wef: __PATH           :
 INFO interface: detail: ReturnValue      : 0
 INFO interface: detail:     wef: ReturnValue      : 0
    wef: ReturnValue      : 0
 INFO interface: detail: PSComputerName   :
 INFO interface: detail:     wef: PSComputerName   :
    wef: PSComputerName   :
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: __GENUS          : 2
 INFO interface: detail:     wef: __GENUS          : 2
    wef: __GENUS          : 2
 INFO interface: detail: __CLASS          : __PARAMETERS
 INFO interface: detail:     wef: __CLASS          : __PARAMETERS
    wef: __CLASS          : __PARAMETERS
 INFO interface: detail: __SUPERCLASS     :
 INFO interface: detail:     wef: __SUPERCLASS     :
    wef: __SUPERCLASS     :
 INFO interface: detail: __DYNASTY        : __PARAMETERS
 INFO interface: detail:     wef: __DYNASTY        : __PARAMETERS
    wef: __DYNASTY        : __PARAMETERS
 INFO interface: detail: __RELPATH        :
 INFO interface: detail:     wef: __RELPATH        :
    wef: __RELPATH        :
 INFO interface: detail: __PROPERTY_COUNT : 1
 INFO interface: detail:     wef: __PROPERTY_COUNT : 1
    wef: __PROPERTY_COUNT : 1
 INFO interface: detail: __DERIVATION     : {}
 INFO interface: detail:     wef: __DERIVATION     : {}
    wef: __DERIVATION     : {}
 INFO interface: detail: __SERVER         :
 INFO interface: detail:     wef: __SERVER         :
    wef: __SERVER         :
 INFO interface: detail: __NAMESPACE      :
 INFO interface: detail:     wef: __NAMESPACE      :
    wef: __NAMESPACE      :
 INFO interface: detail: __PATH           :
 INFO interface: detail:     wef: __PATH           :
    wef: __PATH           :
 INFO interface: detail: ReturnValue      : 0
 INFO interface: detail:     wef: ReturnValue      : 0
    wef: ReturnValue      : 0
 INFO interface: detail: PSComputerName   :
 INFO interface: detail:     wef: PSComputerName   :
    wef: PSComputerName   :
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [19:48] Now join the domain...
 INFO interface: detail:     wef: [19:48] Now join the domain...
    wef: [19:48] Now join the domain...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: HasSucceeded : True
 INFO interface: detail:     wef: HasSucceeded : True
    wef: HasSucceeded : True
 INFO interface: detail: ComputerName : wef
 INFO interface: detail:     wef: ComputerName : wef
    wef: ComputerName : wef
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: WARNING: The changes will take effect after you restart the computer wef.
 INFO interface: detail:     wef: WARNING: The changes will take effect after you restart the computer wef.
    wef: WARNING: The changes will take effect after you restart the computer wef.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: AutoEndTasks : 1
 INFO interface: detail:     wef: AutoEndTasks : 1
    wef: AutoEndTasks : 1
 INFO interface: detail: PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Control Panel\Desktop
 INFO interface: detail:     wef: PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Control Panel\Desktop
    wef: PSPath       : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Control Panel\Desktop
 INFO interface: detail: PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Control Panel
 INFO interface: detail:     wef: PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Control Panel
    wef: PSParentPath : Microsoft.PowerShell.Core\Registry::HKEY_CURRENT_USER\Control Panel
 INFO interface: detail: PSChildName  : Desktop
 INFO interface: detail:     wef: PSChildName  : Desktop
    wef: PSChildName  : Desktop
 INFO interface: detail: PSDrive      : HKCU
 INFO interface: detail:     wef: PSDrive      : HKCU
    wef: PSDrive      : HKCU
 INFO interface: detail: PSProvider   : Microsoft.PowerShell.Core\Registry
 INFO interface: detail:     wef: PSProvider   : Microsoft.PowerShell.Core\Registry
    wef: PSProvider   : Microsoft.PowerShell.Core\Registry
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [19:48] Disabling Windows Updates and Windows Module Services
 INFO interface: detail:     wef: [19:48] Disabling Windows Updates and Windows Module Services
    wef: [19:48] Disabling Windows Updates and Windows Module Services
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] cleaning up command_id: B9430845-869D-4902-AA69-569F3C2B5209 on shell_id 766E028C-5EA2-42BC-B244-73D5F542AD51
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c9b110 @data=[{:stdout=>"[19:48] Setting timezone to UTC...\r\n"}, {:stdout=>"[19:48] Checking if Windows evaluation is expiring soon or expired...\r\n"}, {:stdout=>"[19:48] 180 days left until expiration, no need to rearm.\r\n"}, {:stdout=>"[19:48] Disabling the Invoke-WebRequest download progress bar globally for speed improvements.\r\n"}, {:stdout=>"[19:48] See https://github.com/PowerShell/PowerShell/issues/2138 for more info\r\n"}, {:stdout=>"Unable to connect to ping.detectionlab.network\r\n"}, {:stdout=>"[19:48] Disabling IPv6 on all network adatpers...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           DisplayName                                        ComponentID     \r\n"}, {:stdout=>"----                           -----------                                        -----------     \r\n"}, {:stdout=>"Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"The operation completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[19:48] Current domain is set to 'workgroup'. Time to join the domain!\r\n"}, {:stdout=>"[19:48] Installing bginfo...\r\n"}, {:stdout=>"[19:48] Installing BGInfo...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Program Files\\sysinternals\r\n"}, {:stdout=>"PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\Program Files\r\n"}, {:stdout=>"PSChildName       : sysinternals\r\n"}, {:stdout=>"PSDrive           : C\r\n"}, {:stdout=>"PSProvider        : Microsoft.PowerShell.Core\\FileSystem\r\n"}, {:stdout=>"PSIsContainer     : True\r\n"}, {:stdout=>"Name              : sysinternals\r\n"}, {:stdout=>"FullName          : C:\\Program Files\\sysinternals\r\n"}, {:stdout=>"Parent            : Program Files\r\n"}, {:stdout=>"Exists            : True\r\n"}, {:stdout=>"Root              : C:\\\r\n"}, {:stdout=>"Extension         : \r\n"}, {:stdout=>"CreationTime      : 6/20/2022 7:48:37 PM\r\n"}, {:stdout=>"CreationTimeUtc   : 6/21/2022 2:48:37 AM\r\n"}, {:stdout=>"LastAccessTime    : 6/20/2022 7:48:37 PM\r\n"}, {:stdout=>"LastAccessTimeUtc : 6/21/2022 2:48:37 AM\r\n"}, {:stdout=>"LastWriteTime     : 6/20/2022 7:48:37 PM\r\n"}, {:stdout=>"LastWriteTimeUtc  : 6/21/2022 2:48:37 AM\r\n"}, {:stdout=>"Attributes        : Directory\r\n"}, {:stdout=>"Mode              : d-----\r\n"}, {:stdout=>"BaseName          : sysinternals\r\n"}, {:stdout=>"Target            : {}\r\n"}, {:stdout=>"LinkType          : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[19:48] My hostname is WEF\r\n"}, {:stdout=>"[19:48] Joining the domain...\r\n"}, {:stdout=>"[19:48] First, set DNS to DC to join the domain...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"__GENUS          : 2\r\n"}, {:stdout=>"__CLASS          : __PARAMETERS\r\n"}, {:stdout=>"__SUPERCLASS     : \r\n"}, {:stdout=>"__DYNASTY        : __PARAMETERS\r\n"}, {:stdout=>"__RELPATH        : \r\n"}, {:stdout=>"__PROPERTY_COUNT : 1\r\n"}, {:stdout=>"__DERIVATION     : {}\r\n"}, {:stdout=>"__SERVER         : \r\n"}, {:stdout=>"__NAMESPACE      : \r\n"}, {:stdout=>"__PATH           : \r\n"}, {:stdout=>"ReturnValue      : 0\r\n"}, {:stdout=>"PSComputerName   : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"__GENUS          : 2\r\n"}, {:stdout=>"__CLASS          : __PARAMETERS\r\n"}, {:stdout=>"__SUPERCLASS     : \r\n"}, {:stdout=>"__DYNASTY        : __PARAMETERS\r\n"}, {:stdout=>"__RELPATH        : \r\n"}, {:stdout=>"__PROPERTY_COUNT : 1\r\n"}, {:stdout=>"__DERIVATION     : {}\r\n"}, {:stdout=>"__SERVER         : \r\n"}, {:stdout=>"__NAMESPACE      : \r\n"}, {:stdout=>"__PATH           : \r\n"}, {:stdout=>"ReturnValue      : 0\r\n"}, {:stdout=>"PSComputerName   : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[19:48] Now join the domain...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"HasSucceeded : True\r\n"}, {:stdout=>"ComputerName : wef\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: The changes will take effect after you restart the computer wef.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"AutoEndTasks : 1\r\n"}, {:stdout=>"PSPath       : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Control Panel\\Desktop\r\n"}, {:stdout=>"PSParentPath : Microsoft.PowerShell.Core\\Registry::HKEY_CURRENT_USER\\Control Panel\r\n"}, {:stdout=>"PSChildName  : Desktop\r\n"}, {:stdout=>"PSDrive      : HKCU\r\n"}, {:stdout=>"PSProvider   : Microsoft.PowerShell.Core\\Registry\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[19:48] Disabling Windows Updates and Windows Module Services\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352a48110 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: reload...
 INFO interface: info: ==> wef: Running provisioner: reload...
==> wef: Running provisioner: reload...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000002435246fcc0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO machine: Calling action: reload on provider VMware Workstation
 INFO interface: Machine: action ["reload", "start", {:target=>:wef}]
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x00000243523a2810>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x000002435103f4d0>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x00000243505fb028>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000024352ebdd58>
 INFO warden: Calling IN action: #<Proc:0x0000024352c8d560 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000024352ebdc90>
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: VMware Middleware: CheckVMware
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024352e83950>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000024352c1fe98>
 INFO warden: Calling IN action: VMware Middleware: Created
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Created
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000024352a80628>
 INFO warden: Calling IN action: #<Proc:0x00000243529c3c30 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: DiscardSuspendedState
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "FALSE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:d6:5e:fd"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:d6:5e:07"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "1"
DEBUG vmware_driver:   - SET sharedfolder0.enabled = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.expiration = "never"
DEBUG vmware_driver:   - SET sharedfolder0.guestname = "-vagrant"
DEBUG vmware_driver:   - SET sharedfolder0.hostpath = "D:\workspace\eWalker\DetectionLab\Vagrant"
DEBUG vmware_driver:   - SET sharedfolder0.present = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.readaccess = "TRUE"
DEBUG vmware_driver:   - SET sharedfolder0.writeaccess = "TRUE"
DEBUG vmware_driver:   - SET softpoweroff = "FALSE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "3"
DEBUG vmware_driver:   - SET unity.wascapable = "TRUE"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024352a53f38>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x000002435225a520>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243503ca560>
 INFO warden: Calling IN action: #<Proc:0x000002435328f508 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x00000243503ca060>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x00000243531eadc8>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::GracefulHalt:0x00000243531169b0>
 INFO graceful_halt: Verifying source state of machine: :running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO interface: output: Attempting graceful shutdown of VM...
 INFO interface: output: ==> wef: Attempting graceful shutdown of VM...
==> wef: Attempting graceful shutdown of VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - unity.wascapable = TRUE
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2208, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2207
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7BFB74C9-414E-4AFA-9681-104D00852A25
DEBUG winrmshell: [WinRM] Command created for hostname with id: F91483D7-2561-407F-A096-C9DEE5DE6DE8
DEBUG winrmshell: [WinRM] creating command_id: F91483D7-2561-407F-A096-C9DEE5DE6DE8 on shell_id 7BFB74C9-414E-4AFA-9681-104D00852A25
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F91483D7-2561-407F-A096-C9DEE5DE6DE8 on shell_id 7BFB74C9-414E-4AFA-9681-104D00852A25
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b55788 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: halt
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: halt in windows
 INFO guest: Execute capability: halt [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
DEBUG winrm: powershell executing:
shutdown -a
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435308afa0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435308a118 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f821d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32101697-05C4-47FC-B9C0-84272E8ADBF6
DEBUG winrmshell: [WinRM] Command created for shutdown -a

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E4AAD2E0-F977-4D74-9C37-85B0B4C693ED
DEBUG winrmshell: [WinRM] creating command_id: E4AAD2E0-F977-4D74-9C37-85B0B4C693ED on shell_id 32101697-05C4-47FC-B9C0-84272E8ADBF6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E4AAD2E0-F977-4D74-9C37-85B0B4C693ED on shell_id 32101697-05C4-47FC-B9C0-84272E8ADBF6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352e3dba8 @data=[{:stderr=>"shutdown.exe : Unable to abort the system shutdown because no shutdown was in progress.(1116)\n    + CategoryInfo          : NotSpecified: (Unable to abort...progress.(1116):String) [], RemoteException\n    + FullyQualifiedErrorId : NativeCommandError\n"}], @exitcode=1116>
DEBUG winrm: powershell executing:
shutdown /s /t 1 /c "Vagrant Halt" /f /d p:4:1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2207/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fca890 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fc9a08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352eb6ff8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2FCFC6BA-6B32-4F2F-A2BE-11C6C1D6AB97
DEBUG winrmshell: [WinRM] Command created for shutdown /s /t 1 /c "Vagrant Halt" /f /d p:4:1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CA9B2678-78F8-44AC-92D5-8F34D7541423
DEBUG winrmshell: [WinRM] creating command_id: CA9B2678-78F8-44AC-92D5-8F34D7541423 on shell_id 2FCFC6BA-6B32-4F2F-A2BE-11C6C1D6AB97
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CA9B2678-78F8-44AC-92D5-8F34D7541423 on shell_id 2FCFC6BA-6B32-4F2F-A2BE-11C6C1D6AB97
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352db2cd8 @data=[], @exitcode=0>
DEBUG graceful_halt: Waiting for target graceful halt state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO graceful_halt: Gracefully halted.
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::GracefulHalt:0x00000243531169b0>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243532f6528>
 INFO warden: Calling IN action: #<Proc:0x00000243531273f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: WaitForVMXHalt
 INFO wait_for_vmx_halt: Waiting for VMX process to go away...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
 INFO warden: Calling IN action: #<Proc:0x000002435328e108 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x00000243503c9e58 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x0000024352a53ec0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
DEBUG checkpoint: checkpoint data processing complete
 INFO warden: Calling IN action: VMware Middleware: Compatibility
 INFO warden: Calling IN action: VMware Middleware: FixOldMachineID
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000024352e02df0>
 INFO interface: output: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO interface: output: ==> wef: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
==> wef: Checking if box 'detectionlab/win2016' version '1.9' is up to date...
 INFO box: box update check is under the interval threshold
 INFO box: Skipping box update check
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024352dd8f28>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000024352fdbaa0>
 INFO warden: Calling IN action: VMware Middleware: Running
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
 INFO warden: Calling OUT action: VMware Middleware: Running
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x0000024352ce97e8>
 INFO warden: Calling IN action: #<Proc:0x0000024352becac0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: CheckExistingNetwork
 INFO check_existing_network: Checking if the vmnet devices are healthy...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Verifying vmnet devices are healthy...
 INFO interface: info: ==> wef: Verifying vmnet devices are healthy...
==> wef: Verifying vmnet devices are healthy...
DEBUG vagrant_utility: request METHOD=POST PATH=/vmnet/verify RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: PruneForwardedPorts
 INFO prune_forwarded_ports: Pruning forwarded ports...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
DEBUG vmware_driver: requesting prune of unused port forwards
DEBUG vagrant_utility: request METHOD=DELETE PATH=/portforwards RESPONSE=204 
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Call:0x0000024352c7e998>
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Builder:0x0000024352b36b30>
 INFO warden: Calling IN action: VMware Middleware: Suspended
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: not_running
DEBUG suspended: result: false
 INFO warden: Calling OUT action: VMware Middleware: Suspended
 INFO runner: Running action: machine_action_reload #<Vagrant::Action::Warden:0x00000243504f39a0>
 INFO warden: Calling IN action: #<Proc:0x0000024352e03f48 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Provision:0x00000243504f2f78>
 INFO provision: Checking provisioner sentinel file...
 INFO provision: Sentinel found! Not provisioning.
 INFO warden: Calling IN action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 2

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x000002435330ed30>
DEBUG host: Searching for cap: nfs_prune
DEBUG host: Checking in: windows
 INFO nfs: Host doesn't support pruning NFS. Skipping.
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x00000243532d7d08>
 INFO synced_folder_cleanup: Invoking synced folder cleanup for: vmware
 INFO synced_folder: Clearing shared folders
 INFO vmware_driver: Clearing shared folders...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.generatedaddress = "00:0c:29:d6:5e:fd"
DEBUG vmware_driver:   - SET ethernet0.generatedaddressoffset = "0"
DEBUG vmware_driver:   - SET ethernet0.pcislotnumber = "32"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.generatedaddress = "00:0c:29:d6:5e:07"
DEBUG vmware_driver:   - SET ethernet1.generatedaddressoffset = "10"
DEBUG vmware_driver:   - SET ethernet1.pcislotnumber = "33"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "3"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::Delayed:0x000002435326fe60>
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SyncedFolders:0x000002435326fe38>
 INFO synced_folders: SyncedFolders loading from cache: false
 INFO synced_folders: Synced Folder Implementation: vmware
 INFO synced_folders:   - /vagrant: . => /vagrant
 INFO synced_folders: Invoking synced folder prepare for: vmware
 INFO warden: Calling IN action: VMware Middleware: PrepareNFSSettings
 INFO warden: Calling IN action: VMware Middleware: Network
DEBUG network: Available slots for high-level adapters: #<Set: {1, 2, 3, 4, 5, 6, 7, 8}>
 INFO network: Determining network adapters required for high-level configuration...
 INFO network:  -- Slot 1: hostonly
 INFO network: Determining adapters and compiling network configuration...
 INFO network: Slot 0. Type: nat
DEBUG network: Normalized configuration: {:auto_config=>false, :type=>:dhcp}
DEBUG network: Adapter configuration: {:type=>:nat, :slot=>0}
DEBUG network: Network configuration: {:type=>:dhcp, :auto_config=>false}
 INFO network: Slot 1. Type: hostonly
DEBUG network: Normalized configuration: {:auto_config=>true, :netmask=>"255.255.255.0", :type=>:static, :ip=>"192.168.56.103", :gateway=>"192.168.56.1", :dns=>"192.168.56.102", :protocol=>"tcp", :id=>"b6a5947e-de6d-40a0-abd4-abdb2e456bc0", :subnet_ip=>"192.168.56.0", :adapter_ip=>"192.168.56.1"}
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet RESPONSE=200 
 INFO network: Found matching vmnet device: vmnet2
 INFO network: Checking for hostonly network collisions...
 INFO subprocess: Starting process: ["C:\\WINDOWS\\system32/netsh.exe", "interface", "ip", "show", "route"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: 

Publish  Type      Met  Prefix                    Idx  Gateway/Interface Name

-------  --------  ---  ------------------------  ---  ------------------------

No       Manual    100  0.0.0.0/0                  19  192.168.70.254

No       System    256  127.0.0.0/8                 1  Loopback Pseudo-Interface 1

No       System    256  127.0.0.1/32                1  Loopback Pseudo-Interface 1

No       System    256  127.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  169.254.0.0/16             34  VMware Network Adapter VMnet2

No       System    256  169.254.140.76/32          34  VMware Network Adapter VMnet2

No       System    256  169.254.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  172.22.112.0/20            97  vEthernet (Wi-Fi)

No       System    256  172.22.112.1/32            97  vEthernet (Wi-Fi)

No       System    256  172.22.127.255/32          97  vEthernet (Wi-Fi)

No       System    256  172.23.48.0/20             79  vEthernet (VMware Network )

No       System    256  172.23.48.1/32             79  vEthernet (VMware Network )

No       System    256  172.23.63.255/32           79  vEthernet (VMware Network )

No       System    256  172.23.128.0/20            28  vEthernet (Default Switch)

No       System    256  172.23.128.1/32            28  vEthernet (Default Switch)

No       System    256  172.23.143.255/32          28  vEthernet (Default Switch)

No       System    256  172.24.224.0/20            91  vEthernet (VMware Network ) 3

No       System    256  172.24.224.1/32            91  vEthernet (VMware Network ) 3

No       System    256  172.24.239.255/32          91  vEthernet (VMware Network ) 3

No       System    256  172.25.64.0/20             51  vEthernet (Ethernet)

No       System    256  172.25.64.1/32             51  vEthernet (Ethernet)

No       System    256  172.25.79.255/32           51  vEthernet (Ethernet)

No       System    256  172.28.64.0/20             85  vEthernet (VMware Network ) 2

No       System    256  172.28.64.1/32             85  vEthernet (VMware Network ) 2

No       System    256  172.28.79.255/32           85  vEthernet (VMware Network ) 2

No       System    256  172.30.80.0/20             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.80.1/32             73  vEthernet (vEthernet (NAT )

No       System    256  172.30.95.255/32           73  vEthernet (vEthernet (NAT )

No       System    256  192.168.44.0/24            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.1/32            21  VMware Network Adapter VMnet1

No       System    256  192.168.44.255/32          21  VMware Network Adapter VMnet1

No       System    256  192.168.70.0/24            19  Wi-Fi

No       System    256  192.168.70.245/32          19  Wi-Fi

No       System    256  192.168.70.255/32          19  Wi-Fi

No       System    256  192.168.222.0/24           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.1/32           33  VMware Network Adapter VMnet8

No       System    256  192.168.222.255/32         33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 1  Loopback Pseudo-Interface 1

No       System    256  224.0.0.0/4                11  OpenVPN Wintun

No       System    256  224.0.0.0/4                34  VMware Network Adapter VMnet2

No       System    256  224.0.0.0/4                21  VMware Network Adapter VMnet1

No       System    256  224.0.0.0/4                33  VMware Network Adapter VMnet8

No       System    256  224.0.0.0/4                 4  Ethernet

No       System    256  224.0.0.0/4                24  vEthernet (NAT vSwitch)

No       System    256  224.0.0.0/4                19  Wi-Fi

No       System    256  224.0.0.0/4                51  vEthernet (Ethernet)

No       System    256  224.0.0.0/4                28  vEthernet (Default Switch)

No       System    256  224.0.0.0/4                73  vEthernet (vEthernet (NAT )

No       System    256  224.0.0.0/4                79  vEthernet (VMware Network )

No       System    256  224.0.0.0/4                85  vEthernet (VMware Network ) 2

No       System    256  224.0.0.0/4                91  vEthernet (VMware Network ) 3

No       System    256  224.0.0.0/4                97  vEthernet (Wi-Fi)

No       System    256  224.0.0.0/4                32  Local Area Connection* 2

No       System    256  255.255.255.255/32          1  Loopback Pseudo-Interface 1

No       System    256  255.255.255.255/32         11  OpenVPN Wintun

No       System    256  255.255.255.255/32         34  VMware Network Adapter VMnet2

No       System    256  255.255.255.255/32         21  VMware Network Adapter VMnet1

No       System    256  255.255.255.255/32         33  VMware Network Adapter VMnet8

No       System    256  255.255.255.255/32          4  Ethernet

No       System    256  255.255.255.255/32         24  vEthernet (NAT vSwitch)

No       System    256  255.255.255.255/32         19  Wi-Fi

No       System    256  255.255.255.255/32         51  vEthernet (Ethernet)

No       System    256  255.255.255.255/32         28  vEthernet (Default Switch)

No       System    256  255.255.255.255/32         73  vEthernet (vEthernet (NAT )

No       System    256  255.255.255.255/32         79  vEthernet (VMware Network )

No       System    256  255.255.255.255/32         85  vEthernet (VMware Network ) 2

No       System    256  255.255.255.255/32         91  vEthernet (VMware Network ) 3

No       System    256  255.255.255.255/32         97  vEthernet (Wi-Fi)

No       System    256  255.255.255.255/32         32  Local Area Connection* 2


DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG network: Adapter configuration: {:type=>:custom, :mac_address=>nil, :vnet=>"vmnet2", :slot=>1}
DEBUG network: Network configuration: {:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.103", :netmask=>"255.255.255.0", :auto_config=>true}
 INFO network: Enabling 2 adapters...
DEBUG environment: Attempting to acquire process-lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: vmware-network
 INFO interface: info: Preparing network adapters...
 INFO interface: info: ==> wef: Preparing network adapters...
==> wef: Preparing network adapters...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet0.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet0.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.addresstype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.connectiontype
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddress
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.generatedaddressoffset
 WARN vmware_driver: setup_adapter: Removing allowlisted VMX key: ethernet1.pcislotnumber
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.present
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.virtualdev
 WARN vmware_driver: setup_adapter: Removing VMX key: ethernet1.vnet
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "3"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO environment: Released process lock: vmware-network
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: BaseMacToIp
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::SetHostname:0x00000243530a04b8>
 INFO warden: Calling IN action: VMware Middleware: VMXModify
 INFO vmx_modify: Modifying VMX file according to user config...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = TRUE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = TRUE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
 INFO vmx_modify:   - Set: displayname = 'wef.windomain.local'
 INFO vmx_modify:   - Set: memsize = '2048'
 INFO vmx_modify:   - Set: numvcpus = '2'
 INFO vmware_driver: Modifying VMX data...
DEBUG vmware_driver:   - SET .encoding = "UTF-8"
DEBUG vmware_driver:   - SET bios.bootorder = "hdd,cdrom"
DEBUG vmware_driver:   - SET checkpoint.vmstate = ""
DEBUG vmware_driver:   - SET cleanshutdown = "TRUE"
DEBUG vmware_driver:   - SET config.version = "8"
DEBUG vmware_driver:   - SET displayname = "wef.windomain.local"
DEBUG vmware_driver:   - SET ehci.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET ehci.present = "FALSE"
DEBUG vmware_driver:   - SET ethernet0.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet0.connectiontype = "nat"
DEBUG vmware_driver:   - SET ethernet0.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet0.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.addresstype = "generated"
DEBUG vmware_driver:   - SET ethernet1.connectiontype = "custom"
DEBUG vmware_driver:   - SET ethernet1.present = "TRUE"
DEBUG vmware_driver:   - SET ethernet1.virtualdev = "e1000"
DEBUG vmware_driver:   - SET ethernet1.vnet = "vmnet2"
DEBUG vmware_driver:   - SET extendedconfigfile = "WindowsServer2016.vmxf"
DEBUG vmware_driver:   - SET filesearchpath = ".;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop"
DEBUG vmware_driver:   - SET floppy0.present = "FALSE"
DEBUG vmware_driver:   - SET guestinfo.detailed.data = "architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET guestos = "windows8srv-64"
DEBUG vmware_driver:   - SET guestos.detailed.data = "bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'"
DEBUG vmware_driver:   - SET gui.fullscreenatpoweron = "FALSE"
DEBUG vmware_driver:   - SET gui.viewmodeatpoweron = "windowed"
DEBUG vmware_driver:   - SET hgfs.linkrootshare = "TRUE"
DEBUG vmware_driver:   - SET hgfs.maprootshare = "TRUE"
DEBUG vmware_driver:   - SET hpet0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.clientdevice = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.devicetype = "cdrom-raw"
DEBUG vmware_driver:   - SET ide0:0.filename = "auto detect"
DEBUG vmware_driver:   - SET ide0:0.present = "TRUE"
DEBUG vmware_driver:   - SET ide0:0.startconnected = "TRUE"
DEBUG vmware_driver:   - SET isolation.tools.hgfs.disable = "FALSE"
DEBUG vmware_driver:   - SET memsize = "2048"
DEBUG vmware_driver:   - SET monitor.phys_bits_used = "42"
DEBUG vmware_driver:   - SET msg.autoanswer = "true"
DEBUG vmware_driver:   - SET numa.autosize.cookie = "20001"
DEBUG vmware_driver:   - SET numa.autosize.vcpu.maxpervirtualnode = "2"
DEBUG vmware_driver:   - SET numvcpus = "2"
DEBUG vmware_driver:   - SET nvme0.present = "FALSE"
DEBUG vmware_driver:   - SET nvram = "WindowsServer2016.nvram"
DEBUG vmware_driver:   - SET parallel0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET parallel0.bidirectional = ""
DEBUG vmware_driver:   - SET parallel0.filename = ""
DEBUG vmware_driver:   - SET parallel0.present = "FALSE"
DEBUG vmware_driver:   - SET parallel0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET pcibridge0.pcislotnumber = "17"
DEBUG vmware_driver:   - SET pcibridge0.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.functions = "8"
DEBUG vmware_driver:   - SET pcibridge4.pcislotnumber = "21"
DEBUG vmware_driver:   - SET pcibridge4.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge4.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge5.functions = "8"
DEBUG vmware_driver:   - SET pcibridge5.pcislotnumber = "22"
DEBUG vmware_driver:   - SET pcibridge5.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge5.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge6.functions = "8"
DEBUG vmware_driver:   - SET pcibridge6.pcislotnumber = "23"
DEBUG vmware_driver:   - SET pcibridge6.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge6.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET pcibridge7.functions = "8"
DEBUG vmware_driver:   - SET pcibridge7.pcislotnumber = "24"
DEBUG vmware_driver:   - SET pcibridge7.present = "TRUE"
DEBUG vmware_driver:   - SET pcibridge7.virtualdev = "pcieRootPort"
DEBUG vmware_driver:   - SET policy.vm.mvmtid = ""
DEBUG vmware_driver:   - SET powertype.poweroff = "soft"
DEBUG vmware_driver:   - SET powertype.poweron = "soft"
DEBUG vmware_driver:   - SET powertype.reset = "soft"
DEBUG vmware_driver:   - SET powertype.suspend = "soft"
DEBUG vmware_driver:   - SET proxyapps.publishtohost = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.enabled = "FALSE"
DEBUG vmware_driver:   - SET remotedisplay.vnc.ip = "127.0.0.1"
DEBUG vmware_driver:   - SET remotedisplay.vnc.key = "Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg="
DEBUG vmware_driver:   - SET remotedisplay.vnc.password = "hFVYlFpz"
DEBUG vmware_driver:   - SET remotedisplay.vnc.port = "5933"
DEBUG vmware_driver:   - SET replay.filename = ""
DEBUG vmware_driver:   - SET replay.supported = "FALSE"
DEBUG vmware_driver:   - SET sata0.present = "FALSE"
DEBUG vmware_driver:   - SET scsi0.pcislotnumber = "160"
DEBUG vmware_driver:   - SET scsi0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0.saswwid = "50 05 05 61 28 38 7e 20"
DEBUG vmware_driver:   - SET scsi0.virtualdev = "lsisas1068"
DEBUG vmware_driver:   - SET scsi0:0.filename = "disk-cl1.vmdk"
DEBUG vmware_driver:   - SET scsi0:0.present = "TRUE"
DEBUG vmware_driver:   - SET scsi0:0.redo = ""
DEBUG vmware_driver:   - SET serial0.autodetect = "FALSE"
DEBUG vmware_driver:   - SET serial0.filename = ""
DEBUG vmware_driver:   - SET serial0.filetype = ""
DEBUG vmware_driver:   - SET serial0.pipe.endpoint = ""
DEBUG vmware_driver:   - SET serial0.present = "FALSE"
DEBUG vmware_driver:   - SET serial0.startconnected = "FALSE"
DEBUG vmware_driver:   - SET serial0.trynorxloss = ""
DEBUG vmware_driver:   - SET serial0.yieldonmsrread = ""
DEBUG vmware_driver:   - SET sharedfolder.maxnum = "0"
DEBUG vmware_driver:   - SET softpoweroff = "TRUE"
DEBUG vmware_driver:   - SET sound.autodetect = "TRUE"
DEBUG vmware_driver:   - SET sound.filename = "-1"
DEBUG vmware_driver:   - SET sound.present = "FALSE"
DEBUG vmware_driver:   - SET sound.startconnected = "FALSE"
DEBUG vmware_driver:   - SET svga.guestbackedprimaryaware = "TRUE"
DEBUG vmware_driver:   - SET svga.vramsize = "134217728"
DEBUG vmware_driver:   - SET tools.remindinstall = "FALSE"
DEBUG vmware_driver:   - SET tools.synctime = "TRUE"
DEBUG vmware_driver:   - SET tools.upgrade.policy = "upgradeAtPowerCycle"
DEBUG vmware_driver:   - SET toolsinstallmanager.lastinstallerror = "0"
DEBUG vmware_driver:   - SET toolsinstallmanager.updatecounter = "3"
DEBUG vmware_driver:   - SET usb.pcislotnumber = "-1"
DEBUG vmware_driver:   - SET usb.present = "FALSE"
DEBUG vmware_driver:   - SET uuid.action = "create"
DEBUG vmware_driver:   - SET uuid.bios = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET uuid.location = "56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd"
DEBUG vmware_driver:   - SET vc.uuid = ""
DEBUG vmware_driver:   - SET virtualhw.productcompatibility = "hosted"
DEBUG vmware_driver:   - SET virtualhw.version = "11"
DEBUG vmware_driver:   - SET vm.genid = "-4386289836503236366"
DEBUG vmware_driver:   - SET vm.genidx = "-119294786489706003"
DEBUG vmware_driver:   - SET vmci0.id = "1861462629"
DEBUG vmware_driver:   - SET vmci0.pcislotnumber = "35"
DEBUG vmware_driver:   - SET vmci0.present = "TRUE"
DEBUG vmware_driver:   - SET vmotion.checkpointfbsize = "4194304"
DEBUG vmware_driver:   - SET vmotion.checkpointsvgaprimarysize = "134217728"
 INFO warden: Calling IN action: VMware Middleware: PrepareForwardedPortCollisionParams
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2208, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2209, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2207, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}]
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x0000024352fd26a8>
DEBUG environment: Attempting to acquire process-lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO environment: Acquired process lock: fpcollision
 INFO handle_port_collisions: Detecting any forwarded port collisions...
DEBUG handle_port_collisions: Extra in use: {2208=>#<Set: {"*"}>, 2209=>#<Set: {"*"}>, 2222=>#<Set: {"*"}>, 2201=>#<Set: {"*"}>, 2202=>#<Set: {"*"}>, 2205=>#<Set: {"*"}>, 2206=>#<Set: {"*"}>, 2207=>#<Set: {"*"}>, 55985=>#<Set: {"*"}>, 55986=>#<Set: {"*"}>, 2200=>#<Set: {"*"}>, 2203=>#<Set: {"*"}>, 2204=>#<Set: {"*"}>}
DEBUG handle_port_collisions: Remap: {}
DEBUG handle_port_collisions: Repair: true
 INFO handle_port_collisions: Attempting to repair FP collision: 2207
 INFO handle_port_collisions: Repaired FP collision: 2207 to 2210
 INFO interface: info: Fixed port collision for 5985 => 2207. Now on port 2210.
 INFO interface: info: ==> wef: Fixed port collision for 5985 => 2207. Now on port 2210.
==> wef: Fixed port collision for 5985 => 2207. Now on port 2210.
 INFO handle_port_collisions: Attempting to repair FP collision: 2208
 INFO handle_port_collisions: Repaired FP collision: 2208 to 2211
 INFO interface: info: Fixed port collision for 5986 => 2208. Now on port 2211.
 INFO interface: info: ==> wef: Fixed port collision for 5986 => 2208. Now on port 2211.
==> wef: Fixed port collision for 5986 => 2208. Now on port 2211.
 INFO handle_port_collisions: Attempting to repair FP collision: 2209
 INFO handle_port_collisions: Repaired FP collision: 2209 to 2212
 INFO interface: info: Fixed port collision for 22 => 2209. Now on port 2212.
 INFO interface: info: ==> wef: Fixed port collision for 22 => 2209. Now on port 2212.
==> wef: Fixed port collision for 22 => 2209. Now on port 2212.
 INFO environment: Released process lock: fpcollision
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO warden: Calling IN action: VMware Middleware: Boot
 INFO interface: info: Starting the VMware VM...
 INFO interface: info: ==> wef: Starting the VMware VM...
==> wef: Starting the VMware VM...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "start", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx", "gui"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 43
DEBUG subprocess: Exit status: 0
 INFO warden: Calling IN action: VMware Middleware: WaitForAddress
 INFO interface: info: Waiting for the VM to receive an address...
 INFO interface: info: ==> wef: Waiting for the VM to receive an address...
==> wef: Waiting for the VM to receive an address...
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
 INFO warden: Calling IN action: VMware Middleware: ForwardPorts
DEBUG forward_ports: Building up ports to forward...
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: existing port forwards: [{:port=>2208, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2209, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>55985, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}, {:port=>2204, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2206, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>22}}, {:port=>2207, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5985}}, {:port=>2202, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2203, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2205, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.131", :port=>5986}}, {:port=>2222, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\logger\\vmware_desktop\\5bd371db-e01c-4dfd-ac24-27f599313642\\ubuntu-20.04-amd64.vmx", :guest=>{:ip=>"192.168.222.128", :port=>22}}, {:port=>55986, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5986}}, {:port=>2200, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>22}}, {:port=>2201, :protocol=>"tcp", :description=>"vagrant: d:\\workspace\\ewalker\\detectionlab\\vagrant\\.vagrant\\machines\\dc\\vmware_desktop\\ef966a7e-e2da-4049-b298-3e4c7ef9c443\\windowsserver2016.vmx", :guest=>{:ip=>"192.168.222.129", :port=>5985}}]
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
 INFO interface: info: Forwarding ports...
 INFO interface: info: ==> wef: Forwarding ports...
==> wef: Forwarding ports...
 INFO interface: detail: -- 5985 => 2210
 INFO interface: detail:     wef: -- 5985 => 2210
    wef: -- 5985 => 2210
 INFO interface: detail: -- 5986 => 2211
 INFO interface: detail:     wef: -- 5986 => 2211
    wef: -- 5986 => 2211
 INFO interface: detail: -- 22 => 2212
 INFO interface: detail:     wef: -- 22 => 2212
    wef: -- 22 => 2212
DEBUG vmware_driver: requesting ports to be forwarded: [{:device=>"vmnet8", :guest_port=>5985, :host_port=>2210, :protocol=>"tcp", :guest_ip=>"192.168.222.131"}, {:device=>"vmnet8", :guest_port=>5986, :host_port=>2211, :protocol=>"tcp", :guest_ip=>"192.168.222.131"}, {:device=>"vmnet8", :guest_port=>22, :host_port=>2212, :protocol=>"tcp", :guest_ip=>"192.168.222.131"}]
DEBUG vmware_driver: forwarding ports via collection method
DEBUG vagrant_utility: request METHOD=PUT PATH=/vmnet/vmnet8/portforward RESPONSE=200 
 INFO warden: Calling IN action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x0000024352f27aa0>
 INFO interface: output: Waiting for machine to boot. This may take a few minutes...
 INFO interface: output: ==> wef: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Searching for cap: winrm_info
==> wef: Waiting for machine to boot. This may take a few minutes...
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
 INFO interface: detail: WinRM address: 127.0.0.1:2207
 INFO interface: detail:     wef: WinRM address: 127.0.0.1:2207
    wef: WinRM address: 127.0.0.1:2207
 INFO interface: detail: WinRM username: vagrant
 INFO interface: detail:     wef: WinRM username: vagrant
    wef: WinRM username: vagrant
 INFO interface: detail: WinRM execution_time_limit: PT2H
 INFO interface: detail:     wef: WinRM execution_time_limit: PT2H
    wef: WinRM execution_time_limit: PT2H
 INFO interface: detail: WinRM transport: negotiate
 INFO interface: detail:     wef: WinRM transport: negotiate
    wef: WinRM transport: negotiate
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 22=>2212, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9B83C05D-05A3-4521-827E-C16E0EC81510
DEBUG winrmshell: [WinRM] Command created for hostname with id: A831F28C-C1C4-42C0-B76D-C30ABA72A934
DEBUG winrmshell: [WinRM] creating command_id: A831F28C-C1C4-42C0-B76D-C30ABA72A934 on shell_id 9B83C05D-05A3-4521-827E-C16E0EC81510
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A831F28C-C1C4-42C0-B76D-C30ABA72A934 on shell_id 9B83C05D-05A3-4521-827E-C16E0EC81510
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243521e2340 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO interface: output: Machine booted and ready!
 INFO interface: output: ==> wef: Machine booted and ready!
==> wef: Machine booted and ready!
 INFO warden: Calling IN action: #<Proc:0x0000024352f27a50 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: #<Proc:0x0000024352c7e920 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling IN action: #<Proc:0x0000024352da2ab8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling IN action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x0000024352da2ab8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x0000024352c7e920 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x0000024352f27a50 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::WaitForCommunicator:0x0000024352f27aa0>
 INFO warden: Calling OUT action: VMware Middleware: ForwardPorts
 INFO warden: Calling OUT action: VMware Middleware: WaitForAddress
 INFO warden: Calling OUT action: VMware Middleware: Boot
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::HandleForwardedPortCollisions:0x0000024352fd26a8>
 INFO warden: Calling OUT action: VMware Middleware: PrepareForwardedPortCollisionParams
 INFO warden: Calling OUT action: VMware Middleware: VMXModify
 INFO interface: info: Setting hostname...
 INFO interface: info: ==> wef: Setting hostname...
==> wef: Setting hostname...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2208, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DE705C8E-304A-4A81-B266-32B428D39E04
DEBUG winrmshell: [WinRM] Command created for hostname with id: 7B029FBA-2BD5-40DE-90A6-BB36415704F2
DEBUG winrmshell: [WinRM] creating command_id: 7B029FBA-2BD5-40DE-90A6-BB36415704F2 on shell_id DE705C8E-304A-4A81-B266-32B428D39E04
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 7B029FBA-2BD5-40DE-90A6-BB36415704F2 on shell_id DE705C8E-304A-4A81-B266-32B428D39E04
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352be4d98 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: change_host_name
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: change_host_name in windows
 INFO guest: Execute capability: change_host_name [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, "wef"] (windows)
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353003488 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353002308 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f49d08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4ECAC868-1DE3-4C6D-881A-10F4EBD8C9B3
DEBUG winrmshell: [WinRM] Command created for if ([System.Net.Dns]::GetHostName() -eq 'wef') { exit 0 } exit 1

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C039C662-0D97-4493-B7C6-AB1026AC9382
DEBUG winrmshell: [WinRM] creating command_id: C039C662-0D97-4493-B7C6-AB1026AC9382 on shell_id 4ECAC868-1DE3-4C6D-881A-10F4EBD8C9B3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C039C662-0D97-4493-B7C6-AB1026AC9382 on shell_id 4ECAC868-1DE3-4C6D-881A-10F4EBD8C9B3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352dd17f0 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SetHostname:0x00000243530a04b8>
 INFO warden: Calling OUT action: VMware Middleware: BaseMacToIp
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
 INFO interface: info: Configuring network adapters within the VM...
 INFO interface: info: ==> wef: Configuring network adapters within the VM...
==> wef: Configuring network adapters within the VM...
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2211, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6C565A34-DA56-476D-BEE7-A2BDEA3F769C
DEBUG winrmshell: [WinRM] Command created for hostname with id: DBDE36B4-07DB-4F51-944A-BA9D0FA6B8AD
DEBUG winrmshell: [WinRM] creating command_id: DBDE36B4-07DB-4F51-944A-BA9D0FA6B8AD on shell_id 6C565A34-DA56-476D-BEE7-A2BDEA3F769C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DBDE36B4-07DB-4F51-944A-BA9D0FA6B8AD on shell_id 6C565A34-DA56-476D-BEE7-A2BDEA3F769C
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243508ce2c8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: configure_networks
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: configure_networks in windows
 INFO guest: Execute capability: configure_networks [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.103", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]] (windows)
DEBUG configure_networks: Networks: [{:type=>:static, :adapter_ip=>"192.168.56.1", :ip=>"192.168.56.103", :netmask=>"255.255.255.0", :auto_config=>true, :interface=>1}]
 INFO interface: warn: Configuring secondary network adapters through VMware 
 INFO interface: warn: ==> wef: Configuring secondary network adapters through VMware 
==> wef: Configuring secondary network adapters through VMware 
 INFO interface: warn: on Windows is not yet supported. You will need to manually
 INFO interface: warn: ==> wef: on Windows is not yet supported. You will need to manually
==> wef: on Windows is not yet supported. You will need to manually
 INFO interface: warn: configure the network adapter.
 INFO interface: warn: ==> wef: configure the network adapter.
==> wef: configure the network adapter.
 INFO warden: Calling OUT action: VMware Middleware: Network
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
 INFO warden: Calling OUT action: VMware Middleware: PrepareNFSSettings
 INFO synced_folders: Invoking synced folder enable: vmware
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2212, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F0FB9367-3001-45A3-873B-5CE846F0B443
DEBUG winrmshell: [WinRM] Command created for hostname with id: D959B240-4BC8-42C9-83C8-40F4DE9AB304
DEBUG winrmshell: [WinRM] creating command_id: D959B240-4BC8-42C9-83C8-40F4DE9AB304 on shell_id F0FB9367-3001-45A3-873B-5CE846F0B443
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D959B240-4BC8-42C9-83C8-40F4DE9AB304 on shell_id F0FB9367-3001-45A3-873B-5CE846F0B443
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a414c8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: verify_vmware_hgfs
DEBUG guest: Checking in: windows
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 0
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2211, 22=>2206}, :udp=>{}}
 INFO synced_folder: Preparing shared folders with VMX...
 INFO interface: info: Enabling and configuring shared folders...
 INFO interface: info: ==> wef: Enabling and configuring shared folders...
==> wef: Enabling and configuring shared folders...
 INFO vmware_driver: Enabling shared folders...
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "enableSharedFolders", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31992
DEBUG subprocess: Exit status: 0
 INFO interface: detail: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO interface: detail:     wef: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
    wef: -- D:/workspace/eWalker/DetectionLab/Vagrant: /vagrant
 INFO vmware_driver: Adding a shared folder '-vagrant': D:/workspace/eWalker/DetectionLab/Vagrant
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "addSharedFolder", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "setSharedFolderState", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant\\.vagrant\\machines\\wef\\vmware_desktop\\b422f57c-7c53-492b-8be2-3da74bf5d4c0\\WindowsServer2016.vmx", "-vagrant", "D:\\workspace\\eWalker\\DetectionLab\\Vagrant", "writable"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5986=>2205, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7FD9F11F-5050-41AD-A105-DCE390B9C22C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 688FE05F-608A-4F85-BA37-65BA0A84ED7A
DEBUG winrmshell: [WinRM] creating command_id: 688FE05F-608A-4F85-BA37-65BA0A84ED7A on shell_id 7FD9F11F-5050-41AD-A105-DCE390B9C22C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 688FE05F-608A-4F85-BA37-65BA0A84ED7A on shell_id 7FD9F11F-5050-41AD-A105-DCE390B9C22C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a535b0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: mount_vmware_shared_folder
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: mount_vmware_shared_folder in windows
 INFO guest: Execute capability: mount_vmware_shared_folder [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>, "-vagrant", "/vagrant", {:guestpath=>"/vagrant", :hostpath=>"D:/workspace/eWalker/DetectionLab/Vagrant", :disabled=>false, :__vagrantfile=>true, :plugin=>#<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000024352a914c8 @logger=#<Log4r::Logger:0x0000024352a91450 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_logger=#<Log4r::Logger:0x0000024352a633c0 @fullname="vagrant::capability_host::hashicorp::vagrantvmwaredesktop::syncedfolder", @outputters=[], @additive=true, @name="syncedfolder", @path="vagrant::capability_host::hashicorp::vagrantvmwaredesktop", @parent=#<VagrantLogger:0x000002434ff30f40 @fullname="vagrant", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="vagrant", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>, @cap_host_chain=[[:vmware, #<HashiCorp::VagrantVMwareDesktop::SyncedFolder:0x0000024352a3b550 @logger=#<Log4r::Logger:0x0000024352a3b4b0 @fullname="hashicorp::provider::vmware::synced_folder", @outputters=[], @additive=true, @name="synced_folder", @path="hashicorp::provider::vmware", @parent=#<Log4r::Logger:0x0000024350e00c50 @fullname="hashicorp", @outputters=[#<Log4r::StderrOutputter:0x000002434fedc170 @name="stderr", @level=0, @formatter=#<Vagrant::Util::LoggingFormatter:0x000002434fec5c18 @formatter=#<Log4r::BasicFormatter:0x000002434fec71d0 @depth=7>>, @out=#<IO:<STDERR>>>], @additive=true, @name="hashicorp", @path="", @parent=#<Log4r::RootLogger:0x000002434ff30888 @level=0, @outputters=[]>, @level=1, @trace=false>, @level=1, @trace=false>>]], @cap_args=[#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>], @cap_caps={:virtualbox=>#<Vagrant::Registry:0x0000024352a637f8 @items={:mount_options=>#<Proc:0x0000024350450ae8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:72>, :mount_type=>#<Proc:0x0000024350450a20 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:77>, :mount_name=>#<Proc:0x0000024350450958 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/providers/virtualbox/plugin.rb:82>}, @results_cache={}>, :smb=>#<Vagrant::Registry:0x0000024352a63690 @items={:default_fstab_modification=>#<Proc:0x000002435052d100 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:26>, :mount_options=>#<Proc:0x000002435052d088 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:31>, :mount_name=>#<Proc:0x000002435052d010 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:36>, :mount_type=>#<Proc:0x000002435052cf98 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/plugins/synced_folders/smb/plugin.rb:41>}, @results_cache={}>}>, :owner=>"vagrant", :group=>"vagrant"}] (windows)
DEBUG winrm: powershell executing:
function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352da8eb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dabeb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c5db58 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 32F50090-A2B6-40ED-92D4-88F46CE63C89
DEBUG winrmshell: [WinRM] Command created for function Test-ReparsePoint([string]$path) {
  $file = Get-Item $path -Force -ea 0
  return [bool]($file.Attributes -band [IO.FileAttributes]::ReparsePoint)
}

$MountPoint = [System.IO.Path]::GetFullPath("/vagrant")
$ShareName = "-vagrant"
$VmProviderUncPath = "\\vmware-host\Shared Folders\-vagrant"

# https://github.com/BIAINC/vagrant-windows/issues/4
# Not sure why this works, but it does.

& net use $ShareName 2>&1 | Out-Null

Write-Debug "Attempting to mount $ShareName to $MountPoint"
if( (Test-Path "$MountPoint") -and (Test-ReparsePoint "$MountPoint") )
{
  Write-Debug "Junction already exists, so I will delete it"
  # Powershell refuses to delete junctions, oh well use cmd
  cmd.exe /c rd "$MountPoint"

  if ( $LASTEXITCODE -ne 0 )
  {
    Write-Error "Failed to delete symbolic link at $MountPoint"
    exit 1
  }

}
elseif(Test-Path $MountPoint)
{
  Write-Error "Mount point already exists and is not a symbolic link"
  exit 1
}

$BaseDirectory = [System.IO.Path]::GetDirectoryName($MountPoint)

if (-not (Test-Path $BaseDirectory))
{
  Write-Debug "Creating parent directory for mount point $BaseDirectory"
  New-Item $BaseDirectory -Type Directory -Force | Out-Null
}

cmd.exe /c mklink /D "$MountPoint" "$VmProviderUncPath" | out-null

if ( $LASTEXITCODE -ne 0 )
{
  exit 1
}


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DF8B160B-4B8B-46FB-B22F-C12A9FC9FA10
DEBUG winrmshell: [WinRM] creating command_id: DF8B160B-4B8B-46FB-B22F-C12A9FC9FA10 on shell_id 32F50090-A2B6-40ED-92D4-88F46CE63C89
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DF8B160B-4B8B-46FB-B22F-C12A9FC9FA10 on shell_id 32F50090-A2B6-40ED-92D4-88F46CE63C89
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b5cbc8 @data=[], @exitcode=0>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2211, 22=>2212}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 605CB171-D2C0-4B38-AEDE-0018D1E46AD1
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8620FBAD-2C12-4461-A15D-9A3D10182086
DEBUG winrmshell: [WinRM] creating command_id: 8620FBAD-2C12-4461-A15D-9A3D10182086 on shell_id 605CB171-D2C0-4B38-AEDE-0018D1E46AD1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8620FBAD-2C12-4461-A15D-9A3D10182086 on shell_id 605CB171-D2C0-4B38-AEDE-0018D1E46AD1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f82888 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: persist_mount_shared_folder
DEBUG guest: Checking in: windows
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolders:0x000002435326fe38>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Delayed:0x000002435326fe60>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::SyncedFolderCleanup:0x00000243532d7d08>
 INFO warden: Calling OUT action: #<VagrantPlugins::SyncedFolderNFS::ActionCleanup:0x000002435330ed30>
 INFO warden: Calling OUT action: VMware Middleware: PrepareSyncedFolderCleanup
 INFO interface: info: Machine already provisioned. Run `vagrant provision` or use the `--provision`
flag to force provisioning. Provisioners marked to run always will still run.
 INFO interface: info: ==> wef: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> wef: flag to force provisioning. Provisioners marked to run always will still run.
==> wef: Machine already provisioned. Run `vagrant provision` or use the `--provision`
==> wef: flag to force provisioning. Provisioners marked to run always will still run.
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Provision:0x00000243504f2f78>
 INFO warden: Calling OUT action: #<Proc:0x0000024352e03f48 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024352c7e998>
 INFO warden: Calling OUT action: VMware Middleware: PruneForwardedPorts
 INFO warden: Calling OUT action: VMware Middleware: CheckExistingNetwork
 INFO warden: Calling OUT action: #<Proc:0x0000024352becac0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024352dd8f28>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000024352e02df0>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x0000024352a53ec0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x00000243503c9e58 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x000002435328e108 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: VMware Middleware: WaitForVMXHalt
 INFO warden: Calling OUT action: #<Proc:0x00000243531273f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x00000243503ca060>
 INFO warden: Calling OUT action: #<Proc:0x000002435328f508 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024352a53f38>
 INFO warden: Calling OUT action: VMware Middleware: DiscardSuspendedState
 INFO warden: Calling OUT action: #<Proc:0x00000243529c3c30 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024352e83950>
 INFO warden: Calling OUT action: VMware Middleware: CheckVMware
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000024352ebdc90>
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: #<Proc:0x0000024352c8d560 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000002435103f4d0>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO interface: Machine: action ["reload", "end", {:target=>:wef}]
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5986=>2211, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: ED9A1D75-C664-4DA3-AD64-744674A15A4E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 9D28E2E1-4BA0-4182-A309-3604C2C1E36C
DEBUG winrmshell: [WinRM] creating command_id: 9D28E2E1-4BA0-4182-A309-3604C2C1E36C on shell_id ED9A1D75-C664-4DA3-AD64-744674A15A4E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9D28E2E1-4BA0-4182-A309-3604C2C1E36C on shell_id ED9A1D75-C664-4DA3-AD64-744674A15A4E
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435227a2a8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
 INFO warden: Calling OUT action: #<Proc:0x000002435246fcc0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000002435308bdd8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5985=>2207, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A6D0CA43-2138-4BED-9674-3C528373BF6F
DEBUG winrmshell: [WinRM] Command created for hostname with id: 61685A19-1F4E-4CA6-BF7F-89A2487FB022
DEBUG winrmshell: [WinRM] creating command_id: 61685A19-1F4E-4CA6-BF7F-89A2487FB022 on shell_id A6D0CA43-2138-4BED-9674-3C528373BF6F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 61685A19-1F4E-4CA6-BF7F-89A2487FB022 on shell_id A6D0CA43-2138-4BED-9674-3C528373BF6F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b2f678 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2212, 5985=>2204}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4A55E903-D66F-47FC-BFBB-57C9F1FD7787
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8DF5D7C2-84E6-4A61-9057-8881EC8BD83C
DEBUG winrmshell: [WinRM] creating command_id: 8DF5D7C2-84E6-4A61-9057-8881EC8BD83C on shell_id 4A55E903-D66F-47FC-BFBB-57C9F1FD7787
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8DF5D7C2-84E6-4A61-9057-8881EC8BD83C on shell_id 4A55E903-D66F-47FC-BFBB-57C9F1FD7787
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024353080050 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2206, 5985=>2207, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 67EC2B0C-3AE6-4A6A-8883-4788D976374F
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0E6F9B5A-8D88-4479-A11B-5503D258EECE
DEBUG winrmshell: [WinRM] creating command_id: 0E6F9B5A-8D88-4479-A11B-5503D258EECE on shell_id 67EC2B0C-3AE6-4A6A-8883-4788D976374F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0E6F9B5A-8D88-4479-A11B-5503D258EECE on shell_id 67EC2B0C-3AE6-4A6A-8883-4788D976374F
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352497c98 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bc6cd0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bc5b78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ae0938 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CF29CCDE-6D0B-49CA-BD4E-5141BCF975E7
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E3E5595B-5F7E-4BCF-ACFA-B5758B02A4F1
DEBUG winrmshell: [WinRM] creating command_id: E3E5595B-5F7E-4BCF-ACFA-B5758B02A4F1 on shell_id CF29CCDE-6D0B-49CA-BD4E-5141BCF975E7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E3E5595B-5F7E-4BCF-ACFA-B5758B02A4F1 on shell_id CF29CCDE-6D0B-49CA-BD4E-5141BCF975E7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a2a570 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ce8e60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ce3f78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c0fcc8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 662F177C-71E9-4621-A517-47B4AD9D86ED
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1FCA407E-0C36-4532-B827-51F902B1B1A3
DEBUG winrmshell: [WinRM] creating command_id: 1FCA407E-0C36-4532-B827-51F902B1B1A3 on shell_id 662F177C-71E9-4621-A517-47B4AD9D86ED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1FCA407E-0C36-4532-B827-51F902B1B1A3 on shell_id 662F177C-71E9-4621-A517-47B4AD9D86ED
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b138d8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-n8cjct.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dd1ac0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dd0be8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c7d520 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2F6A55D0-4F91-4CAA-88A2-F4642C53C12F
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "91103d0ccbde4757bd913a8feb78e434a7d2d5dc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-n8cjct.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BB298A59-C1AC-4D1A-9FB0-B08214517E31
DEBUG winrmshell: [WinRM] creating command_id: BB298A59-C1AC-4D1A-9FB0-B08214517E31 on shell_id 2F6A55D0-4F91-4CAA-88A2-F4642C53C12F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BB298A59-C1AC-4D1A-9FB0-B08214517E31 on shell_id 2F6A55D0-4F91-4CAA-88A2-F4642C53C12F
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","False","True","False"


DEBUG winrmshell: File C:/tmp/vagrant-shell.ps1 is up to date, skipping
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.54s) stream_files: (0m0.00s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/provision.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352eadb38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352eacc38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d3fbe8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9CDC4312-6D1B-497A-8A00-15DE88A1F046
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 39D03C6E-7E86-4AB0-A6D6-9F6E5E5E284B
DEBUG winrmshell: [WinRM] creating command_id: 39D03C6E-7E86-4AB0-A6D6-9F6E5E5E284B on shell_id 9CDC4312-6D1B-497A-8A00-15DE88A1F046
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:49] Setting timezone to UTC...
 INFO interface: detail:     wef: [02:49] Setting timezone to UTC...
    wef: [02:49] Setting timezone to UTC...
 INFO interface: detail: [02:49] Checking if Windows evaluation is expiring soon or expired...
 INFO interface: detail:     wef: [02:49] Checking if Windows evaluation is expiring soon or expired...
    wef: [02:49] Checking if Windows evaluation is expiring soon or expired...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:49] 180 days left until expiration, no need to rearm.
 INFO interface: detail:     wef: [02:49] 180 days left until expiration, no need to rearm.
    wef: [02:49] 180 days left until expiration, no need to rearm.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Unable to connect to ping.detectionlab.network
 INFO interface: detail:     wef: Unable to connect to ping.detectionlab.network
    wef: Unable to connect to ping.detectionlab.network
 INFO interface: detail: [02:49] Disabling IPv6 on all network adatpers...
 INFO interface: detail:     wef: [02:49] Disabling IPv6 on all network adatpers...
    wef: [02:49] Disabling IPv6 on all network adatpers...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Name                           DisplayName                                        ComponentID
 INFO interface: detail:     wef: Name                           DisplayName                                        ComponentID
    wef: Name                           DisplayName                                        ComponentID
 INFO interface: detail: ----                           -----------                                        -----------
 INFO interface: detail:     wef: ----                           -----------                                        -----------
    wef: ----                           -----------                                        -----------
 INFO interface: detail: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     wef: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    wef: Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail:     wef: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
    wef: Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6
 INFO interface: detail: The operation completed successfully.
 INFO interface: detail:     wef: The operation completed successfully.
    wef: The operation completed successfully.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [02:49] I am domain joined!
 INFO interface: detail:     wef: [02:49] I am domain joined!
    wef: [02:49] I am domain joined!
 INFO interface: detail: [02:49] Setting the registry for auto-login...
 INFO interface: detail:     wef: [02:49] Setting the registry for auto-login...
    wef: [02:49] Setting the registry for auto-login...
 INFO interface: detail: [02:49] Provisioning after joining domain...
 INFO interface: detail:     wef: [02:49] Provisioning after joining domain...
    wef: [02:49] Provisioning after joining domain...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 39D03C6E-7E86-4AB0-A6D6-9F6E5E5E284B on shell_id 9CDC4312-6D1B-497A-8A00-15DE88A1F046
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c2cd50 @data=[{:stdout=>"[02:49] Setting timezone to UTC...\r\n"}, {:stdout=>"[02:49] Checking if Windows evaluation is expiring soon or expired...\r\n"}, {:stdout=>"[02:49] 180 days left until expiration, no need to rearm.\r\n"}, {:stdout=>"Unable to connect to ping.detectionlab.network\r\n"}, {:stdout=>"[02:49] Disabling IPv6 on all network adatpers...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           DisplayName                                        ComponentID     \r\n"}, {:stdout=>"----                           -----------                                        -----------     \r\n"}, {:stdout=>"Ethernet1                      Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"Ethernet0 2                    Internet Protocol Version 6 (TCP/IPv6)             ms_tcpip6       \r\n"}, {:stdout=>"The operation completed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[02:49] I am domain joined!\r\n"}, {:stdout=>"[02:49] Setting the registry for auto-login...\r\n"}, {:stdout=>"[02:49] Provisioning after joining domain...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000002435308bdd8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352ecff08 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5985=>2210, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F37B8A31-4051-4898-89E9-1B329B2D28AE
DEBUG winrmshell: [WinRM] Command created for hostname with id: F7A4CBB2-D02E-4E60-97BD-247C3C58B899
DEBUG winrmshell: [WinRM] creating command_id: F7A4CBB2-D02E-4E60-97BD-247C3C58B899 on shell_id F37B8A31-4051-4898-89E9-1B329B2D28AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F7A4CBB2-D02E-4E60-97BD-247C3C58B899 on shell_id F37B8A31-4051-4898-89E9-1B329B2D28AE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a31668 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5986=>2205, 5985=>2204}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 06D9995F-6AF4-47A7-83C1-BA63CC2C5CD8
DEBUG winrmshell: [WinRM] Command created for hostname with id: 6ACFC43C-A00B-40E2-96A8-3DFB635D95F7
DEBUG winrmshell: [WinRM] creating command_id: 6ACFC43C-A00B-40E2-96A8-3DFB635D95F7 on shell_id 06D9995F-6AF4-47A7-83C1-BA63CC2C5CD8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6ACFC43C-A00B-40E2-96A8-3DFB635D95F7 on shell_id 06D9995F-6AF4-47A7-83C1-BA63CC2C5CD8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ead408 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2212, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 816404A1-4836-425E-A749-FA90CCC013A9
DEBUG winrmshell: [WinRM] Command created for hostname with id: 63B0377F-3DD6-4857-A08A-10375E0F4ED0
DEBUG winrmshell: [WinRM] creating command_id: 63B0377F-3DD6-4857-A08A-10375E0F4ED0 on shell_id 816404A1-4836-425E-A749-FA90CCC013A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 63B0377F-3DD6-4857-A08A-10375E0F4ED0 on shell_id 816404A1-4836-425E-A749-FA90CCC013A9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024351f61148 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a617c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a603a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435299a060 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4C082B57-77A2-4201-9014-CA8AF10C6E41
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 64E5F807-D224-4553-8710-FA3BC8B41BC6
DEBUG winrmshell: [WinRM] creating command_id: 64E5F807-D224-4553-8710-FA3BC8B41BC6 on shell_id 4C082B57-77A2-4201-9014-CA8AF10C6E41
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 64E5F807-D224-4553-8710-FA3BC8B41BC6 on shell_id 4C082B57-77A2-4201-9014-CA8AF10C6E41
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352393c98 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b3d480 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b37d78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a93958 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C4A3CD40-983A-42F7-8012-EF9A500966A0
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E0B71C14-8660-4B01-B50F-4F13762E363E
DEBUG winrmshell: [WinRM] creating command_id: E0B71C14-8660-4B01-B50F-4F13762E363E on shell_id C4A3CD40-983A-42F7-8012-EF9A500966A0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E0B71C14-8660-4B01-B50F-4F13762E363E on shell_id C4A3CD40-983A-42F7-8012-EF9A500966A0
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243529c03a0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1fsyd2u.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bc6e88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bc5da8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352adbaa0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "09c377ee7e4e922ca5e8af4143bc0682a8350493" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-1fsyd2u.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 643242C9-3678-410A-97C5-D1536341AAB6
DEBUG winrmshell: [WinRM] creating command_id: 643242C9-3678-410A-97C5-D1536341AAB6 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 643242C9-3678-410A-97C5-D1536341AAB6 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","09c377ee7e4e922ca5e8af4143bc0682a8350493","91103d0ccbde4757bd913a8feb78e434a7d2d5dc","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1fsyd2u.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E7BF282C-B8DF-4A9C-9148-5660EB83C607
DEBUG winrmshell: [WinRM] creating command_id: E7BF282C-B8DF-4A9C-9148-5660EB83C607 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E7BF282C-B8DF-4A9C-9148-5660EB83C607 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIHVuemlwcyBhIGNvcHkgb2YgdGhlIFBhbGFudGlyIFdFRiBHaXRodWIgUmVwby4gVGhpcyBpbmNsdWRlcyBXRUYgc3Vic2NyaXB0aW9ucyBhbmQgY3VzdG9tIFdFRiBjaGFubmVscy4KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBhbmQgdW56aXBwaW5nIHRoZSBQYWxhbnRpciBXaW5kb3dzIEV2ZW50IEZvcndhcmRpbmcgUmVwbyBmcm9tIEdpdGh1Yi4uLiIKCiR3ZWZSZXBvUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3ZWYtTWFzdGVyLnppcCcKCklmICgtbm90IChUZXN0LVBhdGggJHdlZlJlcG9QYXRoKSkKewogICAgIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzEvMjAxOAogICAgW05ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VjdXJpdHlQcm90b2NvbCA9IFtOZXQuU2VjdXJpdHlQcm90b2NvbFR5cGVdOjpUbHMxMgogICAgIyBEaXNhYmxpbmcgdGhlIHByb2dyZXNzIGJhciBzcGVlZHMgdXAgSVdSIGh0dHBzOi8vZ2l0aHViLmNvbS9Qb3dlclNoZWxsL1Bvd2VyU2hlbGwvaXNzdWVzLzIxMzgKICAgICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICAgIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgImh0dHBzOi8vZ2l0aHViLmNvbS9wYWxhbnRpci93aW5kb3dzLWV2ZW50LWZvcndhcmRpbmcvYXJjaGl2ZS9tYXN0ZXIuemlwIiAtT3V0RmlsZSAkd2VmUmVwb1BhdGgKICAgIEV4cGFuZC1BcmNoaXZlIC1wYXRoICIkd2VmUmVwb1BhdGgiIC1kZXN0aW5hdGlvbnBhdGggJ2M6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wJyAtRm9yY2UKfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSAkd2VmUmVwb1BhdGggYWxyZWFkeSBleGlzdHMuIE1vdmluZyBPbi4iCn0KV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFBhbGFudGlyIFdFRiBkb3dubG9hZCBjb21wbGV0ZSEiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F953B170-32AA-4EBB-BABD-26774D4F2608
DEBUG winrmshell: [WinRM] creating command_id: F953B170-32AA-4EBB-BABD-26774D4F2608 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F953B170-32AA-4EBB-BABD-26774D4F2608 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 086A358D-FF13-4C79-A355-4A0EF066C2D4
DEBUG winrmshell: [WinRM] creating command_id: 086A358D-FF13-4C79-A355-4A0EF066C2D4 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 086A358D-FF13-4C79-A355-4A0EF066C2D4 on shell_id 5278CA5E-56D7-4D1B-8A01-33A2AEAD513E
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1fsyd2u.ps1 to C:/tmp/vagrant-shell.ps1 (1.384 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.57s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/download_palantir_wef.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fd1460 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fd05d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352eaef60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 79B33083-960E-467F-8060-C51A38478527
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 147CABE6-692D-4568-A98D-3F53D9889AFF
DEBUG winrmshell: [WinRM] creating command_id: 147CABE6-692D-4568-A98D-3F53D9889AFF on shell_id 79B33083-960E-467F-8060-C51A38478527
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:49] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
 INFO interface: detail:     wef: [02:49] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
    wef: [02:49] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:50] Palantir WEF download complete!
 INFO interface: detail:     wef: [02:50] Palantir WEF download complete!
    wef: [02:50] Palantir WEF download complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 147CABE6-692D-4568-A98D-3F53D9889AFF on shell_id 79B33083-960E-467F-8060-C51A38478527
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352d3c740 @data=[{:stdout=>"[02:49] Downloading and unzipping the Palantir Windows Event Forwarding Repo from Github...\r\n"}, {:stdout=>"[02:50] Palantir WEF download complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352ecff08 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352292358 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2205, 22=>2212}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E9B3FFA9-89AF-4578-938F-76A1C749EFD6
DEBUG winrmshell: [WinRM] Command created for hostname with id: CEBC2EAC-FB2D-4034-9B08-384DA0A0CE7E
DEBUG winrmshell: [WinRM] creating command_id: CEBC2EAC-FB2D-4034-9B08-384DA0A0CE7E on shell_id E9B3FFA9-89AF-4578-938F-76A1C749EFD6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CEBC2EAC-FB2D-4034-9B08-384DA0A0CE7E on shell_id E9B3FFA9-89AF-4578-938F-76A1C749EFD6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f5a928 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2212, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 09CEE2F4-5938-4EFE-8D7B-F1CB741FAC61
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0E09EBE7-C760-4D8B-899C-D645C3C9F403
DEBUG winrmshell: [WinRM] creating command_id: 0E09EBE7-C760-4D8B-899C-D645C3C9F403 on shell_id 09CEE2F4-5938-4EFE-8D7B-F1CB741FAC61
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0E09EBE7-C760-4D8B-899C-D645C3C9F403 on shell_id 09CEE2F4-5938-4EFE-8D7B-F1CB741FAC61
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243521d02f8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2212, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 16ADBA17-FDAC-4F70-9DD9-037FCADABEDA
DEBUG winrmshell: [WinRM] Command created for hostname with id: 1BE3B3B2-3A87-4C59-BA34-2EF4E1852ECB
DEBUG winrmshell: [WinRM] creating command_id: 1BE3B3B2-3A87-4C59-BA34-2EF4E1852ECB on shell_id 16ADBA17-FDAC-4F70-9DD9-037FCADABEDA
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1BE3B3B2-3A87-4C59-BA34-2EF4E1852ECB on shell_id 16ADBA17-FDAC-4F70-9DD9-037FCADABEDA
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352baf0a8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f619f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f60760 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352df33f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3075B11D-FB1E-4E35-B9D4-3E7D7BEE265A
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CB49B820-6B6D-43B5-BA73-03D57D14A090
DEBUG winrmshell: [WinRM] creating command_id: CB49B820-6B6D-43B5-BA73-03D57D14A090 on shell_id 3075B11D-FB1E-4E35-B9D4-3E7D7BEE265A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CB49B820-6B6D-43B5-BA73-03D57D14A090 on shell_id 3075B11D-FB1E-4E35-B9D4-3E7D7BEE265A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c8cc78 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435308aac8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353089b78 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f705c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D0333EB6-9E26-4BB3-A67D-28B9742E0AED
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 638ED00E-FDCE-4543-8280-E98A4EF93DA7
DEBUG winrmshell: [WinRM] creating command_id: 638ED00E-FDCE-4543-8280-E98A4EF93DA7 on shell_id D0333EB6-9E26-4BB3-A67D-28B9742E0AED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 638ED00E-FDCE-4543-8280-E98A4EF93DA7 on shell_id D0333EB6-9E26-4BB3-A67D-28B9742E0AED
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352df9778 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1glzvfn to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353014fa8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243530a3eb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352faa658 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "af4aaea595b5271e1593adca5253b0b12d4b3df3" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-1glzvfn";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D782776E-7EF0-4C45-8E80-B407AD714669
DEBUG winrmshell: [WinRM] creating command_id: D782776E-7EF0-4C45-8E80-B407AD714669 on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D782776E-7EF0-4C45-8E80-B407AD714669 on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","af4aaea595b5271e1593adca5253b0b12d4b3df3","09c377ee7e4e922ca5e8af4143bc0682a8350493","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1glzvfn to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 46F6BDDF-D497-45E5-889E-27CD1CB69044
DEBUG winrmshell: [WinRM] creating command_id: 46F6BDDF-D497-45E5-889E-27CD1CB69044 on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 46F6BDDF-D497-45E5-889E-27CD1CB69044 on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('d2V2dHV0aWwgZWwgfCBTZWxlY3QtU3RyaW5nIC1ub3RtYXRjaCAiTWljcm9zb2Z0LVdpbmRvd3MtTGl2ZUlkIiB8IEZvcmVhY2gtT2JqZWN0IHt3ZXZ0dXRpbCBjbCAiJF8ifQ==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F8991C86-A34D-48AB-976E-48590911D9E6
DEBUG winrmshell: [WinRM] creating command_id: F8991C86-A34D-48AB-976E-48590911D9E6 on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F8991C86-A34D-48AB-976E-48590911D9E6 on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: EE37F1C3-D639-4E16-92BD-789F5FE2001A
DEBUG winrmshell: [WinRM] creating command_id: EE37F1C3-D639-4E16-92BD-789F5FE2001A on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EE37F1C3-D639-4E16-92BD-789F5FE2001A on shell_id CA05CEE9-B359-4168-A207-44677BE1D195
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1glzvfn to C:/tmp/vagrant-shell.ps1 (0.132 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.52s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     wef: Running: inline PowerShell script
    wef: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243521dacf8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243521d32c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350e84ca8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CD97DDD2-0AAB-488B-9585-89FCF42B761D
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 673730DA-C0FF-4DA0-8EE5-42D29AEB0F33
DEBUG winrmshell: [WinRM] creating command_id: 673730DA-C0FF-4DA0-8EE5-42D29AEB0F33 on shell_id CD97DDD2-0AAB-488B-9585-89FCF42B761D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 673730DA-C0FF-4DA0-8EE5-42D29AEB0F33 on shell_id CD97DDD2-0AAB-488B-9585-89FCF42B761D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024353295ac0 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352292358 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352ce9e00 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2212, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2D657482-4417-4971-A3BC-722EBB779ACD
DEBUG winrmshell: [WinRM] Command created for hostname with id: 66F41A0D-0CCD-4603-94C5-B5C74F1658F4
DEBUG winrmshell: [WinRM] creating command_id: 66F41A0D-0CCD-4603-94C5-B5C74F1658F4 on shell_id 2D657482-4417-4971-A3BC-722EBB779ACD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 66F41A0D-0CCD-4603-94C5-B5C74F1658F4 on shell_id 2D657482-4417-4971-A3BC-722EBB779ACD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352497c48 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2212, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F9A381C6-F231-4ABF-9259-E58BBAF8D6F8
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4B3BF8D1-B02D-43D8-90A3-E5D3426082A4
DEBUG winrmshell: [WinRM] creating command_id: 4B3BF8D1-B02D-43D8-90A3-E5D3426082A4 on shell_id F9A381C6-F231-4ABF-9259-E58BBAF8D6F8
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4B3BF8D1-B02D-43D8-90A3-E5D3426082A4 on shell_id F9A381C6-F231-4ABF-9259-E58BBAF8D6F8
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c7dde0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 5985=>2204, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 94D226E6-02B2-4364-803D-318B7A6ED2EC
DEBUG winrmshell: [WinRM] Command created for hostname with id: AC3AF3A7-79BC-4B73-8ACD-F83BC65647F6
DEBUG winrmshell: [WinRM] creating command_id: AC3AF3A7-79BC-4B73-8ACD-F83BC65647F6 on shell_id 94D226E6-02B2-4364-803D-318B7A6ED2EC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AC3AF3A7-79BC-4B73-8ACD-F83BC65647F6 on shell_id 94D226E6-02B2-4364-803D-318B7A6ED2EC
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435325d120 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243523910d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435237afb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243520c80b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C687B59B-FB33-49CE-A4B2-B21357441AAF
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 68185F3A-1F09-4FAD-9325-52DB6DBDB46F
DEBUG winrmshell: [WinRM] creating command_id: 68185F3A-1F09-4FAD-9325-52DB6DBDB46F on shell_id C687B59B-FB33-49CE-A4B2-B21357441AAF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 68185F3A-1F09-4FAD-9325-52DB6DBDB46F on shell_id C687B59B-FB33-49CE-A4B2-B21357441AAF
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435071c970 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352992018 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352991118 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243523924d8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A4524D81-F5A6-4175-AAAB-25868337F2D7
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 84A4AB28-8783-4046-8CA8-6DAA29809279
DEBUG winrmshell: [WinRM] creating command_id: 84A4AB28-8783-4046-8CA8-6DAA29809279 on shell_id A4524D81-F5A6-4175-AAAB-25868337F2D7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 84A4AB28-8783-4046-8CA8-6DAA29809279 on shell_id A4524D81-F5A6-4175-AAAB-25868337F2D7
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243520a99b0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-a96325.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243529a9bf0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243529a8d18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243523d36b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "22167b116e9ffcf5417a32e89fe9fcd8441017c8" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-a96325.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 81039341-B42A-4E6E-8832-7FE0D0AC1259
DEBUG winrmshell: [WinRM] creating command_id: 81039341-B42A-4E6E-8832-7FE0D0AC1259 on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 81039341-B42A-4E6E-8832-7FE0D0AC1259 on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","22167b116e9ffcf5417a32e89fe9fcd8441017c8","af4aaea595b5271e1593adca5253b0b12d4b3df3","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-a96325.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3B016A6A-5968-4887-82CA-707D96EE1C09
DEBUG winrmshell: [WinRM] creating command_id: 3B016A6A-5968-4887-82CA-707D96EE1C09 on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3B016A6A-5968-4887-82CA-707D96EE1C09 on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbXBvcnRzIHRoZSBjdXN0b20gV2luZG93cyBFdmVudCBDaGFubmVsIGFuZCBYTUwgc3Vic2NyaXB0aW9ucyBvbiB0aGUgV0VGIGhvc3QKIyBOb3RlOiBUaGlzIG9ubHkgbmVlZHMgdG8gYmUgaW5zdGFsbGVkIG9uIHRoZSBXRUYgc2VydmVyCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW5zdGFsbGluZyBXRUYgU3Vic2NyaXB0aW9ucy4uLiIKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDb3B5aW5nIEN1c3RvbSBFdmVudCBDaGFubmVscyBETEwuLi4iCmlmICgtbm90IChUZXN0LVBhdGggIiRlbnY6d2luZGlyXHN5c3RlbTMyXEN1c3RvbUV2ZW50Q2hhbm5lbHMuZGxsIikpCnsKICAgIENvcHktSXRlbSBjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3aW5kb3dzLWV2ZW50LWZvcndhcmRpbmctbWFzdGVyXHdpbmRvd3MtZXZlbnQtY2hhbm5lbHNcQ3VzdG9tRXZlbnRDaGFubmVscy5kbGwgIiRlbnY6d2luZGlyXHN5c3RlbTMyIgogICAgQ29weS1JdGVtIGM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHdpbmRvd3MtZXZlbnQtZm9yd2FyZGluZy1tYXN0ZXJcd2luZG93cy1ldmVudC1jaGFubmVsc1xDdXN0b21FdmVudENoYW5uZWxzLm1hbiAiJGVudjp3aW5kaXJcc3lzdGVtMzIiCgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ3VzdG9tIEV2ZW50IENoYW5uZWxzIE1hbmlmZXN0Li4uIgogICAgd2V2dHV0aWwgaW0gImM6XHdpbmRvd3Ncc3lzdGVtMzJcQ3VzdG9tRXZlbnRDaGFubmVscy5tYW4iCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgUmVzaXppbmcgQ2hhbm5lbHMgdG8gNEdCLi4uIgogICAgJHhtbCA9IHdldnR1dGlsIGVsIHwgc2VsZWN0LXN0cmluZyAtcGF0dGVybiAiV0VDIgogICAgZm9yZWFjaCAoJHN1YnNjcmlwdGlvbiBpbiAkeG1sKSB7IHdldnR1dGlsIHNsICRzdWJzY3JpcHRpb24gL21zOjQyOTQ5NjcyOTYgfQoKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTdGFydGluZyB0aGUgV2luZG93cyBFdmVudCBDb2xsZWN0b3IgU2VydmljZS4uLiIKICAgIG5ldCBzdGFydCB3ZWNzdmMKCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ3JlYXRpbmcgY3VzdG9tIGV2ZW50IHN1YnNjcmlwdGlvbnMuLi4iCiAgICBjZCBjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3aW5kb3dzLWV2ZW50LWZvcndhcmRpbmctbWFzdGVyXHdlZi1zdWJzY3JpcHRpb25zCiAgICBjbWQgL2MgImZvciAvciAlaSBpbiAoKi54bWwpIGRvIHdlY3V0aWwgY3MgJWkiCgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEVuYWJsaW5nIGN1c3RvbSBldmVudCBzdWJzY3JpcHRpb25zLi4uIgogICAgY21kIC9jICJmb3IgL3IgJWkgaW4gKCoueG1sKSBkbyB3ZWN1dGlsIHNzICV+bmkgL2U6dHJ1ZSIKCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRW5hYmxpbmcgV2VjVXRpbCBRdWljayBDb25maWcuLi4iCiAgICB3ZWN1dGlsIHFjIC9xOnRydWUKfQplbHNlCnsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV0VGIFN1YnNjcmlwdGlvbnMgYXJlIGFscmVhZHkgaW5zdGFsbGVkLCBtb3Zpbmcgb24uLi4iCiAgaWYgKChHZXQtU2VydmljZSAtTmFtZSB3ZWNzdmMpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQogIHsKICAgIG5ldCBzdGFydCB3ZWNzdmMKICB9Cn0KU3RhcnQtU2xlZXAgLVNlY29uZHMgNjAKaWYgKChHZXQtU2VydmljZSAtTmFtZSB3ZWNzdmMpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgICB0aHJvdyAiV2luZG93cyBFdmVudCBDb2xsZWN0b3IgZmFpbGVkIHRvIHN0YXJ0Igp9Cg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E38E6A82-65F0-4D68-B1DE-8F3FA9323B3D
DEBUG winrmshell: [WinRM] creating command_id: E38E6A82-65F0-4D68-B1DE-8F3FA9323B3D on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E38E6A82-65F0-4D68-B1DE-8F3FA9323B3D on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: ABF6C12C-4B5A-4014-A0D9-256AC3A67DBA
DEBUG winrmshell: [WinRM] creating command_id: ABF6C12C-4B5A-4014-A0D9-256AC3A67DBA on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ABF6C12C-4B5A-4014-A0D9-256AC3A67DBA on shell_id C5AB650C-7D11-4FFF-BBAC-9BDF95407046
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-a96325.ps1 to C:/tmp/vagrant-shell.ps1 (2.64 KB over 1 chunks) in (0m0.17s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.48s) stream_files: (0m0.17s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-wefsubscriptions.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-wefsubscriptions.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-wefsubscriptions.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c04be8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bfed38 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b10de0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 57E013A0-34CD-414F-8396-E84253B6AE15
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4A2258AD-7FA3-40D8-897F-1CB7B84DF0F5
DEBUG winrmshell: [WinRM] creating command_id: 4A2258AD-7FA3-40D8-897F-1CB7B84DF0F5 on shell_id 57E013A0-34CD-414F-8396-E84253B6AE15
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:50] Installing WEF Subscriptions...
 INFO interface: detail:     wef: [02:50] Installing WEF Subscriptions...
    wef: [02:50] Installing WEF Subscriptions...
 INFO interface: detail: [02:50] Copying Custom Event Channels DLL...
 INFO interface: detail:     wef: [02:50] Copying Custom Event Channels DLL...
    wef: [02:50] Copying Custom Event Channels DLL...
 INFO interface: detail: [02:50] Installing Custom Event Channels Manifest...
 INFO interface: detail:     wef: [02:50] Installing Custom Event Channels Manifest...
    wef: [02:50] Installing Custom Event Channels Manifest...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:50] Resizing Channels to 4GB...
 INFO interface: detail:     wef: [02:50] Resizing Channels to 4GB...
    wef: [02:50] Resizing Channels to 4GB...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:50] Starting the Windows Event Collector Service...
 INFO interface: detail:     wef: [02:50] Starting the Windows Event Collector Service...
    wef: [02:50] Starting the Windows Event Collector Service...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: The Windows Event Collector service is starting.
 INFO interface: detail:     wef: The Windows Event Collector service is starting.
    wef: The Windows Event Collector service is starting.
 INFO interface: detail: The Windows Event Collector service was started successfully.
 INFO interface: detail:     wef: The Windows Event Collector service was started successfully.
    wef: The Windows Event Collector service was started successfully.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [02:50] Creating custom event subscriptions...
 INFO interface: detail:     wef: [02:50] Creating custom event subscriptions...
    wef: [02:50] Creating custom event subscriptions...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Account-Lockout.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Account-Lockout.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Account-Lockout.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Account-Management.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Account-Management.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Account-Management.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Active-Directory.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Active-Directory.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Active-Directory.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\ADFS.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\ADFS.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\ADFS.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Application-Crashes.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Application-Crashes.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Application-Crashes.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Applocker.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Applocker.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Applocker.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Authentication.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Authentication.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Authentication.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Autoruns.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Autoruns.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Autoruns.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Bits-Client.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Bits-Client.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Bits-Client.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Certificate-Authority.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Certificate-Authority.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Certificate-Authority.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Code-Integrity.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Code-Integrity.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Code-Integrity.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Device-Guard.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Device-Guard.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Device-Guard.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\DNS.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\DNS.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\DNS.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Drivers.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Drivers.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Drivers.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Duo-Security.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Duo-Security.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Duo-Security.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\EMET.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\EMET.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\EMET.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Event-Log-Diagnostics.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Event-Log-Diagnostics.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Event-Log-Diagnostics.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Explicit-Credentials.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Explicit-Credentials.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Explicit-Credentials.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-ASR.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-ASR.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-ASR.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-CFA.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-CFA.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-CFA.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-EP.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-EP.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-EP.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-NP.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-NP.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Exploit-Guard-NP.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\External-Devices.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\External-Devices.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\External-Devices.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Firewall.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Firewall.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Firewall.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Group-Policy-Errors.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Group-Policy-Errors.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Group-Policy-Errors.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Kerberos.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Kerberos.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Kerberos.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Log-Deletion-Security.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Log-Deletion-Security.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Log-Deletion-Security.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Log-Deletion-System.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Log-Deletion-System.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Log-Deletion-System.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Microsoft-Office.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Microsoft-Office.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Microsoft-Office.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\MSI-Packages.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\MSI-Packages.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\MSI-Packages.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\NTLM.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\NTLM.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\NTLM.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Object-Manipulation.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Object-Manipulation.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Object-Manipulation.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Operating-System.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Operating-System.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Operating-System.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Powershell.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Powershell.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Powershell.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Print.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Print.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Print.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Privilege-Use.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Privilege-Use.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Privilege-Use.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Process-Execution.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Process-Execution.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Process-Execution.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Registry.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Registry.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Registry.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Services.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Services.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Services.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Shares.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Shares.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Shares.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Smart-Card.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Smart-Card.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Smart-Card.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Software-Restriction-Policies.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Software-Restriction-Policies.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Software-Restriction-Policies.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Sysmon.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Sysmon.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Sysmon.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\System-Time-Change.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\System-Time-Change.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\System-Time-Change.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Task-Scheduler.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Task-Scheduler.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Task-Scheduler.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Terminal-Services.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Terminal-Services.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Terminal-Services.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Defender.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Defender.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Defender.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Diagnostics.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Diagnostics.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Diagnostics.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Updates.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Updates.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Windows-Updates.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Wireless.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Wireless.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\Wireless.xml
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\WMI.xml
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\WMI.xml
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil cs C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions\WMI.xml
 INFO interface: detail: ├»┬╗┬┐[02:50] Enabling custom event subscriptions...
 INFO interface: detail:     wef: ├»┬╗┬┐[02:50] Enabling custom event subscriptions...
    wef: ├»┬╗┬┐[02:50] Enabling custom event subscriptions...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Account-Lockout /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Account-Lockout /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Account-Lockout /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Account-Management /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Account-Management /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Account-Management /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Active-Directory /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Active-Directory /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Active-Directory /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss ADFS /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss ADFS /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss ADFS /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Application-Crashes /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Application-Crashes /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Application-Crashes /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Applocker /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Applocker /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Applocker /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Authentication /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Authentication /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Authentication /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Autoruns /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Autoruns /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Autoruns /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Bits-Client /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Bits-Client /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Bits-Client /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Certificate-Authority /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Certificate-Authority /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Certificate-Authority /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Code-Integrity /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Code-Integrity /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Code-Integrity /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Device-Guard /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Device-Guard /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Device-Guard /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss DNS /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss DNS /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss DNS /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Drivers /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Drivers /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Drivers /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Duo-Security /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Duo-Security /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Duo-Security /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss EMET /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss EMET /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss EMET /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Event-Log-Diagnostics /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Event-Log-Diagnostics /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Event-Log-Diagnostics /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Explicit-Credentials /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Explicit-Credentials /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Explicit-Credentials /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-ASR /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-ASR /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-ASR /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-CFA /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-CFA /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-CFA /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-EP /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-EP /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-EP /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-NP /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-NP /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Exploit-Guard-NP /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss External-Devices /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss External-Devices /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss External-Devices /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Firewall /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Firewall /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Firewall /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Group-Policy-Errors /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Group-Policy-Errors /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Group-Policy-Errors /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Kerberos /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Kerberos /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Kerberos /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Log-Deletion-Security /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Log-Deletion-Security /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Log-Deletion-Security /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Log-Deletion-System /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Log-Deletion-System /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Log-Deletion-System /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Microsoft-Office /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Microsoft-Office /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Microsoft-Office /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss MSI-Packages /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss MSI-Packages /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss MSI-Packages /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss NTLM /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss NTLM /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss NTLM /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Object-Manipulation /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Object-Manipulation /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Object-Manipulation /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Operating-System /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Operating-System /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Operating-System /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Powershell /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Powershell /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Powershell /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Print /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Print /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Print /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Privilege-Use /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Privilege-Use /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Privilege-Use /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Process-Execution /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Process-Execution /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Process-Execution /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Registry /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Registry /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Registry /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Services /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Services /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Services /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Shares /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Shares /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Shares /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Smart-Card /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Smart-Card /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Smart-Card /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Software-Restriction-Policies /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Software-Restriction-Policies /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Software-Restriction-Policies /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Sysmon /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Sysmon /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Sysmon /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss System-Time-Change /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss System-Time-Change /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss System-Time-Change /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Task-Scheduler /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Task-Scheduler /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Task-Scheduler /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Terminal-Services /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Terminal-Services /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Terminal-Services /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Defender /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Defender /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Defender /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Diagnostics /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Diagnostics /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Diagnostics /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Updates /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Updates /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Windows-Updates /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Wireless /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Wireless /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss Wireless /e:true
 INFO interface: detail: ├»┬╗┬┐
 INFO interface: detail:     wef: ├»┬╗┬┐
    wef: ├»┬╗┬┐
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss WMI /e:true
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss WMI /e:true
    wef: C:\Users\vagrant\AppData\Local\Temp\windows-event-forwarding-master\wef-subscriptions>wecutil ss WMI /e:true
 INFO interface: detail: ├»┬╗┬┐[02:50] Enabling WecUtil Quick Config...
 INFO interface: detail:     wef: ├»┬╗┬┐[02:50] Enabling WecUtil Quick Config...
    wef: ├»┬╗┬┐[02:50] Enabling WecUtil Quick Config...
 INFO interface: detail: ├»┬╗┬┐Windows Event Collector service was configured successfully.
 INFO interface: detail:     wef: ├»┬╗┬┐Windows Event Collector service was configured successfully.
    wef: ├»┬╗┬┐Windows Event Collector service was configured successfully.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4A2258AD-7FA3-40D8-897F-1CB7B84DF0F5 on shell_id 57E013A0-34CD-414F-8396-E84253B6AE15
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a5a248 @data=[{:stdout=>"[02:50] Installing WEF Subscriptions...\r\n"}, {:stdout=>"[02:50] Copying Custom Event Channels DLL...\r\n"}, {:stdout=>"[02:50] Installing Custom Event Channels Manifest...\r\n"}, {:stdout=>"[02:50] Resizing Channels to 4GB...\r\n"}, {:stdout=>"[02:50] Starting the Windows Event Collector Service...\r\n"}, {:stdout=>"The Windows Event Collector service is starting.\r\n"}, {:stdout=>"The Windows Event Collector service was started successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[02:50] Creating custom event subscriptions...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Account-Lockout.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Account-Management.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Active-Directory.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\ADFS.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Application-Crashes.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Applocker.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Authentication.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Autoruns.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Bits-Client.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Certificate-Authority.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Code-Integrity.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Device-Guard.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\DNS.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Drivers.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Duo-Security.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\EMET.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Event-Log-Diagnostics.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Explicit-Credentials.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Exploit-Guard-ASR.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Exploit-Guard-CFA.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Exploit-Guard-EP.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Exploit-Guard-NP.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\External-Devices.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Firewall.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Group-Policy-Errors.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Kerberos.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Log-Deletion-Security.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Log-Deletion-System.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Microsoft-Office.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\MSI-Packages.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\NTLM.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Object-Manipulation.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Operating-System.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Powershell.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Print.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Privilege-Use.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Process-Execution.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Registry.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Services.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Shares.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Smart-Card.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Software-Restriction-Policies.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Sysmon.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\System-Time-Change.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Task-Scheduler.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Terminal-Services.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Windows-Defender.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Windows-Diagnostics.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Windows-Updates.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\Wireless.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil cs C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions\\WMI.xml \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF[02:50] Enabling custom event subscriptions...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Account-Lockout /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Account-Management /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Active-Directory /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss ADFS /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Application-Crashes /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Applocker /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Authentication /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Autoruns /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Bits-Client /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Certificate-Authority /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Code-Integrity /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Device-Guard /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss DNS /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Drivers /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Duo-Security /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss EMET /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Event-Log-Diagnostics /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Explicit-Credentials /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Exploit-Guard-ASR /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Exploit-Guard-CFA /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Exploit-Guard-EP /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Exploit-Guard-NP /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss External-Devices /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Firewall /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Group-Policy-Errors /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Kerberos /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Log-Deletion-Security /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Log-Deletion-System /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Microsoft-Office /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss MSI-Packages /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss NTLM /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Object-Manipulation /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Operating-System /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Powershell /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Print /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Privilege-Use /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Process-Execution /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Registry /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Services /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Shares /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Smart-Card /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Software-Restriction-Policies /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Sysmon /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss System-Time-Change /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Task-Scheduler /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Terminal-Services /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Windows-Defender /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Windows-Diagnostics /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Windows-Updates /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss Wireless /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\windows-event-forwarding-master\\wef-subscriptions>wecutil ss WMI /e:true \r\n"}, {:stdout=>"\u00EF\u00BB\u00BF[02:50] Enabling WecUtil Quick Config...\r\n"}, {:stdout=>"\u00EF\u00BB\u00BFWindows Event Collector service was configured successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352ce9e00 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024350fe5480 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: FA11F537-2684-4F8F-9206-1085B27C0E02
DEBUG winrmshell: [WinRM] Command created for hostname with id: 07ADEC5B-7041-4C32-B549-270E38DCE544
DEBUG winrmshell: [WinRM] creating command_id: 07ADEC5B-7041-4C32-B549-270E38DCE544 on shell_id FA11F537-2684-4F8F-9206-1085B27C0E02
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 07ADEC5B-7041-4C32-B549-270E38DCE544 on shell_id FA11F537-2684-4F8F-9206-1085B27C0E02
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352db4740 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 5985=>2207, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 01587F43-782D-4A95-B55E-5A700B7AD386
DEBUG winrmshell: [WinRM] Command created for hostname with id: DF317924-B99E-459F-B41E-9E9CF8363D2D
DEBUG winrmshell: [WinRM] creating command_id: DF317924-B99E-459F-B41E-9E9CF8363D2D on shell_id 01587F43-782D-4A95-B55E-5A700B7AD386
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DF317924-B99E-459F-B41E-9E9CF8363D2D on shell_id 01587F43-782D-4A95-B55E-5A700B7AD386
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435056b310 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5985=>2210, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C8FF007D-63A7-4417-B9E2-B9213CFAA79C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 9C4DA09A-ED56-4BEF-80B5-6EDC5D8B8E56
DEBUG winrmshell: [WinRM] creating command_id: 9C4DA09A-ED56-4BEF-80B5-6EDC5D8B8E56 on shell_id C8FF007D-63A7-4417-B9E2-B9213CFAA79C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9C4DA09A-ED56-4BEF-80B5-6EDC5D8B8E56 on shell_id C8FF007D-63A7-4417-B9E2-B9213CFAA79C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a4a690 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ca2d70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ca0f48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bcc090 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9B2DD70E-1746-4208-B6D1-E0D55E37A1AD
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A931B72A-3D3D-4D42-ADA8-A323E33FF2A2
DEBUG winrmshell: [WinRM] creating command_id: A931B72A-3D3D-4D42-ADA8-A323E33FF2A2 on shell_id 9B2DD70E-1746-4208-B6D1-E0D55E37A1AD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A931B72A-3D3D-4D42-ADA8-A323E33FF2A2 on shell_id 9B2DD70E-1746-4208-B6D1-E0D55E37A1AD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ad08a8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352db4088 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352db2be8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c5de50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AF98C4A0-3FD4-4A95-A144-C802D07FA7DF
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 69D7FE19-B994-425A-B289-EB80948EB74F
DEBUG winrmshell: [WinRM] creating command_id: 69D7FE19-B994-425A-B289-EB80948EB74F on shell_id AF98C4A0-3FD4-4A95-A144-C802D07FA7DF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 69D7FE19-B994-425A-B289-EB80948EB74F on shell_id AF98C4A0-3FD4-4A95-A144-C802D07FA7DF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b4fa18 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-3j564f.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d47848 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d469c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c2f7f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "7e44d007b06722762c8db75337310d9fdca23ebd" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-3j564f.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: AA04EAF2-5556-4FD5-8F22-ECF78E327203
DEBUG winrmshell: [WinRM] creating command_id: AA04EAF2-5556-4FD5-8F22-ECF78E327203 on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AA04EAF2-5556-4FD5-8F22-ECF78E327203 on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","7e44d007b06722762c8db75337310d9fdca23ebd","22167b116e9ffcf5417a32e89fe9fcd8441017c8","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-3j564f.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 16DCCFB4-06CF-4568-899D-3EEB06D03E4D
DEBUG winrmshell: [WinRM] creating command_id: 16DCCFB4-06CF-4568-899D-3EEB06D03E4D on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 16DCCFB4-06CF-4568-899D-3EEB06D03E4D on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBhIFNwbHVuayBVbml2ZXJzYWwgRm9yd2FkZXIgb24gdGhlIGhvc3QKCklmICgtbm90IChUZXN0LVBhdGggIkM6XFByb2dyYW0gRmlsZXNcU3BsdW5rVW5pdmVyc2FsRm9yd2FyZGVyXGJpblxzcGx1bmsuZXhlIikpIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgU3BsdW5rIFVuaXZlcnNhbCBGb3J3YXJkZXIuLi4iCiAgJG1zaUZpbGUgPSAkZW52OlRlbXAgKyAiXHNwbHVua2ZvcndhcmRlci04LjEuMC4xLTI0ZmQ1MjQyOGI1YS14NjQtcmVsZWFzZS5tc2kiCgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nICYgU3RhcnRpbmcgU3BsdW5rIgogIFtOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSAidGxzMTIsIHRsczExLCB0bHMiCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9kb3dubG9hZC5zcGx1bmsuY29tL3Byb2R1Y3RzL3VuaXZlcnNhbGZvcndhcmRlci9yZWxlYXNlcy84LjIuMi4xL3dpbmRvd3Mvc3BsdW5rZm9yd2FyZGVyLTguMi4yLjEtYWU2ODIxYjdjNjRiLXg2NC1yZWxlYXNlLm1zaScsICRtc2lGaWxlKQogIFN0YXJ0LVByb2Nlc3MgLUZpbGVQYXRoICJjOlx3aW5kb3dzXHN5c3RlbTMyXG1zaWV4ZWMuZXhlIiAtQXJndW1lbnRMaXN0ICcvaScsICIkbXNpRmlsZSIsICdSRUNFSVZJTkdfSU5ERVhFUj0iMTkyLjE2OC41Ni4xMDU6OTk5NyIgV0lORVZFTlRMT0dfU0VDX0VOQUJMRT0wIFdJTkVWRU5UTE9HX1NZU19FTkFCTEU9MCBXSU5FVkVOVExPR19BUFBfRU5BQkxFPTAgQUdSRUVUT0xJQ0VOU0U9WWVzIFNFUlZJQ0VTVEFSVFRZUEU9QVVUTyBMQVVOQ0hTUExVTks9MSBTUExVTktQQVNTV09SRD1jaGFuZ2VtZSAvcXVpZXQnIC1XYWl0Cn0KRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNwbHVuayBpcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIG9uLiIKfQpJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIHNwbHVua2ZvcndhcmRlcikuU3RhdHVzIC1uZSAiUnVubmluZyIpIHsKICB0aHJvdyAiU3BsdW5rIGZvcndhcmRlciBzZXJ2aWNlIG5vdCBydW5uaW5nIgp9CldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTcGx1bmsgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 02D24012-1164-439A-B5F5-882FAF630335
DEBUG winrmshell: [WinRM] creating command_id: 02D24012-1164-439A-B5F5-882FAF630335 on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 02D24012-1164-439A-B5F5-882FAF630335 on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C93CC3E3-8DA7-446A-B0C5-3480CD65B35C
DEBUG winrmshell: [WinRM] creating command_id: C93CC3E3-8DA7-446A-B0C5-3480CD65B35C on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C93CC3E3-8DA7-446A-B0C5-3480CD65B35C on shell_id A4880CA7-3B49-40AD-88BB-5FE115AB554B
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-3j564f.ps1 to C:/tmp/vagrant-shell.ps1 (1.652 KB over 1 chunks) in (0m0.15s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.46s) stream_files: (0m0.15s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-splunkuf.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-splunkuf.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-splunkuf.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353076d48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353075c40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f58380 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6C597AB7-427F-4C0A-910C-6532C3CF11E0
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 826C7AE2-7C2F-481B-A769-00ACFA4E3A23
DEBUG winrmshell: [WinRM] creating command_id: 826C7AE2-7C2F-481B-A769-00ACFA4E3A23 on shell_id 6C597AB7-427F-4C0A-910C-6532C3CF11E0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:51] Downloading Splunk Universal Forwarder...
 INFO interface: detail:     wef: [02:51] Downloading Splunk Universal Forwarder...
    wef: [02:51] Downloading Splunk Universal Forwarder...
 INFO interface: detail: [02:51] Installing & Starting Splunk
 INFO interface: detail:     wef: [02:51] Installing & Starting Splunk
    wef: [02:51] Installing & Starting Splunk
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:52] Splunk installation complete!
 INFO interface: detail:     wef: [02:52] Splunk installation complete!
    wef: [02:52] Splunk installation complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 826C7AE2-7C2F-481B-A769-00ACFA4E3A23 on shell_id 6C597AB7-427F-4C0A-910C-6532C3CF11E0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352dd1610 @data=[{:stdout=>"[02:51] Downloading Splunk Universal Forwarder...\r\n"}, {:stdout=>"[02:51] Installing & Starting Splunk\r\n"}, {:stdout=>"[02:52] Splunk installation complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024350fe5480 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000002435208b938 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5985=>2207, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9E82752A-C571-4D69-9194-336945552548
DEBUG winrmshell: [WinRM] Command created for hostname with id: 85135606-2A54-4E17-9928-25FC0168D123
DEBUG winrmshell: [WinRM] creating command_id: 85135606-2A54-4E17-9928-25FC0168D123 on shell_id 9E82752A-C571-4D69-9194-336945552548
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 85135606-2A54-4E17-9928-25FC0168D123 on shell_id 9E82752A-C571-4D69-9194-336945552548
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352dfa5b0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2205, 22=>2212, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DEDDD8B6-E474-4BFC-B558-54CDCA600B5E
DEBUG winrmshell: [WinRM] Command created for hostname with id: 6757F72C-A304-4613-B2C0-AAF5B5960186
DEBUG winrmshell: [WinRM] creating command_id: 6757F72C-A304-4613-B2C0-AAF5B5960186 on shell_id DEDDD8B6-E474-4BFC-B558-54CDCA600B5E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6757F72C-A304-4613-B2C0-AAF5B5960186 on shell_id DEDDD8B6-E474-4BFC-B558-54CDCA600B5E
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243506bf950 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2204, 22=>2212, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 486B0221-2C2A-4E5A-A863-EE259E3472FB
DEBUG winrmshell: [WinRM] Command created for hostname with id: F844E444-7733-4DCD-8EE1-9D28C59A7206
DEBUG winrmshell: [WinRM] creating command_id: F844E444-7733-4DCD-8EE1-9D28C59A7206 on shell_id 486B0221-2C2A-4E5A-A863-EE259E3472FB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F844E444-7733-4DCD-8EE1-9D28C59A7206 on shell_id 486B0221-2C2A-4E5A-A863-EE259E3472FB
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a506d0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c8d880 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c8c340 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bbc780 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E5C266A0-FF0A-4027-B545-7611E8711CE7
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: AA54C701-89B0-4995-9F1E-C5AB9B0F7FDD
DEBUG winrmshell: [WinRM] creating command_id: AA54C701-89B0-4995-9F1E-C5AB9B0F7FDD on shell_id E5C266A0-FF0A-4027-B545-7611E8711CE7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AA54C701-89B0-4995-9F1E-C5AB9B0F7FDD on shell_id E5C266A0-FF0A-4027-B545-7611E8711CE7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ac13a8 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d47460 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d46538 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c2cbc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C9227031-10EB-4469-8187-2AB1B8F0FD20
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2B327857-75EC-4551-97A1-C36C7D644F93
DEBUG winrmshell: [WinRM] creating command_id: 2B327857-75EC-4551-97A1-C36C7D644F93 on shell_id C9227031-10EB-4469-8187-2AB1B8F0FD20
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2B327857-75EC-4551-97A1-C36C7D644F93 on shell_id C9227031-10EB-4469-8187-2AB1B8F0FD20
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b245e8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-yhiaap.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352cd29a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352cd1940 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bdd818 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "ee8f44f7c17fef1f8d8a4645eca0cf3d7cee894d" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-yhiaap.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5C2317D8-1F91-444E-858D-14A926746F29
DEBUG winrmshell: [WinRM] creating command_id: 5C2317D8-1F91-444E-858D-14A926746F29 on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5C2317D8-1F91-444E-858D-14A926746F29 on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","ee8f44f7c17fef1f8d8a4645eca0cf3d7cee894d","7e44d007b06722762c8db75337310d9fdca23ebd","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-yhiaap.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 41ED8FF2-E266-450B-9E9D-8B946B1EB89F
DEBUG winrmshell: [WinRM] creating command_id: 41ED8FF2-E266-450B-9E9D-8B946B1EB89F on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 41ED8FF2-E266-450B-9E9D-8B946B1EB89F on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyB0aGUgV2luZG93cyBTcGx1bmsgVGVjaG5pYWwgQWRkLU9uCiMgTm90ZTogVGhpcyBvbmx5IG5lZWRzIHRvIGJlIGluc3RhbGxlZCBvbiB0aGUgV0VGIHNlcnZlcgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgdGhlIFdpbmRvd3MgVEEgZm9yIFNwbHVuayIKCklmIChUZXN0LVBhdGggIkM6XFByb2dyYW0gRmlsZXNcU3BsdW5rVW5pdmVyc2FsRm9yd2FyZGVyXGV0Y1xhcHBzXFNwbHVua19UQV93aW5kb3dzXGRlZmF1bHQiKSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdpbmRvd3MgVEEgaXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBvbi4iCiAgRXhpdCAwCn0KCiMgSW5zdGFsbCBXaW5kb3dzIFRBICh0aGlzIG9ubHkgbmVlZHMgdG8gYmUgZG9uZSBvbiB0aGUgV0VGIHNlcnZlcikKQ29weS1JdGVtIC1QYXRoICJDOlx2YWdyYW50XHJlc291cmNlc1xzcGx1bmtfZm9yd2FyZGVyXHNwbHVuay1hZGQtb24tZm9yLW1pY3Jvc29mdC13aW5kb3dzXzcwMC50Z3oiIC1EZXN0aW5hdGlvbiAkZW52OnRlbXAKJHdpbmRvd3N0YVBhdGggPSAkZW52OnRlbXAgKyAiXHNwbHVuay1hZGQtb24tZm9yLW1pY3Jvc29mdC13aW5kb3dzXzcwMC50Z3oiCiRpbnB1dHNQYXRoID0gIkM6XFByb2dyYW0gRmlsZXNcU3BsdW5rVW5pdmVyc2FsRm9yd2FyZGVyXGV0Y1xhcHBzXFNwbHVua19UQV93aW5kb3dzXGxvY2FsXGlucHV0cy5jb25mIgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW5zdGFsbGluZyB0aGUgV2luZG93cyBUQSIKU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggIkM6XFByb2dyYW0gRmlsZXNcU3BsdW5rVW5pdmVyc2FsRm9yd2FyZGVyXGJpblxzcGx1bmsuZXhlIiAtQXJndW1lbnRMaXN0ICJpbnN0YWxsIGFwcCAkd2luZG93c3RhUGF0aCAtYXV0aCBhZG1pbjpjaGFuZ2VtZSIgLU5vTmV3V2luZG93CgojIENyZWF0ZSBsb2NhbCBkaXJlY3RvcnkKTmV3LUl0ZW0gLUl0ZW1UeXBlIERpcmVjdG9yeSAtRm9yY2UgLVBhdGggIkM6XFByb2dyYW0gRmlsZXNcU3BsdW5rVW5pdmVyc2FsRm9yd2FyZGVyXGV0Y1xhcHBzXFNwbHVua19UQV93aW5kb3dzXGxvY2FsIgpDb3B5LUl0ZW0gYzpcdmFncmFudFxyZXNvdXJjZXNcc3BsdW5rX2ZvcndhcmRlclx3ZWZfaW5wdXRzLmNvbmYgJGlucHV0c1BhdGggLUZvcmNlCgojIEFkZCBhIGNoZWNrIGhlcmUgdG8gbWFrZSBzdXJlIHRoZSBUQSB3YXMgaW5zdGFsbGVkIGNvcnJlY3RseQpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU2xlZXBpbmcgZm9yIDE1IHNlY29uZHMiClN0YXJ0LVNsZWVwIC1zIDE1CklmIChUZXN0LVBhdGggIkM6XFByb2dyYW0gRmlsZXNcU3BsdW5rVW5pdmVyc2FsRm9yd2FyZGVyXGV0Y1xhcHBzXFNwbHVua19UQV93aW5kb3dzXGRlZmF1bHQiKSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdpbmRvd3MgVEEgaW5zdGFsbGVkIHN1Y2Nlc3NmdWxseS4iCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFNvbWV0aGluZyB3ZW50IHdyb25nIGR1cmluZyBpbnN0YWxsYXRpb24uIgogIGV4aXQgMQp9Cg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CEA9DDE5-B59F-457C-A1BC-F1C16861874D
DEBUG winrmshell: [WinRM] creating command_id: CEA9DDE5-B59F-457C-A1BC-F1C16861874D on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CEA9DDE5-B59F-457C-A1BC-F1C16861874D on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1216FD79-239B-46B5-8D93-635AD429C2E0
DEBUG winrmshell: [WinRM] creating command_id: 1216FD79-239B-46B5-8D93-635AD429C2E0 on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1216FD79-239B-46B5-8D93-635AD429C2E0 on shell_id 7FC8A4BF-ADC6-4AA5-B72D-0C9B440A4B88
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-yhiaap.ps1 to C:/tmp/vagrant-shell.ps1 (2.208 KB over 1 chunks) in (0m0.27s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.47s) stream_files: (0m0.27s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-windows_ta.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-windows_ta.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-windows_ta.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fb55f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352fb4720 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352e3c2d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A1347CFE-7215-4F0D-9740-B947546CCCA5
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BF141BE7-241A-4E4B-8C87-FF307C7F2944
DEBUG winrmshell: [WinRM] creating command_id: BF141BE7-241A-4E4B-8C87-FF307C7F2944 on shell_id A1347CFE-7215-4F0D-9740-B947546CCCA5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:52] Installing the Windows TA for Splunk
 INFO interface: detail:     wef: [02:52] Installing the Windows TA for Splunk
    wef: [02:52] Installing the Windows TA for Splunk
 INFO interface: detail: [02:52] Installing the Windows TA
 INFO interface: detail:     wef: [02:52] Installing the Windows TA
    wef: [02:52] Installing the Windows TA
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail:     Directory: C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_windows
 INFO interface: detail:     wef:     Directory: C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_windows
    wef:     Directory: C:\Program Files\SplunkUniversalForwarder\etc\apps\Splunk_TA_windows
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     wef: Mode                LastWriteTime         Length Name
    wef: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     wef: ----                -------------         ------ ----
    wef: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   2:52 AM                local
 INFO interface: detail:     wef: d-----        6/21/2022   2:52 AM                local
    wef: d-----        6/21/2022   2:52 AM                local
 INFO interface: detail: [02:52] Sleeping for 15 seconds
 INFO interface: detail:     wef: [02:52] Sleeping for 15 seconds
    wef: [02:52] Sleeping for 15 seconds
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: App 'C:\Users\vagrant\AppData\Local\Temp\splunk-add-on-for-microsoft-windows_700.tgz' installed
 INFO interface: detail:     wef: App 'C:\Users\vagrant\AppData\Local\Temp\splunk-add-on-for-microsoft-windows_700.tgz' installed
    wef: App 'C:\Users\vagrant\AppData\Local\Temp\splunk-add-on-for-microsoft-windows_700.tgz' installed
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:52] Windows TA installed successfully.
 INFO interface: detail:     wef: [02:52] Windows TA installed successfully.
    wef: [02:52] Windows TA installed successfully.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BF141BE7-241A-4E4B-8C87-FF307C7F2944 on shell_id A1347CFE-7215-4F0D-9740-B947546CCCA5
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352cd0e50 @data=[{:stdout=>"[02:52] Installing the Windows TA for Splunk\r\n"}, {:stdout=>"[02:52] Installing the Windows TA\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Program Files\\SplunkUniversalForwarder\\etc\\apps\\Splunk_TA_windows\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   2:52 AM                local                                            \r\n"}, {:stdout=>"[02:52] Sleeping for 15 seconds\r\n"}, {:stdout=>"App 'C:\\Users\\vagrant\\AppData\\Local\\Temp\\splunk-add-on-for-microsoft-windows_700.tgz' installed \r\n"}, {:stdout=>"[02:52] Windows TA installed successfully.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000002435208b938 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024353090400 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5986=>2205, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 829B435E-0BEA-49CF-A9A8-3016AAF4BC75
DEBUG winrmshell: [WinRM] Command created for hostname with id: AB13786A-72D3-4BA8-B311-452B4D9F26AB
DEBUG winrmshell: [WinRM] creating command_id: AB13786A-72D3-4BA8-B311-452B4D9F26AB on shell_id 829B435E-0BEA-49CF-A9A8-3016AAF4BC75
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: AB13786A-72D3-4BA8-B311-452B4D9F26AB on shell_id 829B435E-0BEA-49CF-A9A8-3016AAF4BC75
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352af96e0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5985=>2207, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 24F27900-8D8D-4682-9EF0-4DE3EA1A8DCE
DEBUG winrmshell: [WinRM] Command created for hostname with id: 9677A9AC-F1E4-476D-8246-73167BA60186
DEBUG winrmshell: [WinRM] creating command_id: 9677A9AC-F1E4-476D-8246-73167BA60186 on shell_id 24F27900-8D8D-4682-9EF0-4DE3EA1A8DCE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9677A9AC-F1E4-476D-8246-73167BA60186 on shell_id 24F27900-8D8D-4682-9EF0-4DE3EA1A8DCE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f6afa8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2204}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F93699B7-1D8D-4ABB-BF58-6901564CE8D1
DEBUG winrmshell: [WinRM] Command created for hostname with id: 870F36C4-6A09-45B9-8A1C-5154B0B7B8D7
DEBUG winrmshell: [WinRM] creating command_id: 870F36C4-6A09-45B9-8A1C-5154B0B7B8D7 on shell_id F93699B7-1D8D-4ABB-BF58-6901564CE8D1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 870F36C4-6A09-45B9-8A1C-5154B0B7B8D7 on shell_id F93699B7-1D8D-4ABB-BF58-6901564CE8D1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024351eb23f0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a03088 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a00b80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524b6080 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C132ABE5-8DF9-4BE2-969C-7AE78BE06DB9
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0FA0B86F-1D67-47DD-AA9A-C3150616F756
DEBUG winrmshell: [WinRM] creating command_id: 0FA0B86F-1D67-47DD-AA9A-C3150616F756 on shell_id C132ABE5-8DF9-4BE2-969C-7AE78BE06DB9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0FA0B86F-1D67-47DD-AA9A-C3150616F756 on shell_id C132ABE5-8DF9-4BE2-969C-7AE78BE06DB9
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243521f3b68 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a5a2c0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a58510 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352988590 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D20F1E28-12CC-4F58-9BBD-98D2068977EB
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B47448D0-C59B-4C7D-959B-BBA33C4C9F90
DEBUG winrmshell: [WinRM] creating command_id: B47448D0-C59B-4C7D-959B-BBA33C4C9F90 on shell_id D20F1E28-12CC-4F58-9BBD-98D2068977EB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B47448D0-C59B-4C7D-959B-BBA33C4C9F90 on shell_id D20F1E28-12CC-4F58-9BBD-98D2068977EB
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435232ab08 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-xo3u9u.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a0a5e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a09730 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524c4db0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "2ccc385c1b1113d499646914f2abe476d7a690be" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-xo3u9u.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CD8BB8EC-5381-4864-A595-DD1C73697D56
DEBUG winrmshell: [WinRM] creating command_id: CD8BB8EC-5381-4864-A595-DD1C73697D56 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CD8BB8EC-5381-4864-A595-DD1C73697D56 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","2ccc385c1b1113d499646914f2abe476d7a690be","ee8f44f7c17fef1f8d8a4645eca0cf3d7cee894d","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-xo3u9u.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 066F47DE-E15A-464B-9A2F-02F2956CC273
DEBUG winrmshell: [WinRM] creating command_id: 066F47DE-E15A-464B-9A2F-02F2956CC273 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 066F47DE-E15A-464B-9A2F-02F2956CC273 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBjaG9jb2xhdGV5IHBhY2thZ2UgbWFuYWdlciwgdGhlbiBpbnN0YWxscyBjdXN0b20gdXRpbGl0aWVzIGZyb20gQ2hvY28uCgpJZiAoLW5vdCAoVGVzdC1QYXRoICJDOlxQcm9ncmFtRGF0YVxjaG9jb2xhdGV5IikpIHsKICBbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ2hvY29sYXRleSIKICBJbnZva2UtRXhwcmVzc2lvbiAoKG5ldy1vYmplY3QgbmV0LndlYmNsaWVudCkuRG93bmxvYWRTdHJpbmcoJ2h0dHBzOi8vY2hvY29sYXRleS5vcmcvaW5zdGFsbC5wczEnKSkKfSBlbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ2hvY29sYXRleSBpcyBhbHJlYWR5IGluc3RhbGxlZC4iCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIHV0aWxpdGllcy4uLiIKSWYgKCQoaG9zdG5hbWUpIC1lcSAid2luMTAiKSB7CiAgIyBCZWNhdXNlIHRoZSBXaW5kb3dzMTAgc3RhcnQgbWVudSBzdWNrcwogIGNob2NvIGluc3RhbGwgLXkgLS1saW1pdC1vdXRwdXQgLS1uby1wcm9ncmVzcyBjbGFzc2ljLXNoZWxsIC1pbnN0YWxsQXJncyBBRERMT0NBTD1DbGFzc2ljU3RhcnRNZW51CiAgJiAiQzpcUHJvZ3JhbSBGaWxlc1xDbGFzc2ljIFNoZWxsXENsYXNzaWNTdGFydE1lbnUuZXhlIiAiLXhtbCIgImM6XHZhZ3JhbnRccmVzb3VyY2VzXHdpbmRvd3NcTWVudVNldHRpbmdzLnhtbCIKICByZWdlZGl0IC9zIGM6XHZhZ3JhbnRccmVzb3VyY2VzXHdpbmRvd3NcTWVudVN0eWxlX0RlZmF1bHRfV2luNy5yZWcKfQpjaG9jbyBpbnN0YWxsIC15IC0tbGltaXQtb3V0cHV0IC0tbm8tcHJvZ3Jlc3MgTm90ZXBhZFBsdXNQbHVzIFdpblJhciBwcm9jZXNzaGFja2VyCgojIFRoaXMgcmVwbyBvZnRlbiBjYXVzZXMgZmFpbHVyZXMgZHVlIHRvIGluY29ycmVjdCBjaGVja3N1bXMsIHNvIHdlIGlnbm9yZSB0aGVtIGZvciBDaHJvbWUKY2hvY28gaW5zdGFsbCAteSAtLWxpbWl0LW91dHB1dCAtLW5vLXByb2dyZXNzIC0taWdub3JlLWNoZWNrc3VtcyBHb29nbGVDaHJvbWUgCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVXRpbHRpZXMgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F79564F0-7BD1-4CE6-A6E6-A7B67C2E2727
DEBUG winrmshell: [WinRM] creating command_id: F79564F0-7BD1-4CE6-A6E6-A7B67C2E2727 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F79564F0-7BD1-4CE6-A6E6-A7B67C2E2727 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E8929AA3-0744-4A74-B95D-8FE96FF29504
DEBUG winrmshell: [WinRM] creating command_id: E8929AA3-0744-4A74-B95D-8FE96FF29504 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E8929AA3-0744-4A74-B95D-8FE96FF29504 on shell_id CADB24FA-92B1-405B-AFDD-F262945D1483
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-xo3u9u.ps1 to C:/tmp/vagrant-shell.ps1 (1.66 KB over 1 chunks) in (0m0.15s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.48s) stream_files: (0m0.15s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-utilities.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b9ecd0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b9c340 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ab1e08 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8550B853-C10F-4D97-8C4F-FA5DD850C663
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9F235103-FA81-465C-A073-34D2B3B26811
DEBUG winrmshell: [WinRM] creating command_id: 9F235103-FA81-465C-A073-34D2B3B26811 on shell_id 8550B853-C10F-4D97-8C4F-FA5DD850C663
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:52] Installing Chocolatey
 INFO interface: detail:     wef: [02:52] Installing Chocolatey
    wef: [02:52] Installing Chocolatey
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
 INFO interface: detail:     wef: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
    wef: Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)
 INFO interface: detail: Getting latest version of the Chocolatey package for download.
 INFO interface: detail:     wef: Getting latest version of the Chocolatey package for download.
    wef: Getting latest version of the Chocolatey package for download.
 INFO interface: detail: Not using proxy.
 INFO interface: detail:     wef: Not using proxy.
    wef: Not using proxy.
 INFO interface: detail: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
 INFO interface: detail:     wef: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
    wef: Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.
 INFO interface: detail: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
 INFO interface: detail:     wef: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
    wef: Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
 INFO interface: detail: Not using proxy.
 INFO interface: detail:     wef: Not using proxy.
    wef: Not using proxy.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
 INFO interface: detail:     wef: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
    wef: Extracting C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip to C:\Users\vagrant\AppData\Local\Temp\chocolatey\chocoInstall
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing Chocolatey on the local machine
 INFO interface: detail:     wef: Installing Chocolatey on the local machine
    wef: Installing Chocolatey on the local machine
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
 INFO interface: detail:     wef: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
    wef: Creating ChocolateyInstall as an environment variable (targeting 'Machine')
 INFO interface: detail:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
 INFO interface: detail:     wef:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
    wef:   Setting ChocolateyInstall to 'C:\ProgramData\chocolatey'
 INFO interface: detail: WARNING: It's very likely you will need to close and reopen your shell
 INFO interface: detail:     wef: WARNING: It's very likely you will need to close and reopen your shell
    wef: WARNING: It's very likely you will need to close and reopen your shell
 INFO interface: detail:   before you can use choco.
 INFO interface: detail:     wef:   before you can use choco.
    wef:   before you can use choco.
 INFO interface: detail: Restricting write permissions to Administrators
 INFO interface: detail:     wef: Restricting write permissions to Administrators
    wef: Restricting write permissions to Administrators
 INFO interface: detail: We are setting up the Chocolatey package repository.
 INFO interface: detail:     wef: We are setting up the Chocolatey package repository.
    wef: We are setting up the Chocolatey package repository.
 INFO interface: detail: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
 INFO interface: detail:     wef: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
    wef: The packages themselves go to 'C:\ProgramData\chocolatey\lib'
 INFO interface: detail:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
 INFO interface: detail:     wef:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
    wef:   (i.e. C:\ProgramData\chocolatey\lib\yourPackageName).
 INFO interface: detail: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
 INFO interface: detail:     wef: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
    wef: A shim file for the command line goes to 'C:\ProgramData\chocolatey\bin'
 INFO interface: detail:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
 INFO interface: detail:     wef:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
    wef:   and points to an executable in 'C:\ProgramData\chocolatey\lib\yourPackageName'.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Creating Chocolatey folders if they do not already exist.
 INFO interface: detail:     wef: Creating Chocolatey folders if they do not already exist.
    wef: Creating Chocolatey folders if they do not already exist.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: WARNING: You can safely ignore errors related to missing log files when
 INFO interface: detail:     wef: WARNING: You can safely ignore errors related to missing log files when
    wef: WARNING: You can safely ignore errors related to missing log files when
 INFO interface: detail:   upgrading from a version of Chocolatey less than 0.9.9.
 INFO interface: detail:     wef:   upgrading from a version of Chocolatey less than 0.9.9.
    wef:   upgrading from a version of Chocolatey less than 0.9.9.
 INFO interface: detail:   'Batch file could not be found' is also safe to ignore.
 INFO interface: detail:     wef:   'Batch file could not be found' is also safe to ignore.
    wef:   'Batch file could not be found' is also safe to ignore.
 INFO interface: detail:   'The system cannot find the file specified' - also safe.
 INFO interface: detail:     wef:   'The system cannot find the file specified' - also safe.
    wef:   'The system cannot find the file specified' - also safe.
 INFO interface: detail: chocolatey.nupkg file not installed in lib.
 INFO interface: detail:     wef: chocolatey.nupkg file not installed in lib.
    wef: chocolatey.nupkg file not installed in lib.
 INFO interface: detail:  Attempting to locate it from bootstrapper.
 INFO interface: detail:     wef:  Attempting to locate it from bootstrapper.
    wef:  Attempting to locate it from bootstrapper.
 INFO interface: detail: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
 INFO interface: detail:     wef: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
    wef: PATH environment variable does not have C:\ProgramData\chocolatey\bin in it. Adding...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Not setting tab completion: Profile file does not exist at
 INFO interface: detail:     wef: WARNING: Not setting tab completion: Profile file does not exist at
    wef: WARNING: Not setting tab completion: Profile file does not exist at
 INFO interface: detail: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
 INFO interface: detail:     wef: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
    wef: 'C:\Users\vagrant\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Chocolatey (choco.exe) is now ready.
 INFO interface: detail:     wef: Chocolatey (choco.exe) is now ready.
    wef: Chocolatey (choco.exe) is now ready.
 INFO interface: detail: You can call choco from anywhere, command line or powershell by typing choco.
 INFO interface: detail:     wef: You can call choco from anywhere, command line or powershell by typing choco.
    wef: You can call choco from anywhere, command line or powershell by typing choco.
 INFO interface: detail: Run choco /? for a list of functions.
 INFO interface: detail:     wef: Run choco /? for a list of functions.
    wef: Run choco /? for a list of functions.
 INFO interface: detail: You may need to shut down and restart powershell and/or consoles
 INFO interface: detail:     wef: You may need to shut down and restart powershell and/or consoles
    wef: You may need to shut down and restart powershell and/or consoles
 INFO interface: detail:  first prior to using choco.
 INFO interface: detail:     wef:  first prior to using choco.
    wef:  first prior to using choco.
 INFO interface: detail: Ensuring Chocolatey commands are on the path
 INFO interface: detail:     wef: Ensuring Chocolatey commands are on the path
    wef: Ensuring Chocolatey commands are on the path
 INFO interface: detail: Ensuring chocolatey.nupkg is in the lib folder
 INFO interface: detail:     wef: Ensuring chocolatey.nupkg is in the lib folder
    wef: Ensuring chocolatey.nupkg is in the lib folder
 INFO interface: detail: [02:52] Installing utilities...
 INFO interface: detail:     wef: [02:52] Installing utilities...
    wef: [02:52] Installing utilities...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     wef: Installing the following packages:
    wef: Installing the following packages:
 INFO interface: detail: NotepadPlusPlus;WinRar;processhacker
 INFO interface: detail:     wef: NotepadPlusPlus;WinRar;processhacker
    wef: NotepadPlusPlus;WinRar;processhacker
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     wef: By installing, you accept licenses for the packages.
    wef: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: chocolatey-compatibility.extension v1.0.0 [Approved]
 INFO interface: detail:     wef: chocolatey-compatibility.extension v1.0.0 [Approved]
    wef: chocolatey-compatibility.extension v1.0.0 [Approved]
 INFO interface: detail: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
    wef: chocolatey-compatibility.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-compatibility extensions.
 INFO interface: detail:     wef:  Installed/updated chocolatey-compatibility extensions.
    wef:  Installed/updated chocolatey-compatibility extensions.
 INFO interface: detail:  The install of chocolatey-compatibility.extension was successful.
 INFO interface: detail:     wef:  The install of chocolatey-compatibility.extension was successful.
    wef:  The install of chocolatey-compatibility.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
 INFO interface: detail:     wef:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
    wef:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-compatibility'
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: chocolatey-core.extension v1.4.0 [Approved]
 INFO interface: detail:     wef: chocolatey-core.extension v1.4.0 [Approved]
    wef: chocolatey-core.extension v1.4.0 [Approved]
 INFO interface: detail: chocolatey-core.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: chocolatey-core.extension package files install completed. Performing other installation steps.
    wef: chocolatey-core.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-core extensions.
 INFO interface: detail:     wef:  Installed/updated chocolatey-core extensions.
    wef:  Installed/updated chocolatey-core extensions.
 INFO interface: detail:  The install of chocolatey-core.extension was successful.
 INFO interface: detail:     wef:  The install of chocolatey-core.extension was successful.
    wef:  The install of chocolatey-core.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
 INFO interface: detail:     wef:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
    wef:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-core'
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: notepadplusplus.install v8.4.2 [Approved]
 INFO interface: detail:     wef: notepadplusplus.install v8.4.2 [Approved]
    wef: notepadplusplus.install v8.4.2 [Approved]
 INFO interface: detail: notepadplusplus.install package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: notepadplusplus.install package files install completed. Performing other installation steps.
    wef: notepadplusplus.install package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing 64-bit notepadplusplus.install...
 INFO interface: detail:     wef: Installing 64-bit notepadplusplus.install...
    wef: Installing 64-bit notepadplusplus.install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: notepadplusplus.install has been installed.
 INFO interface: detail:     wef: notepadplusplus.install has been installed.
    wef: notepadplusplus.install has been installed.
 INFO interface: detail: WARNING: No registry key found based on  'Notepad\+\+*'
 INFO interface: detail:     wef: WARNING: No registry key found based on  'Notepad\+\+*'
    wef: WARNING: No registry key found based on  'Notepad\+\+*'
 INFO interface: detail: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
 INFO interface: detail:     wef: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
    wef: notepadplusplus.install installed to 'C:\Program Files\Notepad++'
 INFO interface: detail: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
 INFO interface: detail:     wef: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
    wef: Added C:\ProgramData\chocolatey\bin\notepad++.exe shim pointed to 'c:\program files\notepad++\notepad++.exe'.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   notepadplusplus.install can be automatically uninstalled.
 INFO interface: detail:     wef:   notepadplusplus.install can be automatically uninstalled.
    wef:   notepadplusplus.install can be automatically uninstalled.
 INFO interface: detail:  The install of notepadplusplus.install was successful.
 INFO interface: detail:     wef:  The install of notepadplusplus.install was successful.
    wef:  The install of notepadplusplus.install was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     wef:   Software installed as 'exe', install location is likely default.
    wef:   Software installed as 'exe', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: notepadplusplus v8.4.2 [Approved]
 INFO interface: detail:     wef: notepadplusplus v8.4.2 [Approved]
    wef: notepadplusplus v8.4.2 [Approved]
 INFO interface: detail: notepadplusplus package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: notepadplusplus package files install completed. Performing other installation steps.
    wef: notepadplusplus package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of notepadplusplus was successful.
 INFO interface: detail:     wef:  The install of notepadplusplus was successful.
    wef:  The install of notepadplusplus was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: winrar v6.11.0.20220504 [Approved]
 INFO interface: detail:     wef: winrar v6.11.0.20220504 [Approved]
    wef: winrar v6.11.0.20220504 [Approved]
 INFO interface: detail: winrar package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: winrar package files install completed. Performing other installation steps.
    wef: winrar package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading winrar 64 bit
 INFO interface: detail:     wef: Downloading winrar 64 bit
    wef: Downloading winrar 64 bit
 INFO interface: detail:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
 INFO interface: detail:     wef:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
    wef:   from 'https://www.rarlab.com/rar/winrar-x64-611.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Download of winrar-x64-611.exe (3.32 MB) completed.
 INFO interface: detail:     wef: Download of winrar-x64-611.exe (3.32 MB) completed.
    wef: Download of winrar-x64-611.exe (3.32 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     wef: Hashes match.
    wef: Hashes match.
 INFO interface: detail: Installing winrar...
 INFO interface: detail:     wef: Installing winrar...
    wef: Installing winrar...
 INFO interface: detail: winrar has been installed.
 INFO interface: detail:     wef: winrar has been installed.
    wef: winrar has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   winrar may be able to be automatically uninstalled.
 INFO interface: detail:     wef:   winrar may be able to be automatically uninstalled.
    wef:   winrar may be able to be automatically uninstalled.
 INFO interface: detail:  The install of winrar was successful.
 INFO interface: detail:     wef:  The install of winrar was successful.
    wef:  The install of winrar was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\WinRAR\'
 INFO interface: detail:     wef:   Software installed to 'C:\Program Files\WinRAR\'
    wef:   Software installed to 'C:\Program Files\WinRAR\'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
 INFO interface: detail:     wef: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
    wef: processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)
 INFO interface: detail: processhacker.install package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: processhacker.install package files install completed. Performing other installation steps.
    wef: processhacker.install package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading processhacker.install
 INFO interface: detail:     wef: Downloading processhacker.install
    wef: Downloading processhacker.install
 INFO interface: detail:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
 INFO interface: detail:     wef:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
    wef:   from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
 INFO interface: detail:     wef: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
    wef: Download of processhacker-2.39-setup.exe (2.16 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     wef: Hashes match.
    wef: Hashes match.
 INFO interface: detail: Installing processhacker.install...
 INFO interface: detail:     wef: Installing processhacker.install...
    wef: Installing processhacker.install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: processhacker.install has been installed.
 INFO interface: detail:     wef: processhacker.install has been installed.
    wef: processhacker.install has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   processhacker.install can be automatically uninstalled.
 INFO interface: detail:     wef:   processhacker.install can be automatically uninstalled.
    wef:   processhacker.install can be automatically uninstalled.
 INFO interface: detail:  The install of processhacker.install was successful.
 INFO interface: detail:     wef:  The install of processhacker.install was successful.
    wef:  The install of processhacker.install was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\Process Hacker 2\'
 INFO interface: detail:     wef:   Software installed to 'C:\Program Files\Process Hacker 2\'
    wef:   Software installed to 'C:\Program Files\Process Hacker 2\'
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: processhacker v2.39 [Approved] - Possibly broken
 INFO interface: detail:     wef: processhacker v2.39 [Approved] - Possibly broken
    wef: processhacker v2.39 [Approved] - Possibly broken
 INFO interface: detail: processhacker package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: processhacker package files install completed. Performing other installation steps.
    wef: processhacker package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of processhacker was successful.
 INFO interface: detail:     wef:  The install of processhacker was successful.
    wef:  The install of processhacker was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Chocolatey installed 7/7 packages.
 INFO interface: detail:     wef: Chocolatey installed 7/7 packages.
    wef: Chocolatey installed 7/7 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Installed:
 INFO interface: detail:     wef: Installed:
    wef: Installed:
 INFO interface: detail:  - processhacker.install v2.39
 INFO interface: detail:     wef:  - processhacker.install v2.39
    wef:  - processhacker.install v2.39
 INFO interface: detail:  - notepadplusplus.install v8.4.2
 INFO interface: detail:     wef:  - notepadplusplus.install v8.4.2
    wef:  - notepadplusplus.install v8.4.2
 INFO interface: detail:  - chocolatey-core.extension v1.4.0
 INFO interface: detail:     wef:  - chocolatey-core.extension v1.4.0
    wef:  - chocolatey-core.extension v1.4.0
 INFO interface: detail:  - winrar v6.11.0.20220504
 INFO interface: detail:     wef:  - winrar v6.11.0.20220504
    wef:  - winrar v6.11.0.20220504
 INFO interface: detail:  - chocolatey-compatibility.extension v1.0.0
 INFO interface: detail:     wef:  - chocolatey-compatibility.extension v1.0.0
    wef:  - chocolatey-compatibility.extension v1.0.0
 INFO interface: detail:  - notepadplusplus v8.4.2
 INFO interface: detail:     wef:  - notepadplusplus v8.4.2
    wef:  - notepadplusplus v8.4.2
 INFO interface: detail:  - processhacker v2.39
 INFO interface: detail:     wef:  - processhacker v2.39
    wef:  - processhacker v2.39
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     wef: Installing the following packages:
    wef: Installing the following packages:
 INFO interface: detail: GoogleChrome
 INFO interface: detail:     wef: GoogleChrome
    wef: GoogleChrome
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     wef: By installing, you accept licenses for the packages.
    wef: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: GoogleChrome v102.0.5005.115 [Approved]
 INFO interface: detail:     wef: GoogleChrome v102.0.5005.115 [Approved]
    wef: GoogleChrome v102.0.5005.115 [Approved]
 INFO interface: detail: googlechrome package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: googlechrome package files install completed. Performing other installation steps.
    wef: googlechrome package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading googlechrome 64 bit
 INFO interface: detail:     wef: Downloading googlechrome 64 bit
    wef: Downloading googlechrome 64 bit
 INFO interface: detail:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
 INFO interface: detail:     wef:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
    wef:   from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
 INFO interface: detail:     wef: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
    wef: Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
 INFO interface: detail:     wef: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
    wef: WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.
 INFO interface: detail: Installing googlechrome...
 INFO interface: detail:     wef: Installing googlechrome...
    wef: Installing googlechrome...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: googlechrome has been installed.
 INFO interface: detail:     wef: googlechrome has been installed.
    wef: googlechrome has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   googlechrome may be able to be automatically uninstalled.
 INFO interface: detail:     wef:   googlechrome may be able to be automatically uninstalled.
    wef:   googlechrome may be able to be automatically uninstalled.
 INFO interface: detail:  The install of googlechrome was successful.
 INFO interface: detail:     wef:  The install of googlechrome was successful.
    wef:  The install of googlechrome was successful.
 INFO interface: detail:   Software installed as 'MSI', install location is likely default.
 INFO interface: detail:     wef:   Software installed as 'MSI', install location is likely default.
    wef:   Software installed as 'MSI', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     wef: Chocolatey installed 1/1 packages.
    wef: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: [02:54] Utilties installation complete!
 INFO interface: detail:     wef: [02:54] Utilties installation complete!
    wef: [02:54] Utilties installation complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9F235103-FA81-465C-A073-34D2B3B26811 on shell_id 8550B853-C10F-4D97-8C4F-FA5DD850C663
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243529c8d48 @data=[{:stdout=>"[02:52] Installing Chocolatey\r\n"}, {:stdout=>"Forcing web requests to allow TLS v1.2 (Required for requests to Chocolatey.org)\r\n"}, {:stdout=>"Getting latest version of the Chocolatey package for download.\r\n"}, {:stdout=>"Not using proxy.\r\n"}, {:stdout=>"Getting Chocolatey from https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0.\r\n"}, {:stdout=>"Downloading https://community.chocolatey.org/api/v2/package/chocolatey/1.1.0 to C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\\chocolatey.zip\r\n"}, {:stdout=>"Not using proxy.\r\n"}, {:stdout=>"Extracting C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\\chocolatey.zip to C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\chocoInstall\r\n"}, {:stdout=>"Installing Chocolatey on the local machine\r\n"}, {:stdout=>"Creating ChocolateyInstall as an environment variable (targeting 'Machine') \r\n"}, {:stdout=>"  Setting ChocolateyInstall to 'C:\\ProgramData\\chocolatey'\r\n"}, {:stdout=>"WARNING: It's very likely you will need to close and reopen your shell \r\n"}, {:stdout=>"  before you can use choco.\r\n"}, {:stdout=>"Restricting write permissions to Administrators\r\n"}, {:stdout=>"We are setting up the Chocolatey package repository.\r\n"}, {:stdout=>"The packages themselves go to 'C:\\ProgramData\\chocolatey\\lib'\r\n"}, {:stdout=>"  (i.e. C:\\ProgramData\\chocolatey\\lib\\yourPackageName).\r\n"}, {:stdout=>"A shim file for the command line goes to 'C:\\ProgramData\\chocolatey\\bin'\r\n"}, {:stdout=>"  and points to an executable in 'C:\\ProgramData\\chocolatey\\lib\\yourPackageName'.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Creating Chocolatey folders if they do not already exist.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WARNING: You can safely ignore errors related to missing log files when \r\n"}, {:stdout=>"  upgrading from a version of Chocolatey less than 0.9.9. \r\n"}, {:stdout=>"  'Batch file could not be found' is also safe to ignore. \r\n"}, {:stdout=>"  'The system cannot find the file specified' - also safe.\r\n"}, {:stdout=>"chocolatey.nupkg file not installed in lib.\r\n"}, {:stdout=>" Attempting to locate it from bootstrapper.\r\n"}, {:stdout=>"PATH environment variable does not have C:\\ProgramData\\chocolatey\\bin in it. Adding...\r\n"}, {:stdout=>"WARNING: Not setting tab completion: Profile file does not exist at \r\n"}, {:stdout=>"'C:\\Users\\vagrant\\Documents\\WindowsPowerShell\\Microsoft.PowerShell_profile.ps1'.\r\n"}, {:stdout=>"Chocolatey (choco.exe) is now ready.\r\n"}, {:stdout=>"You can call choco from anywhere, command line or powershell by typing choco.\r\n"}, {:stdout=>"Run choco /? for a list of functions.\r\n"}, {:stdout=>"You may need to shut down and restart powershell and/or consoles\r\n"}, {:stdout=>" first prior to using choco.\r\n"}, {:stdout=>"Ensuring Chocolatey commands are on the path\r\n"}, {:stdout=>"Ensuring chocolatey.nupkg is in the lib folder\r\n"}, {:stdout=>"[02:52] Installing utilities...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"NotepadPlusPlus;WinRar;processhacker\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-compatibility.extension v1.0.0 [Approved]\r\n"}, {:stdout=>"chocolatey-compatibility.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-compatibility extensions.\r\n"}, {:stdout=>" The install of chocolatey-compatibility.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-compatibility'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-core.extension v1.4.0 [Approved]\r\n"}, {:stdout=>"chocolatey-core.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-core extensions.\r\n"}, {:stdout=>" The install of chocolatey-core.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-core'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"notepadplusplus.install v8.4.2 [Approved]\r\n"}, {:stdout=>"notepadplusplus.install package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing 64-bit notepadplusplus.install...\r\n"}, {:stdout=>"notepadplusplus.install has been installed.\r\n"}, {:stdout=>"WARNING: No registry key found based on  'Notepad\\+\\+*'\r\n"}, {:stdout=>"notepadplusplus.install installed to 'C:\\Program Files\\Notepad++'\r\n"}, {:stdout=>"Added C:\\ProgramData\\chocolatey\\bin\\notepad++.exe shim pointed to 'c:\\program files\\notepad++\\notepad++.exe'.\r\n"}, {:stdout=>"  notepadplusplus.install can be automatically uninstalled.\r\n"}, {:stdout=>" The install of notepadplusplus.install was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"notepadplusplus v8.4.2 [Approved]\r\n"}, {:stdout=>"notepadplusplus package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" The install of notepadplusplus was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"winrar v6.11.0.20220504 [Approved]\r\n"}, {:stdout=>"winrar package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading winrar 64 bit\r\n"}, {:stdout=>"  from 'https://www.rarlab.com/rar/winrar-x64-611.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of winrar-x64-611.exe (3.32 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing winrar...\r\n"}, {:stdout=>"winrar has been installed.\r\n"}, {:stdout=>"  winrar may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of winrar was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\WinRAR\\'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"processhacker.install v2.39 [Approved] - Likely broken for FOSS users (due to download location changes)\r\n"}, {:stdout=>"processhacker.install package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading processhacker.install \r\n"}, {:stdout=>"  from 'https://sourceforge.net/projects/processhacker/files/processhacker2/processhacker-2.39-setup.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of processhacker-2.39-setup.exe (2.16 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing processhacker.install...\r\n"}, {:stdout=>"processhacker.install has been installed.\r\n"}, {:stdout=>"  processhacker.install can be automatically uninstalled.\r\n"}, {:stdout=>" The install of processhacker.install was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\Process Hacker 2\\'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"processhacker v2.39 [Approved] - Possibly broken\r\n"}, {:stdout=>"processhacker package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" The install of processhacker was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 7/7 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Installed:\r\n"}, {:stdout=>" - processhacker.install v2.39\r\n"}, {:stdout=>" - notepadplusplus.install v8.4.2\r\n"}, {:stdout=>" - chocolatey-core.extension v1.4.0\r\n"}, {:stdout=>" - winrar v6.11.0.20220504\r\n"}, {:stdout=>" - chocolatey-compatibility.extension v1.0.0\r\n"}, {:stdout=>" - notepadplusplus v8.4.2\r\n"}, {:stdout=>" - processhacker v2.39\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"GoogleChrome\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"GoogleChrome v102.0.5005.115 [Approved]\r\n"}, {:stdout=>"googlechrome package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading googlechrome 64 bit\r\n"}, {:stdout=>"  from 'https://dl.google.com/tag/s/dl/chrome/install/googlechromestandaloneenterprise64.msi'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of googlechromestandaloneenterprise64.msi (83.11 MB) completed.\r\n"}, {:stdout=>"WARNING: Ignoring checksums due to feature checksumFiles turned off or option --ignore-checksums set.\r\n"}, {:stdout=>"Installing googlechrome...\r\n"}, {:stdout=>"googlechrome has been installed.\r\n"}, {:stdout=>"  googlechrome may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of googlechrome was successful.\r\n"}, {:stdout=>"  Software installed as 'MSI', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"[02:54] Utilties installation complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024353090400 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x00000243523297f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 5985=>2204, 22=>2212}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F9FC344B-1E7B-496A-9A01-FEAB441D3AF4
DEBUG winrmshell: [WinRM] Command created for hostname with id: 286BDEDD-B922-4010-B56E-E0CEF4E926F1
DEBUG winrmshell: [WinRM] creating command_id: 286BDEDD-B922-4010-B56E-E0CEF4E926F1 on shell_id F9FC344B-1E7B-496A-9A01-FEAB441D3AF4
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 286BDEDD-B922-4010-B56E-E0CEF4E926F1 on shell_id F9FC344B-1E7B-496A-9A01-FEAB441D3AF4
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f495d8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5985=>2204, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2C6EAB8E-76E1-492A-9D93-55E05A9FC97D
DEBUG winrmshell: [WinRM] Command created for hostname with id: 979F7E8B-3C6B-4C21-84FA-74A545AC3EB0
DEBUG winrmshell: [WinRM] creating command_id: 979F7E8B-3C6B-4C21-84FA-74A545AC3EB0 on shell_id 2C6EAB8E-76E1-492A-9D93-55E05A9FC97D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 979F7E8B-3C6B-4C21-84FA-74A545AC3EB0 on shell_id 2C6EAB8E-76E1-492A-9D93-55E05A9FC97D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024350f60780 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5985=>2204, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 73E1DDDD-FBBD-4535-9B16-26F4BAF09CD7
DEBUG winrmshell: [WinRM] Command created for hostname with id: F1FEF1D6-5675-4FEA-9EEA-BFC675B4DCC8
DEBUG winrmshell: [WinRM] creating command_id: F1FEF1D6-5675-4FEA-9EEA-BFC675B4DCC8 on shell_id 73E1DDDD-FBBD-4535-9B16-26F4BAF09CD7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F1FEF1D6-5675-4FEA-9EEA-BFC675B4DCC8 on shell_id 73E1DDDD-FBBD-4535-9B16-26F4BAF09CD7
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a8a560 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c85568 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c7ee48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352baf5f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 52424C51-DB83-486B-BB3B-F90786A165A1
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 3E8586CA-2274-450D-B548-A44ED81A4B77
DEBUG winrmshell: [WinRM] creating command_id: 3E8586CA-2274-450D-B548-A44ED81A4B77 on shell_id 52424C51-DB83-486B-BB3B-F90786A165A1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3E8586CA-2274-450D-B548-A44ED81A4B77 on shell_id 52424C51-DB83-486B-BB3B-F90786A165A1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ab0918 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352cb2a18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352cb0240 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bcc770 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9BCA5FBC-0EDB-49C8-85CF-35268BB7C39D
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: F7CD3B62-48BE-4E0A-8B88-CAAE1243DB40
DEBUG winrmshell: [WinRM] creating command_id: F7CD3B62-48BE-4E0A-8B88-CAAE1243DB40 on shell_id 9BCA5FBC-0EDB-49C8-85CF-35268BB7C39D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F7CD3B62-48BE-4E0A-8B88-CAAE1243DB40 on shell_id 9BCA5FBC-0EDB-49C8-85CF-35268BB7C39D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352acab10 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1gcf7wf.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bff198 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bfd398 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b08dc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "c7314f1931cc68e64e30c31ffa092d2063d36af1" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-1gcf7wf.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: FC925D7C-B88D-455D-A8F1-A289D306B974
DEBUG winrmshell: [WinRM] creating command_id: FC925D7C-B88D-455D-A8F1-A289D306B974 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: FC925D7C-B88D-455D-A8F1-A289D306B974 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","c7314f1931cc68e64e30c31ffa092d2063d36af1","2ccc385c1b1113d499646914f2abe476d7a690be","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1gcf7wf.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 678A97A8-DAB6-4932-AEA0-040A32A009E8
DEBUG winrmshell: [WinRM] creating command_id: 678A97A8-DAB6-4932-AEA0-040A32A009E8 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 678A97A8-DAB6-4932-AEA0-040A32A009E8 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBNaW1pa2F0eiBhbmQgUG93ZXJzcGxvaXQgaW50byBjOlxUb29sc1xNaW1pa2F0ei4gVXNlZCB0byBpbnN0YWxsIHJlZHRlYW0gcmVsYXRlZCB0b29saW5nLgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgUmVkIFRlYW0gVG9vbGluZy4uLiIKJGhvc3RuYW1lID0gJChob3N0bmFtZSkKCiMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzI3CltOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSBbTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTIKCiMgV2luZG93cyBEZWZlbmRlciBzaG91bGQgYmUgZGlzYWJsZWQgYWxyZWFkeSBieSBPJk8gU2h1dFVwMTAgYW5kIHRoZSBHUE8KSWYgKCRob3N0bmFtZSAtZXEgIndpbjEwIiAtQW5kIChHZXQtU2VydmljZSAtTmFtZSBXaW5EZWZlbmQpLlN0YXJ0VHlwZSAtbmUgJ0Rpc2FibGVkJyApIHsKICAjIEFkZGluZyBEZWZlbmRlciBleGNsdXNpb25zIGp1c3QgaW4gY2FzZQogIFNldC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblBhdGggIkM6XFRvb2xzIgogIEFkZC1NcFByZWZlcmVuY2UgLUV4Y2x1c2lvblBhdGggIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wIgoKICAuIGM6XHZhZ3JhbnRcc2NyaXB0c1xJbnZva2UtQ29tbWFuZEFzLnBzMQogIEludm9rZS1Db21tYW5kQXMgJ05UIFNFUlZJQ0VcVHJ1c3RlZEluc3RhbGxlcicgewogICAgU2V0LVNlcnZpY2UgV2luRGVmZW5kIC1TdGFydHVwVHlwZSBEaXNhYmxlZAogICAgU3RvcC1TZXJ2aWNlIFdpbkRlZmVuZAogIH0KfQoKIyBXaW5kb3dzIERlZmVuZGVyIHNob3VsZCBiZSBkaXNhYmxlZCBieSB0aGUgR1BPIG9yIHVuaW5zdGFsbGVkIGFscmVhZHksIGJ1dCB3ZSdsbCBrZWVwIHRoaXMganVzdCBpbiBjYXNlCklmICgkaG9zdG5hbWUgLW5lICJ3aW4xMCIgLUFuZCAoR2V0LVNlcnZpY2UgLU5hbWUgV2luRGVmZW5kIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlKS5zdGF0dXMgLWVxICdSdW5uaW5nJykgewogICMgVW5pbnN0YWxsaW5nIFdpbmRvd3MgRGVmZW5kZXIgKGh0dHBzOi8vZ2l0aHViLmNvbS9TdGVmYW5TY2hlcmVyL3BhY2tlci13aW5kb3dzL2lzc3Vlcy8yMDEpCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgVW5pbnN0YWxsaW5nIFdpbmRvd3MgRGVmZW5kZXIuLi4iCiAgVHJ5IHsKICAgIFVuaW5zdGFsbC1XaW5kb3dzRmVhdHVyZSBXaW5kb3dzLURlZmVuZGVyIC1FcnJvckFjdGlvbiBTdG9wCiAgICBVbmluc3RhbGwtV2luZG93c0ZlYXR1cmUgV2luZG93cy1EZWZlbmRlci1GZWF0dXJlcyAtRXJyb3JBY3Rpb24gU3RvcAogIH0gQ2F0Y2ggewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdpbmRvd3MgRGVmZW5kZXIgZGlkIG5vdCB1bmluc3RhbGwgc3VjY2Vzc2Z1bGx5Li4uIgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFdlJ2xsIHRyeSBhZ2FpbiBkdXJpbmcgaW5zdGFsbC1yZWQtdGVhbS5wczEiCiAgfQp9IEVsc2UgIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV2luZG93cyBEZWZlbmRlciBoYXMgYWxyZWFkeSBiZWVuIGRpc2FibGVkIG9yIHVuaW5zdGFsbGVkLiIKfQoKIyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIHVuemlwcyBhIGNvcHkgb2YgdGhlIGxhdGVzdCBNaW1pa2F0eiB0cnVuawpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRGV0ZXJtaW5pbmcgbGF0ZXN0IHJlbGVhc2Ugb2YgTWltaWthdHouLi4iCiR0YWcgPSAoSW52b2tlLVdlYlJlcXVlc3QgImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvZ2VudGlsa2l3aS9taW1pa2F0ei9yZWxlYXNlcyIgLVVzZUJhc2ljUGFyc2luZyB8IENvbnZlcnRGcm9tLUpzb24pWzBdLnRhZ19uYW1lCiRtaW1pa2F0ekRvd25sb2FkVXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbS9nZW50aWxraXdpL21pbWlrYXR6L3JlbGVhc2VzL2Rvd25sb2FkLyR0YWcvbWltaWthdHpfdHJ1bmsuemlwIgokbWltaWthdHpSZXBvUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFxtaW1pa2F0el90cnVuay56aXAnCklmICgtbm90IChUZXN0LVBhdGggJG1pbWlrYXR6UmVwb1BhdGgpKSB7CiAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJG1pbWlrYXR6RG93bmxvYWRVcmwiIC1PdXRGaWxlICRtaW1pa2F0elJlcG9QYXRoCiAgRXhwYW5kLUFyY2hpdmUgLXBhdGggIiRtaW1pa2F0elJlcG9QYXRoIiAtZGVzdGluYXRpb25wYXRoICdjOlxUb29sc1xNaW1pa2F0eicgLUZvcmNlCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIE1pbWlrYXR6IHdhcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQoKIyBEb3dubG9hZCBhbmQgdW56aXAgYSBjb3B5IG9mIFBvd2VyU3Bsb2l0CldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBQb3dlcnNwbG9pdC4uLiIKJHBvd2Vyc3Bsb2l0RG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGxNYWZpYS9Qb3dlclNwbG9pdC9hcmNoaXZlL2Rldi56aXAiCiRwb3dlcnNwbG9pdFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHBvd2Vyc3Bsb2l0LnppcCIKSWYgKC1ub3QgKFRlc3QtUGF0aCAkcG93ZXJzcGxvaXRSZXBvUGF0aCkpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkcG93ZXJzcGxvaXREb3dubG9hZFVybCIgLU91dEZpbGUgJHBvd2Vyc3Bsb2l0UmVwb1BhdGgKICBFeHBhbmQtQXJjaGl2ZSAtcGF0aCAiJHBvd2Vyc3Bsb2l0UmVwb1BhdGgiIC1kZXN0aW5hdGlvbnBhdGggJ2M6XFRvb2xzXFBvd2VyU3Bsb2l0JyAtRm9yY2UKICBDb3B5LUl0ZW0gImM6XFRvb2xzXFBvd2VyU3Bsb2l0XFBvd2VyU3Bsb2l0LWRldlwqIiAiJEVudjp3aW5kaXJcU3lzdGVtMzJcV2luZG93c1Bvd2VyU2hlbGxcdjEuMFxNb2R1bGVzIiAtUmVjdXJzZSAtRm9yY2UKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgUG93ZXJTcGxvaXQgd2FzIGFscmVhZHkgaW5zdGFsbGVkLiBNb3ZpbmcgT24uIgp9CgojIERvd25sb2FkIGFuZCB1bnppcCBhIGNvcHkgb2YgQmFkQmxvb2QKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIEJhZEJsb29kLi4uIgokYmFkYmxvb2REb3dubG9hZFVybCA9ICJodHRwczovL2dpdGh1Yi5jb20vZGF2aWRwcm93ZS9CYWRCbG9vZC9hcmNoaXZlL21hc3Rlci56aXAiCiRiYWRibG9vZFJlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXGJhZGJsb29kLnppcCIKSWYgKC1ub3QgKFRlc3QtUGF0aCAkYmFkYmxvb2RSZXBvUGF0aCkpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICIkYmFkYmxvb2REb3dubG9hZFVybCIgLU91dEZpbGUgIiRiYWRibG9vZFJlcG9QYXRoIgogIEV4cGFuZC1BcmNoaXZlIC1wYXRoICIkYmFkYmxvb2RSZXBvUGF0aCIgLWRlc3RpbmF0aW9ucGF0aCAnYzpcVG9vbHNcQmFkQmxvb2QnIC1Gb3JjZQogICMgTG93ZXIgdGhlIG51bWJlciBvZiBkZWZhdWx0IHVzZXJzIHRvIGJlIGNyZWF0ZWQgYnkgQmFkQmxvb2QKICAkaW52b2tlQmFkQmxvb2RQYXRoID0gImM6XFRvb2xzXEJhZEJsb29kXEJhZEJsb29kLW1hc3RlclxJbnZva2UtQmFkQmxvb2QucHMxIgogICgoR2V0LUNvbnRlbnQgLXBhdGggJGludm9rZUJhZEJsb29kUGF0aCAtUmF3KSAtcmVwbGFjZSAnMTAwMC4uNTAwMCcsJzUwMC4uMTUwMCcpIHwgU2V0LUNvbnRlbnQgLVBhdGggJGludm9rZUJhZEJsb29kUGF0aAp9IEVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBCYWRCbG9vZCB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgRG93bmxvYWQgYW5kIGluc3RhbGwgSW52b2tlLUF0b21pY1JlZFRlYW0KV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIEludm9rZS1BdG9taWNSZWRUZWFtIGFuZCBhdG9taWMgdGVzdHMuLi4iCklmICgtbm90IChUZXN0LVBhdGggIkM6XFRvb2xzXEF0b21pY1JlZFRlYW0iKSkgewogIEluc3RhbGwtUGFja2FnZVByb3ZpZGVyIC1OYW1lIE51R2V0IC1Gb3JjZQogIEluc3RhbGwtTW9kdWxlIC1OYW1lIHBvd2Vyc2hlbGwteWFtbCAtRm9yY2UKICBJRVggKElXUiAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZGNhbmFyeWNvL2ludm9rZS1hdG9taWNyZWR0ZWFtL21hc3Rlci9pbnN0YWxsLWF0b21pY3JlZHRlYW0ucHMxJyAtVXNlQmFzaWNQYXJzaW5nKTsKICBJbnN0YWxsLUF0b21pY1JlZFRlYW0gLWdldEF0b21pY3MgLUluc3RhbGxQYXRoICJjOlxUb29sc1xBdG9taWNSZWRUZWFtIgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBVcGRhdGluZyBQcm9maWxlLnBzMSB0byBpbXBvcnQgdGhlIEludm9rZS1BdG9taWNSZWRUZWFtIG1vZHVsZS4uLiIKICBBZGQtQ29udGVudCAtUGF0aCBDOlxXaW5kb3dzXFN5c3RlbTMyXFdpbmRvd3NQb3dlclNoZWxsXHYxLjBcUHJvZmlsZS5wczEgJ0ltcG9ydC1Nb2R1bGUgIkM6XFRvb2xzXEF0b21pY1JlZFRlYW1caW52b2tlLWF0b21pY3JlZHRlYW1cSW52b2tlLUF0b21pY1JlZFRlYW0ucHNkMSIgLUZvcmNlCiRQU0RlZmF1bHRQYXJhbWV0ZXJWYWx1ZXMgPSBAeyJJbnZva2UtQXRvbWljVGVzdDpQYXRoVG9BdG9taWNzRm9sZGVyIj0iQzpcVG9vbHNcQXRvbWljUmVkVGVhbVxhdG9taWNzIn0nIC1Gb3JjZQp9IEVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnZva2UtQXRvbWljUmVkVGVhbSB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KCiMgUHVycG9zZTogRG93bmxvYWRzIHRoZSBsYXRlc3QgcmVsZWFzZSBvZiBQdXJwbGVTaGFycE5ld3RvbnNvZnQuSnNvbi5kbGwKSWYgKC1ub3QgKFRlc3QtUGF0aCAiYzpcVG9vbHNcUHVycGxlU2hhcnAiKSkgewogIE5ldy1JdGVtIC1QYXRoICJjOlxUb29sc1wiIC1OYW1lICJQdXJwbGVTaGFycCIgLUl0ZW1UeXBlICJkaXJlY3RvcnkiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFB1cnBsZVNoYXJwIGZvbGRlciBhbHJlYWR5IGV4aXN0cy4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERldGVybWluaW5nIGxhdGVzdCByZWxlYXNlIG9mIFB1cnBsZXNoYXJwLi4uIgokdGFnID0gKEludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL212ZWxhemMwL1B1cnBsZVNoYXJwL3JlbGVhc2VzIiAtVXNlQmFzaWNQYXJzaW5nIHwgQ29udmVydEZyb20tSnNvbilbMF0udGFnX25hbWUKJHB1cnBsZXNoYXJwRG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL212ZWxhemMwL1B1cnBsZVNoYXJwL3JlbGVhc2VzL2Rvd25sb2FkLyR0YWcvUHVycGxlU2hhcnBfeDY0LmV4ZSIKSWYgKC1ub3QgKFRlc3QtUGF0aCAiYzpcVG9vbHNcUHVycGxlU2hhcnBcUHVycGxlU2hhcnAuZXhlIikpIHsKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICRwdXJwbGVzaGFycERvd25sb2FkVXJsIC1PdXRGaWxlICJjOlxUb29sc1xQdXJwbGVTaGFycFxQdXJwbGVTaGFycC5leGUiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFB1cnBsZVNoYXJwIHdhcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFJlZCBUZWFtIHRvb2xpbmcgaW5zdGFsbGF0aW9uIGNvbXBsZXRlISIK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2A982C57-C850-49A8-83FE-0759C91576E8
DEBUG winrmshell: [WinRM] creating command_id: 2A982C57-C850-49A8-83FE-0759C91576E8 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2A982C57-C850-49A8-83FE-0759C91576E8 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 817B98D3-B213-4D3E-B60E-3A5AA115D800
DEBUG winrmshell: [WinRM] creating command_id: 817B98D3-B213-4D3E-B60E-3A5AA115D800 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 817B98D3-B213-4D3E-B60E-3A5AA115D800 on shell_id 482656BD-542F-4789-9E6B-209CD56F7D60
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1gcf7wf.ps1 to C:/tmp/vagrant-shell.ps1 (8.2 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m2.01s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-redteam.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352db73a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352db6478 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c55390 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: AAA96BC2-34E5-4D4B-9C77-9EC22396D930
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 61399453-EFFF-4467-A042-5B548C017B8D
DEBUG winrmshell: [WinRM] creating command_id: 61399453-EFFF-4467-A042-5B548C017B8D on shell_id AAA96BC2-34E5-4D4B-9C77-9EC22396D930
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:54] Installing Red Team Tooling...
 INFO interface: detail:     wef: [02:54] Installing Red Team Tooling...
    wef: [02:54] Installing Red Team Tooling...
 INFO interface: detail: [02:54] Windows Defender has already been disabled or uninstalled.
 INFO interface: detail:     wef: [02:54] Windows Defender has already been disabled or uninstalled.
    wef: [02:54] Windows Defender has already been disabled or uninstalled.
 INFO interface: detail: [02:54] Determining latest release of Mimikatz...
 INFO interface: detail:     wef: [02:54] Determining latest release of Mimikatz...
    wef: [02:54] Determining latest release of Mimikatz...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:54] Downloading Powersploit...
 INFO interface: detail:     wef: [02:54] Downloading Powersploit...
    wef: [02:54] Downloading Powersploit...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:54] Downloading BadBlood...
 INFO interface: detail:     wef: [02:54] Downloading BadBlood...
    wef: [02:54] Downloading BadBlood...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:54] Downloading Invoke-AtomicRedTeam and atomic tests...
 INFO interface: detail:     wef: [02:54] Downloading Invoke-AtomicRedTeam and atomic tests...
    wef: [02:54] Downloading Invoke-AtomicRedTeam and atomic tests...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Name                           Version          Source           Summary
 INFO interface: detail:     wef: Name                           Version          Source           Summary
    wef: Name                           Version          Source           Summary
 INFO interface: detail: ----                           -------          ------           -------
 INFO interface: detail:     wef: ----                           -------          ------           -------
    wef: ----                           -------          ------           -------
 INFO interface: detail: nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...
 INFO interface: detail:     wef: nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...
    wef: nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function
 INFO interface: detail:     wef: Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function
    wef: Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function
 INFO interface: detail: See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details
 INFO interface: detail:     wef: See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details
    wef: See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details
 INFO interface: detail: [02:54] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...
 INFO interface: detail:     wef: [02:54] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...
    wef: [02:54] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Tools\PurpleSharp
 INFO interface: detail:     wef: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Tools\PurpleSharp
    wef: PSPath            : Microsoft.PowerShell.Core\FileSystem::C:\Tools\PurpleSharp
 INFO interface: detail: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Tools
 INFO interface: detail:     wef: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Tools
    wef: PSParentPath      : Microsoft.PowerShell.Core\FileSystem::C:\Tools
 INFO interface: detail: PSChildName       : PurpleSharp
 INFO interface: detail:     wef: PSChildName       : PurpleSharp
    wef: PSChildName       : PurpleSharp
 INFO interface: detail: PSDrive           : C
 INFO interface: detail:     wef: PSDrive           : C
    wef: PSDrive           : C
 INFO interface: detail: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail:     wef: PSProvider        : Microsoft.PowerShell.Core\FileSystem
    wef: PSProvider        : Microsoft.PowerShell.Core\FileSystem
 INFO interface: detail: PSIsContainer     : True
 INFO interface: detail:     wef: PSIsContainer     : True
    wef: PSIsContainer     : True
 INFO interface: detail: Name              : PurpleSharp
 INFO interface: detail:     wef: Name              : PurpleSharp
    wef: Name              : PurpleSharp
 INFO interface: detail: FullName          : C:\Tools\PurpleSharp
 INFO interface: detail:     wef: FullName          : C:\Tools\PurpleSharp
    wef: FullName          : C:\Tools\PurpleSharp
 INFO interface: detail: Parent            : Tools
 INFO interface: detail:     wef: Parent            : Tools
    wef: Parent            : Tools
 INFO interface: detail: Exists            : True
 INFO interface: detail:     wef: Exists            : True
    wef: Exists            : True
 INFO interface: detail: Root              : C:\
 INFO interface: detail:     wef: Root              : C:\
    wef: Root              : C:\
 INFO interface: detail: Extension         :
 INFO interface: detail:     wef: Extension         :
    wef: Extension         :
 INFO interface: detail: CreationTime      : 6/21/2022 2:54:50 AM
 INFO interface: detail:     wef: CreationTime      : 6/21/2022 2:54:50 AM
    wef: CreationTime      : 6/21/2022 2:54:50 AM
 INFO interface: detail: CreationTimeUtc   : 6/21/2022 2:54:50 AM
 INFO interface: detail:     wef: CreationTimeUtc   : 6/21/2022 2:54:50 AM
    wef: CreationTimeUtc   : 6/21/2022 2:54:50 AM
 INFO interface: detail: LastAccessTime    : 6/21/2022 2:54:50 AM
 INFO interface: detail:     wef: LastAccessTime    : 6/21/2022 2:54:50 AM
    wef: LastAccessTime    : 6/21/2022 2:54:50 AM
 INFO interface: detail: LastAccessTimeUtc : 6/21/2022 2:54:50 AM
 INFO interface: detail:     wef: LastAccessTimeUtc : 6/21/2022 2:54:50 AM
    wef: LastAccessTimeUtc : 6/21/2022 2:54:50 AM
 INFO interface: detail: LastWriteTime     : 6/21/2022 2:54:50 AM
 INFO interface: detail:     wef: LastWriteTime     : 6/21/2022 2:54:50 AM
    wef: LastWriteTime     : 6/21/2022 2:54:50 AM
 INFO interface: detail: LastWriteTimeUtc  : 6/21/2022 2:54:50 AM
 INFO interface: detail:     wef: LastWriteTimeUtc  : 6/21/2022 2:54:50 AM
    wef: LastWriteTimeUtc  : 6/21/2022 2:54:50 AM
 INFO interface: detail: Attributes        : Directory
 INFO interface: detail:     wef: Attributes        : Directory
    wef: Attributes        : Directory
 INFO interface: detail: Mode              : d-----
 INFO interface: detail:     wef: Mode              : d-----
    wef: Mode              : d-----
 INFO interface: detail: BaseName          : PurpleSharp
 INFO interface: detail:     wef: BaseName          : PurpleSharp
    wef: BaseName          : PurpleSharp
 INFO interface: detail: Target            : {}
 INFO interface: detail:     wef: Target            : {}
    wef: Target            : {}
 INFO interface: detail: LinkType          :
 INFO interface: detail:     wef: LinkType          :
    wef: LinkType          :
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [02:54] Determining latest release of Purplesharp...
 INFO interface: detail:     wef: [02:54] Determining latest release of Purplesharp...
    wef: [02:54] Determining latest release of Purplesharp...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:54] Red Team tooling installation complete!
 INFO interface: detail:     wef: [02:54] Red Team tooling installation complete!
    wef: [02:54] Red Team tooling installation complete!
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 61399453-EFFF-4467-A042-5B548C017B8D on shell_id AAA96BC2-34E5-4D4B-9C77-9EC22396D930
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b3f528 @data=[{:stdout=>"[02:54] Installing Red Team Tooling...\r\n"}, {:stdout=>"[02:54] Windows Defender has already been disabled or uninstalled.\r\n"}, {:stdout=>"[02:54] Determining latest release of Mimikatz...\r\n"}, {:stdout=>"[02:54] Downloading Powersploit...\r\n"}, {:stdout=>"[02:54] Downloading BadBlood...\r\n"}, {:stdout=>"[02:54] Downloading Invoke-AtomicRedTeam and atomic tests...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Name                           Version          Source           Summary                          \r\n"}, {:stdout=>"----                           -------          ------           -------                          \r\n"}, {:stdout=>"nuget                          2.8.5.208        https://onege... NuGet provider for the OneGet ...\r\n"}, {:stdout=>"Installation of Invoke-AtomicRedTeam is complete. You can now use the Invoke-AtomicTest function\r\n"}, {:stdout=>"See Wiki at https://github.com/redcanaryco/invoke-atomicredteam/wiki for complete details\r\n"}, {:stdout=>"[02:54] Updating Profile.ps1 to import the Invoke-AtomicRedTeam module...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"PSPath            : Microsoft.PowerShell.Core\\FileSystem::C:\\Tools\\PurpleSharp\r\n"}, {:stdout=>"PSParentPath      : Microsoft.PowerShell.Core\\FileSystem::C:\\Tools\r\n"}, {:stdout=>"PSChildName       : PurpleSharp\r\n"}, {:stdout=>"PSDrive           : C\r\n"}, {:stdout=>"PSProvider        : Microsoft.PowerShell.Core\\FileSystem\r\n"}, {:stdout=>"PSIsContainer     : True\r\n"}, {:stdout=>"Name              : PurpleSharp\r\n"}, {:stdout=>"FullName          : C:\\Tools\\PurpleSharp\r\n"}, {:stdout=>"Parent            : Tools\r\n"}, {:stdout=>"Exists            : True\r\n"}, {:stdout=>"Root              : C:\\\r\n"}, {:stdout=>"Extension         : \r\n"}, {:stdout=>"CreationTime      : 6/21/2022 2:54:50 AM\r\n"}, {:stdout=>"CreationTimeUtc   : 6/21/2022 2:54:50 AM\r\n"}, {:stdout=>"LastAccessTime    : 6/21/2022 2:54:50 AM\r\n"}, {:stdout=>"LastAccessTimeUtc : 6/21/2022 2:54:50 AM\r\n"}, {:stdout=>"LastWriteTime     : 6/21/2022 2:54:50 AM\r\n"}, {:stdout=>"LastWriteTimeUtc  : 6/21/2022 2:54:50 AM\r\n"}, {:stdout=>"Attributes        : Directory\r\n"}, {:stdout=>"Mode              : d-----\r\n"}, {:stdout=>"BaseName          : PurpleSharp\r\n"}, {:stdout=>"Target            : {}\r\n"}, {:stdout=>"LinkType          : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[02:54] Determining latest release of Purplesharp...\r\n"}, {:stdout=>"[02:54] Red Team tooling installation complete!\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x00000243523297f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x00000243506e4cc8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2209, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4DCBC07F-7833-4E1E-AB10-36477A44C38C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 054EA59B-AC84-4677-A7FB-2A0156EF68DC
DEBUG winrmshell: [WinRM] creating command_id: 054EA59B-AC84-4677-A7FB-2A0156EF68DC on shell_id 4DCBC07F-7833-4E1E-AB10-36477A44C38C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 054EA59B-AC84-4677-A7FB-2A0156EF68DC on shell_id 4DCBC07F-7833-4E1E-AB10-36477A44C38C
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c8c570 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2211, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B2481318-89F9-4DDB-AA47-D17292EA770C
DEBUG winrmshell: [WinRM] Command created for hostname with id: 65AD8ABD-7625-4283-9B3E-ED74098031C1
DEBUG winrmshell: [WinRM] creating command_id: 65AD8ABD-7625-4283-9B3E-ED74098031C1 on shell_id B2481318-89F9-4DDB-AA47-D17292EA770C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 65AD8ABD-7625-4283-9B3E-ED74098031C1 on shell_id B2481318-89F9-4DDB-AA47-D17292EA770C
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435311cba8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5986=>2205, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B91352D2-1329-4CCC-B5C6-815A94840A10
DEBUG winrmshell: [WinRM] Command created for hostname with id: BDF91C48-A61F-4316-80ED-E1A03D446EAE
DEBUG winrmshell: [WinRM] creating command_id: BDF91C48-A61F-4316-80ED-E1A03D446EAE on shell_id B91352D2-1329-4CCC-B5C6-815A94840A10
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BDF91C48-A61F-4316-80ED-E1A03D446EAE on shell_id B91352D2-1329-4CCC-B5C6-815A94840A10
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435239a660 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352aa2228 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352aa10f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243529bb5f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BD4FFD57-518D-47C1-90B4-2AE92DB9EAEC
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6402744B-7FF2-4DB9-8B67-8E2D2F0EAB4E
DEBUG winrmshell: [WinRM] creating command_id: 6402744B-7FF2-4DB9-8B67-8E2D2F0EAB4E on shell_id BD4FFD57-518D-47C1-90B4-2AE92DB9EAEC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6402744B-7FF2-4DB9-8B67-8E2D2F0EAB4E on shell_id BD4FFD57-518D-47C1-90B4-2AE92DB9EAEC
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243523a9778 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352aa8510 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352aa3560 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243529c1750 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5911326D-9627-488B-8F99-DB68568EC98E
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 16F87474-3975-49A2-9696-639197896526
DEBUG winrmshell: [WinRM] creating command_id: 16F87474-3975-49A2-9696-639197896526 on shell_id 5911326D-9627-488B-8F99-DB68568EC98E
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 16F87474-3975-49A2-9696-639197896526 on shell_id 5911326D-9627-488B-8F99-DB68568EC98E
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243523b3c00 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-svz1r5.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a029a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a00220 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352497540 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "4945b697ffcf10a321d7981a944a532132e5bc8f" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-svz1r5.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0520050F-A207-4653-B47B-EFFB08672238
DEBUG winrmshell: [WinRM] creating command_id: 0520050F-A207-4653-B47B-EFFB08672238 on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0520050F-A207-4653-B47B-EFFB08672238 on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","4945b697ffcf10a321d7981a944a532132e5bc8f","c7314f1931cc68e64e30c31ffa092d2063d36af1","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-svz1r5.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D7D98FEB-443A-4A89-B595-CB5DFC75F4CC
DEBUG winrmshell: [WinRM] creating command_id: D7D98FEB-443A-4A89-B595-CB5DFC75F4CC on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D7D98FEB-443A-4A89-B595-CB5DFC75F4CC on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBEb3dubG9hZHMgYW5kIGluZGV4ZXMgdGhlIEVWVFggc2FtcGxlcyBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9zYm91c3NlYWRlbi9FVlRYLUFUVEFDSy1TQU1QTEVTLyBpbnRvIFNwbHVuawoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluZGV4aW5nIEVWVFggQXR0YWNrIFNhbXBsZXMgaW50byBTcGx1bmsuLi4iCgojIERpc2FibGluZyB0aGUgcHJvZ3Jlc3MgYmFyIHNwZWVkcyB1cCBJV1IgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOAokUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnCiMgR2l0SHViIHJlcXVpcmVzIFRMUyAxLjIgYXMgb2YgMi8yNwpbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCgokaW5wdXRzQ29uZiA9ICJDOlxQcm9ncmFtIEZpbGVzXFNwbHVua1VuaXZlcnNhbEZvcndhcmRlclxldGNcYXBwc1xTcGx1bmtfVEFfd2luZG93c1xsb2NhbFxpbnB1dHMuY29uZiIKCiMgRG93bmxvYWQgYW5kIHVuemlwIGEgY29weSBvZiBFVlRYIEF0dGFjayBTYW1wbGVzCiRldnR4QXR0YWNrRG93bmxvYWRVcmwgPSAiaHR0cHM6Ly9naXRodWIuY29tL3Nib3Vzc2VhZGVuL0VWVFgtQVRUQUNLLVNBTVBMRVMvYXJjaGl2ZS9tYXN0ZXIuemlwIgokZXZ0eEF0dGFja1JlcG9QYXRoID0gIkM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXGV2dHhhdHRhY2suemlwIgpJZiAoLW5vdCAoVGVzdC1QYXRoICJDOlxUb29sc1xFVlRYLUFUVEFDSy1TQU1QTEVTXEVWVFgtQVRUQUNLLVNBTVBMRVMtbWFzdGVyIikpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBFVlRYIEF0dGFjayBTYW1wbGVzIgogICAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJGV2dHhBdHRhY2tEb3dubG9hZFVybCIgLU91dEZpbGUgIiRldnR4QXR0YWNrUmVwb1BhdGgiCiAgICBFeHBhbmQtQXJjaGl2ZSAtcGF0aCAiJGV2dHhBdHRhY2tSZXBvUGF0aCIgLWRlc3RpbmF0aW9ucGF0aCAnYzpcVG9vbHNcRVZUWC1BVFRBQ0stU0FNUExFUycgLUZvcmNlCiAgICAjIEFkZCBzdGFuemFzIHRvIFNwbHVuayBpbnB1dHMuY29uZiB0byBpbmRleCB0aGUgZXZ0eCBmaWxlcwogICAgIyBIdWdlIHRoYW5rcyB0byBodHRwczovL3d3dy5jbG91ZC1yZXNwb25zZS5jb20vMjAxOS8wNy9pbXBvcnRpbmctd2luZG93cy1ldmVudC1sb2ctZmlsZXMtaW50by5odG1sIGZvciBzaG93aW5nIGhvdyB0byBkbyB0aGlzIQogICAgSWYgKCEoU2VsZWN0LVN0cmluZyAtUGF0aCAkaW5wdXRzQ29uZiAtUGF0dGVybiAiZXZ0eF9hdHRhY2tfc2FtcGxlIikpIHsKICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3BsdW5rIGlucHV0cy5jb25mIGhhcyBub3QgeWV0IGJlZW4gbW9kaWZpZWQuIEFkZGluZyBzdGFuemFzIGZvciB0aGVzZSBldnR4IGZpbGVzIG5vdy4uLiIKICAgICAgICBBZGQtQ29udGVudCAtUGF0aCAiJGlucHV0c0NvbmYiIC1WYWx1ZSAnClttb25pdG9yOi8vYzpcVG9vbHNcRVZUWC1BVFRBQ0stU0FNUExFU1xFVlRYLUFUVEFDSy1TQU1QTEVTLW1hc3RlclxBdXRvbWF0ZWRUZXN0aW5nVG9vbHNcKi5ldnR4XQppbmRleCA9IGV2dHhfYXR0YWNrX3NhbXBsZXMKc291cmNldHlwZSA9IHByZXByb2Nlc3Mtd2luZXZ0CgpbbW9uaXRvcjovL2M6XFRvb2xzXEVWVFgtQVRUQUNLLVNBTVBMRVNcRVZUWC1BVFRBQ0stU0FNUExFUy1tYXN0ZXJcQ29tbWFuZCBhbmQgQ29udHJvbFwqLmV2dHhdCmluZGV4ID0gZXZ0eF9hdHRhY2tfc2FtcGxlcwpzb3VyY2V0eXBlID0gcHJlcHJvY2Vzcy13aW5ldnQKClttb25pdG9yOi8vYzpcVG9vbHNcRVZUWC1BVFRBQ0stU0FNUExFU1xFVlRYLUFUVEFDSy1TQU1QTEVTLW1hc3RlclxDcmVkZW50aWFsIEFjY2Vzc1wqLmV2dHhdCmluZGV4ID0gZXZ0eF9hdHRhY2tfc2FtcGxlcwpzb3VyY2V0eXBlID0gcHJlcHJvY2Vzcy13aW5ldnQKClttb25pdG9yOi8vYzpcVG9vbHNcRVZUWC1BVFRBQ0stU0FNUExFU1xFVlRYLUFUVEFDSy1TQU1QTEVTLW1hc3RlclxEZWZlbnNlIEV2YXNpb25cKi5ldnR4XQppbmRleCA9IGV2dHhfYXR0YWNrX3NhbXBsZXMKc291cmNldHlwZSA9IHByZXByb2Nlc3Mtd2luZXZ0CgpbbW9uaXRvcjovL2M6XFRvb2xzXEVWVFgtQVRUQUNLLVNBTVBMRVNcRVZUWC1BVFRBQ0stU0FNUExFUy1tYXN0ZXJcRGlzY292ZXJ5XCouZXZ0eF0KaW5kZXggPSBldnR4X2F0dGFja19zYW1wbGVzCnNvdXJjZXR5cGUgPSBwcmVwcm9jZXNzLXdpbmV2dAoKW21vbml0b3I6Ly9jOlxUb29sc1xFVlRYLUFUVEFDSy1TQU1QTEVTXEVWVFgtQVRUQUNLLVNBTVBMRVMtbWFzdGVyXEV4ZWN1dGlvblwqLmV2dHhdCmluZGV4ID0gZXZ0eF9hdHRhY2tfc2FtcGxlcwpzb3VyY2V0eXBlID0gcHJlcHJvY2Vzcy13aW5ldnQKClttb25pdG9yOi8vYzpcVG9vbHNcRVZUWC1BVFRBQ0stU0FNUExFU1xFVlRYLUFUVEFDSy1TQU1QTEVTLW1hc3RlclxMYXRlcmFsIE1vdmVtZW50XCouZXZ0eF0KaW5kZXggPSBldnR4X2F0dGFja19zYW1wbGVzCnNvdXJjZXR5cGUgPSBwcmVwcm9jZXNzLXdpbmV2dAoKW21vbml0b3I6Ly9jOlxUb29sc1xFVlRYLUFUVEFDSy1TQU1QTEVTXEVWVFgtQVRUQUNLLVNBTVBMRVMtbWFzdGVyXE90aGVyXCouZXZ0eF0KaW5kZXggPSBldnR4X2F0dGFja19zYW1wbGVzCnNvdXJjZXR5cGUgPSBwcmVwcm9jZXNzLXdpbmV2dAoKW21vbml0b3I6Ly9jOlxUb29sc1xFVlRYLUFUVEFDSy1TQU1QTEVTXEVWVFgtQVRUQUNLLVNBTVBMRVMtbWFzdGVyXFBlcnNpc3RlbmNlXCouZXZ0eF0KaW5kZXggPSBldnR4X2F0dGFja19zYW1wbGVzCnNvdXJjZXR5cGUgPSBwcmVwcm9jZXNzLXdpbmV2dAoKW21vbml0b3I6Ly9jOlxUb29sc1xFVlRYLUFUVEFDSy1TQU1QTEVTXEVWVFgtQVRUQUNLLVNBTVBMRVMtbWFzdGVyXFByaXZpbGVnZSBFc2NhbGF0aW9uXCouZXZ0eF0KaW5kZXggPSBldnR4X2F0dGFja19zYW1wbGVzCnNvdXJjZXR5cGUgPSBwcmVwcm9jZXNzLXdpbmV2dCcKICAgICAgICAjIFJlc3RhcnQgdGhlIGZvcndhcmRlciB0byBwaWNrIHVwIGNoYW5nZXMKICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgUmVzdGFydGluZyB0aGUgU3BsdW5rIEZvcndhcmRlci4uLiIKICAgICAgICBUcnkgeyAKICAgICAgICAgIFJlc3RhcnQtU2VydmljZSAtTmFtZSBTcGx1bmtGb3J3YXJkZXIgLUZvcmNlIC1FcnJvckFjdGlvbiBTdG9wIAogICAgICAgIH0gQ2F0Y2ggewogICAgICAgICAgU3RhcnQtU2xlZXAgMTAKICAgICAgICAgIFN0b3AtU2VydmljZSAtTmFtZSBTcGx1bmtGb3J3YXJkZXIgLUZvcmNlCiAgICAgICAgICBTdGFydC1TZXJ2aWNlIC1OYW1lIFNwbHVua0ZvcndhcmRlcgogICAgICAgIH0KICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG9uZSEgTG9vayBpbiAnaW5kZXg9RVZUWC1BVFRBQ0stU0FNUExFUycgaW4gU3BsdW5rIHRvIHF1ZXJ5IHRoZXNlIHNhbXBsZXMuIgogICAgfQp9IEVsc2UgewogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEVWVFggYXR0YWNrIHNhbXBsZXMgd2VyZSBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 55A286BD-B2A0-43E2-AD93-F952DA912BEB
DEBUG winrmshell: [WinRM] creating command_id: 55A286BD-B2A0-43E2-AD93-F952DA912BEB on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 55A286BD-B2A0-43E2-AD93-F952DA912BEB on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2D0E511A-ECE2-4565-A4ED-0F986ED9D5B8
DEBUG winrmshell: [WinRM] creating command_id: 2D0E511A-ECE2-4565-A4ED-0F986ED9D5B8 on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2D0E511A-ECE2-4565-A4ED-0F986ED9D5B8 on shell_id E71FC71D-5744-499D-9934-1FF049B56D2F
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-svz1r5.ps1 to C:/tmp/vagrant-shell.ps1 (4.968 KB over 1 chunks) in (0m0.20s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.53s) stream_files: (0m0.20s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-evtx-attack-samples.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-evtx-attack-samples.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-evtx-attack-samples.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352acbdf8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352acae80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a09b68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5031E728-AC17-4A46-A711-AE08A8CAA81C
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 05CDB02F-278A-45D2-A4FD-A2EFA5E80BE9
DEBUG winrmshell: [WinRM] creating command_id: 05CDB02F-278A-45D2-A4FD-A2EFA5E80BE9 on shell_id 5031E728-AC17-4A46-A711-AE08A8CAA81C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:54] Indexing EVTX Attack Samples into Splunk...
 INFO interface: detail:     wef: [02:54] Indexing EVTX Attack Samples into Splunk...
    wef: [02:54] Indexing EVTX Attack Samples into Splunk...
 INFO interface: detail: [02:54] Downloading EVTX Attack Samples
 INFO interface: detail:     wef: [02:54] Downloading EVTX Attack Samples
    wef: [02:54] Downloading EVTX Attack Samples
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:55] Splunk inputs.conf has not yet been modified. Adding stanzas for these evtx files now...
 INFO interface: detail:     wef: [02:55] Splunk inputs.conf has not yet been modified. Adding stanzas for these evtx files now...
    wef: [02:55] Splunk inputs.conf has not yet been modified. Adding stanzas for these evtx files now...
 INFO interface: detail: [02:55] Restarting the Splunk Forwarder...
 INFO interface: detail:     wef: [02:55] Restarting the Splunk Forwarder...
    wef: [02:55] Restarting the Splunk Forwarder...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
 INFO interface: detail:     wef: WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
    wef: WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
 INFO interface: detail:     wef: WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
    wef: WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:55] Done! Look in 'index=EVTX-ATTACK-SAMPLES' in Splunk to query these samples.
 INFO interface: detail:     wef: [02:55] Done! Look in 'index=EVTX-ATTACK-SAMPLES' in Splunk to query these samples.
    wef: [02:55] Done! Look in 'index=EVTX-ATTACK-SAMPLES' in Splunk to query these samples.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 05CDB02F-278A-45D2-A4FD-A2EFA5E80BE9 on shell_id 5031E728-AC17-4A46-A711-AE08A8CAA81C
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435248f138 @data=[{:stdout=>"[02:54] Indexing EVTX Attack Samples into Splunk...\r\n"}, {:stdout=>"[02:54] Downloading EVTX Attack Samples\r\n"}, {:stdout=>"[02:55] Splunk inputs.conf has not yet been modified. Adding stanzas for these evtx files now...\r\n"}, {:stdout=>"[02:55] Restarting the Splunk Forwarder...\r\n"}, {:stdout=>"WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...\r\n"}, {:stdout=>"WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...\r\n"}, {:stdout=>"[02:55] Done! Look in 'index=EVTX-ATTACK-SAMPLES' in Splunk to query these samples.\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x00000243506e4cc8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352a39e80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2212, 5985=>2204, 5986=>2211}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 29687578-F662-4A73-8573-0111909B74FA
DEBUG winrmshell: [WinRM] Command created for hostname with id: 797DF9AE-A1C2-4671-97B4-E8EDA484AC37
DEBUG winrmshell: [WinRM] creating command_id: 797DF9AE-A1C2-4671-97B4-E8EDA484AC37 on shell_id 29687578-F662-4A73-8573-0111909B74FA
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 797DF9AE-A1C2-4671-97B4-E8EDA484AC37 on shell_id 29687578-F662-4A73-8573-0111909B74FA
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024353126ab8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5985=>2204, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: D8DBC376-8658-4448-848C-834CC4AD64C1
DEBUG winrmshell: [WinRM] Command created for hostname with id: 16AB29CC-603A-4E29-8018-2937EF24B2AC
DEBUG winrmshell: [WinRM] creating command_id: 16AB29CC-603A-4E29-8018-2937EF24B2AC on shell_id D8DBC376-8658-4448-848C-834CC4AD64C1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 16AB29CC-603A-4E29-8018-2937EF24B2AC on shell_id D8DBC376-8658-4448-848C-834CC4AD64C1
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352393f90 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2206, 5986=>2205, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: BDBFEF59-005B-4E48-9387-E7C0BEC6937A
DEBUG winrmshell: [WinRM] Command created for hostname with id: 8B38927F-E63C-41C4-A6A2-F46CB7CB6963
DEBUG winrmshell: [WinRM] creating command_id: 8B38927F-E63C-41C4-A6A2-F46CB7CB6963 on shell_id BDBFEF59-005B-4E48-9387-E7C0BEC6937A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8B38927F-E63C-41C4-A6A2-F46CB7CB6963 on shell_id BDBFEF59-005B-4E48-9387-E7C0BEC6937A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b954c8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dd21a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dd0fd0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c56948 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9E3906D7-C54C-4B18-8891-09092D94ED69
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0F3E630F-38A5-4F31-B97E-734673209814
DEBUG winrmshell: [WinRM] creating command_id: 0F3E630F-38A5-4F31-B97E-734673209814 on shell_id 9E3906D7-C54C-4B18-8891-09092D94ED69
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0F3E630F-38A5-4F31-B97E-734673209814 on shell_id 9E3906D7-C54C-4B18-8891-09092D94ED69
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b44398 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d70680 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352d47708 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c1d8f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F9C52914-90AC-42C2-A2DC-D897D0E967C0
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E913E0D5-0667-46FD-8E7D-0969470E8D97
DEBUG winrmshell: [WinRM] creating command_id: E913E0D5-0667-46FD-8E7D-0969470E8D97 on shell_id F9C52914-90AC-42C2-A2DC-D897D0E967C0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E913E0D5-0667-46FD-8E7D-0969470E8D97 on shell_id F9C52914-90AC-42C2-A2DC-D897D0E967C0
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352b01d68 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-19abk6l.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c04e18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bfef68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b00a30 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "81883041f088db0f0d4a349f41739c56f60c7961" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-19abk6l.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 50591BCC-BAE1-41DA-9E43-C3EAF0622460
DEBUG winrmshell: [WinRM] creating command_id: 50591BCC-BAE1-41DA-9E43-C3EAF0622460 on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 50591BCC-BAE1-41DA-9E43-C3EAF0622460 on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","81883041f088db0f0d4a349f41739c56f60c7961","4945b697ffcf10a321d7981a944a532132e5bc8f","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-19abk6l.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9743C85E-ED18-41CE-8A0F-2A56E7FC9C2F
DEBUG winrmshell: [WinRM] creating command_id: 9743C85E-ED18-41CE-8A0F-2A56E7FC9C2F on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9743C85E-ED18-41CE-8A0F-2A56E7FC9C2F on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxsIGFkZGl0aW9uYWwgcGFja2FnZXMgZnJvbSBDaG9jb2xhdGV5LgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgYWRkaXRpb25hbCBDaG9jbyBwYWNrYWdlcy4uLiIKCklmICgtbm90IChUZXN0LVBhdGggIkM6XFByb2dyYW1EYXRhXGNob2NvbGF0ZXkiKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIENob2NvbGF0ZXkiCiAgaWV4ICgobmV3LW9iamVjdCBuZXQud2ViY2xpZW50KS5Eb3dubG9hZFN0cmluZygnaHR0cHM6Ly9jaG9jb2xhdGV5Lm9yZy9pbnN0YWxsLnBzMScpKQp9IGVsc2UgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBDaG9jb2xhdGV5IGlzIGFscmVhZHkgaW5zdGFsbGVkLiIKfQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQ2hvY29sYXRleSBleHRyYXMuLi4iCmNob2NvIGluc3RhbGwgLXkgLS1saW1pdC1vdXRwdXQgLS1uby1wcm9ncmVzcyB3aXJlc2hhcmsgd2lucGNhcAoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIENob2NvIGFkZG9ucyBjb21wbGV0ZSEiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 760855BF-B893-43DF-B0A8-5E65752EE94A
DEBUG winrmshell: [WinRM] creating command_id: 760855BF-B893-43DF-B0A8-5E65752EE94A on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 760855BF-B893-43DF-B0A8-5E65752EE94A on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BCEDF83E-303B-4FB7-9487-A7A0F638B71E
DEBUG winrmshell: [WinRM] creating command_id: BCEDF83E-303B-4FB7-9487-A7A0F638B71E on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BCEDF83E-303B-4FB7-9487-A7A0F638B71E on shell_id 0CC64EE8-90FB-492A-8A27-8E676FBFFEFC
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-19abk6l.ps1 to C:/tmp/vagrant-shell.ps1 (0.864 KB over 1 chunks) in (0m0.33s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.85s) stream_files: (0m0.33s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-choco-extras.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ca2d70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ca0868 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bbfac0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: E5C3A7CD-A444-4E98-8D34-BB0FC6DCC854
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 595E92C4-5E43-4C64-8543-CDC83C4684D8
DEBUG winrmshell: [WinRM] creating command_id: 595E92C4-5E43-4C64-8543-CDC83C4684D8 on shell_id E5C3A7CD-A444-4E98-8D34-BB0FC6DCC854
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:55] Installing additional Choco packages...
 INFO interface: detail:     wef: [02:55] Installing additional Choco packages...
    wef: [02:55] Installing additional Choco packages...
 INFO interface: detail: [02:55] Chocolatey is already installed.
 INFO interface: detail:     wef: [02:55] Chocolatey is already installed.
    wef: [02:55] Chocolatey is already installed.
 INFO interface: detail: [02:55] Installing Chocolatey extras...
 INFO interface: detail:     wef: [02:55] Installing Chocolatey extras...
    wef: [02:55] Installing Chocolatey extras...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     wef: Installing the following packages:
    wef: Installing the following packages:
 INFO interface: detail: wireshark;winpcap
 INFO interface: detail:     wef: wireshark;winpcap
    wef: wireshark;winpcap
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     wef: By installing, you accept licenses for the packages.
    wef: By installing, you accept licenses for the packages.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: chocolatey-windowsupdate.extension v1.0.4 [Approved]
 INFO interface: detail:     wef: chocolatey-windowsupdate.extension v1.0.4 [Approved]
    wef: chocolatey-windowsupdate.extension v1.0.4 [Approved]
 INFO interface: detail: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
    wef: chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  Installed/updated chocolatey-windowsupdate extensions.
 INFO interface: detail:     wef:  Installed/updated chocolatey-windowsupdate extensions.
    wef:  Installed/updated chocolatey-windowsupdate extensions.
 INFO interface: detail:  The install of chocolatey-windowsupdate.extension was successful.
 INFO interface: detail:     wef:  The install of chocolatey-windowsupdate.extension was successful.
    wef:  The install of chocolatey-windowsupdate.extension was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
 INFO interface: detail:     wef:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
    wef:   Software installed to 'C:\ProgramData\chocolatey\extensions\chocolatey-windowsupdate'
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: KB3035131 v1.0.3 [Approved]
 INFO interface: detail:     wef: KB3035131 v1.0.3 [Approved]
    wef: KB3035131 v1.0.3 [Approved]
 INFO interface: detail: kb3035131 package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: kb3035131 package files install completed. Performing other installation steps.
    wef: kb3035131 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:     wef: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
    wef: Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb3035131 was successful.
 INFO interface: detail:     wef:  The install of kb3035131 was successful.
    wef:  The install of kb3035131 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: KB3033929 v1.0.5 [Approved]
 INFO interface: detail:     wef: KB3033929 v1.0.5 [Approved]
    wef: KB3033929 v1.0.5 [Approved]
 INFO interface: detail: kb3033929 package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: kb3033929 package files install completed. Performing other installation steps.
    wef: kb3033929 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:     wef: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
    wef: Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb3033929 was successful.
 INFO interface: detail:     wef:  The install of kb3033929 was successful.
    wef:  The install of kb3033929 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: KB2919442 v1.0.20160915 [Approved]
 INFO interface: detail:     wef: KB2919442 v1.0.20160915 [Approved]
    wef: KB2919442 v1.0.20160915 [Approved]
 INFO interface: detail: kb2919442 package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: kb2919442 package files install completed. Performing other installation steps.
    wef: kb2919442 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:     wef: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
    wef: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb2919442 was successful.
 INFO interface: detail:     wef:  The install of kb2919442 was successful.
    wef:  The install of kb2919442 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: KB2919355 v1.0.20160915 [Approved]
 INFO interface: detail:     wef: KB2919355 v1.0.20160915 [Approved]
    wef: KB2919355 v1.0.20160915 [Approved]
 INFO interface: detail: kb2919355 package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: kb2919355 package files install completed. Performing other installation steps.
    wef: kb2919355 package files install completed. Performing other installation steps.
 INFO interface: detail: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
 INFO interface: detail:     wef: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
    wef: Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb2919355 was successful.
 INFO interface: detail:     wef:  The install of kb2919355 was successful.
    wef:  The install of kb2919355 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: KB2999226 v1.0.20181019 [Approved] - Possibly broken
 INFO interface: detail:     wef: KB2999226 v1.0.20181019 [Approved] - Possibly broken
    wef: KB2999226 v1.0.20181019 [Approved] - Possibly broken
 INFO interface: detail: kb2999226 package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: kb2999226 package files install completed. Performing other installation steps.
    wef: kb2999226 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
 INFO interface: detail:     wef: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
    wef: Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of kb2999226 was successful.
 INFO interface: detail:     wef:  The install of kb2999226 was successful.
    wef:  The install of kb2999226 was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: vcredist140 v14.32.31326 [Approved]
 INFO interface: detail:     wef: vcredist140 v14.32.31326 [Approved]
    wef: vcredist140 v14.32.31326 [Approved]
 INFO interface: detail: vcredist140 package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: vcredist140 package files install completed. Performing other installation steps.
    wef: vcredist140 package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading vcredist140-x86
 INFO interface: detail:     wef: Downloading vcredist140-x86
    wef: Downloading vcredist140-x86
 INFO interface: detail:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
 INFO interface: detail:     wef:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
    wef:   from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Download of VC_redist.x86.exe (13.1 MB) completed.
 INFO interface: detail:     wef: Download of VC_redist.x86.exe (13.1 MB) completed.
    wef: Download of VC_redist.x86.exe (13.1 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     wef: Hashes match.
    wef: Hashes match.
 INFO interface: detail: Installing vcredist140-x86...
 INFO interface: detail:     wef: Installing vcredist140-x86...
    wef: Installing vcredist140-x86...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: vcredist140-x86 has been installed.
 INFO interface: detail:     wef: vcredist140-x86 has been installed.
    wef: vcredist140-x86 has been installed.
 INFO interface: detail: Downloading vcredist140-x64 64 bit
 INFO interface: detail:     wef: Downloading vcredist140-x64 64 bit
    wef: Downloading vcredist140-x64 64 bit
 INFO interface: detail:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
 INFO interface: detail:     wef:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
    wef:   from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Download of VC_redist.x64.exe (24.16 MB) completed.
 INFO interface: detail:     wef: Download of VC_redist.x64.exe (24.16 MB) completed.
    wef: Download of VC_redist.x64.exe (24.16 MB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     wef: Hashes match.
    wef: Hashes match.
 INFO interface: detail: Installing vcredist140-x64...
 INFO interface: detail:     wef: Installing vcredist140-x64...
    wef: Installing vcredist140-x64...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: vcredist140-x64 has been installed.
 INFO interface: detail:     wef: vcredist140-x64 has been installed.
    wef: vcredist140-x64 has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   vcredist140 may be able to be automatically uninstalled.
 INFO interface: detail:     wef:   vcredist140 may be able to be automatically uninstalled.
    wef:   vcredist140 may be able to be automatically uninstalled.
 INFO interface: detail:  The install of vcredist140 was successful.
 INFO interface: detail:     wef:  The install of vcredist140 was successful.
    wef:  The install of vcredist140 was successful.
 INFO interface: detail:   Software installed as 'exe', install location is likely default.
 INFO interface: detail:     wef:   Software installed as 'exe', install location is likely default.
    wef:   Software installed as 'exe', install location is likely default.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: wireshark v3.6.6 [Approved]
 INFO interface: detail:     wef: wireshark v3.6.6 [Approved]
    wef: wireshark v3.6.6 [Approved]
 INFO interface: detail: wireshark package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: wireshark package files install completed. Performing other installation steps.
    wef: wireshark package files install completed. Performing other installation steps.
 INFO interface: detail: Installing 64-bit wireshark...
 INFO interface: detail:     wef: Installing 64-bit wireshark...
    wef: Installing 64-bit wireshark...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: wireshark has been installed.
 INFO interface: detail:     wef: wireshark has been installed.
    wef: wireshark has been installed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:   wireshark can be automatically uninstalled.
 INFO interface: detail:     wef:   wireshark can be automatically uninstalled.
    wef:   wireshark can be automatically uninstalled.
 INFO interface: detail:  The install of wireshark was successful.
 INFO interface: detail:     wef:  The install of wireshark was successful.
    wef:  The install of wireshark was successful.
 INFO interface: detail:   Software installed to 'C:\Program Files\Wireshark'
 INFO interface: detail:     wef:   Software installed to 'C:\Program Files\Wireshark'
    wef:   Software installed to 'C:\Program Files\Wireshark'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: autohotkey.portable v1.1.34.03 [Approved]
 INFO interface: detail:     wef: autohotkey.portable v1.1.34.03 [Approved]
    wef: autohotkey.portable v1.1.34.03 [Approved]
 INFO interface: detail: autohotkey.portable package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: autohotkey.portable package files install completed. Performing other installation steps.
    wef: autohotkey.portable package files install completed. Performing other installation steps.
 INFO interface: detail: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
 INFO interface: detail:     wef: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
    wef: Extracting C:\ProgramData\chocolatey\lib\autohotkey.portable\tools\AutoHotkey_1.1.34.03.zip to C:\ProgramData\chocolatey\lib\autohotkey.portable\tools...
 INFO interface: detail: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
 INFO interface: detail:     wef: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
    wef: C:\ProgramData\chocolatey\lib\autohotkey.portable\tools
 INFO interface: detail: Removing ANSI-32 version
 INFO interface: detail:     wef: Removing ANSI-32 version
    wef: Removing ANSI-32 version
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  ShimGen has successfully created a shim for AutoHotkey.exe
 INFO interface: detail:     wef:  ShimGen has successfully created a shim for AutoHotkey.exe
    wef:  ShimGen has successfully created a shim for AutoHotkey.exe
 INFO interface: detail:  ShimGen has successfully created a shim for Ahk2Exe.exe
 INFO interface: detail:     wef:  ShimGen has successfully created a shim for Ahk2Exe.exe
    wef:  ShimGen has successfully created a shim for Ahk2Exe.exe
 INFO interface: detail:  The install of autohotkey.portable was successful.
 INFO interface: detail:     wef:  The install of autohotkey.portable was successful.
    wef:  The install of autohotkey.portable was successful.
 INFO interface: detail:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
 INFO interface: detail:     wef:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
    wef:   Software installed to 'C:\ProgramData\chocolatey\lib\autohotkey.portable\tools'
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: WinPcap v4.1.3.20161116 [Approved]
 INFO interface: detail:     wef: WinPcap v4.1.3.20161116 [Approved]
    wef: WinPcap v4.1.3.20161116 [Approved]
 INFO interface: detail: winpcap package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: winpcap package files install completed. Performing other installation steps.
    wef: winpcap package files install completed. Performing other installation steps.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Downloading WinPcap
 INFO interface: detail:     wef: Downloading WinPcap
    wef: Downloading WinPcap
 INFO interface: detail:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
 INFO interface: detail:     wef:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
    wef:   from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Download of WinPcapInstall.exe (893.68 KB) completed.
 INFO interface: detail:     wef: Download of WinPcapInstall.exe (893.68 KB) completed.
    wef: Download of WinPcapInstall.exe (893.68 KB) completed.
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Hashes match.
 INFO interface: detail:     wef: Hashes match.
    wef: Hashes match.
 INFO interface: detail: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
 INFO interface: detail:     wef: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
    wef: C:\Users\vagrant\AppData\Local\Temp\chocolatey\WinPcap\4.1.3.20161116\WinPcapInstall.exe
 INFO interface: detail: Running Autohotkey installer
 INFO interface: detail:     wef: Running Autohotkey installer
    wef: Running Autohotkey installer
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail:  The install of winpcap was successful.
 INFO interface: detail:     wef:  The install of winpcap was successful.
    wef:  The install of winpcap was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Chocolatey installed 10/10 packages.
 INFO interface: detail:     wef: Chocolatey installed 10/10 packages.
    wef: Chocolatey installed 10/10 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Installed:
 INFO interface: detail:     wef: Installed:
    wef: Installed:
 INFO interface: detail:  - kb2919355 v1.0.20160915
 INFO interface: detail:     wef:  - kb2919355 v1.0.20160915
    wef:  - kb2919355 v1.0.20160915
 INFO interface: detail:  - kb3033929 v1.0.5
 INFO interface: detail:     wef:  - kb3033929 v1.0.5
    wef:  - kb3033929 v1.0.5
 INFO interface: detail:  - kb2999226 v1.0.20181019
 INFO interface: detail:     wef:  - kb2999226 v1.0.20181019
    wef:  - kb2999226 v1.0.20181019
 INFO interface: detail:  - wireshark v3.6.6
 INFO interface: detail:     wef:  - wireshark v3.6.6
    wef:  - wireshark v3.6.6
 INFO interface: detail:  - kb2919442 v1.0.20160915
 INFO interface: detail:     wef:  - kb2919442 v1.0.20160915
    wef:  - kb2919442 v1.0.20160915
 INFO interface: detail:  - autohotkey.portable v1.1.34.03
 INFO interface: detail:     wef:  - autohotkey.portable v1.1.34.03
    wef:  - autohotkey.portable v1.1.34.03
 INFO interface: detail:  - vcredist140 v14.32.31326
 INFO interface: detail:     wef:  - vcredist140 v14.32.31326
    wef:  - vcredist140 v14.32.31326
 INFO interface: detail:  - winpcap v4.1.3.20161116
 INFO interface: detail:     wef:  - winpcap v4.1.3.20161116
    wef:  - winpcap v4.1.3.20161116
 INFO interface: detail:  - kb3035131 v1.0.3
 INFO interface: detail:     wef:  - kb3035131 v1.0.3
    wef:  - kb3035131 v1.0.3
 INFO interface: detail:  - chocolatey-windowsupdate.extension v1.0.4
 INFO interface: detail:     wef:  - chocolatey-windowsupdate.extension v1.0.4
    wef:  - chocolatey-windowsupdate.extension v1.0.4
 INFO interface: detail: [02:57] Choco addons complete!
 INFO interface: detail:     wef: [02:57] Choco addons complete!
    wef: [02:57] Choco addons complete!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 595E92C4-5E43-4C64-8543-CDC83C4684D8 on shell_id E5C3A7CD-A444-4E98-8D34-BB0FC6DCC854
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ab29c0 @data=[{:stdout=>"[02:55] Installing additional Choco packages...\r\n"}, {:stdout=>"[02:55] Chocolatey is already installed.\r\n"}, {:stdout=>"[02:55] Installing Chocolatey extras...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"wireshark;winpcap\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"chocolatey-windowsupdate.extension v1.0.4 [Approved]\r\n"}, {:stdout=>"chocolatey-windowsupdate.extension package files install completed. Performing other installation steps.\r\n"}, {:stdout=>" Installed/updated chocolatey-windowsupdate extensions.\r\n"}, {:stdout=>" The install of chocolatey-windowsupdate.extension was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\extensions\\chocolatey-windowsupdate'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB3035131 v1.0.3 [Approved]\r\n"}, {:stdout=>"kb3035131 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB3035131 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).\r\n"}, {:stdout=>" The install of kb3035131 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB3033929 v1.0.5 [Approved]\r\n"}, {:stdout=>"kb3033929 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB3033929 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).\r\n"}, {:stdout=>" The install of kb3033929 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2919442 v1.0.20160915 [Approved]\r\n"}, {:stdout=>"kb2919442 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.\r\n"}, {:stdout=>" The install of kb2919442 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2919355 v1.0.20160915 [Approved]\r\n"}, {:stdout=>"kb2919355 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because this hotfix only applies to Windows 8.1 and Windows Server 2012 R2.\r\n"}, {:stdout=>" The install of kb2919355 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"KB2999226 v1.0.20181019 [Approved] - Possibly broken\r\n"}, {:stdout=>"kb2999226 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Skipping installation because update KB2999226 does not apply to this operating system (Microsoft Windows Server 2016 Standard Evaluation).\r\n"}, {:stdout=>" The install of kb2999226 was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"vcredist140 v14.32.31326 [Approved]\r\n"}, {:stdout=>"vcredist140 package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading vcredist140-x86 \r\n"}, {:stdout=>"  from 'https://download.visualstudio.microsoft.com/download/pr/06ed1d94-3f28-47a5-8025-e7bf9da634da/2ACBFE92157C1CF1A7B524A9325824046D83DBFA3FEB1CBD4DD02A42E020F77C/VC_redist.x86.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of VC_redist.x86.exe (13.1 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing vcredist140-x86...\r\n"}, {:stdout=>"vcredist140-x86 has been installed.\r\n"}, {:stdout=>"Downloading vcredist140-x64 64 bit\r\n"}, {:stdout=>"  from 'https://download.visualstudio.microsoft.com/download/pr/6b6923b0-3045-4379-a96f-ef5506a65d5b/426A34C6F10EA8F7DA58A8C976B586AD84DD4BAB42A0CFDBE941F1763B7755E5/VC_redist.x64.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of VC_redist.x64.exe (24.16 MB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"Installing vcredist140-x64...\r\n"}, {:stdout=>"vcredist140-x64 has been installed.\r\n"}, {:stdout=>"  vcredist140 may be able to be automatically uninstalled.\r\n"}, {:stdout=>" The install of vcredist140 was successful.\r\n"}, {:stdout=>"  Software installed as 'exe', install location is likely default.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"wireshark v3.6.6 [Approved]\r\n"}, {:stdout=>"wireshark package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Installing 64-bit wireshark...\r\n"}, {:stdout=>"wireshark has been installed.\r\n"}, {:stdout=>"  wireshark can be automatically uninstalled.\r\n"}, {:stdout=>" The install of wireshark was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\Program Files\\Wireshark'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"autohotkey.portable v1.1.34.03 [Approved]\r\n"}, {:stdout=>"autohotkey.portable package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Extracting C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools\\AutoHotkey_1.1.34.03.zip to C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools...\r\n"}, {:stdout=>"C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools\r\n"}, {:stdout=>"Removing ANSI-32 version\r\n"}, {:stdout=>" ShimGen has successfully created a shim for AutoHotkey.exe\r\n"}, {:stdout=>" ShimGen has successfully created a shim for Ahk2Exe.exe\r\n"}, {:stdout=>" The install of autohotkey.portable was successful.\r\n"}, {:stdout=>"  Software installed to 'C:\\ProgramData\\chocolatey\\lib\\autohotkey.portable\\tools'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"WinPcap v4.1.3.20161116 [Approved]\r\n"}, {:stdout=>"winpcap package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"Downloading WinPcap \r\n"}, {:stdout=>"  from 'https://www.winpcap.org/install/bin/WinPcap_4_1_3.exe'\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Download of WinPcapInstall.exe (893.68 KB) completed.\r\n"}, {:stdout=>"Hashes match.\r\n"}, {:stdout=>"C:\\Users\\vagrant\\AppData\\Local\\Temp\\chocolatey\\WinPcap\\4.1.3.20161116\\WinPcapInstall.exe\r\n"}, {:stdout=>"Running Autohotkey installer\r\n"}, {:stdout=>" The install of winpcap was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 10/10 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Installed:\r\n"}, {:stdout=>" - kb2919355 v1.0.20160915\r\n"}, {:stdout=>" - kb3033929 v1.0.5\r\n"}, {:stdout=>" - kb2999226 v1.0.20181019\r\n"}, {:stdout=>" - wireshark v3.6.6\r\n"}, {:stdout=>" - kb2919442 v1.0.20160915\r\n"}, {:stdout=>" - autohotkey.portable v1.1.34.03\r\n"}, {:stdout=>" - vcredist140 v14.32.31326\r\n"}, {:stdout=>" - winpcap v4.1.3.20161116\r\n"}, {:stdout=>" - kb3035131 v1.0.3\r\n"}, {:stdout=>" - chocolatey-windowsupdate.extension v1.0.4\r\n"}, {:stdout=>"[02:57] Choco addons complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352a39e80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x00000243532574f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2205, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7B65B43E-FCB5-4ADD-B5F4-3E74955A10B9
DEBUG winrmshell: [WinRM] Command created for hostname with id: DDC6E633-0E68-424B-86CE-6A68CA048FD2
DEBUG winrmshell: [WinRM] creating command_id: DDC6E633-0E68-424B-86CE-6A68CA048FD2 on shell_id 7B65B43E-FCB5-4ADD-B5F4-3E74955A10B9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DDC6E633-0E68-424B-86CE-6A68CA048FD2 on shell_id 7B65B43E-FCB5-4ADD-B5F4-3E74955A10B9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352baca38 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5985=>2207, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 58E42B7C-5094-4011-B704-207F2AB4BDB6
DEBUG winrmshell: [WinRM] Command created for hostname with id: B0DAD58E-89C1-4E44-864C-C14A133435E2
DEBUG winrmshell: [WinRM] creating command_id: B0DAD58E-89C1-4E44-864C-C14A133435E2 on shell_id 58E42B7C-5094-4011-B704-207F2AB4BDB6
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B0DAD58E-89C1-4E44-864C-C14A133435E2 on shell_id 58E42B7C-5094-4011-B704-207F2AB4BDB6
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f70b38 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7F45B63D-869B-4F19-9000-4FE3302B51C3
DEBUG winrmshell: [WinRM] Command created for hostname with id: 86F07483-AAC1-4F7B-9C9B-D0B2D3D536CE
DEBUG winrmshell: [WinRM] creating command_id: 86F07483-AAC1-4F7B-9C9B-D0B2D3D536CE on shell_id 7F45B63D-869B-4F19-9000-4FE3302B51C3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 86F07483-AAC1-4F7B-9C9B-D0B2D3D536CE on shell_id 7F45B63D-869B-4F19-9000-4FE3302B51C3
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024350e0cfa0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352430fe8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435242a5f8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243520db5c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 866E1237-D017-4D5F-A626-5395D790EFFE
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C5221A30-EB89-4D87-9877-B5E0B412893A
DEBUG winrmshell: [WinRM] creating command_id: C5221A30-EB89-4D87-9877-B5E0B412893A on shell_id 866E1237-D017-4D5F-A626-5395D790EFFE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C5221A30-EB89-4D87-9877-B5E0B412893A on shell_id 866E1237-D017-4D5F-A626-5395D790EFFE
DEBUG winrmshell: Output: #<WinRM::Output:0x000002434f034398 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352342758 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435233ba20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243511fb6e8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A7C0741E-E6C6-4FBF-80BE-81B19B6F9728
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: BA4EFD87-0695-4F12-BD70-A58B560C7C95
DEBUG winrmshell: [WinRM] creating command_id: BA4EFD87-0695-4F12-BD70-A58B560C7C95 on shell_id A7C0741E-E6C6-4FBF-80BE-81B19B6F9728
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BA4EFD87-0695-4F12-BD70-A58B560C7C95 on shell_id A7C0741E-E6C6-4FBF-80BE-81B19B6F9728
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243532d6c78 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-mwbegp.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350f638e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350f53b98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353295020 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "299638e78893f8011af9474087001dd60f0e0bcc" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-mwbegp.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E012C6AC-E9A1-4640-AC8A-7D6DD5215065
DEBUG winrmshell: [WinRM] creating command_id: E012C6AC-E9A1-4640-AC8A-7D6DD5215065 on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E012C6AC-E9A1-4640-AC8A-7D6DD5215065 on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","299638e78893f8011af9474087001dd60f0e0bcc","81883041f088db0f0d4a349f41739c56f60c7961","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-mwbegp.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B89567A8-9C4B-459A-B5D7-CF8DAEA8337E
DEBUG winrmshell: [WinRM] creating command_id: B89567A8-9C4B-459A-B5D7-CF8DAEA8337E on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B89567A8-9C4B-459A-B5D7-CF8DAEA8337E on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBvc3F1ZXJ5IG9uIHRoZSBob3N0LiBPc3F1ZXJ5IGNvbm50ZWN0cyB0byBGbGVldCB2aWEgVExTLgoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgb3NxdWVyeS4uLiIKJGZsYWdmaWxlID0gImM6XFByb2dyYW0gRmlsZXNcb3NxdWVyeVxvc3F1ZXJ5LmZsYWdzIgpjaG9jbyBpbnN0YWxsIC15IC0tbGltaXQtb3V0cHV0IC0tbm8tcHJvZ3Jlc3Mgb3NxdWVyeSB8IE91dC1TdHJpbmcgICMgQXBwYXJlbnRseSBPdXQtU3RyaW5nIG1ha2VzIHRoZSBwcm9jZXNzIHdhaXQKJHNlcnZpY2UgPSBHZXQtV21pT2JqZWN0IC1DbGFzcyBXaW4zMl9TZXJ2aWNlIC1GaWx0ZXIgIk5hbWU9J29zcXVlcnlkJyIKSWYgKC1ub3QgKCRzZXJ2aWNlKSkgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTZXR0aW5nIG9zcXVlcnkgdG8gcnVuIGFzIGEgc2VydmljZSIKICBOZXctU2VydmljZSAtTmFtZSAib3NxdWVyeWQiIC1CaW5hcnlQYXRoTmFtZSAiQzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XG9zcXVlcnlkXG9zcXVlcnlkLmV4ZSAtLWZsYWdmaWxlPWAiQzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XG9zcXVlcnkuZmxhZ3NgIiIKCiAgIyBEb3dubG9hZCB0aGUgZmxhZ3MgZmlsZSBmcm9tIHRoZSBQYWxhbnRpciBvc3F1ZXJ5LWNvbmZpZ3VyYXRpb24gR2l0aHViCiAgIyBHaXRIdWIgcmVxdWlyZXMgVExTIDEuMiBhcyBvZiAyLzEvMjAxOAogIFtOZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlY3VyaXR5UHJvdG9jb2wgPSBbTmV0LlNlY3VyaXR5UHJvdG9jb2xUeXBlXTo6VGxzMTIKICAjIERpc2FibGluZyB0aGUgcHJvZ3Jlc3MgYmFyIHNwZWVkcyB1cCBJV1IgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOAogICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcGFsYW50aXIvb3NxdWVyeS1jb25maWd1cmF0aW9uL21hc3Rlci9DbGFzc2ljL0VuZHBvaW50cy9XaW5kb3dzL29zcXVlcnkuZmxhZ3MiIC1PdXRGaWxlICRmbGFnZmlsZQoKICAjIyBVc2UgdGhlIFRMUyBjb25maWcKICAjIyBBZGQgZW50cnkgdG8gaG9zdHMgZmlsZSBmb3IgRmxlZXQgZm9yIFNTTCB2YWxpZGF0aW9uCiAgSWYgKFNlbGVjdC1TdHJpbmcgLVBhdGggImM6XHdpbmRvd3Ncc3lzdGVtMzJcZHJpdmVyc1xldGNcaG9zdHMiIC1QYXR0ZXJuICJmbGVldCIpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBIb3N0cyBmaWxlIGFscmVhZHkgdXBkYXRlZC4gTW92aW5nIG9uLiIKICB9CiAgRWxzZSB7CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQWRkaW5nIEZsZWV0IHRvIHRoZSBob3N0cyBmaWxlIgogICAgQWRkLUNvbnRlbnQgImM6XHdpbmRvd3Ncc3lzdGVtMzJcZHJpdmVyc1xldGNcaG9zdHMiICIgICAgICAgIDE5Mi4xNjguNTYuMTA1ICAgIGZsZWV0IgogIH0KICAjIyBBZGQgRmxlZXQgc2VjcmV0IGFuZCBhdm9pZCBCT00KICAkVXRmOE5vQm9tRW5jb2RpbmcgPSBOZXctT2JqZWN0IFN5c3RlbS5UZXh0LlVURjhFbmNvZGluZyAkRmFsc2UKICBbU3lzdGVtLklPLkZpbGVdOjpXcml0ZUFsbExpbmVzKCJjOlxQcm9ncmFtIEZpbGVzXG9zcXVlcnlcZmxlZXRfc2VjcmV0LnR4dCIsICJlbnJvbGxtZW50c2VjcmV0ZW5yb2xsbWVudHNlY3JldCIsICRVdGY4Tm9Cb21FbmNvZGluZykKICAjIyBDaGFuZ2UgVExTIHNlcnZlciBob3N0bmFtZSBpbiB0aGUgZmxhZ3MgZmlsZQogIChHZXQtQ29udGVudCAkZmxhZ2ZpbGUpIC1yZXBsYWNlICd0bHMuZW5kcG9pbnQuc2VydmVyLmNvbScsICdmbGVldDo4NDEyJyB8IFNldC1Db250ZW50ICRmbGFnZmlsZQogICMjIENoYW5nZSBwYXRoIHRvIHNlY3JldHMgaW4gdGhlIGZsYWdzIGZpbGUKICAoR2V0LUNvbnRlbnQgJGZsYWdmaWxlKSAtcmVwbGFjZSAncGF0aFxcdG9cXGZpbGVcXGNvbnRhaW5pbmdcXHNlY3JldC50eHQnLCAnUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGZsZWV0X3NlY3JldC50eHQnIHwgU2V0LUNvbnRlbnQgJGZsYWdmaWxlCiAgIyMgQ2hhbmdlIHBhdGggdG8gY2VydGZpbGUgaW4gdGhlIGZsYWdzIGZpbGUKICAoR2V0LUNvbnRlbnQgJGZsYWdmaWxlKSAtcmVwbGFjZSAnYzpcXFByb2dyYW1EYXRhXFxvc3F1ZXJ5XFxjZXJ0ZmlsZS5jcnQnLCAnYzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGNlcnRmaWxlLmNydCcgfCBTZXQtQ29udGVudCAkZmxhZ2ZpbGUKICAjIyBSZW1vdmUgdGhlIHZlcmJvc2UgZmxhZyBhbmQgcmVwbGFjZSBpdCB3aXRoIHRoZSBsb2dnZXJfbWluX3N0YXR1cz0xIG9wdGlvbiAoU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9vc3F1ZXJ5L29zcXVlcnkvaXNzdWVzLzUyMTIpCiAgKEdldC1Db250ZW50ICRmbGFnZmlsZSkgLXJlcGxhY2UgJy0tdmVyYm9zZT10cnVlJywgJy0tbG9nZ2VyX21pbl9zdGF0dXM9MScgfCBTZXQtQ29udGVudCAkZmxhZ2ZpbGUKICAjIyBBZGQgY2VydGZpbGUuY3J0CiAgQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1xmbGVldFxzZXJ2ZXIuY3J0IiAiYzpcUHJvZ3JhbSBGaWxlc1xvc3F1ZXJ5XGNlcnRmaWxlLmNydCIKICAjIyBTdGFydCB0aGUgc2VydmljZQogIFN0YXJ0LVNlcnZpY2Ugb3NxdWVyeWQKfQplbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgb3NxdWVyeSBpcyBhbHJlYWR5IGluc3RhbGxlZC4gTW92aW5nIE9uLiIKfQpJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIG9zcXVlcnlkKS5TdGF0dXMgLW5lICJSdW5uaW5nIikKewogIHRocm93ICJvc3F1ZXJ5ZCBzZXJ2aWNlIHdhcyBub3QgcnVubmluZyIKfQo=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 2D0A92E6-B55A-416B-B73A-502667B07994
DEBUG winrmshell: [WinRM] creating command_id: 2D0A92E6-B55A-416B-B73A-502667B07994 on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 2D0A92E6-B55A-416B-B73A-502667B07994 on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A0D06673-9247-4000-8828-3732F7870DC9
DEBUG winrmshell: [WinRM] creating command_id: A0D06673-9247-4000-8828-3732F7870DC9 on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A0D06673-9247-4000-8828-3732F7870DC9 on shell_id C85B7597-70C2-4CB8-8B8F-D92C837A41F5
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-mwbegp.ps1 to C:/tmp/vagrant-shell.ps1 (3.916 KB over 1 chunks) in (0m0.18s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.55s) stream_files: (0m0.18s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-osquery.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350e02b68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243512ee000 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243532feac0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7D06720F-F259-49DE-8AC0-7FEA1371E6B2
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E3F42291-CAAA-449C-99E3-5A80B73071D6
DEBUG winrmshell: [WinRM] creating command_id: E3F42291-CAAA-449C-99E3-5A80B73071D6 on shell_id 7D06720F-F259-49DE-8AC0-7FEA1371E6B2
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:57] Installing osquery...
 INFO interface: detail:     wef: [02:57] Installing osquery...
    wef: [02:57] Installing osquery...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: Installing the following packages:
 INFO interface: detail:     wef: Installing the following packages:
    wef: Installing the following packages:
 INFO interface: detail: osquery
 INFO interface: detail:     wef: osquery
    wef: osquery
 INFO interface: detail: By installing, you accept licenses for the packages.
 INFO interface: detail:     wef: By installing, you accept licenses for the packages.
    wef: By installing, you accept licenses for the packages.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: osquery v5.2.2 [Approved]
 INFO interface: detail:     wef: osquery v5.2.2 [Approved]
    wef: osquery v5.2.2 [Approved]
 INFO interface: detail: osquery package files install completed. Performing other installation steps.
 INFO interface: detail:     wef: osquery package files install completed. Performing other installation steps.
    wef: osquery package files install completed. Performing other installation steps.
 INFO interface: detail: C:\Program Files\osquery\log
 INFO interface: detail:     wef: C:\Program Files\osquery\log
    wef: C:\Program Files\osquery\log
 INFO interface: detail: True
 INFO interface: detail:     wef: True
    wef: True
 INFO interface: detail: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
 INFO interface: detail:     wef: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
    wef: PATH environment variable does not have C:\Program Files\osquery in it. Adding...
 INFO interface: detail: Environment Vars (like PATH) have changed. Close/reopen your shell to
 INFO interface: detail:     wef: Environment Vars (like PATH) have changed. Close/reopen your shell to
    wef: Environment Vars (like PATH) have changed. Close/reopen your shell to
 INFO interface: detail:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
 INFO interface: detail:     wef:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
    wef:  see the changes (or in powershell/cmd.exe just type `refreshenv`).
 INFO interface: detail:  ShimGen has successfully created a shim for osqueryi.exe
 INFO interface: detail:     wef:  ShimGen has successfully created a shim for osqueryi.exe
    wef:  ShimGen has successfully created a shim for osqueryi.exe
 INFO interface: detail:  ShimGen has successfully created a shim for osqueryd.exe
 INFO interface: detail:     wef:  ShimGen has successfully created a shim for osqueryd.exe
    wef:  ShimGen has successfully created a shim for osqueryd.exe
 INFO interface: detail:  The install of osquery was successful.
 INFO interface: detail:     wef:  The install of osquery was successful.
    wef:  The install of osquery was successful.
 INFO interface: detail:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:     wef:   Software install location not explicitly set, it could be in package or
    wef:   Software install location not explicitly set, it could be in package or
 INFO interface: detail:   default install location of installer.
 INFO interface: detail:     wef:   default install location of installer.
    wef:   default install location of installer.
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Chocolatey installed 1/1 packages.
 INFO interface: detail:     wef: Chocolatey installed 1/1 packages.
    wef: Chocolatey installed 1/1 packages.
 INFO interface: detail:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail:     wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
    wef:  See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [02:57] Setting osquery to run as a service
 INFO interface: detail:     wef: [02:57] Setting osquery to run as a service
    wef: [02:57] Setting osquery to run as a service
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Status   Name               DisplayName
 INFO interface: detail:     wef: Status   Name               DisplayName
    wef: Status   Name               DisplayName
 INFO interface: detail: ------   ----               -----------
 INFO interface: detail:     wef: ------   ----               -----------
    wef: ------   ----               -----------
 INFO interface: detail: Stopped  osqueryd           osqueryd
 INFO interface: detail:     wef: Stopped  osqueryd           osqueryd
    wef: Stopped  osqueryd           osqueryd
 INFO interface: detail: [02:57] Adding Fleet to the hosts file
 INFO interface: detail:     wef: [02:57] Adding Fleet to the hosts file
    wef: [02:57] Adding Fleet to the hosts file
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E3F42291-CAAA-449C-99E3-5A80B73071D6 on shell_id 7D06720F-F259-49DE-8AC0-7FEA1371E6B2
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243530e6c10 @data=[{:stdout=>"[02:57] Installing osquery...\r\n"}, {:stdout=>"Installing the following packages:\r\n"}, {:stdout=>"osquery\r\n"}, {:stdout=>"By installing, you accept licenses for the packages.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"osquery v5.2.2 [Approved]\r\n"}, {:stdout=>"osquery package files install completed. Performing other installation steps.\r\n"}, {:stdout=>"C:\\Program Files\\osquery\\log\r\n"}, {:stdout=>"True\r\n"}, {:stdout=>"PATH environment variable does not have C:\\Program Files\\osquery in it. Adding...\r\n"}, {:stdout=>"Environment Vars (like PATH) have changed. Close/reopen your shell to\r\n"}, {:stdout=>" see the changes (or in powershell/cmd.exe just type `refreshenv`).\r\n"}, {:stdout=>" ShimGen has successfully created a shim for osqueryi.exe\r\n"}, {:stdout=>" ShimGen has successfully created a shim for osqueryd.exe\r\n"}, {:stdout=>" The install of osquery was successful.\r\n"}, {:stdout=>"  Software install location not explicitly set, it could be in package or\r\n"}, {:stdout=>"  default install location of installer.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Chocolatey installed 1/1 packages. \r\n"}, {:stdout=>" See the log for details (C:\\ProgramData\\chocolatey\\logs\\chocolatey.log).\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[02:57] Setting osquery to run as a service\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status   Name               DisplayName                           \r\n"}, {:stdout=>"------   ----               -----------                           \r\n"}, {:stdout=>"Stopped  osqueryd           osqueryd                              \r\n"}, {:stdout=>"[02:57] Adding Fleet to the hosts file\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x00000243532574f0 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x000002435330d840 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{22=>2209, 5985=>2204, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5D64D752-CAD5-4A83-9851-8C555331E950
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4BEE1F23-E20D-4487-A518-43FF831E7053
DEBUG winrmshell: [WinRM] creating command_id: 4BEE1F23-E20D-4487-A518-43FF831E7053 on shell_id 5D64D752-CAD5-4A83-9851-8C555331E950
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4BEE1F23-E20D-4487-A518-43FF831E7053 on shell_id 5D64D752-CAD5-4A83-9851-8C555331E950
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c2d020 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2209, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 1A663235-721E-4E50-961C-3F5F6B8804CC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 4A8369F1-9BFB-4A79-9D86-4AB03B42CD30
DEBUG winrmshell: [WinRM] creating command_id: 4A8369F1-9BFB-4A79-9D86-4AB03B42CD30 on shell_id 1A663235-721E-4E50-961C-3F5F6B8804CC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4A8369F1-9BFB-4A79-9D86-4AB03B42CD30 on shell_id 1A663235-721E-4E50-961C-3F5F6B8804CC
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352fe3ae8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2205, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F6C59BC8-9FDA-4139-BC37-FDF56FCFD813
DEBUG winrmshell: [WinRM] Command created for hostname with id: BEB39D16-D912-43C6-86C2-AE7EB258BD44
DEBUG winrmshell: [WinRM] creating command_id: BEB39D16-D912-43C6-86C2-AE7EB258BD44 on shell_id F6C59BC8-9FDA-4139-BC37-FDF56FCFD813
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BEB39D16-D912-43C6-86C2-AE7EB258BD44 on shell_id F6C59BC8-9FDA-4139-BC37-FDF56FCFD813
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435116a300 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524c6f48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524c44f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243521f21c8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 20CED3CB-51A1-433A-861F-8AB99F88742A
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B5676649-5E3B-4066-82D7-A86831581A83
DEBUG winrmshell: [WinRM] creating command_id: B5676649-5E3B-4066-82D7-A86831581A83 on shell_id 20CED3CB-51A1-433A-861F-8AB99F88742A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B5676649-5E3B-4066-82D7-A86831581A83 on shell_id 20CED3CB-51A1-433A-861F-8AB99F88742A
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024350802c18 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435237a748 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243523788d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243513e0918 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5320B6A9-B4E1-4484-A9B8-341029A4DEA5
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C878BEF3-9DCD-40B5-966B-9C2D1BCDAB60
DEBUG winrmshell: [WinRM] creating command_id: C878BEF3-9DCD-40B5-966B-9C2D1BCDAB60 on shell_id 5320B6A9-B4E1-4484-A9B8-341029A4DEA5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C878BEF3-9DCD-40B5-966B-9C2D1BCDAB60 on shell_id 5320B6A9-B4E1-4484-A9B8-341029A4DEA5
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243532e55e8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-hslgoe.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350f1a870 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350f11a18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353274460 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "74ae4687be5f0897ea0e3af4033ec979f9cb4103" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-hslgoe.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 9E3A9C27-AA4C-49DE-8E06-967A6DFAD02E
DEBUG winrmshell: [WinRM] creating command_id: 9E3A9C27-AA4C-49DE-8E06-967A6DFAD02E on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 9E3A9C27-AA4C-49DE-8E06-967A6DFAD02E on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","74ae4687be5f0897ea0e3af4033ec979f9cb4103","299638e78893f8011af9474087001dd60f0e0bcc","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-hslgoe.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E780B27C-E941-4D61-923B-28E3B5149C2A
DEBUG winrmshell: [WinRM] creating command_id: E780B27C-E941-4D61-923B-28E3B5149C2A on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E780B27C-E941-4D61-923B-28E3B5149C2A on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBhIGhhbmRmdWwgb2YgU3lzSW50ZXJuYWxzIHRvb2xzIG9uIHRoZSBob3N0IGludG8gYzpcVG9vbHNcU3lzaW50ZXJuYWxzCiMgQWxzbyBpbnN0YWxscyBTeXNtb24gYW5kIE9sYWYgSGFydG9uJ3MgU3lzbW9uIGNvbmZpZwoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgU3lzSW50ZXJuYWxzIFRvb2xpbmcuLi4iCiRzeXNpbnRlcm5hbHNEaXIgPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzIgokc3lzbW9uRGlyID0gIkM6XFByb2dyYW1EYXRhXFN5c21vbiIKSWYoISh0ZXN0LXBhdGggJHN5c2ludGVybmFsc0RpcikpIHsKICBOZXctSXRlbSAtSXRlbVR5cGUgRGlyZWN0b3J5IC1Gb3JjZSAtUGF0aCAkc3lzaW50ZXJuYWxzRGlyCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFRvb2xzIGRpcmVjdG9yeSBleGlzdHMsIG5vIG5lZWQgdG8gcmUtaW5zdGFsbC4gRXhpdGluZy4iCiAgZXhpdAp9CgpJZighKHRlc3QtcGF0aCAkc3lzbW9uRGlyKSkgewogIE5ldy1JdGVtIC1JdGVtVHlwZSBEaXJlY3RvcnkgLUZvcmNlIC1QYXRoICRzeXNtb25EaXIKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3lzbW9uIGRpcmVjdG9yeSBleGlzdHMsIG5vIG5lZWQgdG8gcmUtaW5zdGFsbC4gRXhpdGluZy4iCiAgZXhpdAp9CgokYXV0b3J1bnNQYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xBdXRvcnVuczY0LmV4ZSIKJHByb2Ntb25QYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xQcm9jbW9uLmV4ZSIKJHBzZXhlY1BhdGggPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzXFBzRXhlYzY0LmV4ZSIKJHByb2NleHBQYXRoID0gIkM6XFRvb2xzXFN5c2ludGVybmFsc1xwcm9jZXhwNjQuZXhlIgokc3lzbW9uUGF0aCA9ICJDOlxUb29sc1xTeXNpbnRlcm5hbHNcU3lzbW9uNjQuZXhlIgokc2RlbGV0ZVBhdGggPSAiQzpcVG9vbHNcU3lzaW50ZXJuYWxzXFNkZWxldGU2NC5leGUiCiR0Y3B2aWV3UGF0aCA9ICJDOlxUb29sc1xTeXNpbnRlcm5hbHNcVGNwdmlldy5leGUiCiRzeXNtb25Db25maWdQYXRoID0gIiRzeXNtb25EaXJcc3lzbW9uQ29uZmlnLnhtbCIKJHNob3J0Y3V0TG9jYXRpb24gPSAiJEVOVjpBTExVU0VSU1BST0ZJTEVcTWljcm9zb2Z0XFdpbmRvd3NcU3RhcnQgTWVudVxQcm9ncmFtc1wiCgokV1NjcmlwdFNoZWxsID0gTmV3LU9iamVjdCAtQ29tT2JqZWN0IFdTY3JpcHQuU2hlbGwKCiMgTWljcm9zb2Z0IGxpa2VzIFRMU3YxLjIgYXMgd2VsbApbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBBdXRvcnVuczY0LmV4ZS4uLiIKVHJ5IHsgCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vQXV0b3J1bnM2NC5leGUnLCAkYXV0b3J1bnNQYXRoKSAKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL0F1dG9ydW5zNjQuZXhlJywgJGF1dG9ydW5zUGF0aCkgCn0KJFNob3J0Y3V0ID0gJFdTY3JpcHRTaGVsbC5DcmVhdGVTaG9ydGN1dCgkU2hvcnRjdXRMb2NhdGlvbiArICJBdXRvcnVucy5sbmsiKQokU2hvcnRjdXQuVGFyZ2V0UGF0aCA9ICRhdXRvcnVuc1BhdGgKJFNob3J0Y3V0LlNhdmUoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIFByb2Ntb24uZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9Qcm9jbW9uLmV4ZScsICRwcm9jbW9uUGF0aCkKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1Byb2Ntb24uZXhlJywgJHByb2Ntb25QYXRoKQp9CiRTaG9ydGN1dCA9ICRXU2NyaXB0U2hlbGwuQ3JlYXRlU2hvcnRjdXQoJFNob3J0Y3V0TG9jYXRpb24gKyAiUHJvY2VzcyBNb25pdG9yLmxuayIpCiRTaG9ydGN1dC5UYXJnZXRQYXRoID0gJHByb2Ntb25QYXRoCiRTaG9ydGN1dC5TYXZlKCkKCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBQc0V4ZWM2NC5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1BzRXhlYzY0LmV4ZScsICRwc2V4ZWNQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vUHNFeGVjNjQuZXhlJywgJHBzZXhlY1BhdGgpCn0KCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBwcm9jZXhwNjQuZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9wcm9jZXhwNjQuZXhlJywgJHByb2NleHBQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vcHJvY2V4cDY0LmV4ZScsICRwcm9jZXhwUGF0aCkKfQokU2hvcnRjdXQgPSAkV1NjcmlwdFNoZWxsLkNyZWF0ZVNob3J0Y3V0KCRTaG9ydGN1dExvY2F0aW9uICsgIlByb2Nlc3MgRXhwbG9yZXIubG5rIikKJFNob3J0Y3V0LlRhcmdldFBhdGggPSAkcHJvY2V4cFBhdGgKJFNob3J0Y3V0LlNhdmUoKQoKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nIHNkZWxldGU2NC5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL3NkZWxldGU2NC5leGUnLCAkc2RlbGV0ZVBhdGgpCn0KQ2F0Y2ggeyAKICBXcml0ZS1Ib3N0ICJIVFRQUyBjb25uZWN0aW9uIGZhaWxlZC4gU3dpdGNoaW5nIHRvIEhUVFAgOigiCiAgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cDovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9zZGVsZXRlNjQuZXhlJywgJHNkZWxldGVQYXRoKQp9CgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgU3lzbW9uNjQuZXhlLi4uIgpUcnkgeyAKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwczovL2xpdmUuc3lzaW50ZXJuYWxzLmNvbS9TeXNtb242NC5leGUnLCAkc3lzbW9uUGF0aCkKfSBDYXRjaCB7IAogIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCdodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1N5c21vbjY0LmV4ZScsICRzeXNtb25QYXRoKQp9CkNvcHktSXRlbSAkc3lzbW9uUGF0aCAkc3lzbW9uRGlyCgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgVGNwdmlldy5leGUuLi4iClRyeSB7IAogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHBzOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL1RjcHZpZXcuZXhlJywgJHRjcHZpZXdQYXRoKQp9IENhdGNoIHsgCiAgV3JpdGUtSG9zdCAiSFRUUFMgY29ubmVjdGlvbiBmYWlsZWQuIFN3aXRjaGluZyB0byBIVFRQIDooIgogIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJ2h0dHA6Ly9saXZlLnN5c2ludGVybmFscy5jb20vVGNwdmlldy5leGUnLCAkdGNwdmlld1BhdGgpCn0KJFNob3J0Y3V0ID0gJFdTY3JpcHRTaGVsbC5DcmVhdGVTaG9ydGN1dCgkU2hvcnRjdXRMb2NhdGlvbiArICJUY3B2aWV3LmxuayIpCiRTaG9ydGN1dC5UYXJnZXRQYXRoID0gJHRjcHZpZXdQYXRoCiRTaG9ydGN1dC5TYXZlKCkKCiMgUmVzdGFydCBFeHBsb3JlciBzbyB0aGUgdGFza2JhciBzaG9ydGN1dHMgc2hvdyB1cAppZiAoR2V0LVByb2Nlc3MgLVByb2Nlc3NOYW1lIGV4cGxvcmVyIC1FcnJvckFjdGlvbiAnc2lsZW50bHljb250aW51ZScpIHsKICBTdG9wLVByb2Nlc3MgLVByb2Nlc3NOYW1lIGV4cGxvcmVyIC1Gb3JjZQp9CgojIERvd25sb2FkIE9sYWYgSGFydG9uZ3MgU3lzbW9uIGNvbmZpZwpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgRG93bmxvYWRpbmcgT2xhZiBIYXJ0b25nJ3MgU3lzbW9uIGNvbmZpZy4uLiIKKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL29sYWZoYXJ0b25nL3N5c21vbi1tb2R1bGFyL21hc3Rlci9zeXNtb25jb25maWcueG1sJywgIiRzeXNtb25Db25maWdQYXRoIikKIyBBbHRlcm5hdGl2ZTogRG93bmxvYWQgU3dpZnRPblNlY3VyaXR5J3MgU3lzbW9uIGNvbmZpZwojIFdyaXRlLUhvc3QgIkRvd25sb2FkaW5nIFN3aWZ0T25TZWN1cml0eSdzIFN5c21vbiBjb25maWcuLi4iCiMgKE5ldy1PYmplY3QgU3lzdGVtLk5ldC5XZWJDbGllbnQpLkRvd25sb2FkRmlsZSgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL1N3aWZ0T25TZWN1cml0eS9zeXNtb24tY29uZmlnL21hc3Rlci9zeXNtb25jb25maWctZXhwb3J0LnhtbCcsICIkc3lzbW9uQ29uZmlnUGF0aCIpCgojIFN0YXJ0IFN5c21vbgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgU3RhcnRpbmcgU3lzbW9uLi4uIgpTdGFydC1Qcm9jZXNzIC1GaWxlUGF0aCAiJHN5c21vbkRpclxTeXNtb242NC5leGUiIC1Bcmd1bWVudExpc3QgIi1hY2NlcHRldWxhIC1pICRzeXNtb25Db25maWdQYXRoIgpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgV2FpdGluZyA1IHNlY29uZHMgdG8gZ2l2ZSB0aGUgc2VydmljZSB0aW1lIHRvIGluc3RhbGwuLi4iClN0YXJ0LVNsZWVwIDUKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFZlcmlmeWluZyB0aGF0IHRoZSBTeXNtb24gc2VydmljZSBpcyBydW5uaW5nLi4uIgoKIyBQb2xsIHRoZSBzeXNtb24gc2VydmljZSBldmVyeSA1IHNlY29uZHMgdG8gc2VlIGlmIGl0IGhhcyBzdGFydGVkICh1cCB0byAyNSBzZWNvbmRzKQokdHJpZXMgPSAxCldoaWxlICgkdHJpZXMgLWx0IDYpIHsKICBJZiAoKEdldC1TZXJ2aWNlIC1uYW1lIFN5c21vbjY0KS5TdGF0dXMgLW5lICJSdW5uaW5nIikgewogICAgV3JpdGUtSG9zdCAiV2FpdGluZyBmb3IgdGhlIFN5c21vbiBzZXJ2aWNlIHRvIHN0YXJ0Li4uIChBdHRlbXB0ICR0cmllcyBvZiA1KSIKICAgIFN0YXJ0LVNsZWVwIDUKICAgICR0cmllcyArPSAxCiAgfSBFbHNlIHsKICAgIFdyaXRlLUhvc3QgIlRoZSBTeXNtb24gc2VydmljZSBoYXMgc3RhcnRlZCBzdWNjZXNzZnVsbHkhIgogICAgYnJlYWsKICB9Cn0KCklmICgoR2V0LVNlcnZpY2UgLW5hbWUgU3lzbW9uNjQpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgdGhyb3cgIlRoZSBTeXNtb24gc2VydmljZSBmYWlsZWQgdG8gc3RhcnQgc3VjY2Vzc2Z1bGx5Igp9CgojIE1ha2UgdGhlIGV2ZW50IGxvZyBjaGFubmVsIHJlYWRhYmxlLiBGb3Igc29tZSByZWFzb24gdGhpcyBkb2Vzbid0IHdvcmsgaW4gdGhlIEdQTyBhbmQgb25seSB3b3JrcyB3aGVuIHJ1biBtYW51YWxseS4Kd2V2dHV0aWwgc2wgTWljcm9zb2Z0LVdpbmRvd3MtU3lzbW9uL09wZXJhdGlvbmFsICIvY2E6TzpCQUc6U1lEOihBOzsweDU7OztCQSkoQTs7MHgxOzs7Uy0xLTUtMjApKEE7OzB4MTs7O1MtMS01LTMyLTU3MykiCg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 407D4660-0928-45DF-9EA8-D1FD8699F433
DEBUG winrmshell: [WinRM] creating command_id: 407D4660-0928-45DF-9EA8-D1FD8699F433 on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 407D4660-0928-45DF-9EA8-D1FD8699F433 on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: EFF38CDB-F66E-4258-81F3-EE8A628CC705
DEBUG winrmshell: [WinRM] creating command_id: EFF38CDB-F66E-4258-81F3-EE8A628CC705 on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EFF38CDB-F66E-4258-81F3-EE8A628CC705 on shell_id 936E3849-FABF-4260-87E9-098CCB99F57C
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-hslgoe.ps1 to C:/tmp/vagrant-shell.ps1 (8.58 KB over 1 chunks) in (0m0.23s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.65s) stream_files: (0m0.23s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-sysinternals.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350e7d408 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350e6ed18 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353265b90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2201801B-42B6-465B-BECE-4AFD53580D1D
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CC74BEE8-5732-401B-A6F0-A8A4DEA937AE
DEBUG winrmshell: [WinRM] creating command_id: CC74BEE8-5732-401B-A6F0-A8A4DEA937AE on shell_id 2201801B-42B6-465B-BECE-4AFD53580D1D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Installing SysInternals Tooling...
 INFO interface: detail:     wef: [02:58] Installing SysInternals Tooling...
    wef: [02:58] Installing SysInternals Tooling...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail:     Directory: C:\Tools
 INFO interface: detail:     wef:     Directory: C:\Tools
    wef:     Directory: C:\Tools
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     wef: Mode                LastWriteTime         Length Name
    wef: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     wef: ----                -------------         ------ ----
    wef: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   2:58 AM                Sysinternals
 INFO interface: detail:     wef: d-----        6/21/2022   2:58 AM                Sysinternals
    wef: d-----        6/21/2022   2:58 AM                Sysinternals
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail:     Directory: C:\ProgramData
 INFO interface: detail:     wef:     Directory: C:\ProgramData
    wef:     Directory: C:\ProgramData
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     wef: Mode                LastWriteTime         Length Name
    wef: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     wef: ----                -------------         ------ ----
    wef: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   2:58 AM                Sysmon
 INFO interface: detail:     wef: d-----        6/21/2022   2:58 AM                Sysmon
    wef: d-----        6/21/2022   2:58 AM                Sysmon
 INFO interface: detail: [02:58] Downloading Autoruns64.exe...
 INFO interface: detail:     wef: [02:58] Downloading Autoruns64.exe...
    wef: [02:58] Downloading Autoruns64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading Procmon.exe...
 INFO interface: detail:     wef: [02:58] Downloading Procmon.exe...
    wef: [02:58] Downloading Procmon.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading PsExec64.exe...
 INFO interface: detail:     wef: [02:58] Downloading PsExec64.exe...
    wef: [02:58] Downloading PsExec64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading procexp64.exe...
 INFO interface: detail:     wef: [02:58] Downloading procexp64.exe...
    wef: [02:58] Downloading procexp64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading sdelete64.exe...
 INFO interface: detail:     wef: [02:58] Downloading sdelete64.exe...
    wef: [02:58] Downloading sdelete64.exe...
 INFO interface: detail: [02:58] Downloading Sysmon64.exe...
 INFO interface: detail:     wef: [02:58] Downloading Sysmon64.exe...
    wef: [02:58] Downloading Sysmon64.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading Tcpview.exe...
 INFO interface: detail:     wef: [02:58] Downloading Tcpview.exe...
    wef: [02:58] Downloading Tcpview.exe...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading Olaf Hartong's Sysmon config...
 INFO interface: detail:     wef: [02:58] Downloading Olaf Hartong's Sysmon config...
    wef: [02:58] Downloading Olaf Hartong's Sysmon config...
 INFO interface: detail: [02:58] Starting Sysmon...
 INFO interface: detail:     wef: [02:58] Starting Sysmon...
    wef: [02:58] Starting Sysmon...
 INFO interface: detail: [02:58] Waiting 5 seconds to give the service time to install...
 INFO interface: detail:     wef: [02:58] Waiting 5 seconds to give the service time to install...
    wef: [02:58] Waiting 5 seconds to give the service time to install...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Verifying that the Sysmon service is running...
 INFO interface: detail:     wef: [02:58] Verifying that the Sysmon service is running...
    wef: [02:58] Verifying that the Sysmon service is running...
 INFO interface: detail: The Sysmon service has started successfully!
 INFO interface: detail:     wef: The Sysmon service has started successfully!
    wef: The Sysmon service has started successfully!
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CC74BEE8-5732-401B-A6F0-A8A4DEA937AE on shell_id 2201801B-42B6-465B-BECE-4AFD53580D1D
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435307e020 @data=[{:stdout=>"[02:58] Installing SysInternals Tooling...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Tools\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   2:58 AM                Sysinternals                                     \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\ProgramData\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   2:58 AM                Sysmon                                           \r\n"}, {:stdout=>"[02:58] Downloading Autoruns64.exe...\r\n"}, {:stdout=>"[02:58] Downloading Procmon.exe...\r\n"}, {:stdout=>"[02:58] Downloading PsExec64.exe...\r\n"}, {:stdout=>"[02:58] Downloading procexp64.exe...\r\n"}, {:stdout=>"[02:58] Downloading sdelete64.exe...\r\n"}, {:stdout=>"[02:58] Downloading Sysmon64.exe...\r\n"}, {:stdout=>"[02:58] Downloading Tcpview.exe...\r\n"}, {:stdout=>"[02:58] Downloading Olaf Hartong's Sysmon config...\r\n"}, {:stdout=>"[02:58] Starting Sysmon...\r\n"}, {:stdout=>"[02:58] Waiting 5 seconds to give the service time to install...\r\n"}, {:stdout=>"[02:58] Verifying that the Sysmon service is running...\r\n"}, {:stdout=>"The Sysmon service has started successfully!\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x000002435330d840 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352a03ee8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2205, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8855A691-511E-4325-A61D-A92ED39F535A
DEBUG winrmshell: [WinRM] Command created for hostname with id: EA432C28-7FD0-4BA8-BD28-CCE2CADA7F91
DEBUG winrmshell: [WinRM] creating command_id: EA432C28-7FD0-4BA8-BD28-CCE2CADA7F91 on shell_id 8855A691-511E-4325-A61D-A92ED39F535A
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: EA432C28-7FD0-4BA8-BD28-CCE2CADA7F91 on shell_id 8855A691-511E-4325-A61D-A92ED39F535A
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435307c928 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2209, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4F9895E3-8C42-493D-8E3D-8159DFCBE2C5
DEBUG winrmshell: [WinRM] Command created for hostname with id: CC17C8DA-6519-4A79-B666-EA868821F4C6
DEBUG winrmshell: [WinRM] creating command_id: CC17C8DA-6519-4A79-B666-EA868821F4C6 on shell_id 4F9895E3-8C42-493D-8E3D-8159DFCBE2C5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CC17C8DA-6519-4A79-B666-EA868821F4C6 on shell_id 4F9895E3-8C42-493D-8E3D-8159DFCBE2C5
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243520a8ba0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2208, 22=>2212}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 817A8BD5-54F0-4160-B9EA-16D7F82DD679
DEBUG winrmshell: [WinRM] Command created for hostname with id: 38DE06AF-C393-4D8B-9ED4-EFF579B33784
DEBUG winrmshell: [WinRM] creating command_id: 38DE06AF-C393-4D8B-9ED4-EFF579B33784 on shell_id 817A8BD5-54F0-4160-B9EA-16D7F82DD679
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 38DE06AF-C393-4D8B-9ED4-EFF579B33784 on shell_id 817A8BD5-54F0-4160-B9EA-16D7F82DD679
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352a78428 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bc61b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bc52e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ac1ba0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DB0D620A-68EA-4238-9446-E77DFFC55E30
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 07AE96FC-C9D1-406E-94B5-D05B62FE1539
DEBUG winrmshell: [WinRM] creating command_id: 07AE96FC-C9D1-406E-94B5-D05B62FE1539 on shell_id DB0D620A-68EA-4238-9446-E77DFFC55E30
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 07AE96FC-C9D1-406E-94B5-D05B62FE1539 on shell_id DB0D620A-68EA-4238-9446-E77DFFC55E30
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243529b2750 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352af9b68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352af8c90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a28798 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 4776DA88-72AA-47CF-B828-CB632E5C5C4F
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CEB98505-4A0A-41CE-AF0D-2CCDA965C667
DEBUG winrmshell: [WinRM] creating command_id: CEB98505-4A0A-41CE-AF0D-2CCDA965C667 on shell_id 4776DA88-72AA-47CF-B828-CB632E5C5C4F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CEB98505-4A0A-41CE-AF0D-2CCDA965C667 on shell_id 4776DA88-72AA-47CF-B828-CB632E5C5C4F
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435249eef8 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-15cs2jb.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352993e90 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352992f68 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352349e40 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "984c644c76a43d97a0e67d77a7ece323b8897b17" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-15cs2jb.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 03A3B8DD-C50F-4BB0-AD2B-42C6AC6BF3AA
DEBUG winrmshell: [WinRM] creating command_id: 03A3B8DD-C50F-4BB0-AD2B-42C6AC6BF3AA on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 03A3B8DD-C50F-4BB0-AD2B-42C6AC6BF3AA on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","984c644c76a43d97a0e67d77a7ece323b8897b17","74ae4687be5f0897ea0e3af4033ec979f9cb4103","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-15cs2jb.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A7F2CD8C-44A5-4D30-BCC1-706BBC40D7D3
DEBUG winrmshell: [WinRM] creating command_id: A7F2CD8C-44A5-4D30-BCC1-706BBC40D7D3 on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A7F2CD8C-44A5-4D30-BCC1-706BBC40D7D3 on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyB2ZWxvY2lyYXB0b3Igb24gdGhlIGhvc3QKCnBhcmFtICgKICBbc3dpdGNoXSRVcGRhdGUKKQoKIyBBZGQgYSBob3N0cyBlbnRyeSB0byBhdm9pZCBETlMgaXNzdWVzCklmIChTZWxlY3QtU3RyaW5nIC1QYXRoICJjOlx3aW5kb3dzXHN5c3RlbTMyXGRyaXZlcnNcZXRjXGhvc3RzIiAtUGF0dGVybiAibG9nZ2VyIikgewogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBIb3N0cyBmaWxlIGFscmVhZHkgdXBkYXRlZC4gTW92aW5nIG9uLiIKfSBFbHNlIHsKICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQWRkaW5nIGxvZ2dlciB0byB0aGUgaG9zdHMgZmlsZSIKICBBZGQtQ29udGVudCAiYzpcd2luZG93c1xzeXN0ZW0zMlxkcml2ZXJzXGV0Y1xob3N0cyIgIiAgICAgICAgMTkyLjE2OC41Ni4xMDUgICAgbG9nZ2VyIgp9CgojIERvd25sb2FkcyBhbmQgaW5zdGFsbCB0aGUgbGF0ZXN0IFZlbG9jaXJhcHRvciByZWxlYXNlCldyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEZXRlcm1pbmluZyBsYXRlc3QgcmVsZWFzZSBvZiBWZWxvY2lyYXB0b3IuLi4iCiMgR2l0SHViIHJlcXVpcmVzIFRMUyAxLjIgYXMgb2YgMi8yNwpbTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZWN1cml0eVByb3RvY29sID0gW05ldC5TZWN1cml0eVByb3RvY29sVHlwZV06OlRsczEyCiMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKJHZlbG9jaXJhcHRvckRvd25sb2FkVXJsID0gImh0dHBzOi8vZ2l0aHViLmNvbSIgKyAoKEludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2dpdGh1Yi5jb20vVmVsb2NpZGV4L3ZlbG9jaXJhcHRvci9yZWxlYXNlcy9sYXRlc3QiIC1Vc2VCYXNpY1BhcnNpbmcpLmxpbmtzIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgaHJlZiB8IFNlbGVjdC1TdHJpbmcgIndpbmRvd3MtYW1kNjQubXNpJCIgfCBTZWxlY3QtT2JqZWN0IC1GaXJzdCAxKQokdmVsb2NpcmFwdG9yTVNJUGF0aCA9ICdDOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx2ZWxvY2lyYXB0b3IubXNpJwokdmVsb2NpcmFwdG9yTG9nRmlsZSA9ICdjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx2ZWxvY2lyYXB0b3JfaW5zdGFsbC5sb2cnCklmICgtbm90KFRlc3QtUGF0aCAkdmVsb2NpcmFwdG9yTG9nRmlsZSkgLW9yICgkVXBkYXRlIC1lcSAkdHJ1ZSkpIHsKICBpZiAoJFVwZGF0ZSAtZXEgJHRydWUpIHsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBUaGUgdXBkYXRlIGZsYWcgd2FzIHNldC4gQXR0ZW1wdGluZyB0byB1cGRhdGUuLi4iCiAgfQogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBEb3dubG9hZGluZyBWZWxvY2lyYXB0b3IuLi4iCiAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiJHZlbG9jaXJhcHRvckRvd25sb2FkVXJsIiAtT3V0RmlsZSAkdmVsb2NpcmFwdG9yTVNJUGF0aAogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBJbnN0YWxsaW5nIFZlbG9jaXJhcHRvci4uLiIKICBTdGFydC1Qcm9jZXNzIEM6XFdpbmRvd3NcU3lzdGVtMzJcbXNpZXhlYy5leGUgLUFyZ3VtZW50TGlzdCAiL2kgJHZlbG9jaXJhcHRvck1TSVBhdGggL3F1aWV0IC9xbiAvbm9yZXN0YXJ0IC9sb2cgJHZlbG9jaXJhcHRvckxvZ0ZpbGUiIC13YWl0CiAgQ29weS1JdGVtICJjOlx2YWdyYW50XHJlc291cmNlc1x2ZWxvY2lyYXB0b3JcVmVsb2NpcmFwdG9yLmNvbmZpZy55YW1sIiAiQzpcUHJvZ3JhbSBGaWxlc1xWZWxvY2lyYXB0b3IiCiAgUmVzdGFydC1TZXJ2aWNlIFZlbG9jaXJhcHRvcgogIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBWZWxvY2lyYXB0b3Igc3VjY2Vzc2Z1bGx5IGluc3RhbGxlZCEiCn0gRWxzZSB7CiAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFZlbG9jaXJhcHRvciB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0KSWYgKChHZXQtU2VydmljZSAtbmFtZSBWZWxvY2lyYXB0b3IpLlN0YXR1cyAtbmUgIlJ1bm5pbmciKQp7CiAgVGhyb3cgIlZlbG9jaXJhcHRvciBzZXJ2aWNlIGlzIG5vdCBydW5uaW5nIgp9CgoK')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 0F0C8C95-2FBC-4023-B0EE-7DECF1F7052A
DEBUG winrmshell: [WinRM] creating command_id: 0F0C8C95-2FBC-4023-B0EE-7DECF1F7052A on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0F0C8C95-2FBC-4023-B0EE-7DECF1F7052A on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A7494B88-E339-4EED-BAC9-E37498503440
DEBUG winrmshell: [WinRM] creating command_id: A7494B88-E339-4EED-BAC9-E37498503440 on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A7494B88-E339-4EED-BAC9-E37498503440 on shell_id A3B383A1-3B4C-4A6F-8AA6-13A0A42EB62B
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-15cs2jb.ps1 to C:/tmp/vagrant-shell.ps1 (3.044 KB over 1 chunks) in (0m0.17s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.61s) stream_files: (0m0.17s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-velociraptor.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524df390 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524dd450 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352241980 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 45EDF2C8-9436-4B46-9483-09A23F309291
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E228C6EC-B6B0-4886-8D43-473B7798F8F5
DEBUG winrmshell: [WinRM] creating command_id: E228C6EC-B6B0-4886-8D43-473B7798F8F5 on shell_id 45EDF2C8-9436-4B46-9483-09A23F309291
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Adding logger to the hosts file
 INFO interface: detail:     wef: [02:58] Adding logger to the hosts file
    wef: [02:58] Adding logger to the hosts file
 INFO interface: detail: [02:58] Determining latest release of Velociraptor...
 INFO interface: detail:     wef: [02:58] Determining latest release of Velociraptor...
    wef: [02:58] Determining latest release of Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Downloading Velociraptor...
 INFO interface: detail:     wef: [02:58] Downloading Velociraptor...
    wef: [02:58] Downloading Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Installing Velociraptor...
 INFO interface: detail:     wef: [02:58] Installing Velociraptor...
    wef: [02:58] Installing Velociraptor...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Velociraptor successfully installed!
 INFO interface: detail:     wef: [02:58] Velociraptor successfully installed!
    wef: [02:58] Velociraptor successfully installed!
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E228C6EC-B6B0-4886-8D43-473B7798F8F5 on shell_id 45EDF2C8-9436-4B46-9483-09A23F309291
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435083fe38 @data=[{:stdout=>"[02:58] Adding logger to the hosts file\r\n"}, {:stdout=>"[02:58] Determining latest release of Velociraptor...\r\n"}, {:stdout=>"[02:58] Downloading Velociraptor...\r\n"}, {:stdout=>"[02:58] Installing Velociraptor...\r\n"}, {:stdout=>"[02:58] Velociraptor successfully installed!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352a03ee8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x00000243524ade80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 5985=>2204, 22=>2212}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 7A94FD17-8316-4E60-9938-EFC8955FA8CC
DEBUG winrmshell: [WinRM] Command created for hostname with id: 38177F91-F435-441F-83E1-C5DBC547685C
DEBUG winrmshell: [WinRM] creating command_id: 38177F91-F435-441F-83E1-C5DBC547685C on shell_id 7A94FD17-8316-4E60-9938-EFC8955FA8CC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 38177F91-F435-441F-83E1-C5DBC547685C on shell_id 7A94FD17-8316-4E60-9938-EFC8955FA8CC
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f58c40 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2204, 5986=>2205, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: A94B8220-6D46-45C8-B4D6-CDD2624388F1
DEBUG winrmshell: [WinRM] Command created for hostname with id: F2AA7140-A33F-451B-B576-C38FDFCD48DC
DEBUG winrmshell: [WinRM] creating command_id: F2AA7140-A33F-451B-B576-C38FDFCD48DC on shell_id A94B8220-6D46-45C8-B4D6-CDD2624388F1
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: F2AA7140-A33F-451B-B576-C38FDFCD48DC on shell_id A94B8220-6D46-45C8-B4D6-CDD2624388F1
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243532fcdd8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2204, 22=>2206, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 8F68547E-CB79-4DCD-845F-88E84CDA90AD
DEBUG winrmshell: [WinRM] Command created for hostname with id: BC73ACC5-B932-4BDA-87EB-14C7F87CD372
DEBUG winrmshell: [WinRM] creating command_id: BC73ACC5-B932-4BDA-87EB-14C7F87CD372 on shell_id 8F68547E-CB79-4DCD-845F-88E84CDA90AD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BC73ACC5-B932-4BDA-87EB-14C7F87CD372 on shell_id 8F68547E-CB79-4DCD-845F-88E84CDA90AD
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243524c4b30 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a726b8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a70cc8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243525667f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 20CCC766-5BA3-44F3-BAE0-8D66890DED83
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: CED196DC-E68A-430F-899E-CEAF4B814E5E
DEBUG winrmshell: [WinRM] creating command_id: CED196DC-E68A-430F-899E-CEAF4B814E5E on shell_id 20CCC766-5BA3-44F3-BAE0-8D66890DED83
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CED196DC-E68A-430F-899E-CEAF4B814E5E on shell_id 20CCC766-5BA3-44F3-BAE0-8D66890DED83
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435226b668 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352991910 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352990560 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435232b120 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 239D4E64-2B14-413F-B111-B1BB4F19092D
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6C905678-0409-4AFC-81D0-6CA306BC57BA
DEBUG winrmshell: [WinRM] creating command_id: 6C905678-0409-4AFC-81D0-6CA306BC57BA on shell_id 239D4E64-2B14-413F-B111-B1BB4F19092D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6C905678-0409-4AFC-81D0-6CA306BC57BA on shell_id 239D4E64-2B14-413F-B111-B1BB4F19092D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024350f380a0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-qsrao6.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024351fecd10 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024351fd53e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243532fc888 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "4698c90d03873bc1ed055195518d53ef05c64780" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-qsrao6.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E7212D25-C098-449C-AC43-F79A0C902B82
DEBUG winrmshell: [WinRM] creating command_id: E7212D25-C098-449C-AC43-F79A0C902B82 on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E7212D25-C098-449C-AC43-F79A0C902B82 on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","4698c90d03873bc1ed055195518d53ef05c64780","984c644c76a43d97a0e67d77a7ece323b8897b17","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-qsrao6.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 8FA448E6-3844-42FD-8CB8-C22097E6765A
DEBUG winrmshell: [WinRM] creating command_id: 8FA448E6-3844-42FD-8CB8-C22097E6765A on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 8FA448E6-3844-42FD-8CB8-C22097E6765A on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBDb25maWd1cmUgYW4gU01CIHNoYXJlIGZvciBQb3dlcnNoZWxsIHRyYW5zY3JpcHRpb24gbG9ncyB0byBiZSB3cml0dGVuIHRvCiMgU291cmNlOiBodHRwczovL2Jsb2dzLm1zZG4ubWljcm9zb2Z0LmNvbS9wb3dlcnNoZWxsLzIwMTUvMDYvMDkvcG93ZXJzaGVsbC10aGUtYmx1ZS10ZWFtLwpXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQ29uZmlndXJpbmcgdGhlIFBvd2Vyc2hlbGwgVHJhbnNjcmlwdHMgU2hhcmUiCklmICgtbm90IChUZXN0LVBhdGggYzpccHNsb2dzKSkKewogICAgbWQgYzpccHNsb2dzCn0KCgojIyBLaWxsIGFsbCBpbmhlcml0ZWQgcGVybWlzc2lvbnMKJGFjbCA9IEdldC1BY2wgYzpccHNsb2dzCiRhY2wuU2V0QWNjZXNzUnVsZVByb3RlY3Rpb24oJHRydWUsICRmYWxzZSkKCgojIyBHcmFudCBBZG1pbmlzdHJhdG9ycyBmdWxsIGNvbnRyb2wKJGFkbWluaXN0cmF0b3JzID0gW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuTlRBY2NvdW50XSAiQWRtaW5pc3RyYXRvcnMiCiRwZXJtaXNzaW9uID0gJGFkbWluaXN0cmF0b3JzLCJGdWxsQ29udHJvbCIsIk9iamVjdEluaGVyaXQsQ29udGFpbmVySW5oZXJpdCIsIk5vbmUiLCJBbGxvdyIKJGFjY2Vzc1J1bGUgPSBOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5BY2Nlc3NDb250cm9sLkZpbGVTeXN0ZW1BY2Nlc3NSdWxlICRwZXJtaXNzaW9uCiRhY2wuQWRkQWNjZXNzUnVsZSgkYWNjZXNzUnVsZSkKCgojIyBHcmFudCBldmVyeW9uZSBlbHNlIFdyaXRlIGFuZCBSZWFkQXR0cmlidXRlcy4gVGhpcyBwcmV2ZW50cyB1c2VycyBmcm9tIGxpc3RpbmcKIyMgdHJhbnNjcmlwdHMgZnJvbSBvdGhlciBtYWNoaW5lcyBvbiB0aGUgZG9tYWluLgokZXZlcnlvbmUgPSBbU3lzdGVtLlNlY3VyaXR5LlByaW5jaXBhbC5OVEFjY291bnRdICJFdmVyeW9uZSIKJHBlcm1pc3Npb24gPSAkZXZlcnlvbmUsIldyaXRlLFJlYWRBdHRyaWJ1dGVzIiwiT2JqZWN0SW5oZXJpdCxDb250YWluZXJJbmhlcml0IiwiTm9uZSIsIkFsbG93IgokYWNjZXNzUnVsZSA9IE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2wuRmlsZVN5c3RlbUFjY2Vzc1J1bGUgJHBlcm1pc3Npb24KJGFjbC5BZGRBY2Nlc3NSdWxlKCRhY2Nlc3NSdWxlKQoKIyMgVE9ETzogTGVhdmluZyB0aGlzIGNvbW1lbnRlZCBvdXQgc28gU3BsdW5rIEZvcndhZGVyIGNhbiByZWFkIHRoZXNlIGZpbGVzCiMjIE1pZ2h0IGJlIGEgd2F5IHRvIGxlYXZlIHRoaXMgcGVybWlzc2lvbiBpbnRhY3QgYnV0IHN0aWxsIGFsbG93IFNwbHVuawojIyBEZW55ICJDcmVhdG9yIE93bmVyIiBldmVyeXRoaW5nLiBUaGlzIHByZXZlbnRzIHVzZXJzIGZyb20KIyMgdmlld2luZyB0aGUgY29udGVudCBvZiBwcmV2aW91c2x5IHdyaXR0ZW4gZmlsZXMuCiMkY3JlYXRvck93bmVyID0gW1N5c3RlbS5TZWN1cml0eS5QcmluY2lwYWwuTlRBY2NvdW50XSAiQ3JlYXRvciBPd25lciIKIyRwZXJtaXNzaW9uID0gJGNyZWF0b3JPd25lciwiRnVsbENvbnRyb2wiLCJPYmplY3RJbmhlcml0LENvbnRhaW5lckluaGVyaXQiLCJJbmhlcml0T25seSIsIkRlbnkiCiMkYWNjZXNzUnVsZSA9IE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LkFjY2Vzc0NvbnRyb2wuRmlsZVN5c3RlbUFjY2Vzc1J1bGUgJHBlcm1pc3Npb24KIyRhY2wuQWRkQWNjZXNzUnVsZSgkYWNjZXNzUnVsZSkKCgojIyBTZXQgdGhlIEFDTAokYWNsIHwgU2V0LUFjbCBjOlxwc2xvZ3NcCgoKIyMgQ3JlYXRlIHRoZSBTTUIgU2hhcmUsIGdyYW50aW5nIEV2ZXJ5b25lIHRoZSByaWdodCB0byByZWFkIGFuZCB3cml0ZSBmaWxlcy4gU3BlY2lmaWMKIyMgYWN0aW9ucyB3aWxsIGFjdHVhbGx5IGJlIGVuZm9yY2VkIGJ5IHRoZSBBQ0wgb24gdGhlIGZpbGUgZm9sZGVyLgppZiAoKEdldC1TbWJTaGFyZSAtTmFtZSBwc2xvZ3MgLWVhIHNpbGVudCkgLWVxICRudWxsKQp7CiAgICBOZXctU21iU2hhcmUgLU5hbWUgcHNsb2dzIC1QYXRoIGM6XHBzbG9ncyAtQ2hhbmdlQWNjZXNzIEV2ZXJ5b25lCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 86DD335E-70BB-470A-A378-4D80D72FAEC5
DEBUG winrmshell: [WinRM] creating command_id: 86DD335E-70BB-470A-A378-4D80D72FAEC5 on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 86DD335E-70BB-470A-A378-4D80D72FAEC5 on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DC20520D-52AD-4FA2-8531-1DD4C66BE50D
DEBUG winrmshell: [WinRM] creating command_id: DC20520D-52AD-4FA2-8531-1DD4C66BE50D on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DC20520D-52AD-4FA2-8531-1DD4C66BE50D on shell_id 205A37B7-A03C-45E2-9A56-D27CEB1E1DED
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-qsrao6.ps1 to C:/tmp/vagrant-shell.ps1 (2.716 KB over 1 chunks) in (0m0.23s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.72s) stream_files: (0m0.23s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/configure-pslogstranscriptsshare.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/configure-pslogstranscriptsshare.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/configure-pslogstranscriptsshare.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435332d0f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353327268 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024353181238 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5D1C4D55-DC5E-4CD4-8DDA-EEE9BC353FBC
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D4E4074E-0489-4760-BD16-C69C315F736A
DEBUG winrmshell: [WinRM] creating command_id: D4E4074E-0489-4760-BD16-C69C315F736A on shell_id 5D1C4D55-DC5E-4CD4-8DDA-EEE9BC353FBC
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:58] Configuring the Powershell Transcripts Share
 INFO interface: detail:     wef: [02:58] Configuring the Powershell Transcripts Share
    wef: [02:58] Configuring the Powershell Transcripts Share
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail:     Directory: C:\
 INFO interface: detail:     wef:     Directory: C:\
    wef:     Directory: C:\
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     wef: Mode                LastWriteTime         Length Name
    wef: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     wef: ----                -------------         ------ ----
    wef: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   2:58 AM                pslogs
 INFO interface: detail:     wef: d-----        6/21/2022   2:58 AM                pslogs
    wef: d-----        6/21/2022   2:58 AM                pslogs
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: AvailabilityType      : NonClustered
 INFO interface: detail:     wef: AvailabilityType      : NonClustered
    wef: AvailabilityType      : NonClustered
 INFO interface: detail: CachingMode           : Manual
 INFO interface: detail:     wef: CachingMode           : Manual
    wef: CachingMode           : Manual
 INFO interface: detail: CATimeout             : 0
 INFO interface: detail:     wef: CATimeout             : 0
    wef: CATimeout             : 0
 INFO interface: detail: ConcurrentUserLimit   : 0
 INFO interface: detail:     wef: ConcurrentUserLimit   : 0
    wef: ConcurrentUserLimit   : 0
 INFO interface: detail: ContinuouslyAvailable : False
 INFO interface: detail:     wef: ContinuouslyAvailable : False
    wef: ContinuouslyAvailable : False
 INFO interface: detail: CurrentUsers          : 0
 INFO interface: detail:     wef: CurrentUsers          : 0
    wef: CurrentUsers          : 0
 INFO interface: detail: Description           :
 INFO interface: detail:     wef: Description           :
    wef: Description           :
 INFO interface: detail: EncryptData           : False
 INFO interface: detail:     wef: EncryptData           : False
    wef: EncryptData           : False
 INFO interface: detail: FolderEnumerationMode : Unrestricted
 INFO interface: detail:     wef: FolderEnumerationMode : Unrestricted
    wef: FolderEnumerationMode : Unrestricted
 INFO interface: detail: Name                  : pslogs
 INFO interface: detail:     wef: Name                  : pslogs
    wef: Name                  : pslogs
 INFO interface: detail: Path                  : c:\pslogs
 INFO interface: detail:     wef: Path                  : c:\pslogs
    wef: Path                  : c:\pslogs
 INFO interface: detail: Scoped                : False
 INFO interface: detail:     wef: Scoped                : False
    wef: Scoped                : False
 INFO interface: detail: ScopeName             : *
 INFO interface: detail:     wef: ScopeName             : *
    wef: ScopeName             : *
 INFO interface: detail: SecurityDescriptor    : O:SYG:SYD:(A;;0x1301bf;;;WD)
 INFO interface: detail:     wef: SecurityDescriptor    : O:SYG:SYD:(A;;0x1301bf;;;WD)
    wef: SecurityDescriptor    : O:SYG:SYD:(A;;0x1301bf;;;WD)
 INFO interface: detail: ShadowCopy            : False
 INFO interface: detail:     wef: ShadowCopy            : False
    wef: ShadowCopy            : False
 INFO interface: detail: ShareState            : Online
 INFO interface: detail:     wef: ShareState            : Online
    wef: ShareState            : Online
 INFO interface: detail: ShareType             : FileSystemDirectory
 INFO interface: detail:     wef: ShareType             : FileSystemDirectory
    wef: ShareType             : FileSystemDirectory
 INFO interface: detail: SmbInstance           : Default
 INFO interface: detail:     wef: SmbInstance           : Default
    wef: SmbInstance           : Default
 INFO interface: detail: Special               : False
 INFO interface: detail:     wef: Special               : False
    wef: Special               : False
 INFO interface: detail: Temporary             : False
 INFO interface: detail:     wef: Temporary             : False
    wef: Temporary             : False
 INFO interface: detail: Volume                : \\?\Volume{f025ccc7-0000-0000-0000-f01500000000}\
 INFO interface: detail:     wef: Volume                : \\?\Volume{f025ccc7-0000-0000-0000-f01500000000}\
    wef: Volume                : \\?\Volume{f025ccc7-0000-0000-0000-f01500000000}\
 INFO interface: detail: PSComputerName        :
 INFO interface: detail:     wef: PSComputerName        :
    wef: PSComputerName        :
 INFO interface: detail: PresetPathAcl         : System.Security.AccessControl.DirectorySecurity
 INFO interface: detail:     wef: PresetPathAcl         : System.Security.AccessControl.DirectorySecurity
    wef: PresetPathAcl         : System.Security.AccessControl.DirectorySecurity
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] cleaning up command_id: D4E4074E-0489-4760-BD16-C69C315F736A on shell_id 5D1C4D55-DC5E-4CD4-8DDA-EEE9BC353FBC
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352fdb0a0 @data=[{:stdout=>"[02:58] Configuring the Powershell Transcripts Share\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   2:58 AM                pslogs                                           \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"AvailabilityType      : NonClustered\r\n"}, {:stdout=>"CachingMode           : Manual\r\n"}, {:stdout=>"CATimeout             : 0\r\n"}, {:stdout=>"ConcurrentUserLimit   : 0\r\n"}, {:stdout=>"ContinuouslyAvailable : False\r\n"}, {:stdout=>"CurrentUsers          : 0\r\n"}, {:stdout=>"Description           : \r\n"}, {:stdout=>"EncryptData           : False\r\n"}, {:stdout=>"FolderEnumerationMode : Unrestricted\r\n"}, {:stdout=>"Name                  : pslogs\r\n"}, {:stdout=>"Path                  : c:\\pslogs\r\n"}, {:stdout=>"Scoped                : False\r\n"}, {:stdout=>"ScopeName             : *\r\n"}, {:stdout=>"SecurityDescriptor    : O:SYG:SYD:(A;;0x1301bf;;;WD)\r\n"}, {:stdout=>"ShadowCopy            : False\r\n"}, {:stdout=>"ShareState            : Online\r\n"}, {:stdout=>"ShareType             : FileSystemDirectory\r\n"}, {:stdout=>"SmbInstance           : Default\r\n"}, {:stdout=>"Special               : False\r\n"}, {:stdout=>"Temporary             : False\r\n"}, {:stdout=>"Volume                : \\\\?\\Volume{f025ccc7-0000-0000-0000-f01500000000}\\\r\n"}, {:stdout=>"PSComputerName        : \r\n"}, {:stdout=>"PresetPathAcl         : System.Security.AccessControl.DirectorySecurity\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x00000243524ade80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x00000243530d6ec8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2212, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3165D7FE-62E1-4CCB-B3A7-90B51E50C00B
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0B13A9B8-5D6D-40C0-881F-BA40CE3D0D85
DEBUG winrmshell: [WinRM] creating command_id: 0B13A9B8-5D6D-40C0-881F-BA40CE3D0D85 on shell_id 3165D7FE-62E1-4CCB-B3A7-90B51E50C00B
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0B13A9B8-5D6D-40C0-881F-BA40CE3D0D85 on shell_id 3165D7FE-62E1-4CCB-B3A7-90B51E50C00B
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ad0d58 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 22=>2212, 5985=>2204}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3E9CE152-B19D-49D3-9FA9-0F417B0347A0
DEBUG winrmshell: [WinRM] Command created for hostname with id: 18675120-8585-4A00-AF29-ED28B147B201
DEBUG winrmshell: [WinRM] creating command_id: 18675120-8585-4A00-AF29-ED28B147B201 on shell_id 3E9CE152-B19D-49D3-9FA9-0F417B0347A0
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 18675120-8585-4A00-AF29-ED28B147B201 on shell_id 3E9CE152-B19D-49D3-9FA9-0F417B0347A0
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435251f530 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F1B2C2E5-BBE4-4897-98D7-3BF4075AE7E3
DEBUG winrmshell: [WinRM] Command created for hostname with id: C5C36189-BB63-491C-9976-80065F0F372D
DEBUG winrmshell: [WinRM] creating command_id: C5C36189-BB63-491C-9976-80065F0F372D on shell_id F1B2C2E5-BBE4-4897-98D7-3BF4075AE7E3
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C5C36189-BB63-491C-9976-80065F0F372D on shell_id F1B2C2E5-BBE4-4897-98D7-3BF4075AE7E3
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243530d70f8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524dfa98 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524ddd10 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435230bdc0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: B04256C1-7464-41F1-80CB-EAA4C2B87D44
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C15846E2-91E3-4824-B3E9-4A6BB6022F85
DEBUG winrmshell: [WinRM] creating command_id: C15846E2-91E3-4824-B3E9-4A6BB6022F85 on shell_id B04256C1-7464-41F1-80CB-EAA4C2B87D44
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C15846E2-91E3-4824-B3E9-4A6BB6022F85 on shell_id B04256C1-7464-41F1-80CB-EAA4C2B87D44
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024351f61a58 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b004e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352afb5d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a72ac8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C99DF74D-3CBD-4924-8C20-7DFA84B0A4EF
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 148F33C7-8A9D-40C8-AAA4-0F4852903DFB
DEBUG winrmshell: [WinRM] creating command_id: 148F33C7-8A9D-40C8-AAA4-0F4852903DFB on shell_id C99DF74D-3CBD-4924-8C20-7DFA84B0A4EF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 148F33C7-8A9D-40C8-AAA4-0F4852903DFB on shell_id C99DF74D-3CBD-4924-8C20-7DFA84B0A4EF
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243529c88c0 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-13qoq19.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c8fbd0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c8ed48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bdf910 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "04b00952985c8555d76eb259f2adab5966222b80" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-13qoq19.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5BFE1F21-0D83-4DB0-A1F5-A7CBA09CE9EF
DEBUG winrmshell: [WinRM] creating command_id: 5BFE1F21-0D83-4DB0-A1F5-A7CBA09CE9EF on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5BFE1F21-0D83-4DB0-A1F5-A7CBA09CE9EF on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","04b00952985c8555d76eb259f2adab5966222b80","4698c90d03873bc1ed055195518d53ef05c64780","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-13qoq19.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 52924B01-33E7-4C30-AACB-2E3C96C9FB0F
DEBUG winrmshell: [WinRM] creating command_id: 52924B01-33E7-4C30-AACB-2E3C96C9FB0F on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 52924B01-33E7-4C30-AACB-2E3C96C9FB0F on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBJbnN0YWxscyBBdXRvcnVuc1RvV2luRXZlbnRMb2cgZnJvbSB0aGUgUGFsYW50aXIgV0VGIHJlcG86IChodHRwczovL2dpdGh1Yi5jb20vcGFsYW50aXIvd2luZG93cy1ldmVudC1mb3J3YXJkaW5nL3RyZWUvbWFzdGVyL0F1dG9ydW5zVG9XaW5FdmVudExvZykKIyBUTDtEUiAtIExvZ3MgYWxsIGVudHJpZXMgZnJvbSBBdXRvcnVucyB0byB0aGUgV2luZG93cyBldmVudCBsb2cgdG8gYmUgaW5kZXhlZCBieSBTcGx1bmsKV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIEluc3RhbGxpbmcgQXV0b3J1bnNUb1dpbkV2ZW50TG9nLi4uIgpJZiAoKEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIiAtZWEgc2lsZW50KSAtZXEgJG51bGwpCnsKICAgICMgTW9kaWZ5IHRoZSBpbnN0YWxsZXIgdG8gYWRkIGFuIEhUVFAgZmFsbGJhY2sgdW50aWwgdGhpcyBnZXRzIGZpeGVkIHVwc3RyZWFtIGluIHRoZSB3aW5kb3dzLWV2ZW50LWZvd2FyZGluZyByZXBvCiAgICAjIFNlZSBodHRwczovL2dpdGh1Yi5jb20vY2xvbmcvRGV0ZWN0aW9uTGFiL2lzc3Vlcy81OTcKICAgIChHZXQtQ29udGVudCBjOlxVc2Vyc1x2YWdyYW50XEFwcERhdGFcTG9jYWxcVGVtcFx3aW5kb3dzLWV2ZW50LWZvcndhcmRpbmctbWFzdGVyXEF1dG9ydW5zVG9XaW5FdmVudExvZ1xJbnN0YWxsLnBzMSAtUmF3KSAtcmVwbGFjZSAnSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAiaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vYXV0b3J1bnNjNjQuZXhlIiAtT3V0RmlsZSAiXCRhdXRvcnVuc1BhdGgiJywgJ1RyeSB7CiAgICAoTmV3LU9iamVjdCBTeXN0ZW0uTmV0LldlYkNsaWVudCkuRG93bmxvYWRGaWxlKCcnaHR0cHM6Ly9saXZlLnN5c2ludGVybmFscy5jb20vQXV0b3J1bnM2NC5leGUnJywgJGF1dG9ydW5zUGF0aCkKICB9IENhdGNoIHsKICAgIFdyaXRlLUhvc3QgIkhUVFBTIGNvbm5lY3Rpb24gZmFpbGVkLiBTd2l0Y2hpbmcgdG8gSFRUUCA6KCIKICAgIChOZXctT2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJydodHRwOi8vbGl2ZS5zeXNpbnRlcm5hbHMuY29tL0F1dG9ydW5zNjQuZXhlJycsICRhdXRvcnVuc1BhdGgpCiAgfScgfCBTZXQtQ29udGVudCAtUGF0aCAiYzpcVXNlcnNcdmFncmFudFxBcHBEYXRhXExvY2FsXFRlbXBcd2luZG93cy1ldmVudC1mb3J3YXJkaW5nLW1hc3RlclxBdXRvcnVuc1RvV2luRXZlbnRMb2dcSW5zdGFsbC5wczEiCiAgICAuIGM6XFVzZXJzXHZhZ3JhbnRcQXBwRGF0YVxMb2NhbFxUZW1wXHdpbmRvd3MtZXZlbnQtZm9yd2FyZGluZy1tYXN0ZXJcQXV0b3J1bnNUb1dpbkV2ZW50TG9nXEluc3RhbGwucHMxCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgQXV0b3J1bnNUb1dpbkV2ZW50TG9nIGluc3RhbGxlZC4gU3RhcnRpbmcgdGhlIHNjaGVkdWxlZCB0YXNrLiBGdXR1cmUgcnVucyB3aWxsIGJlZ2luIGF0IDExYW0iCiAgICBTdGFydC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIgogICAgIyBodHRwczovL21jcG1hZy5jb20vYXJ0aWNsZXMvMjAxOC8wMy8xNi93YWl0LWFjdGlvbi1mdW5jdGlvbi1wb3dlcnNoZWxsLmFzcHgKICAgICMgV2FpdCAzMCBzZWNvbmRzIGZvciB0aGUgc2NoZWR1bGVkIHRhc2sgdG8gZW50ZXIgdGhlICJSdW5uaW5nIiBzdGF0ZQogICAgJFRpbWVvdXQgPSAzMAogICAgJHRpbWVyID0gW0RpYWdub3N0aWNzLlN0b3B3YXRjaF06OlN0YXJ0TmV3KCkKICAgIHdoaWxlICgoJHRpbWVyLkVsYXBzZWQuVG90YWxTZWNvbmRzIC1sdCAkVGltZW91dCkgLWFuZCAoKEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIikuU3RhdGUgLW5lICJSdW5uaW5nIikpIHsKICAgICAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAzCiAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFN0aWxsIHdhaXRpbmcgZm9yIHNjaGVkdWxlZCB0YXNrIHRvIHN0YXJ0IGFmdGVyICIkdGltZXIuRWxhcHNlZC5TZWNvbmRzIiBzZWNvbmRzLi4uIgogICAgfQogICAgJHRpbWVyLlN0b3AoKQogICAgJFRzayA9IEdldC1TY2hlZHVsZWRUYXNrIC1UYXNrTmFtZSAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIgogICAgaWYgKCRUc2suU3RhdGUgLW5lICJSdW5uaW5nIikKICAgIHsKICAgICAgICB0aHJvdyAiQXV0b3J1bnNUb1dpbkV2ZW50TG9nIHNjaGVkdWxlZCB0YXNrcyB3YXNuJ3QgcnVubmluZyBhZnRlciBzdGFydGluZyBpdCIKICAgIH0KfQplbHNlCnsKICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBBdXRvcnVuc1RvV2luRXZlbnRMb2cgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCn0K')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: D1733CD1-59BB-4B36-BC2B-93C93F3CEA33
DEBUG winrmshell: [WinRM] creating command_id: D1733CD1-59BB-4B36-BC2B-93C93F3CEA33 on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: D1733CD1-59BB-4B36-BC2B-93C93F3CEA33 on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DA436E00-8010-4D8E-B5FB-EAC4E4B487E9
DEBUG winrmshell: [WinRM] creating command_id: DA436E00-8010-4D8E-B5FB-EAC4E4B487E9 on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DA436E00-8010-4D8E-B5FB-EAC4E4B487E9 on shell_id F5DC2C1D-4D8F-43E4-8432-D0E26631C6AE
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-13qoq19.ps1 to C:/tmp/vagrant-shell.ps1 (3.24 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.55s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-autorunstowineventlog.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243520b2088 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243520a8a60 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243508babb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 6007EC45-D31D-40CE-B6CF-33693DCDE556
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 03E2B418-C0EC-4262-8167-526811185038
DEBUG winrmshell: [WinRM] creating command_id: 03E2B418-C0EC-4262-8167-526811185038 on shell_id 6007EC45-D31D-40CE-B6CF-33693DCDE556
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:59] Installing AutorunsToWinEventLog...
 INFO interface: detail:     wef: [02:59] Installing AutorunsToWinEventLog...
    wef: [02:59] Installing AutorunsToWinEventLog...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail:     Directory: C:\Program Files
 INFO interface: detail:     wef:     Directory: C:\Program Files
    wef:     Directory: C:\Program Files
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Mode                LastWriteTime         Length Name
 INFO interface: detail:     wef: Mode                LastWriteTime         Length Name
    wef: Mode                LastWriteTime         Length Name
 INFO interface: detail: ----                -------------         ------ ----
 INFO interface: detail:     wef: ----                -------------         ------ ----
    wef: ----                -------------         ------ ----
 INFO interface: detail: d-----        6/21/2022   2:59 AM                AutorunsToWinEventLog
 INFO interface: detail:     wef: d-----        6/21/2022   2:59 AM                AutorunsToWinEventLog
    wef: d-----        6/21/2022   2:59 AM                AutorunsToWinEventLog
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail:     wef: Actions            : {MSFT_TaskExecAction}
    wef: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail: Author             :
 INFO interface: detail:     wef: Author             :
    wef: Author             :
 INFO interface: detail: Date               :
 INFO interface: detail:     wef: Date               :
    wef: Date               :
 INFO interface: detail: Description        :
 INFO interface: detail:     wef: Description        :
    wef: Description        :
 INFO interface: detail: Documentation      :
 INFO interface: detail:     wef: Documentation      :
    wef: Documentation      :
 INFO interface: detail: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail:     wef: Principal          : MSFT_TaskPrincipal2
    wef: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail: SecurityDescriptor :
 INFO interface: detail:     wef: SecurityDescriptor :
    wef: SecurityDescriptor :
 INFO interface: detail: Settings           : MSFT_TaskSettings3
 INFO interface: detail:     wef: Settings           : MSFT_TaskSettings3
    wef: Settings           : MSFT_TaskSettings3
 INFO interface: detail: Source             :
 INFO interface: detail:     wef: Source             :
    wef: Source             :
 INFO interface: detail: State              : Ready
 INFO interface: detail:     wef: State              : Ready
    wef: State              : Ready
 INFO interface: detail: TaskName           : AutorunsToWinEventLog
 INFO interface: detail:     wef: TaskName           : AutorunsToWinEventLog
    wef: TaskName           : AutorunsToWinEventLog
 INFO interface: detail: TaskPath           : \
 INFO interface: detail:     wef: TaskPath           : \
    wef: TaskPath           : \
 INFO interface: detail: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail:     wef: Triggers           : {MSFT_TaskDailyTrigger}
    wef: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail: URI                : \AutorunsToWinEventLog
 INFO interface: detail:     wef: URI                : \AutorunsToWinEventLog
    wef: URI                : \AutorunsToWinEventLog
 INFO interface: detail: Version            :
 INFO interface: detail:     wef: Version            :
    wef: Version            :
 INFO interface: detail: PSComputerName     :
 INFO interface: detail:     wef: PSComputerName     :
    wef: PSComputerName     :
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail:     wef: Actions            : {MSFT_TaskExecAction}
    wef: Actions            : {MSFT_TaskExecAction}
 INFO interface: detail: Author             :
 INFO interface: detail:     wef: Author             :
    wef: Author             :
 INFO interface: detail: Date               :
 INFO interface: detail:     wef: Date               :
    wef: Date               :
 INFO interface: detail: Description        :
 INFO interface: detail:     wef: Description        :
    wef: Description        :
 INFO interface: detail: Documentation      :
 INFO interface: detail:     wef: Documentation      :
    wef: Documentation      :
 INFO interface: detail: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail:     wef: Principal          : MSFT_TaskPrincipal2
    wef: Principal          : MSFT_TaskPrincipal2
 INFO interface: detail: SecurityDescriptor :
 INFO interface: detail:     wef: SecurityDescriptor :
    wef: SecurityDescriptor :
 INFO interface: detail: Settings           : MSFT_TaskSettings3
 INFO interface: detail:     wef: Settings           : MSFT_TaskSettings3
    wef: Settings           : MSFT_TaskSettings3
 INFO interface: detail: Source             :
 INFO interface: detail:     wef: Source             :
    wef: Source             :
 INFO interface: detail: State              : Ready
 INFO interface: detail:     wef: State              : Ready
    wef: State              : Ready
 INFO interface: detail: TaskName           : AutorunsToWinEventLog
 INFO interface: detail:     wef: TaskName           : AutorunsToWinEventLog
    wef: TaskName           : AutorunsToWinEventLog
 INFO interface: detail: TaskPath           : \
 INFO interface: detail:     wef: TaskPath           : \
    wef: TaskPath           : \
 INFO interface: detail: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail:     wef: Triggers           : {MSFT_TaskDailyTrigger}
    wef: Triggers           : {MSFT_TaskDailyTrigger}
 INFO interface: detail: URI                : \AutorunsToWinEventLog
 INFO interface: detail:     wef: URI                : \AutorunsToWinEventLog
    wef: URI                : \AutorunsToWinEventLog
 INFO interface: detail: Version            :
 INFO interface: detail:     wef: Version            :
    wef: Version            :
 INFO interface: detail: PSComputerName     :
 INFO interface: detail:     wef: PSComputerName     :
    wef: PSComputerName     :
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [02:59] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
 INFO interface: detail:     wef: [02:59] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
    wef: [02:59] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 03E2B418-C0EC-4262-8167-526811185038 on shell_id 6007EC45-D31D-40CE-B6CF-33693DCDE556
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435328f580 @data=[{:stdout=>"[02:59] Installing AutorunsToWinEventLog...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"    Directory: C:\\Program Files\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Mode                LastWriteTime         Length Name                                             \r\n"}, {:stdout=>"----                -------------         ------ ----                                             \r\n"}, {:stdout=>"d-----        6/21/2022   2:59 AM                AutorunsToWinEventLog                            \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Actions            : {MSFT_TaskExecAction}\r\n"}, {:stdout=>"Author             : \r\n"}, {:stdout=>"Date               : \r\n"}, {:stdout=>"Description        : \r\n"}, {:stdout=>"Documentation      : \r\n"}, {:stdout=>"Principal          : MSFT_TaskPrincipal2\r\n"}, {:stdout=>"SecurityDescriptor : \r\n"}, {:stdout=>"Settings           : MSFT_TaskSettings3\r\n"}, {:stdout=>"Source             : \r\n"}, {:stdout=>"State              : Ready\r\n"}, {:stdout=>"TaskName           : AutorunsToWinEventLog\r\n"}, {:stdout=>"TaskPath           : \\\r\n"}, {:stdout=>"Triggers           : {MSFT_TaskDailyTrigger}\r\n"}, {:stdout=>"URI                : \\AutorunsToWinEventLog\r\n"}, {:stdout=>"Version            : \r\n"}, {:stdout=>"PSComputerName     : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Actions            : {MSFT_TaskExecAction}\r\n"}, {:stdout=>"Author             : \r\n"}, {:stdout=>"Date               : \r\n"}, {:stdout=>"Description        : \r\n"}, {:stdout=>"Documentation      : \r\n"}, {:stdout=>"Principal          : MSFT_TaskPrincipal2\r\n"}, {:stdout=>"SecurityDescriptor : \r\n"}, {:stdout=>"Settings           : MSFT_TaskSettings3\r\n"}, {:stdout=>"Source             : \r\n"}, {:stdout=>"State              : Ready\r\n"}, {:stdout=>"TaskName           : AutorunsToWinEventLog\r\n"}, {:stdout=>"TaskPath           : \\\r\n"}, {:stdout=>"Triggers           : {MSFT_TaskDailyTrigger}\r\n"}, {:stdout=>"URI                : \\AutorunsToWinEventLog\r\n"}, {:stdout=>"Version            : \r\n"}, {:stdout=>"PSComputerName     : \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[02:59] AutorunsToWinEventLog installed. Starting the scheduled task. Future runs will begin at 11am\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x00000243530d6ec8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x00000243507f2fe8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 5985=>2207, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: F0DCDA08-19C1-4324-B4B9-B711B2C14697
DEBUG winrmshell: [WinRM] Command created for hostname with id: 3F0C4BC3-8D8F-4562-AAB9-05F185391085
DEBUG winrmshell: [WinRM] creating command_id: 3F0C4BC3-8D8F-4562-AAB9-05F185391085 on shell_id F0DCDA08-19C1-4324-B4B9-B711B2C14697
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 3F0C4BC3-8D8F-4562-AAB9-05F185391085 on shell_id F0DCDA08-19C1-4324-B4B9-B711B2C14697
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352db7cd8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 22=>2212, 5986=>2208}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 3CA4F1CD-ED00-42BC-86F2-2DECC37842A7
DEBUG winrmshell: [WinRM] Command created for hostname with id: 153390C1-EF6D-4C7E-A52A-7CBFEF50740A
DEBUG winrmshell: [WinRM] creating command_id: 153390C1-EF6D-4C7E-A52A-7CBFEF50740A on shell_id 3CA4F1CD-ED00-42BC-86F2-2DECC37842A7
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 153390C1-EF6D-4C7E-A52A-7CBFEF50740A on shell_id 3CA4F1CD-ED00-42BC-86F2-2DECC37842A7
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435211b088 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2210, 5986=>2208, 22=>2209}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 2BCDD24F-1A5F-4DAC-BB19-03E1985A8A6D
DEBUG winrmshell: [WinRM] Command created for hostname with id: 994FB680-C94B-405D-91F7-8F26E321E6D8
DEBUG winrmshell: [WinRM] creating command_id: 994FB680-C94B-405D-91F7-8F26E321E6D8 on shell_id 2BCDD24F-1A5F-4DAC-BB19-03E1985A8A6D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 994FB680-C94B-405D-91F7-8F26E321E6D8 on shell_id 2BCDD24F-1A5F-4DAC-BB19-03E1985A8A6D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c345a0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243531faf20 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243531f9eb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435307dcd8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 941F82EF-1A24-45E9-AC69-C710483F7ABA
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 857A20F8-9D02-4FAD-B5C0-81E5BBBD8BEE
DEBUG winrmshell: [WinRM] creating command_id: 857A20F8-9D02-4FAD-B5C0-81E5BBBD8BEE on shell_id 941F82EF-1A24-45E9-AC69-C710483F7ABA
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 857A20F8-9D02-4FAD-B5C0-81E5BBBD8BEE on shell_id 941F82EF-1A24-45E9-AC69-C710483F7ABA
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352f59280 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243521c1ff0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243521bb858 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024350eb7ce8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 764B8C28-5DC9-4668-A360-041943DA440F
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 278FB92B-F86F-4C75-8EE9-23D251CDB4DD
DEBUG winrmshell: [WinRM] creating command_id: 278FB92B-F86F-4C75-8EE9-23D251CDB4DD on shell_id 764B8C28-5DC9-4668-A360-041943DA440F
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 278FB92B-F86F-4C75-8EE9-23D251CDB4DD on shell_id 764B8C28-5DC9-4668-A360-041943DA440F
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243532f5498 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-hqru6m to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435297a490 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352979590 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352398518 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "f8e57c707a5489b2bd0a0b1e5c2beddb083153ed" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-hqru6m";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 76AADF92-AB0E-44C6-84B3-AFB401C90440
DEBUG winrmshell: [WinRM] creating command_id: 76AADF92-AB0E-44C6-84B3-AFB401C90440 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 76AADF92-AB0E-44C6-84B3-AFB401C90440 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","f8e57c707a5489b2bd0a0b1e5c2beddb083153ed","04b00952985c8555d76eb259f2adab5966222b80","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-hqru6m to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 62B17ED5-0CFE-42E1-AC37-65D5AA690738
DEBUG winrmshell: [WinRM] creating command_id: 62B17ED5-0CFE-42E1-AC37-65D5AA690738 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 62B17ED5-0CFE-42E1-AC37-65D5AA690738 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('U2V0LVNtYlNlcnZlckNvbmZpZ3VyYXRpb24gLUF1ZGl0U21iMUFjY2VzcyAkdHJ1ZSAtRm9yY2U=')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 24BE0009-48D1-4740-B2F9-AF7250DFE2E4
DEBUG winrmshell: [WinRM] creating command_id: 24BE0009-48D1-4740-B2F9-AF7250DFE2E4 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 24BE0009-48D1-4740-B2F9-AF7250DFE2E4 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: DB9E86CF-AAA8-40DA-B195-D504BD7935B8
DEBUG winrmshell: [WinRM] creating command_id: DB9E86CF-AAA8-40DA-B195-D504BD7935B8 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: DB9E86CF-AAA8-40DA-B195-D504BD7935B8 on shell_id DB859E64-6D66-47A5-A237-F54F12246C74
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-hqru6m to C:/tmp/vagrant-shell.ps1 (0.072 KB over 1 chunks) in (0m0.17s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.91s) stream_files: (0m0.17s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     wef: Running: inline PowerShell script
    wef: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ed7190 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ed57a0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352dd05d0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 083A398A-B2E9-4A44-96D5-EA6346D2C2A9
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 621312AA-6A27-436E-89D5-F3943ADD9BDE
DEBUG winrmshell: [WinRM] creating command_id: 621312AA-6A27-436E-89D5-F3943ADD9BDE on shell_id 083A398A-B2E9-4A44-96D5-EA6346D2C2A9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 621312AA-6A27-436E-89D5-F3943ADD9BDE on shell_id 083A398A-B2E9-4A44-96D5-EA6346D2C2A9
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352c7caa8 @data=[], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x00000243507f2fe8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352a39e80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2207, 5986=>2211, 22=>2206}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: CB298284-736E-425D-932C-8F3A9D8D8ADF
DEBUG winrmshell: [WinRM] Command created for hostname with id: CDBE20A9-0627-4B35-B9AA-9EFE13EFF822
DEBUG winrmshell: [WinRM] creating command_id: CDBE20A9-0627-4B35-B9AA-9EFE13EFF822 on shell_id CB298284-736E-425D-932C-8F3A9D8D8ADF
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: CDBE20A9-0627-4B35-B9AA-9EFE13EFF822 on shell_id CB298284-736E-425D-932C-8F3A9D8D8ADF
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024353317840 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 22=>2206, 5985=>2210}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 69034AE7-71A2-49F7-91B2-9042C9D8B0DE
DEBUG winrmshell: [WinRM] Command created for hostname with id: BFCE2C20-756A-4041-9C2D-9B8829723B4B
DEBUG winrmshell: [WinRM] creating command_id: BFCE2C20-756A-4041-9C2D-9B8829723B4B on shell_id 69034AE7-71A2-49F7-91B2-9042C9D8B0DE
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: BFCE2C20-756A-4041-9C2D-9B8829723B4B on shell_id 69034AE7-71A2-49F7-91B2-9042C9D8B0DE
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352ac8f90 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2204}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 07B822A3-C10E-414C-9023-5C5A6063AFBB
DEBUG winrmshell: [WinRM] Command created for hostname with id: ABB22425-AC44-4A6C-B76E-07E42BA67664
DEBUG winrmshell: [WinRM] creating command_id: ABB22425-AC44-4A6C-B76E-07E42BA67664 on shell_id 07B822A3-C10E-414C-9023-5C5A6063AFBB
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: ABB22425-AC44-4A6C-B76E-07E42BA67664 on shell_id 07B822A3-C10E-414C-9023-5C5A6063AFBB
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243530930b0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435245fe10 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435245da70 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243522189e0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 9807D780-9B86-4B1B-8609-5FFCD4EF1C05
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 173A2DC3-B0B2-4B0F-AA6E-CEDF8C4CF44F
DEBUG winrmshell: [WinRM] creating command_id: 173A2DC3-B0B2-4B0F-AA6E-CEDF8C4CF44F on shell_id 9807D780-9B86-4B1B-8609-5FFCD4EF1C05
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 173A2DC3-B0B2-4B0F-AA6E-CEDF8C4CF44F on shell_id 9807D780-9B86-4B1B-8609-5FFCD4EF1C05
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024350f51c30 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ab1458 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352ab0440 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a22d48 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C53F12D8-F88E-4041-9BF1-3E47B64D0334
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 54C76A6B-766A-4114-9BF0-B70069947AB9
DEBUG winrmshell: [WinRM] creating command_id: 54C76A6B-766A-4114-9BF0-B70069947AB9 on shell_id C53F12D8-F88E-4041-9BF1-3E47B64D0334
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 54C76A6B-766A-4114-9BF0-B70069947AB9 on shell_id C53F12D8-F88E-4041-9BF1-3E47B64D0334
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435256da50 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1870tdm.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c04c88 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352bff008 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b26398 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "1aeca5e0a81386becd3cfb528ab0c38dae8cb1ef" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-1870tdm.ps1";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 6B2651EF-EAB4-4CEC-A090-3100B08D4278
DEBUG winrmshell: [WinRM] creating command_id: 6B2651EF-EAB4-4CEC-A090-3100B08D4278 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 6B2651EF-EAB4-4CEC-A090-3100B08D4278 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","1aeca5e0a81386becd3cfb528ab0c38dae8cb1ef","f8e57c707a5489b2bd0a0b1e5c2beddb083153ed","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1870tdm.ps1 to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E2E99634-271C-44D8-8ABC-39698C9BAF21
DEBUG winrmshell: [WinRM] creating command_id: E2E99634-271C-44D8-8ABC-39698C9BAF21 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E2E99634-271C-44D8-8ABC-39698C9BAF21 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('IyBQdXJwb3NlOiBEb3dubG9hZHMsIGluc3RhbGxzIGFuZCBjb25maWd1cmVzIE1pY3Jvc2Z0IEFUQSAxLjkKJHRpdGxlID0gIk1pY3Jvc29mdCBBVEEgMS45IgokZG93bmxvYWRVcmwgPSAiaHR0cDovL2Rvd25sb2FkLm1pY3Jvc29mdC5jb20vZG93bmxvYWQvNC85LzEvNDkxMzk0RDEtM0YyOC00MjYxLUFCQzYtQzgzNkEzMDEyOTBFL0FUQTEuOS5pc28iCiRmaWxlSGFzaCA9ICJEQzEwNzBBOUU4Rjg0RTc1MTk4QTkyMEEyRTAwRERDM0NBOEQxMjc0NUFGNjRGNkIxNjE4OTJEOUYzOTc1ODU3IiAjIFVzZSBHZXQtRmlsZUhhc2ggb24gYSBjb3JyZWN0IGRvd25sb2FkZWQgZmlsZSB0byBnZXQgdGhlIGhhc2gKCiMgRW5hYmxlIHdlYiByZXF1ZXN0cyB0byBlbmRwb2ludHMgd2l0aCBpbnZhbGlkIFNTTCBjZXJ0cyAobGlrZSBzZWxmLXNpZ25lZCBjZXJ0cykKSWYgKC1ub3QoIlNTTFZhbGlkYXRvciIgLWFzIFt0eXBlXSkpIHsKICAgIGFkZC10eXBlIC1UeXBlRGVmaW5pdGlvbiBAIgp1c2luZyBTeXN0ZW07CnVzaW5nIFN5c3RlbS5OZXQ7CnVzaW5nIFN5c3RlbS5OZXQuU2VjdXJpdHk7CnVzaW5nIFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuWDUwOUNlcnRpZmljYXRlczsKCnB1YmxpYyBzdGF0aWMgY2xhc3MgU1NMVmFsaWRhdG9yIHsKICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBSZXR1cm5UcnVlKG9iamVjdCBzZW5kZXIsCiAgICAgICAgWDUwOUNlcnRpZmljYXRlIGNlcnRpZmljYXRlLAogICAgICAgIFg1MDlDaGFpbiBjaGFpbiwKICAgICAgICBTc2xQb2xpY3lFcnJvcnMgc3NsUG9saWN5RXJyb3JzKSB7IHJldHVybiB0cnVlOyB9CgogICAgcHVibGljIHN0YXRpYyBSZW1vdGVDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayBHZXREZWxlZ2F0ZSgpIHsKICAgICAgICByZXR1cm4gbmV3IFJlbW90ZUNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrKFNTTFZhbGlkYXRvci5SZXR1cm5UcnVlKTsKICAgIH0KfQoiQAp9CltTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9IFtTU0xWYWxpZGF0b3JdOjpHZXREZWxlZ2F0ZSgpCgpJZiAoLW5vdCAoVGVzdC1QYXRoICJDOlxQcm9ncmFtIEZpbGVzXE1pY3Jvc29mdCBBZHZhbmNlZCBUaHJlYXQgQW5hbHl0aWNzXENlbnRlciIpKQp7CiAgICAkZG93bmxvYWQgPSAkZmFsc2UKICAgIElmICgtbm90IChUZXN0LVBhdGggImM6XCR0aXRsZS5pc28iKSkKICAgIHsKICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgJHRpdGxlLmlzbyBkb2Vzbid0IGV4aXN0IHlldCwgZG93bmxvYWRpbmcuLi4iCiAgICAgICAgJGRvd25sb2FkID0gJHRydWUKICAgIH0KICAgIEVsc2UKICAgIHsKICAgICAgICAkYWN0dWFsSGFzaCA9IChHZXQtRmlsZUhhc2ggLUFsZ29yaXRobSBTSEEyNTYgLVBhdGggImM6XCR0aXRsZS5pc28iKS5IYXNoCiAgICAgICAgSWYgKC1ub3QgKCRhY3R1YWxIYXNoIC1lcSAkZmlsZUhhc2gpKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpICR0aXRsZS5pc28gZXhpc3RzLCBidXQgdGhlIGhhc2ggZGlkIG5vdCB2YWxpZGF0ZSBzdWNjZXNzZnVsbHkuIERvd25sb2FkaW5nIGEgbmV3IGNvcHkuLi4iCiAgICAgICAgICAgICRkb3dubG9hZCA9ICR0cnVlCiAgICAgICAgfQogICAgfQogICAgSWYgKCRkb3dubG9hZCAtZXEgJHRydWUpCiAgICB7CiAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIERvd25sb2FkaW5nICR0aXRsZS4uLiIKICAgICAgICAjIERpc2FibGluZyB0aGUgcHJvZ3Jlc3MgYmFyIHNwZWVkcyB1cCBJV1IgaHR0cHM6Ly9naXRodWIuY29tL1Bvd2VyU2hlbGwvUG93ZXJTaGVsbC9pc3N1ZXMvMjEzOAogICAgICAgICRQcm9ncmVzc1ByZWZlcmVuY2UgPSAnU2lsZW50bHlDb250aW51ZScKICAgICAgICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICRkb3dubG9hZFVybCAtT3V0RmlsZSAiYzpcJHRpdGxlLmlzbyIKICAgICAgICAkYWN0dWFsSGFzaCA9IChHZXQtRmlsZUhhc2ggLUFsZ29yaXRobSBTSEEyNTYgLVBhdGggImM6XCR0aXRsZS5pc28iKS5IYXNoCiAgICAgICAgSWYgKC1ub3QgKCRhY3R1YWxIYXNoIC1lcSAkZmlsZUhhc2gpKQogICAgICAgIHsKICAgICAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpICR0aXRsZS5pc28gd2FzIG5vdCBkb3dubG9hZGVkIGNvcnJlY3RseTogaGFzaCBmcm9tIGRvd25sb2FkZWQgZmlsZTogJGFjdHVhbEhhc2gsIHNob3VsZCd2ZSBiZWVuOiAkZmlsZUhhc2guIFJlLXRyeWluZyB1c2luZyBCaXRzQWRtaW4gbm93Li4uIgogICAgICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAiYzpcJHRpdGxlLmlzbyIgLUZvcmNlCiAgICAgICAgICAgIGJpdHNhZG1pbiAvVHJhbnNmZXIgQVRBICRkb3dubG9hZFVybCAiYzpcJHRpdGxlLmlzbyIKICAgICAgICAgICAgJGFjdHVhbEhhc2ggPSAoR2V0LUZpbGVIYXNoIC1BbGdvcml0aG0gU0hBMjU2IC1QYXRoICJjOlwkdGl0bGUuaXNvIikuSGFzaAogICAgICAgICAgICBJZiAoLW5vdCAoJGFjdHVhbEhhc2ggLWVxICRmaWxlSGFzaCkpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIFRocm93ICIkdGl0bGUuaXNvIHdhcyBub3QgZG93bmxvYWRlZCBjb3JyZWN0bHkgYWZ0ZXIgYSByZXRyeTogaGFzaCBmcm9tIGRvd25sb2FkZWQgZmlsZTogJGFjdHVhbEhhc2gsIHNob3VsZCd2ZSBiZWVuOiAkZmlsZUhhc2ggLSBHaXZpbmcgdXAuIgogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQogICAgJE1vdW50ID0gTW91bnQtRGlza0ltYWdlIC1JbWFnZVBhdGggImM6XCR0aXRsZS5pc28iIC1TdG9yYWdlVHlwZSBJU08gLUFjY2VzcyBSZWFkT25seSAtUGFzc1RocnUKICAgICRWb2x1bWUgPSAkTW91bnQgfCBHZXQtVm9sdW1lCiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgSW5zdGFsbGluZyAkdGl0bGUiCiAgICAkSW5zdGFsbCA9IFN0YXJ0LVByb2Nlc3MgLVdhaXQgLUZpbGVQYXRoICgkVm9sdW1lLkRyaXZlTGV0dGVyICsgIjpcTWljcm9zb2Z0IEFUQSBDZW50ZXIgU2V0dXAuZXhlIikgLUFyZ3VtZW50TGlzdCAiL3EgLS1MaWNlbnNlQWNjZXB0ZWQgTmV0RnJhbWV3b3JrQ29tbWFuZExpbmVBcmd1bWVudHM9YCIvcWAiIC0tRW5hYmxlTWljcm9zb2Z0VXBkYXRlIiAtUGFzc1RocnUKICAgICRJbnN0YWxsCiAgICAkTW91bnQgfCBEaXNtb3VudC1EaXNrSW1hZ2UgLUNvbmZpcm06JGZhbHNlCiAgICAkYm9keSA9IGdldC1jb250ZW50ICJDOlx2YWdyYW50XHJlc291cmNlc1xtaWNyb3NvZnRfYXRhXG1pY3Jvc29mdC1hdGEtY29uZmlnLmpzb24iCgogICAgJHJlcSA9IFtTeXN0ZW0uTmV0LldlYlJlcXVlc3RdOjpDcmVhdGVIdHRwKCJodHRwczovL3dlZiIpCiAgICBUcnkgewogICAgICAgICRyZXEuR2V0UmVzcG9uc2UoKQogICAgfQogICAgQ2F0Y2ggewogICAgICAgICMgd2UgZG9uJ3QgY2FyZSBhYm91dCBlcnJvcnMgaGVyZSwgd2UganVzdCB3YW50IHRvIGdldCB0aGUgY2VydCA7KQogICAgfQogICAgJFRodW1iUHJpbnQgPSAkcmVxLlNlcnZpY2VQb2ludC5DZXJ0aWZpY2F0ZS5HZXRDZXJ0SGFzaFN0cmluZygpCiAgICAkYm9keSA9ICRib2R5IC1yZXBsYWNlICJ7e1RIVU1CUFJJTlR9fSIsICRUaHVtYlByaW50CgogICAgSW52b2tlLVJlc3RNZXRob2QgLXVyaSBodHRwczovL2xvY2FsaG9zdC9hcGkvbWFuYWdlbWVudC9zeXN0ZW1Qcm9maWxlcy9jZW50ZXIgLWJvZHkgJGJvZHkgLU1ldGhvZCBQb3N0IC1Vc2VCYXNpY1BhcnNpbmcgLVVzZURlZmF1bHRDcmVkZW50aWFscyAtQ29udGVudFR5cGUgImFwcGxpY2F0aW9uL2pzb24iCn0KClN0YXJ0LVNsZWVwIC1TZWNvbmRzIDYwCgpJbnZva2UtQ29tbWFuZCAtY29tcHV0ZXJuYW1lIGRjIC1DcmVkZW50aWFsIChuZXctb2JqZWN0IHBzY3JlZGVudGlhbCgid2luZG9tYWluXHZhZ3JhbnQiLCAoQ29udmVydFRvLVNlY3VyZVN0cmluZyAtQXNQbGFpblRleHQgLUZvcmNlIC1TdHJpbmcgInZhZ3JhbnQiKSkpIC1TY3JpcHRCbG9jayB7CgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFskZW52OmNvbXB1dGVybmFtZV0gSW5zdGFsbGluZyB0aGUgQVRBIExpZ2h0d2VpZ2h0IGdhdGV3YXkgb24gREMuLi4iCgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFskZW52OmNvbXB1dGVybmFtZV0gQWRkaW5nIHdlZi53aW5kb21haW4ubG9jYWwgdG8gaG9zdHMgZmlsZS4uLiIKICAgIEFkZC1Db250ZW50ICdjOlxcd2luZG93c1xcc3lzdGVtMzJcXGRyaXZlcnNcXGV0Y1xcaG9zdHMnICcgICAgICAgIDE5Mi4xNjguNTYuMTAzICAgIHdlZi53aW5kb21haW4ubG9jYWwnCgogICAgIyBFbmFibGUgd2ViIHJlcXVlc3RzIHRvIGVuZHBvaW50cyB3aXRoIGludmFsaWQgU1NMIGNlcnRzIChsaWtlIHNlbGYtc2lnbmVkIGNlcnRzKQogICAgSWYgKC1ub3QoIlNTTFZhbGlkYXRvciIgLWFzIFt0eXBlXSkpIHsKICAgICAgICBhZGQtdHlwZSAtVHlwZURlZmluaXRpb24gQCIKICAgIHVzaW5nIFN5c3RlbTsKICAgIHVzaW5nIFN5c3RlbS5OZXQ7CiAgICB1c2luZyBTeXN0ZW0uTmV0LlNlY3VyaXR5OwogICAgdXNpbmcgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5YNTA5Q2VydGlmaWNhdGVzOwogICAgcHVibGljIHN0YXRpYyBjbGFzcyBTU0xWYWxpZGF0b3IgewogICAgICAgIHB1YmxpYyBzdGF0aWMgYm9vbCBSZXR1cm5UcnVlKG9iamVjdCBzZW5kZXIsCiAgICAgICAgICAgIFg1MDlDZXJ0aWZpY2F0ZSBjZXJ0aWZpY2F0ZSwKICAgICAgICAgICAgWDUwOUNoYWluIGNoYWluLAogICAgICAgICAgICBTc2xQb2xpY3lFcnJvcnMgc3NsUG9saWN5RXJyb3JzKSB7IHJldHVybiB0cnVlOyB9CiAgICAgICAgcHVibGljIHN0YXRpYyBSZW1vdGVDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayBHZXREZWxlZ2F0ZSgpIHsKICAgICAgICAgICAgcmV0dXJuIG5ldyBSZW1vdGVDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayhTU0xWYWxpZGF0b3IuUmV0dXJuVHJ1ZSk7CiAgICAgICAgfQogICAgfQoiQAogICAgfQogICAgW1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlcnZlckNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrID0gW1NTTFZhbGlkYXRvcl06OkdldERlbGVnYXRlKCkKCiAgICBJZiAoLW5vdCAoVGVzdC1QYXRoICIkZW52OnRlbXBcZ2F0ZXdheXNldHVwLnppcCIpKSB7CiAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFskZW52OmNvbXB1dGVybmFtZV0gRG93bmxvYWRpbmcgQVRBIExpZ2h0d2VpZ2h0IEdhdGV3YXkgZnJvbSBXRUYgbm93Li4uIgogICAgICAgICMgRGlzYWJsaW5nIHRoZSBwcm9ncmVzcyBiYXIgc3BlZWRzIHVwIElXUiBodHRwczovL2dpdGh1Yi5jb20vUG93ZXJTaGVsbC9Qb3dlclNoZWxsL2lzc3Vlcy8yMTM4CiAgICAgICAgJFByb2dyZXNzUHJlZmVyZW5jZSA9ICdTaWxlbnRseUNvbnRpbnVlJwogICAgICAgIEludm9rZS1XZWJSZXF1ZXN0IC11cmkgaHR0cHM6Ly93ZWYvYXBpL21hbmFnZW1lbnQvc29mdHdhcmVVcGRhdGVzL2dhdGV3YXlzL2RlcGxveW1lbnRQYWNrYWdlIC1Vc2VCYXNpY1BhcnNpbmcgLU91dEZpbGUgIiRlbnY6dGVtcFxnYXRld2F5c2V0dXAuemlwIiAtQ3JlZGVudGlhbCAobmV3LW9iamVjdCBwc2NyZWRlbnRpYWwoIndlZlx2YWdyYW50IiwgKGNvbnZlcnR0by1zZWN1cmVzdHJpbmcgLUFzUGxhaW5UZXh0IC1Gb3JjZSAtU3RyaW5nICJ2YWdyYW50IikpKQogICAgICAgIEV4cGFuZC1BcmNoaXZlIC1QYXRoICIkZW52OnRlbXBcZ2F0ZXdheXNldHVwLnppcCIgLURlc3RpbmF0aW9uUGF0aCAiJGVudjp0ZW1wXGdhdGV3YXlzZXR1cCIgLUZvcmNlCiAgICB9CiAgICBFbHNlIHsKICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgWyRlbnY6Y29tcHV0ZXJuYW1lXSBNaWNyb3NvZnQgR2F0ZXdheSBoYXMgYWxyZWFkeSBiZWVuIGFscmVhZHkgZG93bmxvYWRlZC4gTW92aW5nIE9uLiIKICAgIH0KICAgIElmICgtbm90IChUZXN0LVBhdGggIkM6XFByb2dyYW0gRmlsZXNcTWljcm9zb2Z0IEFkdmFuY2VkIFRocmVhdCBBbmFseXRpY3MiKSkgewogICAgICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBbJGVudjpjb21wdXRlcm5hbWVdIEF0dGVtcHRpbmcgdG8gaW5zdGFsbCBNaWNyb3NvZnQgQVRBLi4uICIKICAgICAgICBTZXQtTG9jYXRpb24gIiRlbnY6dGVtcFxnYXRld2F5c2V0dXAiCiAgICAgICAgVHJ5IHsKICAgICAgICAgICAgU3RhcnQtUHJvY2VzcyAtV2FpdCAtRmlsZVBhdGggIi5cTWljcm9zb2Z0IEFUQSBHYXRld2F5IFNldHVwLmV4ZSIgLUFyZ3VtZW50TGlzdCAiL3EgTmV0RnJhbWV3b3JrQ29tbWFuZExpbmVBcmd1bWVudHM9YCIvcWAiIENvbnNvbGVBY2NvdW50TmFtZT1gIndlZlx2YWdyYW50YCIgQ29uc29sZUFjY291bnRQYXNzd29yZD1gInZhZ3JhbnRgIiIKICAgICAgICB9IENhdGNoIHsgCiAgICAgICAgICAgIFdyaXRlLUhvc3QgIiQoJ1t7MDpISDptbX1dJyAtZiAoR2V0LURhdGUpKSBTb21ldGhpbmcgd2VudCB3cm9uZyBhdHRlbXB0aW5nIHRvIGluc3RhbGwgdGhlIEdhdGV3YXkgb24gREMuIEFib3J0aW5nIGluc3RhbGxhdGlvbi4iCiAgICAgICAgICAgIEV4aXQgMQogICAgICAgIH0KICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgWyRlbnY6Y29tcHV0ZXJuYW1lXSBBVEEgR2F0ZXdheSBpbnN0YWxsYXRpb24gY29tcGxldGUhIgogICAgfQogICAgRWxzZSB7CiAgICAgICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFskZW52OmNvbXB1dGVybmFtZV0gVGhlIE1pY3Jvc29mdCBBVEEgR2F0ZXdheSB3YXMgYWxyZWFkeSBpbnN0YWxsZWQuIE1vdmluZyBPbi4iCiAgICAgICAgRXhpdCAwCiAgICB9CiAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgWyRlbnY6Y29tcHV0ZXJuYW1lXSBFbnN1cmluZyB0aGUgQVRBIEdhdGV3YXkgc2VydmljZSBleGlzdHMuLi4iCiAgICBUcnkgewogICAgICAgIEdldC1TZXJ2aWNlICJBVEFHYXRld2F5IiAtRXJyb3JBY3Rpb24gU3RvcAogICAgfSBDYXRjaCBbTWljcm9zb2Z0LlBvd2VyU2hlbGwuQ29tbWFuZHMuU2VydmljZUNvbW1hbmRFeGNlcHRpb25dIHsKICAgICAgICBXcml0ZS1Ib3N0ICIkKCdbezA6SEg6bW19XScgLWYgKEdldC1EYXRlKSkgWyRlbnY6Y29tcHV0ZXJuYW1lXSBVbmFibGUgdG8gZmluZCB0aGUgQVRBR2F0ZXdheSBzZXJ2aWNlLiBJbnN0YWxsYXRpb24gbXVzdCBoYXZlIGZhaWxlZC4gRXhpdGluZy4iCiAgICAgICAgRXhpdCAxCiAgICB9CgogICAgV3JpdGUtSG9zdCAiJCgnW3swOkhIOm1tfV0nIC1mIChHZXQtRGF0ZSkpIFskZW52OmNvbXB1dGVybmFtZV0gV2FpdGluZyBmb3IgdGhlIEFUQSBHYXRld2F5IHNlcnZpY2UgdG8gc3RhcnQuLi4iCiAgICAoR2V0LVNlcnZpY2UgQVRBR2F0ZXdheSkuV2FpdEZvclN0YXR1cygnUnVubmluZycsICcwMDoxMDowMCcpCiAgICBJZiAoKEdldC1TZXJ2aWNlICJBVEFHYXRld2F5IikuU3RhdHVzIC1uZSAiUnVubmluZyIpIHsKICAgICAgICBUaHJvdyAiQVRBIEdhdGV3YXkgc2VydmljZSBmYWlsZWQgdG8gc3RhcnQgb24gREMiCiAgICB9CiAgICAjIERpc2FibGUgaW52YWxpZCB3ZWIgcmVxdWVzdHMgdG8gZW5kcG9pbnRzIHdpdGggaW52YWxpZCBTU0wgY2VydHMgYWdhaW4KICAgIFtTeXN0ZW0uTmV0LlNlcnZpY2VQb2ludE1hbmFnZXJdOjpTZXJ2ZXJDZXJ0aWZpY2F0ZVZhbGlkYXRpb25DYWxsYmFjayA9ICRudWxsCn0KCiMgU2V0IHRoZSBEQyBhcyB0aGUgZG9tYWluIHN5bmNocm9uaXplcgokY29uZmlnID0gSW52b2tlLVJlc3RNZXRob2QgLVVyaSAiaHR0cHM6Ly9sb2NhbGhvc3QvYXBpL21hbmFnZW1lbnQvc3lzdGVtUHJvZmlsZXMvZ2F0ZXdheXMiIC1Vc2VEZWZhdWx0Q3JlZGVudGlhbHMgLVVzZUJhc2ljUGFyc2luZwokY29uZmlnWzBdLkNvbmZpZ3VyYXRpb24uRGlyZWN0b3J5U2VydmljZXNSZXNvbHZlckNvbmZpZ3VyYXRpb24uVXBkYXRlRGlyZWN0b3J5RW50aXR5Q2hhbmdlc0NvbmZpZ3VyYXRpb24uSXNFbmFibGVkID0gJHRydWUKCkludm9rZS1SZXN0TWV0aG9kIC1VcmkgImh0dHBzOi8vbG9jYWxob3N0L2FwaS9tYW5hZ2VtZW50L3N5c3RlbVByb2ZpbGVzL2dhdGV3YXlzLyQoJGNvbmZpZ1swXS5JZCkiIC1Vc2VEZWZhdWx0Q3JlZGVudGlhbHMgLVVzZUJhc2ljUGFyc2luZyAtTWV0aG9kIFBvc3QgLUNvbnRlbnRUeXBlICJhcHBsaWNhdGlvbi9qc29uIiAtQm9keSAoJGNvbmZpZ1swXSB8IGNvbnZlcnR0by1qc29uIC1kZXB0aCA5OSkKCiMgRGlzYWJsZSBpbnZhbGlkIHdlYiByZXF1ZXN0cyB0byBlbmRwb2ludHMgd2l0aCBpbnZhbGlkIFNTTCBjZXJ0cyBhZ2FpbgpbU3lzdGVtLk5ldC5TZXJ2aWNlUG9pbnRNYW5hZ2VyXTo6U2VydmVyQ2VydGlmaWNhdGVWYWxpZGF0aW9uQ2FsbGJhY2sgPSAkbnVsbAoKSWYgKChHZXQtU2VydmljZSAtbmFtZSAiQVRBQ2VudGVyIikuU3RhdHVzIC1uZSAiUnVubmluZyIpIHsKICAgIFRocm93ICJUaGUgTWljcm9zb2Z0IEFUQSBzZXJ2aWNlIHdhcyB1bmFibGUgdG8gc3RhcnQuIgp9Cg==')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A52C73CC-15AA-4604-B96D-54BE3446D870
DEBUG winrmshell: [WinRM] creating command_id: A52C73CC-15AA-4604-B96D-54BE3446D870 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A52C73CC-15AA-4604-B96D-54BE3446D870 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1DF0E719-A937-4BEE-8D2A-DECF0E829960
DEBUG winrmshell: [WinRM] creating command_id: 1DF0E719-A937-4BEE-8D2A-DECF0E829960 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 1DF0E719-A937-4BEE-8D2A-DECF0E829960 on shell_id 861161F5-9BFE-42C1-846F-AA89F86378A5
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-1870tdm.ps1 to C:/tmp/vagrant-shell.ps1 (11.648 KB over 1 chunks) in (0m0.16s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.49s) stream_files: (0m0.16s) extract: (0m0.00s) 
 INFO interface: detail: Running: scripts/install-microsoft-ata.ps1 as C:\tmp\vagrant-shell.ps1
 INFO interface: detail:     wef: Running: scripts/install-microsoft-ata.ps1 as C:\tmp\vagrant-shell.ps1
    wef: Running: scripts/install-microsoft-ata.ps1 as C:\tmp\vagrant-shell.ps1
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243505fbeb0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243505f8ad0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x000002435325e188 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 702B1210-9E2B-44F0-B113-6062983CA9FD
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 1473FB77-EF73-48F4-B7C3-945ACDA2EEC3
DEBUG winrmshell: [WinRM] creating command_id: 1473FB77-EF73-48F4-B7C3-945ACDA2EEC3 on shell_id 702B1210-9E2B-44F0-B113-6062983CA9FD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [02:59] Installing Microsoft ATA 1.9
 INFO interface: detail:     wef: [02:59] Installing Microsoft ATA 1.9
    wef: [02:59] Installing Microsoft ATA 1.9
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
 INFO interface: detail:     wef: Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
    wef: Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
 INFO interface: detail: -------  ------    -----      -----     ------     --  -- -----------
 INFO interface: detail:     wef: -------  ------    -----      -----     ------     --  -- -----------
    wef: -------  ------    -----      -----     ------     --  -- -----------
 INFO interface: detail:               0        0          0       0.61   3812
 INFO interface: detail:     wef:               0        0          0       0.61   3812
    wef:               0        0          0       0.61   3812
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:01] [DC] Installing the ATA Lightweight gateway on DC...
 INFO interface: detail:     wef: [03:01] [DC] Installing the ATA Lightweight gateway on DC...
    wef: [03:01] [DC] Installing the ATA Lightweight gateway on DC...
 INFO interface: detail: [03:01] [DC] Adding wef.windomain.local to hosts file...
 INFO interface: detail:     wef: [03:01] [DC] Adding wef.windomain.local to hosts file...
    wef: [03:01] [DC] Adding wef.windomain.local to hosts file...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:01] [DC] Downloading ATA Lightweight Gateway from WEF now...
 INFO interface: detail:     wef: [03:01] [DC] Downloading ATA Lightweight Gateway from WEF now...
    wef: [03:01] [DC] Downloading ATA Lightweight Gateway from WEF now...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:02] [DC] Attempting to install Microsoft ATA...
 INFO interface: detail:     wef: [03:02] [DC] Attempting to install Microsoft ATA...
    wef: [03:02] [DC] Attempting to install Microsoft ATA...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: [03:02] [DC] ATA Gateway installation complete!
 INFO interface: detail:     wef: [03:02] [DC] ATA Gateway installation complete!
    wef: [03:02] [DC] ATA Gateway installation complete!
 INFO interface: detail: [03:02] [DC] Ensuring the ATA Gateway service exists...
 INFO interface: detail:     wef: [03:02] [DC] Ensuring the ATA Gateway service exists...
    wef: [03:02] [DC] Ensuring the ATA Gateway service exists...
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: Status         : StartPending
 INFO interface: detail:     wef: Status         : StartPending
    wef: Status         : StartPending
 INFO interface: detail: Name           : ATAGateway
 INFO interface: detail:     wef: Name           : ATAGateway
    wef: Name           : ATAGateway
 INFO interface: detail: DisplayName    : Microsoft Advanced Threat Analytics Gateway
 INFO interface: detail:     wef: DisplayName    : Microsoft Advanced Threat Analytics Gateway
    wef: DisplayName    : Microsoft Advanced Threat Analytics Gateway
 INFO interface: detail: PSComputerName : dc
 INFO interface: detail:     wef: PSComputerName : dc
    wef: PSComputerName : dc
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: [03:02] [DC] Waiting for the ATA Gateway service to start...
 INFO interface: detail:     wef: [03:02] [DC] Waiting for the ATA Gateway service to start...
    wef: [03:02] [DC] Waiting for the ATA Gateway service to start...
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
 INFO interface: detail: 
 INFO interface: detail:     wef: 
    wef: 
DEBUG winrmshell: [WinRM] cleaning up command_id: 1473FB77-EF73-48F4-B7C3-945ACDA2EEC3 on shell_id 702B1210-9E2B-44F0-B113-6062983CA9FD
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435308b388 @data=[{:stdout=>"[02:59] Installing Microsoft ATA 1.9\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                             \r\n"}, {:stdout=>"-------  ------    -----      -----     ------     --  -- -----------                             \r\n"}, {:stdout=>"              0        0          0       0.61   3812                                             \r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[03:01] [DC] Installing the ATA Lightweight gateway on DC...\r\n"}, {:stdout=>"[03:01] [DC] Adding wef.windomain.local to hosts file...\r\n"}, {:stdout=>"[03:01] [DC] Downloading ATA Lightweight Gateway from WEF now...\r\n"}, {:stdout=>"[03:02] [DC] Attempting to install Microsoft ATA... \r\n"}, {:stdout=>"[03:02] [DC] ATA Gateway installation complete!\r\n"}, {:stdout=>"[03:02] [DC] Ensuring the ATA Gateway service exists...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status         : StartPending\r\n"}, {:stdout=>"Name           : ATAGateway\r\n"}, {:stdout=>"DisplayName    : Microsoft Advanced Threat Analytics Gateway\r\n"}, {:stdout=>"PSComputerName : dc\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"[03:02] [DC] Waiting for the ATA Gateway service to start...\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352a39e80 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO interface: info: Running provisioner: shell...
 INFO interface: info: ==> wef: Running provisioner: shell...
==> wef: Running provisioner: shell...
 INFO environment: Running hook: provisioner_run
 INFO runner: Running action: provisioner_run #<Method: Vagrant::Action::Builtin::Provision#run_provisioner(env) C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/builtin/provision.rb:137>
 INFO warden: Calling IN action: #<Proc:0x0000024352ca9648 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2208, 5985=>2210, 22=>2212}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 37AC3078-D419-408B-871B-BCD2210D28CD
DEBUG winrmshell: [WinRM] Command created for hostname with id: 90B73B22-0409-4895-BD24-9129EF67AE9D
DEBUG winrmshell: [WinRM] creating command_id: 90B73B22-0409-4895-BD24-9129EF67AE9D on shell_id 37AC3078-D419-408B-871B-BCD2210D28CD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 90B73B22-0409-4895-BD24-9129EF67AE9D on shell_id 37AC3078-D419-408B-871B-BCD2210D28CD
DEBUG winrmshell: Output: #<WinRM::Output:0x000002435258eca0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5986=>2211, 22=>2209, 5985=>2207}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: FE0B17C5-ABE3-469B-926E-50A5910467D5
DEBUG winrmshell: [WinRM] Command created for hostname with id: E25E3198-3B39-4A9D-9F98-272493CFEFBF
DEBUG winrmshell: [WinRM] creating command_id: E25E3198-3B39-4A9D-9F98-272493CFEFBF on shell_id FE0B17C5-ABE3-469B-926E-50A5910467D5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E25E3198-3B39-4A9D-9F98-272493CFEFBF on shell_id FE0B17C5-ABE3-469B-926E-50A5910467D5
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352df8ff8 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG guest: Searching for cap: wait_for_reboot
DEBUG guest: Checking in: windows
DEBUG guest: Found cap: wait_for_reboot in windows
 INFO guest: Execute capability: wait_for_reboot [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (windows)
 INFO winrm: Checking whether WinRM is ready...
DEBUG provider: Searching for cap: winrm_info
DEBUG provider: Checking in: vmware_desktop
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 32000
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO vmware_driver: Reading an accessible IP for machine...
 INFO vmware_driver: Reading VMX data...
DEBUG vmware_driver:   - .encoding = UTF-8
DEBUG vmware_driver:   - bios.bootorder = hdd,cdrom
DEBUG vmware_driver:   - checkpoint.vmstate = 
DEBUG vmware_driver:   - cleanshutdown = FALSE
DEBUG vmware_driver:   - config.version = 8
DEBUG vmware_driver:   - displayname = wef.windomain.local
DEBUG vmware_driver:   - ehci.pcislotnumber = -1
DEBUG vmware_driver:   - ehci.present = FALSE
DEBUG vmware_driver:   - ethernet0.addresstype = generated
DEBUG vmware_driver:   - ethernet0.connectiontype = nat
DEBUG vmware_driver:   - ethernet0.present = TRUE
DEBUG vmware_driver:   - ethernet0.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.addresstype = generated
DEBUG vmware_driver:   - ethernet1.connectiontype = custom
DEBUG vmware_driver:   - ethernet1.present = TRUE
DEBUG vmware_driver:   - ethernet1.virtualdev = e1000
DEBUG vmware_driver:   - ethernet1.vnet = vmnet2
DEBUG vmware_driver:   - extendedconfigfile = WindowsServer2016.vmxf
DEBUG vmware_driver:   - filesearchpath = .;D:\yzhao\.vagrant.d\boxes\detectionlab-VAGRANTSLASH-win2016\1.9\vmware_desktop
DEBUG vmware_driver:   - floppy0.present = FALSE
DEBUG vmware_driver:   - guestinfo.detailed.data = architecture='X86' bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - guestos = windows8srv-64
DEBUG vmware_driver:   - guestos.detailed.data = bitness='64' buildNumber='14393' distroName='Windows' distroVersion='10.0' familyName='Windows' kernelVersion='14393.2248' prettyName='Windows Server 2016, 64-bit (Build 14393.2248)'
DEBUG vmware_driver:   - gui.fullscreenatpoweron = FALSE
DEBUG vmware_driver:   - gui.viewmodeatpoweron = windowed
DEBUG vmware_driver:   - hgfs.linkrootshare = TRUE
DEBUG vmware_driver:   - hgfs.maprootshare = TRUE
DEBUG vmware_driver:   - hpet0.present = TRUE
DEBUG vmware_driver:   - ide0:0.clientdevice = TRUE
DEBUG vmware_driver:   - ide0:0.devicetype = cdrom-raw
DEBUG vmware_driver:   - ide0:0.filename = auto detect
DEBUG vmware_driver:   - ide0:0.present = TRUE
DEBUG vmware_driver:   - ide0:0.startconnected = TRUE
DEBUG vmware_driver:   - isolation.tools.hgfs.disable = FALSE
DEBUG vmware_driver:   - memsize = 2048
DEBUG vmware_driver:   - monitor.phys_bits_used = 42
DEBUG vmware_driver:   - msg.autoanswer = true
DEBUG vmware_driver:   - numa.autosize.cookie = 20001
DEBUG vmware_driver:   - numa.autosize.vcpu.maxpervirtualnode = 2
DEBUG vmware_driver:   - numvcpus = 2
DEBUG vmware_driver:   - nvme0.present = FALSE
DEBUG vmware_driver:   - nvram = WindowsServer2016.nvram
DEBUG vmware_driver:   - parallel0.autodetect = FALSE
DEBUG vmware_driver:   - parallel0.bidirectional = 
DEBUG vmware_driver:   - parallel0.filename = 
DEBUG vmware_driver:   - parallel0.present = FALSE
DEBUG vmware_driver:   - parallel0.startconnected = FALSE
DEBUG vmware_driver:   - pcibridge0.pcislotnumber = 17
DEBUG vmware_driver:   - pcibridge0.present = TRUE
DEBUG vmware_driver:   - pcibridge4.functions = 8
DEBUG vmware_driver:   - pcibridge4.pcislotnumber = 21
DEBUG vmware_driver:   - pcibridge4.present = TRUE
DEBUG vmware_driver:   - pcibridge4.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge5.functions = 8
DEBUG vmware_driver:   - pcibridge5.pcislotnumber = 22
DEBUG vmware_driver:   - pcibridge5.present = TRUE
DEBUG vmware_driver:   - pcibridge5.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge6.functions = 8
DEBUG vmware_driver:   - pcibridge6.pcislotnumber = 23
DEBUG vmware_driver:   - pcibridge6.present = TRUE
DEBUG vmware_driver:   - pcibridge6.virtualdev = pcieRootPort
DEBUG vmware_driver:   - pcibridge7.functions = 8
DEBUG vmware_driver:   - pcibridge7.pcislotnumber = 24
DEBUG vmware_driver:   - pcibridge7.present = TRUE
DEBUG vmware_driver:   - pcibridge7.virtualdev = pcieRootPort
DEBUG vmware_driver:   - policy.vm.mvmtid = 
DEBUG vmware_driver:   - powertype.poweroff = soft
DEBUG vmware_driver:   - powertype.poweron = soft
DEBUG vmware_driver:   - powertype.reset = soft
DEBUG vmware_driver:   - powertype.suspend = soft
DEBUG vmware_driver:   - proxyapps.publishtohost = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.enabled = FALSE
DEBUG vmware_driver:   - remotedisplay.vnc.ip = 127.0.0.1
DEBUG vmware_driver:   - remotedisplay.vnc.key = Ph0VJAcnCgMmCyoQFysWIhc5EA83NjALLxsRMQs4KiAVNQg6Hy0ULB8TLAMsOQoJNzYBCCkPOyM4GjErPS0AFDMqBQU6LRoRPCMDCTcfJSQ7LyQmMDQENC02DgIXHDkCGiUQJRw+LREfPiswBRMAMAouKgYvLiQPNwwwKS82BBg=
DEBUG vmware_driver:   - remotedisplay.vnc.password = hFVYlFpz
DEBUG vmware_driver:   - remotedisplay.vnc.port = 5933
DEBUG vmware_driver:   - replay.filename = 
DEBUG vmware_driver:   - replay.supported = FALSE
DEBUG vmware_driver:   - sata0.present = FALSE
DEBUG vmware_driver:   - scsi0.pcislotnumber = 160
DEBUG vmware_driver:   - scsi0.present = TRUE
DEBUG vmware_driver:   - scsi0.saswwid = 50 05 05 61 28 38 7e 20
DEBUG vmware_driver:   - scsi0.virtualdev = lsisas1068
DEBUG vmware_driver:   - scsi0:0.filename = disk-cl1.vmdk
DEBUG vmware_driver:   - scsi0:0.present = TRUE
DEBUG vmware_driver:   - scsi0:0.redo = 
DEBUG vmware_driver:   - serial0.autodetect = FALSE
DEBUG vmware_driver:   - serial0.filename = 
DEBUG vmware_driver:   - serial0.filetype = 
DEBUG vmware_driver:   - serial0.pipe.endpoint = 
DEBUG vmware_driver:   - serial0.present = FALSE
DEBUG vmware_driver:   - serial0.startconnected = FALSE
DEBUG vmware_driver:   - serial0.trynorxloss = 
DEBUG vmware_driver:   - serial0.yieldonmsrread = 
DEBUG vmware_driver:   - sharedfolder.maxnum = 1
DEBUG vmware_driver:   - softpoweroff = FALSE
DEBUG vmware_driver:   - sound.autodetect = TRUE
DEBUG vmware_driver:   - sound.filename = -1
DEBUG vmware_driver:   - sound.present = FALSE
DEBUG vmware_driver:   - sound.startconnected = FALSE
DEBUG vmware_driver:   - svga.guestbackedprimaryaware = TRUE
DEBUG vmware_driver:   - svga.vramsize = 134217728
DEBUG vmware_driver:   - tools.remindinstall = FALSE
DEBUG vmware_driver:   - tools.synctime = TRUE
DEBUG vmware_driver:   - tools.upgrade.policy = upgradeAtPowerCycle
DEBUG vmware_driver:   - toolsinstallmanager.lastinstallerror = 0
DEBUG vmware_driver:   - toolsinstallmanager.updatecounter = 3
DEBUG vmware_driver:   - usb.pcislotnumber = -1
DEBUG vmware_driver:   - usb.present = FALSE
DEBUG vmware_driver:   - uuid.action = create
DEBUG vmware_driver:   - uuid.bios = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - uuid.location = 56 4d 54 41 28 38 7e 26-40 45 97 ac 3d d6 5e fd
DEBUG vmware_driver:   - vc.uuid = 
DEBUG vmware_driver:   - virtualhw.productcompatibility = hosted
DEBUG vmware_driver:   - virtualhw.version = 11
DEBUG vmware_driver:   - vm.genid = -4386289836503236366
DEBUG vmware_driver:   - vm.genidx = -119294786489706003
DEBUG vmware_driver:   - vmci0.id = 1861462629
DEBUG vmware_driver:   - vmci0.pcislotnumber = 35
DEBUG vmware_driver:   - vmci0.present = TRUE
DEBUG vmware_driver:   - vmotion.checkpointfbsize = 4194304
DEBUG vmware_driver:   - vmotion.checkpointsvgaprimarysize = 134217728
DEBUG vmware_driver:   - ethernet0.pcislotnumber = 32
DEBUG vmware_driver:   - ethernet1.pcislotnumber = 33
DEBUG vmware_driver:   - ethernet0.generatedaddress = 00:0c:29:d6:5e:fd
DEBUG vmware_driver:   - ethernet0.generatedaddressoffset = 0
DEBUG vmware_driver:   - ethernet1.generatedaddress = 00:0c:29:d6:5e:07
DEBUG vmware_driver:   - ethernet1.generatedaddressoffset = 10
DEBUG vmware_driver:   - sharedfolder0.present = TRUE
DEBUG vmware_driver:   - sharedfolder0.enabled = TRUE
DEBUG vmware_driver:   - sharedfolder0.readaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.writeaccess = TRUE
DEBUG vmware_driver:   - sharedfolder0.hostpath = D:\workspace\eWalker\DetectionLab\Vagrant
DEBUG vmware_driver:   - sharedfolder0.guestname = -vagrant
DEBUG vmware_driver:   - sharedfolder0.expiration = never
DEBUG vmware_driver: Trying to get MAC address for ethernet0
DEBUG vmware_driver: No explicitly set MAC, looking or auto-generated one...
DEBUG vmware_driver:  -- MAC: 00:0c:29:d6:5e:fd
 INFO vmware_driver: Reading DHCP lease for '00:0c:29:d6:5e:fd' on 'vmnet8'
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/dhcplease/00:0c:29:d6:5e:fd RESPONSE=200 
DEBUG vmware: Using localhost lookup for SSH info.
DEBUG vagrant_utility: request METHOD=GET PATH=/vmnet/vmnet8/portforward RESPONSE=200 
DEBUG vmware_driver: port forwards for IP 192.168.222.131: {:tcp=>{5985=>2204, 22=>2206, 5986=>2205}, :udp=>{}}
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
DEBUG provider: Searching for cap: forwarded_ports
DEBUG provider: Checking in: vmware_desktop
DEBUG provider: Found cap: forwarded_ports in vmware_desktop
 INFO provider: Execute capability: forwarded_ports [#<Vagrant::Machine: wef (HashiCorp::VagrantVMwareDesktop::Provider)>] (vmware_desktop)
DEBUG winrmshell: initializing WinRMShell
 INFO winrmshell: Attempting to connect to WinRM...
 INFO winrmshell:   - Host: 127.0.0.1
 INFO winrmshell:   - Port: 2210
 INFO winrmshell:   - Username: vagrant
 INFO winrmshell:   - Transport: negotiate
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 10B8CD4B-CCBE-4C4F-9BB9-2AE8202D6380
DEBUG winrmshell: [WinRM] Command created for hostname with id: 0574F963-A658-4100-96E1-649D8B045127
DEBUG winrmshell: [WinRM] creating command_id: 0574F963-A658-4100-96E1-649D8B045127 on shell_id 10B8CD4B-CCBE-4C4F-9BB9-2AE8202D6380
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 0574F963-A658-4100-96E1-649D8B045127 on shell_id 10B8CD4B-CCBE-4C4F-9BB9-2AE8202D6380
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352173bc0 @data=[{:stdout=>"wef"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: WinRM is ready!
DEBUG winrm: powershell executing:
# Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0

DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b24c50 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352b1bd80 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352a90960 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 560F9BA5-6DD7-4617-B98D-483E834AD424
DEBUG winrmshell: [WinRM] Command created for # Function to check whether machine is currently shutting down
function ShuttingDown {
    [string]$sourceCode = @"
using System;
using System.Runtime.InteropServices;

namespace Vagrant {
    public static class RemoteManager {
        private const int SM_SHUTTINGDOWN = 0x2000;

        [DllImport("User32.dll", CharSet = CharSet.Unicode)]
        private static extern int GetSystemMetrics(int Index);

        public static bool Shutdown() {
            return (0 != GetSystemMetrics(SM_SHUTTINGDOWN));
        }
    }
}
"@
    $type = Add-Type -TypeDefinition $sourceCode -PassThru
    return $type::Shutdown()
}

if (ShuttingDown) {
  exit 1
} else {
  # See if a reboot is scheduled in the future by trying to schedule a reboot
  . shutdown.exe -f -r -t 60

  if ($LASTEXITCODE -eq 1190) {
    # reboot is already pending
    exit 2
  }

  if ($LASTEXITCODE -eq 1115) {
    # A system shutdown is in progress
    exit 2
  }

  # Remove the pending reboot we just created above
  if ($LASTEXITCODE -eq 0) {
    . shutdown.exe -a
  }
}

# no reboot in progress or scheduled
exit 0


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: A91FE4DC-6EC9-4358-9232-60D5FD44413E
DEBUG winrmshell: [WinRM] creating command_id: A91FE4DC-6EC9-4358-9232-60D5FD44413E on shell_id 560F9BA5-6DD7-4617-B98D-483E834AD424
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: A91FE4DC-6EC9-4358-9232-60D5FD44413E on shell_id 560F9BA5-6DD7-4617-B98D-483E834AD424
DEBUG winrmshell: Output: #<WinRM::Output:0x00000243529e2478 @data=[], @exitcode=0>
DEBUG winrm: powershell executing:
net use
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352da32b0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352da2220 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352c65268 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: C1AF8ED5-CE6B-4D28-B332-F443BE506DAD
DEBUG winrmshell: [WinRM] Command created for net use

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: B1B6BC48-4F77-47F1-B68B-8CCD0C734B89
DEBUG winrmshell: [WinRM] creating command_id: B1B6BC48-4F77-47F1-B68B-8CCD0C734B89 on shell_id C1AF8ED5-CE6B-4D28-B332-F443BE506DAD
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: B1B6BC48-4F77-47F1-B68B-8CCD0C734B89 on shell_id C1AF8ED5-CE6B-4D28-B332-F443BE506DAD
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024352bae860 @data=[{:stdout=>"New connections will be remembered.\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"Status       Local     Remote                    Network\r\n"}, {:stdout=>"\r\n"}, {:stdout=>"-------------------------------------------------------------------------------\r\n"}, {:stdout=>"Unavailable  Z:        \\\\vmware-host\\Shared Folders \r\n"}, {:stdout=>"                                                VMware Shared Folders\r\n"}, {:stdout=>"The command completed successfully.\r\n"}, {:stdout=>"\r\n"}], @exitcode=0>
 INFO winrm: Uploading: D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-75l9vp to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: creating hash for file C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: Running check_files.ps1
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f73158 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352f722a8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352e22cb8 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Command created for $hash_file = @{
  "5beaa2f5ce9727b6e66058ccc617267c2d838ce7" = @{
    "target" = "C:/tmp/vagrant-shell.ps1";
    "src_basename" = "vagrant-shell20220621-7084-75l9vp";
    "dst" = "C:/tmp/vagrant-shell.ps1"
  }
}

Function Cleanup($disposable) {
  if (($disposable -ne $null) -and ($disposable.GetType().GetMethod("Dispose") -ne $null)) {
    $disposable.Dispose()
  }
}

Function Check-Files($h) {
  return $h.GetEnumerator() | ForEach-Object {
    $dst = Unresolve-Path $_.Value.target
    $dst_changed = $false
    if(Test-Path $dst -PathType Container) {
      $dst_changed = $true
      $dst = Join-Path $dst $_.Value.src_basename
    }
    New-Object psobject -Property @{
      chk_exists = ($exists = Test-Path $dst -PathType Leaf)
      src_sha1 = ($sMd5 = $_.Key)
      dst_sha1 = ($dMd5 = if ($exists) { Get-SHA1Sum $dst } else { $null })
      chk_dirty = ($dirty = if ($sMd5 -ne $dMd5) { $true } else { $false })
      verifies = if ($dirty -eq $false) { $true } else { $false }
      target_is_folder = $dst_changed
    }
  } | Select-Object -Property chk_exists,src_sha1,dst_sha1,chk_dirty,verifies,target_is_folder
}

Function Get-SHA1Sum($src) {
  Try {
    $c = [System.Security.Cryptography.SHA1]::Create()
    $bytes = $c.ComputeHash(($in = (Get-Item $src).OpenRead()))
    return ([System.BitConverter]::ToString($bytes)).Replace("-", "").ToLower()
  } 
  Finally {
    Cleanup $c
    Cleanup $in
  }
}

Function Unresolve-Path($path) {
  if ($path -eq $null) {
    return $null
  }
  else {
    return $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath($path)
  }
}

Check-Files $hash_file | ConvertTo-Csv -NoTypeInformation


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: C1BC7324-6B39-4976-B578-33B67B3F51B9
DEBUG winrmshell: [WinRM] creating command_id: C1BC7324-6B39-4976-B578-33B67B3F51B9 on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: C1BC7324-6B39-4976-B578-33B67B3F51B9 on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: Parsing CSV Response
DEBUG winrmshell: "chk_exists","src_sha1","dst_sha1","chk_dirty","verifies","target_is_folder"

"True","5beaa2f5ce9727b6e66058ccc617267c2d838ce7","1aeca5e0a81386becd3cfb528ab0c38dae8cb1ef","True","False","False"


DEBUG winrmshell: Uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-75l9vp to C:/tmp/vagrant-shell.ps1
DEBUG winrmshell: [WinRM] Command created for             $to = $ExecutionContext.SessionState.Path.GetUnresolvedProviderPathFromPSPath("C:/tmp/vagrant-shell.ps1")
            $parent = Split-Path $to
            if(!(Test-path $parent)) { mkdir $parent | Out-Null }
            $fileStream = New-Object -TypeName System.IO.FileStream -ArgumentList @(
                $to,
                [system.io.filemode]::Create,
                [System.io.FileAccess]::Write,
                [System.IO.FileShare]::ReadWrite
            )
            # Powershell caches ScrpitBlocks in a dictionary
            # keyed on the script block text. Thats just great
            # unless the script is super large and called a gillion
            # times like we might do. In such a case it will saturate the
            # Large Object Heap and lead to Out Of Memory exceptions
            # for large files or folders. So we call the internal method
            # ClearScriptBlockCache to clear it.
            $bindingFlags= [Reflection.BindingFlags] "NonPublic,Static"
            $method = [scriptblock].GetMethod("ClearScriptBlockCache", $bindingFlags)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: E6C93497-E4EB-4110-B906-A9AD150CA53F
DEBUG winrmshell: [WinRM] creating command_id: E6C93497-E4EB-4110-B906-A9AD150CA53F on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: E6C93497-E4EB-4110-B906-A9AD150CA53F on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Command created for             if($method) { $method.Invoke($Null, $Null) }
            $bytes=[Convert]::FromBase64String('V3JpdGUtSG9zdCAnV0VGIFByb3Zpc2lvbmluZyBDb21wbGV0ZSEn')
            $fileStream.Write($bytes, 0, $bytes.length)


if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 4EFAB71E-39B0-481B-8E12-2030C7789BDA
DEBUG winrmshell: [WinRM] creating command_id: 4EFAB71E-39B0-481B-8E12-2030C7789BDA on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 4EFAB71E-39B0-481B-8E12-2030C7789BDA on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Command created for $fileStream.Dispose()

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 5C5A1E40-5391-43F9-8917-BDB69EABBA55
DEBUG winrmshell: [WinRM] creating command_id: 5C5A1E40-5391-43F9-8917-BDB69EABBA55 on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] cleaning up command_id: 5C5A1E40-5391-43F9-8917-BDB69EABBA55 on shell_id 684EF03F-196B-4A67-B006-E92BD1F9BFA5
DEBUG winrmshell: Finished uploading D:/yzhao/AppData/Local/Temp/vagrant-shell20220621-7084-75l9vp to C:/tmp/vagrant-shell.ps1 (0.052 KB over 1 chunks) in (0m0.19s)
DEBUG winrmshell: No remote files to extract, skipping
DEBUG winrmshell: Uploaded 1 items dirty_check: (0m0.81s) stream_files: (0m0.19s) extract: (0m0.00s) 
 INFO interface: detail: Running: inline PowerShell script
 INFO interface: detail:     wef: Running: inline PowerShell script
    wef: Running: inline PowerShell script
DEBUG winrm: powershell executing:
powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"
DEBUG winrmshell: [WinRM] opening remote shell on http://127.0.0.1:2210/wsman
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524c6890 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Version N=\"protocolversion\">2.3</Version><Version N=\"PSVersion\">2.0</Version><Version N=\"SerializationVersion\">1.1.0.1</Version></MS></Obj>", @destination=1, @type=65538, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x00000243524c49f0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><Obj N=\"ApplicationPrivateData\" RefId=\"1\"><TN RefId=\"0\"><T>System.Management.Automation.PSPrimitiveDictionary</T><T>System.Collections.Hashtable</T><T>System.Object</T></TN><DCT><En><S N=\"Key\">BreakAll</S><B N=\"Value\">false</B></En><En><S N=\"Key\">DebugStop</S><B N=\"Value\">false</B></En><En><S N=\"Key\">UnhandledBreakpointMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">PSVersionTable</S><Obj N=\"Value\" RefId=\"2\"><TNRef RefId=\"0\" /><DCT><En><S N=\"Key\">PSVersion</S><Version N=\"Value\">5.1.14393.2248</Version></En><En><S N=\"Key\">PSEdition</S><S N=\"Value\">Desktop</S></En><En><S N=\"Key\">PSCompatibleVersions</S><Obj N=\"Value\" RefId=\"3\"><TN RefId=\"1\"><T>System.Version[]</T><T>System.Array</T><T>System.Object</T></TN><LST><Version>1.0</Version><Version>2.0</Version><Version>3.0</Version><Version>4.0</Version><Version>5.0</Version><Version>5.1.14393.2248</Version></LST></Obj></En><En><S N=\"Key\">CLRVersion</S><Version N=\"Value\">4.0.30319.42000</Version></En><En><S N=\"Key\">BuildVersion</S><Version N=\"Value\">10.0.14393.2248</Version></En><En><S N=\"Key\">WSManStackVersion</S><Version N=\"Value\">3.0</Version></En><En><S N=\"Key\">PSRemotingProtocolVersion</S><Version N=\"Value\">2.3</Version></En><En><S N=\"Key\">SerializationVersion</S><Version N=\"Value\">1.1.0.1</Version></En></DCT></Obj></En><En><S N=\"Key\">DebugMode</S><I32 N=\"Value\">1</I32></En><En><S N=\"Key\">DebugBreakpointCount</S><I32 N=\"Value\">0</I32></En></DCT></Obj></MS></Obj>", @destination=1, @type=135177, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
DEBUG winrmshell: [WinRM] polling for pipeline state. message: #<WinRM::PSRP::Message:0x0000024352292dd0 @data="\xEF\xBB\xBF<Obj RefId=\"0\"><MS><I32 N=\"RunspaceState\">2</I32></MS></Obj>", @destination=1, @type=135173, @pipeline_id="00000000-0000-0000-0000-000000000000", @runspace_pool_id="00000000-0000-0000-0000-000000000000">
DEBUG winrmshell: [WinRM] remote shell created with shell_id: 5FE464C5-A672-448B-93D1-521AF10B626D
DEBUG winrmshell: [WinRM] Command created for powershell -ExecutionPolicy Bypass -OutputFormat Text -file "C:\tmp\vagrant-shell.ps1"

if (!$?) { if($LASTEXITCODE) { exit $LASTEXITCODE } else { exit 1 } } with id: 7083B157-AD8A-4595-9CD4-F5B342353466
DEBUG winrmshell: [WinRM] creating command_id: 7083B157-AD8A-4595-9CD4-F5B342353466 on shell_id 5FE464C5-A672-448B-93D1-521AF10B626D
DEBUG winrmshell: [WinRM] Waiting for output...
DEBUG winrmshell: [WinRM] Processing output
 INFO interface: detail: WEF Provisioning Complete!
 INFO interface: detail:     wef: WEF Provisioning Complete!
    wef: WEF Provisioning Complete!
DEBUG winrmshell: [WinRM] cleaning up command_id: 7083B157-AD8A-4595-9CD4-F5B342353466 on shell_id 5FE464C5-A672-448B-93D1-521AF10B626D
DEBUG winrmshell: Output: #<WinRM::Output:0x0000024351229ef8 @data=[{:stdout=>"WEF Provisioning Complete!\r\n"}], @exitcode=0>
 INFO warden: Calling OUT action: #<Proc:0x0000024352ca9648 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Provision:0x00000243512612b8>
 INFO warden: Calling OUT action: #<Proc:0x000002435222a5c8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x000002435249f088>
 INFO warden: Calling OUT action: VMware Middleware: PruneForwardedPorts
 INFO warden: Calling OUT action: VMware Middleware: CheckExistingNetwork
 INFO warden: Calling OUT action: #<Proc:0x00000243523b24b8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024352291278>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::BoxCheckOutdated:0x0000024352278020>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: VMware Middleware: Checkpoint
 INFO warden: Calling OUT action: #<Proc:0x00000243524a53e8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x00000243520b37f8 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Proc:0x0000024351eb3a70 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x00000243524a5460>
 INFO warden: Calling OUT action: VMware Middleware: DiscardSuspendedState
 INFO warden: Calling OUT action: #<Proc:0x00000243523d3528 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024352248410>
 INFO warden: Calling OUT action: VMware Middleware: CheckVMware
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::ConfigValidate:0x0000024352231508>
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO warden: Calling OUT action: #<Proc:0x0000024350f11f68 C:/Program_Files/HashiCorp/Vagrant/embedded/gems/2.2.19/gems/vagrant-2.2.19/lib/vagrant/action/warden.rb:126 (lambda)>
 INFO warden: Calling OUT action: #<Vagrant::Action::Builtin::Call:0x0000024350f31750>
 INFO warden: Calling OUT action: VMware Middleware: FixOldMachineID
 INFO warden: Calling OUT action: VMware Middleware: Compatibility
 INFO interface: Machine: action ["reload", "end", {:target=>:wef}]
 INFO environment: Released process lock: machine-action-c4cb9d292a6574e05a72b156332ab119
DEBUG environment: Attempting to acquire process-lock: dotlock
 INFO environment: Acquired process lock: dotlock
 INFO environment: Released process lock: dotlock
 INFO subprocess: Starting process: ["C:\\Program_Files_(x86)\\VMware\\VMware Workstation\\vmrun.exe", "list"]
 INFO subprocess: Command not in installer, restoring original environment...
DEBUG subprocess: Selecting on IO
DEBUG subprocess: stdout: Total running VMs: 3

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\logger\vmware_desktop\5bd371db-e01c-4dfd-ac24-27f599313642\ubuntu-20.04-amd64.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\dc\vmware_desktop\ef966a7e-e2da-4049-b298-3e4c7ef9c443\WindowsServer2016.vmx

D:\workspace\eWalker\DetectionLab\Vagrant\.vagrant\machines\wef\vmware_desktop\b422f57c-7c53-492b-8be2-3da74bf5d4c0\WindowsServer2016.vmx
DEBUG subprocess: Waiting for process to exit. Remaining to timeout: 31999
DEBUG subprocess: Exit status: 0
DEBUG vmware: VM state requested. Current state: running
 INFO environment: Running hook: environment_unload
 INFO runner: Running action: environment_unload #<Vagrant::Action::Builder:0x0000024352fb5558>
